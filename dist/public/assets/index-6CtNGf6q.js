const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/authRedirectUtils-_KQTIe7j.js","assets/contactsVaultService-DTnxTawa.js","assets/paymentMethodVaultService-BSfQQN5M.js"])))=>i.map(i=>d[i]);
var fR=Object.defineProperty;var Ux=e=>{throw TypeError(e)};var mR=(e,t,n)=>t in e?fR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Y=(e,t,n)=>mR(e,typeof t!="symbol"?t+"":t,n),dh=(e,t,n)=>t.has(e)||Ux("Cannot "+n);var H=(e,t,n)=>(dh(e,t,"read from private field"),n?n.call(e):t.get(e)),Ie=(e,t,n)=>t.has(e)?Ux("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ee=(e,t,n,r)=>(dh(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Fe=(e,t,n)=>(dh(e,t,"access private method"),n);var Fu=(e,t,n,r)=>({set _(s){Ee(e,t,s,n)},get _(){return H(e,t,r)}});function hR(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const pR="modulepreload",gR=function(e){return"/"+e},Bx={},oe=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=gR(c),c in Bx)return;Bx[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":pR,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((f,p)=>{m.addEventListener("load",f),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};var Vu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _k={exports:{}},cm={},Sk={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hu=Symbol.for("react.element"),yR=Symbol.for("react.portal"),vR=Symbol.for("react.fragment"),xR=Symbol.for("react.strict_mode"),wR=Symbol.for("react.profiler"),_R=Symbol.for("react.provider"),SR=Symbol.for("react.context"),bR=Symbol.for("react.forward_ref"),ER=Symbol.for("react.suspense"),kR=Symbol.for("react.memo"),CR=Symbol.for("react.lazy"),Kx=Symbol.iterator;function NR(e){return e===null||typeof e!="object"?null:(e=Kx&&e[Kx]||e["@@iterator"],typeof e=="function"?e:null)}var bk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ek=Object.assign,kk={};function cl(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||bk}cl.prototype.isReactComponent={};cl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};cl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ck(){}Ck.prototype=cl.prototype;function dy(e,t,n){this.props=e,this.context=t,this.refs=kk,this.updater=n||bk}var fy=dy.prototype=new Ck;fy.constructor=dy;Ek(fy,cl.prototype);fy.isPureReactComponent=!0;var Wx=Array.isArray,Nk=Object.prototype.hasOwnProperty,my={current:null},jk={key:!0,ref:!0,__self:!0,__source:!0};function Ik(e,t,n){var r,s={},o=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)Nk.call(t,r)&&!jk.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:hu,type:e,key:o,ref:i,props:s,_owner:my.current}}function jR(e,t){return{$$typeof:hu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function hy(e){return typeof e=="object"&&e!==null&&e.$$typeof===hu}function IR(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hx=/\/+/g;function fh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?IR(""+e.key):t.toString(36)}function yd(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case hu:case yR:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+fh(i,0):r,Wx(s)?(n="",e!=null&&(n=e.replace(Hx,"$&/")+"/"),yd(s,t,n,"",function(u){return u})):s!=null&&(hy(s)&&(s=jR(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Hx,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",Wx(e))for(var l=0;l<e.length;l++){o=e[l];var c=r+fh(o,l);i+=yd(o,t,n,c,s)}else if(c=NR(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=r+fh(o,l++),i+=yd(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Uu(e,t,n){if(e==null)return e;var r=[],s=0;return yd(e,r,"","",function(o){return t.call(n,o,s++)}),r}function TR(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var In={current:null},vd={transition:null},AR={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:vd,ReactCurrentOwner:my};function Tk(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Uu,forEach:function(e,t,n){Uu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Uu(e,function(){t++}),t},toArray:function(e){return Uu(e,function(t){return t})||[]},only:function(e){if(!hy(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};We.Component=cl;We.Fragment=vR;We.Profiler=wR;We.PureComponent=dy;We.StrictMode=xR;We.Suspense=ER;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AR;We.act=Tk;We.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ek({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=my.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Nk.call(t,c)&&!jk.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:hu,type:e.type,key:s,ref:o,props:r,_owner:i}};We.createContext=function(e){return e={$$typeof:SR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:_R,_context:e},e.Consumer=e};We.createElement=Ik;We.createFactory=function(e){var t=Ik.bind(null,e);return t.type=e,t};We.createRef=function(){return{current:null}};We.forwardRef=function(e){return{$$typeof:bR,render:e}};We.isValidElement=hy;We.lazy=function(e){return{$$typeof:CR,_payload:{_status:-1,_result:e},_init:TR}};We.memo=function(e,t){return{$$typeof:kR,type:e,compare:t===void 0?null:t}};We.startTransition=function(e){var t=vd.transition;vd.transition={};try{e()}finally{vd.transition=t}};We.unstable_act=Tk;We.useCallback=function(e,t){return In.current.useCallback(e,t)};We.useContext=function(e){return In.current.useContext(e)};We.useDebugValue=function(){};We.useDeferredValue=function(e){return In.current.useDeferredValue(e)};We.useEffect=function(e,t){return In.current.useEffect(e,t)};We.useId=function(){return In.current.useId()};We.useImperativeHandle=function(e,t,n){return In.current.useImperativeHandle(e,t,n)};We.useInsertionEffect=function(e,t){return In.current.useInsertionEffect(e,t)};We.useLayoutEffect=function(e,t){return In.current.useLayoutEffect(e,t)};We.useMemo=function(e,t){return In.current.useMemo(e,t)};We.useReducer=function(e,t,n){return In.current.useReducer(e,t,n)};We.useRef=function(e){return In.current.useRef(e)};We.useState=function(e){return In.current.useState(e)};We.useSyncExternalStore=function(e,t,n){return In.current.useSyncExternalStore(e,t,n)};We.useTransition=function(){return In.current.useTransition()};We.version="18.3.1";Sk.exports=We;var w=Sk.exports;const Be=uy(w),Ak=hR({__proto__:null,default:Be},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR=w,DR=Symbol.for("react.element"),RR=Symbol.for("react.fragment"),$R=Object.prototype.hasOwnProperty,OR=PR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,MR={key:!0,ref:!0,__self:!0,__source:!0};function Pk(e,t,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)$R.call(t,r)&&!MR.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:DR,type:e,key:o,ref:i,props:s,_owner:OR.current}}cm.Fragment=RR;cm.jsx=Pk;cm.jsxs=Pk;_k.exports=cm;var a=_k.exports,Dk={exports:{}},or={},Rk={exports:{}},$k={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(L,O){var q=L.length;L.push(O);e:for(;0<q;){var F=q-1>>>1,W=L[F];if(0<s(W,O))L[F]=O,L[q]=W,q=F;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var O=L[0],q=L.pop();if(q!==O){L[0]=q;e:for(var F=0,W=L.length,ce=W>>>1;F<ce;){var ae=2*(F+1)-1,K=L[ae],ne=ae+1,G=L[ne];if(0>s(K,q))ne<W&&0>s(G,K)?(L[F]=G,L[ne]=q,F=ne):(L[F]=K,L[ae]=q,F=ae);else if(ne<W&&0>s(G,q))L[F]=G,L[ne]=q,F=ne;else break e}}return O}function s(L,O){var q=L.sortIndex-O.sortIndex;return q!==0?q:L.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,m=null,f=3,p=!1,v=!1,h=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(L){for(var O=n(u);O!==null;){if(O.callback===null)r(u);else if(O.startTime<=L)r(u),O.sortIndex=O.expirationTime,t(c,O);else break;O=n(u)}}function S(L){if(h=!1,_(L),!v)if(n(c)!==null)v=!0,Z(E);else{var O=n(u);O!==null&&D(S,O.startTime-L)}}function E(L,O){v=!1,h&&(h=!1,y(N),N=-1),p=!0;var q=f;try{for(_(O),m=n(c);m!==null&&(!(m.expirationTime>O)||L&&!M());){var F=m.callback;if(typeof F=="function"){m.callback=null,f=m.priorityLevel;var W=F(m.expirationTime<=O);O=e.unstable_now(),typeof W=="function"?m.callback=W:m===n(c)&&r(c),_(O)}else r(c);m=n(c)}if(m!==null)var ce=!0;else{var ae=n(u);ae!==null&&D(S,ae.startTime-O),ce=!1}return ce}finally{m=null,f=q,p=!1}}var A=!1,I=null,N=-1,T=5,$=-1;function M(){return!(e.unstable_now()-$<T)}function j(){if(I!==null){var L=e.unstable_now();$=L;var O=!0;try{O=I(!0,L)}finally{O?P():(A=!1,I=null)}}else A=!1}var P;if(typeof g=="function")P=function(){g(j)};else if(typeof MessageChannel<"u"){var b=new MessageChannel,V=b.port2;b.port1.onmessage=j,P=function(){V.postMessage(null)}}else P=function(){x(j,0)};function Z(L){I=L,A||(A=!0,P())}function D(L,O){N=x(function(){L(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,Z(E))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(L){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var q=f;f=O;try{return L()}finally{f=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,O){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var q=f;f=L;try{return O()}finally{f=q}},e.unstable_scheduleCallback=function(L,O,q){var F=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?F+q:F):q=F,L){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=q+W,L={id:d++,callback:O,priorityLevel:L,startTime:q,expirationTime:W,sortIndex:-1},q>F?(L.sortIndex=q,t(u,L),n(c)===null&&L===n(u)&&(h?(y(N),N=-1):h=!0,D(S,q-F))):(L.sortIndex=W,t(c,L),v||p||(v=!0,Z(E))),L},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(L){var O=f;return function(){var q=f;f=O;try{return L.apply(this,arguments)}finally{f=q}}}})($k);Rk.exports=$k;var zR=Rk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LR=w,sr=zR;function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ok=new Set,wc={};function Ta(e,t){Ki(e,t),Ki(e+"Capture",t)}function Ki(e,t){for(wc[e]=t,e=0;e<t.length;e++)Ok.add(t[e])}var Ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xp=Object.prototype.hasOwnProperty,FR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qx={},Gx={};function VR(e){return xp.call(Gx,e)?!0:xp.call(qx,e)?!1:FR.test(e)?Gx[e]=!0:(qx[e]=!0,!1)}function UR(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function BR(e,t,n,r){if(t===null||typeof t>"u"||UR(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tn(e,t,n,r,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var un={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){un[e]=new Tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];un[t]=new Tn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){un[e]=new Tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){un[e]=new Tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){un[e]=new Tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){un[e]=new Tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){un[e]=new Tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){un[e]=new Tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){un[e]=new Tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var py=/[\-:]([a-z])/g;function gy(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(py,gy);un[t]=new Tn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(py,gy);un[t]=new Tn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(py,gy);un[t]=new Tn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){un[e]=new Tn(e,1,!1,e.toLowerCase(),null,!1,!1)});un.xlinkHref=new Tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){un[e]=new Tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function yy(e,t,n,r){var s=un.hasOwnProperty(t)?un[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(BR(t,n,s,r)&&(n=null),r||s===null?VR(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Vs=LR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bu=Symbol.for("react.element"),Ha=Symbol.for("react.portal"),qa=Symbol.for("react.fragment"),vy=Symbol.for("react.strict_mode"),wp=Symbol.for("react.profiler"),Mk=Symbol.for("react.provider"),zk=Symbol.for("react.context"),xy=Symbol.for("react.forward_ref"),_p=Symbol.for("react.suspense"),Sp=Symbol.for("react.suspense_list"),wy=Symbol.for("react.memo"),Zs=Symbol.for("react.lazy"),Lk=Symbol.for("react.offscreen"),Zx=Symbol.iterator;function kl(e){return e===null||typeof e!="object"?null:(e=Zx&&e[Zx]||e["@@iterator"],typeof e=="function"?e:null)}var It=Object.assign,mh;function Ll(e){if(mh===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);mh=t&&t[1]||""}return`
`+mh+e}var hh=!1;function ph(e,t){if(!e||hh)return"";hh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{hh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ll(e):""}function KR(e){switch(e.tag){case 5:return Ll(e.type);case 16:return Ll("Lazy");case 13:return Ll("Suspense");case 19:return Ll("SuspenseList");case 0:case 2:case 15:return e=ph(e.type,!1),e;case 11:return e=ph(e.type.render,!1),e;case 1:return e=ph(e.type,!0),e;default:return""}}function bp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case qa:return"Fragment";case Ha:return"Portal";case wp:return"Profiler";case vy:return"StrictMode";case _p:return"Suspense";case Sp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zk:return(e.displayName||"Context")+".Consumer";case Mk:return(e._context.displayName||"Context")+".Provider";case xy:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case wy:return t=e.displayName||null,t!==null?t:bp(e.type)||"Memo";case Zs:t=e._payload,e=e._init;try{return bp(e(t))}catch{}}return null}function WR(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bp(t);case 8:return t===vy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function No(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function HR(e){var t=Fk(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ku(e){e._valueTracker||(e._valueTracker=HR(e))}function Vk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Fk(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Wd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ep(e,t){var n=t.checked;return It({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yx(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=No(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Uk(e,t){t=t.checked,t!=null&&yy(e,"checked",t,!1)}function kp(e,t){Uk(e,t);var n=No(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Cp(e,t.type,n):t.hasOwnProperty("defaultValue")&&Cp(e,t.type,No(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qx(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Cp(e,t,n){(t!=="number"||Wd(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Fl=Array.isArray;function oi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+No(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Np(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return It({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xx(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(me(92));if(Fl(n)){if(1<n.length)throw Error(me(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:No(n)}}function Bk(e,t){var n=No(t.value),r=No(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Jx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Kk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Kk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wu,Wk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Wu=Wu||document.createElement("div"),Wu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Wu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _c(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Yl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qR=["Webkit","ms","Moz","O"];Object.keys(Yl).forEach(function(e){qR.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Yl[t]=Yl[e]})});function Hk(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Yl.hasOwnProperty(e)&&Yl[e]?(""+t).trim():t+"px"}function qk(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Hk(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var GR=It({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ip(e,t){if(t){if(GR[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function Tp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ap=null;function _y(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pp=null,ai=null,ii=null;function ew(e){if(e=yu(e)){if(typeof Pp!="function")throw Error(me(280));var t=e.stateNode;t&&(t=hm(t),Pp(e.stateNode,e.type,t))}}function Gk(e){ai?ii?ii.push(e):ii=[e]:ai=e}function Zk(){if(ai){var e=ai,t=ii;if(ii=ai=null,ew(e),t)for(e=0;e<t.length;e++)ew(t[e])}}function Yk(e,t){return e(t)}function Qk(){}var gh=!1;function Xk(e,t,n){if(gh)return e(t,n);gh=!0;try{return Yk(e,t,n)}finally{gh=!1,(ai!==null||ii!==null)&&(Qk(),Zk())}}function Sc(e,t){var n=e.stateNode;if(n===null)return null;var r=hm(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(me(231,t,typeof n));return n}var Dp=!1;if(Ds)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){Dp=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{Dp=!1}function ZR(e,t,n,r,s,o,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Ql=!1,Hd=null,qd=!1,Rp=null,YR={onError:function(e){Ql=!0,Hd=e}};function QR(e,t,n,r,s,o,i,l,c){Ql=!1,Hd=null,ZR.apply(YR,arguments)}function XR(e,t,n,r,s,o,i,l,c){if(QR.apply(this,arguments),Ql){if(Ql){var u=Hd;Ql=!1,Hd=null}else throw Error(me(198));qd||(qd=!0,Rp=u)}}function Aa(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Jk(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tw(e){if(Aa(e)!==e)throw Error(me(188))}function JR(e){var t=e.alternate;if(!t){if(t=Aa(e),t===null)throw Error(me(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return tw(s),e;if(o===r)return tw(s),t;o=o.sibling}throw Error(me(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(me(189))}}if(n.alternate!==r)throw Error(me(190))}if(n.tag!==3)throw Error(me(188));return n.stateNode.current===n?e:t}function e1(e){return e=JR(e),e!==null?t1(e):null}function t1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=t1(e);if(t!==null)return t;e=e.sibling}return null}var n1=sr.unstable_scheduleCallback,nw=sr.unstable_cancelCallback,e$=sr.unstable_shouldYield,t$=sr.unstable_requestPaint,$t=sr.unstable_now,n$=sr.unstable_getCurrentPriorityLevel,Sy=sr.unstable_ImmediatePriority,r1=sr.unstable_UserBlockingPriority,Gd=sr.unstable_NormalPriority,r$=sr.unstable_LowPriority,s1=sr.unstable_IdlePriority,um=null,ts=null;function s$(e){if(ts&&typeof ts.onCommitFiberRoot=="function")try{ts.onCommitFiberRoot(um,e,void 0,(e.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:i$,o$=Math.log,a$=Math.LN2;function i$(e){return e>>>=0,e===0?32:31-(o$(e)/a$|0)|0}var Hu=64,qu=4194304;function Vl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zd(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=Vl(l):(o&=i,o!==0&&(r=Vl(o)))}else i=n&~s,i!==0?r=Vl(i):o!==0&&(r=Vl(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Pr(t),s=1<<n,r|=e[n],t&=~s;return r}function l$(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function c$(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-Pr(o),l=1<<i,c=s[i];c===-1?(!(l&n)||l&r)&&(s[i]=l$(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function $p(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function o1(){var e=Hu;return Hu<<=1,!(Hu&4194240)&&(Hu=64),e}function yh(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pr(t),e[t]=n}function u$(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Pr(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function by(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Pr(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var at=0;function a1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var i1,Ey,l1,c1,u1,Op=!1,Gu=[],yo=null,vo=null,xo=null,bc=new Map,Ec=new Map,Qs=[],d$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rw(e,t){switch(e){case"focusin":case"focusout":yo=null;break;case"dragenter":case"dragleave":vo=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":bc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(t.pointerId)}}function Nl(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=yu(t),t!==null&&Ey(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function f$(e,t,n,r,s){switch(t){case"focusin":return yo=Nl(yo,e,t,n,r,s),!0;case"dragenter":return vo=Nl(vo,e,t,n,r,s),!0;case"mouseover":return xo=Nl(xo,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return bc.set(o,Nl(bc.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ec.set(o,Nl(Ec.get(o)||null,e,t,n,r,s)),!0}return!1}function d1(e){var t=ea(e.target);if(t!==null){var n=Aa(t);if(n!==null){if(t=n.tag,t===13){if(t=Jk(n),t!==null){e.blockedOn=t,u1(e.priority,function(){l1(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Mp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ap=r,n.target.dispatchEvent(r),Ap=null}else return t=yu(n),t!==null&&Ey(t),e.blockedOn=n,!1;t.shift()}return!0}function sw(e,t,n){xd(e)&&n.delete(t)}function m$(){Op=!1,yo!==null&&xd(yo)&&(yo=null),vo!==null&&xd(vo)&&(vo=null),xo!==null&&xd(xo)&&(xo=null),bc.forEach(sw),Ec.forEach(sw)}function jl(e,t){e.blockedOn===t&&(e.blockedOn=null,Op||(Op=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,m$)))}function kc(e){function t(s){return jl(s,e)}if(0<Gu.length){jl(Gu[0],e);for(var n=1;n<Gu.length;n++){var r=Gu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(yo!==null&&jl(yo,e),vo!==null&&jl(vo,e),xo!==null&&jl(xo,e),bc.forEach(t),Ec.forEach(t),n=0;n<Qs.length;n++)r=Qs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Qs.length&&(n=Qs[0],n.blockedOn===null);)d1(n),n.blockedOn===null&&Qs.shift()}var li=Vs.ReactCurrentBatchConfig,Yd=!0;function h$(e,t,n,r){var s=at,o=li.transition;li.transition=null;try{at=1,ky(e,t,n,r)}finally{at=s,li.transition=o}}function p$(e,t,n,r){var s=at,o=li.transition;li.transition=null;try{at=4,ky(e,t,n,r)}finally{at=s,li.transition=o}}function ky(e,t,n,r){if(Yd){var s=Mp(e,t,n,r);if(s===null)Nh(e,t,r,Qd,n),rw(e,r);else if(f$(s,e,t,n,r))r.stopPropagation();else if(rw(e,r),t&4&&-1<d$.indexOf(e)){for(;s!==null;){var o=yu(s);if(o!==null&&i1(o),o=Mp(e,t,n,r),o===null&&Nh(e,t,r,Qd,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Nh(e,t,r,null,n)}}var Qd=null;function Mp(e,t,n,r){if(Qd=null,e=_y(r),e=ea(e),e!==null)if(t=Aa(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Jk(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qd=e,null}function f1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(n$()){case Sy:return 1;case r1:return 4;case Gd:case r$:return 16;case s1:return 536870912;default:return 16}default:return 16}}var uo=null,Cy=null,wd=null;function m1(){if(wd)return wd;var e,t=Cy,n=t.length,r,s="value"in uo?uo.value:uo.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[o-r];r++);return wd=s.slice(e,1<r?1-r:void 0)}function _d(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zu(){return!0}function ow(){return!1}function ar(e){function t(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Zu:ow,this.isPropagationStopped=ow,this}return It(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zu)},persist:function(){},isPersistent:Zu}),t}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ny=ar(ul),gu=It({},ul,{view:0,detail:0}),g$=ar(gu),vh,xh,Il,dm=It({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Il&&(Il&&e.type==="mousemove"?(vh=e.screenX-Il.screenX,xh=e.screenY-Il.screenY):xh=vh=0,Il=e),vh)},movementY:function(e){return"movementY"in e?e.movementY:xh}}),aw=ar(dm),y$=It({},dm,{dataTransfer:0}),v$=ar(y$),x$=It({},gu,{relatedTarget:0}),wh=ar(x$),w$=It({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),_$=ar(w$),S$=It({},ul,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),b$=ar(S$),E$=It({},ul,{data:0}),iw=ar(E$),k$={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C$={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N$={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j$(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=N$[e])?!!t[e]:!1}function jy(){return j$}var I$=It({},gu,{key:function(e){if(e.key){var t=k$[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_d(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?C$[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jy,charCode:function(e){return e.type==="keypress"?_d(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_d(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),T$=ar(I$),A$=It({},dm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lw=ar(A$),P$=It({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jy}),D$=ar(P$),R$=It({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),$$=ar(R$),O$=It({},dm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),M$=ar(O$),z$=[9,13,27,32],Iy=Ds&&"CompositionEvent"in window,Xl=null;Ds&&"documentMode"in document&&(Xl=document.documentMode);var L$=Ds&&"TextEvent"in window&&!Xl,h1=Ds&&(!Iy||Xl&&8<Xl&&11>=Xl),cw=" ",uw=!1;function p1(e,t){switch(e){case"keyup":return z$.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ga=!1;function F$(e,t){switch(e){case"compositionend":return g1(t);case"keypress":return t.which!==32?null:(uw=!0,cw);case"textInput":return e=t.data,e===cw&&uw?null:e;default:return null}}function V$(e,t){if(Ga)return e==="compositionend"||!Iy&&p1(e,t)?(e=m1(),wd=Cy=uo=null,Ga=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return h1&&t.locale!=="ko"?null:t.data;default:return null}}var U$={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!U$[e.type]:t==="textarea"}function y1(e,t,n,r){Gk(r),t=Xd(t,"onChange"),0<t.length&&(n=new Ny("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jl=null,Cc=null;function B$(e){j1(e,0)}function fm(e){var t=Qa(e);if(Vk(t))return e}function K$(e,t){if(e==="change")return t}var v1=!1;if(Ds){var _h;if(Ds){var Sh="oninput"in document;if(!Sh){var fw=document.createElement("div");fw.setAttribute("oninput","return;"),Sh=typeof fw.oninput=="function"}_h=Sh}else _h=!1;v1=_h&&(!document.documentMode||9<document.documentMode)}function mw(){Jl&&(Jl.detachEvent("onpropertychange",x1),Cc=Jl=null)}function x1(e){if(e.propertyName==="value"&&fm(Cc)){var t=[];y1(t,Cc,e,_y(e)),Xk(B$,t)}}function W$(e,t,n){e==="focusin"?(mw(),Jl=t,Cc=n,Jl.attachEvent("onpropertychange",x1)):e==="focusout"&&mw()}function H$(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fm(Cc)}function q$(e,t){if(e==="click")return fm(t)}function G$(e,t){if(e==="input"||e==="change")return fm(t)}function Z$(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zr=typeof Object.is=="function"?Object.is:Z$;function Nc(e,t){if(zr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xp.call(t,s)||!zr(e[s],t[s]))return!1}return!0}function hw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pw(e,t){var n=hw(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hw(n)}}function w1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?w1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _1(){for(var e=window,t=Wd();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Wd(e.document)}return t}function Ty(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Y$(e){var t=_1(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&w1(n.ownerDocument.documentElement,n)){if(r!==null&&Ty(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=pw(n,o);var i=pw(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Q$=Ds&&"documentMode"in document&&11>=document.documentMode,Za=null,zp=null,ec=null,Lp=!1;function gw(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Lp||Za==null||Za!==Wd(r)||(r=Za,"selectionStart"in r&&Ty(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ec&&Nc(ec,r)||(ec=r,r=Xd(zp,"onSelect"),0<r.length&&(t=new Ny("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Za)))}function Yu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ya={animationend:Yu("Animation","AnimationEnd"),animationiteration:Yu("Animation","AnimationIteration"),animationstart:Yu("Animation","AnimationStart"),transitionend:Yu("Transition","TransitionEnd")},bh={},S1={};Ds&&(S1=document.createElement("div").style,"AnimationEvent"in window||(delete Ya.animationend.animation,delete Ya.animationiteration.animation,delete Ya.animationstart.animation),"TransitionEvent"in window||delete Ya.transitionend.transition);function mm(e){if(bh[e])return bh[e];if(!Ya[e])return e;var t=Ya[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in S1)return bh[e]=t[n];return e}var b1=mm("animationend"),E1=mm("animationiteration"),k1=mm("animationstart"),C1=mm("transitionend"),N1=new Map,yw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fo(e,t){N1.set(e,t),Ta(t,[e])}for(var Eh=0;Eh<yw.length;Eh++){var kh=yw[Eh],X$=kh.toLowerCase(),J$=kh[0].toUpperCase()+kh.slice(1);Fo(X$,"on"+J$)}Fo(b1,"onAnimationEnd");Fo(E1,"onAnimationIteration");Fo(k1,"onAnimationStart");Fo("dblclick","onDoubleClick");Fo("focusin","onFocus");Fo("focusout","onBlur");Fo(C1,"onTransitionEnd");Ki("onMouseEnter",["mouseout","mouseover"]);Ki("onMouseLeave",["mouseout","mouseover"]);Ki("onPointerEnter",["pointerout","pointerover"]);Ki("onPointerLeave",["pointerout","pointerover"]);Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function vw(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,XR(r,t,void 0,e),e.currentTarget=null}function j1(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;vw(s,l,u),o=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;vw(s,l,u),o=c}}}if(qd)throw e=Rp,qd=!1,Rp=null,e}function vt(e,t){var n=t[Kp];n===void 0&&(n=t[Kp]=new Set);var r=e+"__bubble";n.has(r)||(I1(t,e,2,!1),n.add(r))}function Ch(e,t,n){var r=0;t&&(r|=4),I1(n,e,r,t)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function jc(e){if(!e[Qu]){e[Qu]=!0,Ok.forEach(function(n){n!=="selectionchange"&&(eO.has(n)||Ch(n,!1,e),Ch(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qu]||(t[Qu]=!0,Ch("selectionchange",!1,t))}}function I1(e,t,n,r){switch(f1(t)){case 1:var s=h$;break;case 4:s=p$;break;default:s=ky}n=s.bind(null,t,n,e),s=void 0,!Dp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Nh(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=ea(l),i===null)return;if(c=i.tag,c===5||c===6){r=o=i;continue e}l=l.parentNode}}r=r.return}Xk(function(){var u=o,d=_y(n),m=[];e:{var f=N1.get(e);if(f!==void 0){var p=Ny,v=e;switch(e){case"keypress":if(_d(n)===0)break e;case"keydown":case"keyup":p=T$;break;case"focusin":v="focus",p=wh;break;case"focusout":v="blur",p=wh;break;case"beforeblur":case"afterblur":p=wh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=aw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=v$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=D$;break;case b1:case E1:case k1:p=_$;break;case C1:p=$$;break;case"scroll":p=g$;break;case"wheel":p=M$;break;case"copy":case"cut":case"paste":p=b$;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=lw}var h=(t&4)!==0,x=!h&&e==="scroll",y=h?f!==null?f+"Capture":null:f;h=[];for(var g=u,_;g!==null;){_=g;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,y!==null&&(S=Sc(g,y),S!=null&&h.push(Ic(g,S,_)))),x)break;g=g.return}0<h.length&&(f=new p(f,v,null,n,d),m.push({event:f,listeners:h}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&n!==Ap&&(v=n.relatedTarget||n.fromElement)&&(ea(v)||v[Rs]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=u,v=v?ea(v):null,v!==null&&(x=Aa(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(h=aw,S="onMouseLeave",y="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(h=lw,S="onPointerLeave",y="onPointerEnter",g="pointer"),x=p==null?f:Qa(p),_=v==null?f:Qa(v),f=new h(S,g+"leave",p,n,d),f.target=x,f.relatedTarget=_,S=null,ea(d)===u&&(h=new h(y,g+"enter",v,n,d),h.target=_,h.relatedTarget=x,S=h),x=S,p&&v)t:{for(h=p,y=v,g=0,_=h;_;_=za(_))g++;for(_=0,S=y;S;S=za(S))_++;for(;0<g-_;)h=za(h),g--;for(;0<_-g;)y=za(y),_--;for(;g--;){if(h===y||y!==null&&h===y.alternate)break t;h=za(h),y=za(y)}h=null}else h=null;p!==null&&xw(m,f,p,h,!1),v!==null&&x!==null&&xw(m,x,v,h,!0)}}e:{if(f=u?Qa(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=K$;else if(dw(f))if(v1)E=G$;else{E=H$;var A=W$}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=q$);if(E&&(E=E(e,u))){y1(m,E,n,d);break e}A&&A(e,f,u),e==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&Cp(f,"number",f.value)}switch(A=u?Qa(u):window,e){case"focusin":(dw(A)||A.contentEditable==="true")&&(Za=A,zp=u,ec=null);break;case"focusout":ec=zp=Za=null;break;case"mousedown":Lp=!0;break;case"contextmenu":case"mouseup":case"dragend":Lp=!1,gw(m,n,d);break;case"selectionchange":if(Q$)break;case"keydown":case"keyup":gw(m,n,d)}var I;if(Iy)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ga?p1(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(h1&&n.locale!=="ko"&&(Ga||N!=="onCompositionStart"?N==="onCompositionEnd"&&Ga&&(I=m1()):(uo=d,Cy="value"in uo?uo.value:uo.textContent,Ga=!0)),A=Xd(u,N),0<A.length&&(N=new iw(N,e,null,n,d),m.push({event:N,listeners:A}),I?N.data=I:(I=g1(n),I!==null&&(N.data=I)))),(I=L$?F$(e,n):V$(e,n))&&(u=Xd(u,"onBeforeInput"),0<u.length&&(d=new iw("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=I))}j1(m,t)})}function Ic(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Xd(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Sc(e,n),o!=null&&r.unshift(Ic(e,o,s)),o=Sc(e,t),o!=null&&r.push(Ic(e,o,s))),e=e.return}return r}function za(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function xw(e,t,n,r,s){for(var o=t._reactName,i=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Sc(n,o),c!=null&&i.unshift(Ic(n,c,l))):s||(c=Sc(n,o),c!=null&&i.push(Ic(n,c,l)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var tO=/\r\n?/g,nO=/\u0000|\uFFFD/g;function ww(e){return(typeof e=="string"?e:""+e).replace(tO,`
`).replace(nO,"")}function Xu(e,t,n){if(t=ww(t),ww(e)!==t&&n)throw Error(me(425))}function Jd(){}var Fp=null,Vp=null;function Up(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bp=typeof setTimeout=="function"?setTimeout:void 0,rO=typeof clearTimeout=="function"?clearTimeout:void 0,_w=typeof Promise=="function"?Promise:void 0,sO=typeof queueMicrotask=="function"?queueMicrotask:typeof _w<"u"?function(e){return _w.resolve(null).then(e).catch(oO)}:Bp;function oO(e){setTimeout(function(){throw e})}function jh(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),kc(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);kc(t)}function wo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Sw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var dl=Math.random().toString(36).slice(2),Qr="__reactFiber$"+dl,Tc="__reactProps$"+dl,Rs="__reactContainer$"+dl,Kp="__reactEvents$"+dl,aO="__reactListeners$"+dl,iO="__reactHandles$"+dl;function ea(e){var t=e[Qr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Rs]||n[Qr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Sw(e);e!==null;){if(n=e[Qr])return n;e=Sw(e)}return t}e=n,n=e.parentNode}return null}function yu(e){return e=e[Qr]||e[Rs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function hm(e){return e[Tc]||null}var Wp=[],Xa=-1;function Vo(e){return{current:e}}function wt(e){0>Xa||(e.current=Wp[Xa],Wp[Xa]=null,Xa--)}function gt(e,t){Xa++,Wp[Xa]=e.current,e.current=t}var jo={},yn=Vo(jo),Wn=Vo(!1),va=jo;function Wi(e,t){var n=e.type.contextTypes;if(!n)return jo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Hn(e){return e=e.childContextTypes,e!=null}function ef(){wt(Wn),wt(yn)}function bw(e,t,n){if(yn.current!==jo)throw Error(me(168));gt(yn,t),gt(Wn,n)}function T1(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(me(108,WR(e)||"Unknown",s));return It({},n,r)}function tf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jo,va=yn.current,gt(yn,e),gt(Wn,Wn.current),!0}function Ew(e,t,n){var r=e.stateNode;if(!r)throw Error(me(169));n?(e=T1(e,t,va),r.__reactInternalMemoizedMergedChildContext=e,wt(Wn),wt(yn),gt(yn,e)):wt(Wn),gt(Wn,n)}var bs=null,pm=!1,Ih=!1;function A1(e){bs===null?bs=[e]:bs.push(e)}function lO(e){pm=!0,A1(e)}function Uo(){if(!Ih&&bs!==null){Ih=!0;var e=0,t=at;try{var n=bs;for(at=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}bs=null,pm=!1}catch(s){throw bs!==null&&(bs=bs.slice(e+1)),n1(Sy,Uo),s}finally{at=t,Ih=!1}}return null}var Ja=[],ei=0,nf=null,rf=0,fr=[],mr=0,xa=null,Cs=1,Ns="";function Go(e,t){Ja[ei++]=rf,Ja[ei++]=nf,nf=e,rf=t}function P1(e,t,n){fr[mr++]=Cs,fr[mr++]=Ns,fr[mr++]=xa,xa=e;var r=Cs;e=Ns;var s=32-Pr(r)-1;r&=~(1<<s),n+=1;var o=32-Pr(t)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Cs=1<<32-Pr(t)+s|n<<s|r,Ns=o+e}else Cs=1<<o|n<<s|r,Ns=e}function Ay(e){e.return!==null&&(Go(e,1),P1(e,1,0))}function Py(e){for(;e===nf;)nf=Ja[--ei],Ja[ei]=null,rf=Ja[--ei],Ja[ei]=null;for(;e===xa;)xa=fr[--mr],fr[mr]=null,Ns=fr[--mr],fr[mr]=null,Cs=fr[--mr],fr[mr]=null}var er=null,Jn=null,bt=!1,Nr=null;function D1(e,t){var n=hr(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function kw(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,er=e,Jn=wo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,er=e,Jn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=xa!==null?{id:Cs,overflow:Ns}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hr(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,er=e,Jn=null,!0):!1;default:return!1}}function Hp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qp(e){if(bt){var t=Jn;if(t){var n=t;if(!kw(e,t)){if(Hp(e))throw Error(me(418));t=wo(n.nextSibling);var r=er;t&&kw(e,t)?D1(r,n):(e.flags=e.flags&-4097|2,bt=!1,er=e)}}else{if(Hp(e))throw Error(me(418));e.flags=e.flags&-4097|2,bt=!1,er=e}}}function Cw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;er=e}function Ju(e){if(e!==er)return!1;if(!bt)return Cw(e),bt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Up(e.type,e.memoizedProps)),t&&(t=Jn)){if(Hp(e))throw R1(),Error(me(418));for(;t;)D1(e,t),t=wo(t.nextSibling)}if(Cw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Jn=wo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Jn=null}}else Jn=er?wo(e.stateNode.nextSibling):null;return!0}function R1(){for(var e=Jn;e;)e=wo(e.nextSibling)}function Hi(){Jn=er=null,bt=!1}function Dy(e){Nr===null?Nr=[e]:Nr.push(e)}var cO=Vs.ReactCurrentBatchConfig;function Tl(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(me(309));var r=n.stateNode}if(!r)throw Error(me(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(me(284));if(!n._owner)throw Error(me(290,e))}return e}function ed(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Nw(e){var t=e._init;return t(e._payload)}function $1(e){function t(y,g){if(e){var _=y.deletions;_===null?(y.deletions=[g],y.flags|=16):_.push(g)}}function n(y,g){if(!e)return null;for(;g!==null;)t(y,g),g=g.sibling;return null}function r(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=Eo(y,g),y.index=0,y.sibling=null,y}function o(y,g,_){return y.index=_,e?(_=y.alternate,_!==null?(_=_.index,_<g?(y.flags|=2,g):_):(y.flags|=2,g)):(y.flags|=1048576,g)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,g,_,S){return g===null||g.tag!==6?(g=Oh(_,y.mode,S),g.return=y,g):(g=s(g,_),g.return=y,g)}function c(y,g,_,S){var E=_.type;return E===qa?d(y,g,_.props.children,S,_.key):g!==null&&(g.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Zs&&Nw(E)===g.type)?(S=s(g,_.props),S.ref=Tl(y,g,_),S.return=y,S):(S=jd(_.type,_.key,_.props,null,y.mode,S),S.ref=Tl(y,g,_),S.return=y,S)}function u(y,g,_,S){return g===null||g.tag!==4||g.stateNode.containerInfo!==_.containerInfo||g.stateNode.implementation!==_.implementation?(g=Mh(_,y.mode,S),g.return=y,g):(g=s(g,_.children||[]),g.return=y,g)}function d(y,g,_,S,E){return g===null||g.tag!==7?(g=fa(_,y.mode,S,E),g.return=y,g):(g=s(g,_),g.return=y,g)}function m(y,g,_){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Oh(""+g,y.mode,_),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Bu:return _=jd(g.type,g.key,g.props,null,y.mode,_),_.ref=Tl(y,null,g),_.return=y,_;case Ha:return g=Mh(g,y.mode,_),g.return=y,g;case Zs:var S=g._init;return m(y,S(g._payload),_)}if(Fl(g)||kl(g))return g=fa(g,y.mode,_,null),g.return=y,g;ed(y,g)}return null}function f(y,g,_,S){var E=g!==null?g.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return E!==null?null:l(y,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Bu:return _.key===E?c(y,g,_,S):null;case Ha:return _.key===E?u(y,g,_,S):null;case Zs:return E=_._init,f(y,g,E(_._payload),S)}if(Fl(_)||kl(_))return E!==null?null:d(y,g,_,S,null);ed(y,_)}return null}function p(y,g,_,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(_)||null,l(g,y,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Bu:return y=y.get(S.key===null?_:S.key)||null,c(g,y,S,E);case Ha:return y=y.get(S.key===null?_:S.key)||null,u(g,y,S,E);case Zs:var A=S._init;return p(y,g,_,A(S._payload),E)}if(Fl(S)||kl(S))return y=y.get(_)||null,d(g,y,S,E,null);ed(g,S)}return null}function v(y,g,_,S){for(var E=null,A=null,I=g,N=g=0,T=null;I!==null&&N<_.length;N++){I.index>N?(T=I,I=null):T=I.sibling;var $=f(y,I,_[N],S);if($===null){I===null&&(I=T);break}e&&I&&$.alternate===null&&t(y,I),g=o($,g,N),A===null?E=$:A.sibling=$,A=$,I=T}if(N===_.length)return n(y,I),bt&&Go(y,N),E;if(I===null){for(;N<_.length;N++)I=m(y,_[N],S),I!==null&&(g=o(I,g,N),A===null?E=I:A.sibling=I,A=I);return bt&&Go(y,N),E}for(I=r(y,I);N<_.length;N++)T=p(I,y,N,_[N],S),T!==null&&(e&&T.alternate!==null&&I.delete(T.key===null?N:T.key),g=o(T,g,N),A===null?E=T:A.sibling=T,A=T);return e&&I.forEach(function(M){return t(y,M)}),bt&&Go(y,N),E}function h(y,g,_,S){var E=kl(_);if(typeof E!="function")throw Error(me(150));if(_=E.call(_),_==null)throw Error(me(151));for(var A=E=null,I=g,N=g=0,T=null,$=_.next();I!==null&&!$.done;N++,$=_.next()){I.index>N?(T=I,I=null):T=I.sibling;var M=f(y,I,$.value,S);if(M===null){I===null&&(I=T);break}e&&I&&M.alternate===null&&t(y,I),g=o(M,g,N),A===null?E=M:A.sibling=M,A=M,I=T}if($.done)return n(y,I),bt&&Go(y,N),E;if(I===null){for(;!$.done;N++,$=_.next())$=m(y,$.value,S),$!==null&&(g=o($,g,N),A===null?E=$:A.sibling=$,A=$);return bt&&Go(y,N),E}for(I=r(y,I);!$.done;N++,$=_.next())$=p(I,y,N,$.value,S),$!==null&&(e&&$.alternate!==null&&I.delete($.key===null?N:$.key),g=o($,g,N),A===null?E=$:A.sibling=$,A=$);return e&&I.forEach(function(j){return t(y,j)}),bt&&Go(y,N),E}function x(y,g,_,S){if(typeof _=="object"&&_!==null&&_.type===qa&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Bu:e:{for(var E=_.key,A=g;A!==null;){if(A.key===E){if(E=_.type,E===qa){if(A.tag===7){n(y,A.sibling),g=s(A,_.props.children),g.return=y,y=g;break e}}else if(A.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Zs&&Nw(E)===A.type){n(y,A.sibling),g=s(A,_.props),g.ref=Tl(y,A,_),g.return=y,y=g;break e}n(y,A);break}else t(y,A);A=A.sibling}_.type===qa?(g=fa(_.props.children,y.mode,S,_.key),g.return=y,y=g):(S=jd(_.type,_.key,_.props,null,y.mode,S),S.ref=Tl(y,g,_),S.return=y,y=S)}return i(y);case Ha:e:{for(A=_.key;g!==null;){if(g.key===A)if(g.tag===4&&g.stateNode.containerInfo===_.containerInfo&&g.stateNode.implementation===_.implementation){n(y,g.sibling),g=s(g,_.children||[]),g.return=y,y=g;break e}else{n(y,g);break}else t(y,g);g=g.sibling}g=Mh(_,y.mode,S),g.return=y,y=g}return i(y);case Zs:return A=_._init,x(y,g,A(_._payload),S)}if(Fl(_))return v(y,g,_,S);if(kl(_))return h(y,g,_,S);ed(y,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,g!==null&&g.tag===6?(n(y,g.sibling),g=s(g,_),g.return=y,y=g):(n(y,g),g=Oh(_,y.mode,S),g.return=y,y=g),i(y)):n(y,g)}return x}var qi=$1(!0),O1=$1(!1),sf=Vo(null),of=null,ti=null,Ry=null;function $y(){Ry=ti=of=null}function Oy(e){var t=sf.current;wt(sf),e._currentValue=t}function Gp(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ci(e,t){of=e,Ry=ti=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kn=!0),e.firstContext=null)}function vr(e){var t=e._currentValue;if(Ry!==e)if(e={context:e,memoizedValue:t,next:null},ti===null){if(of===null)throw Error(me(308));ti=e,of.dependencies={lanes:0,firstContext:e}}else ti=ti.next=e;return t}var ta=null;function My(e){ta===null?ta=[e]:ta.push(e)}function M1(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,My(t)):(n.next=s.next,s.next=n),t.interleaved=n,$s(e,r)}function $s(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ys=!1;function zy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Is(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _o(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Qe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,$s(e,n)}return s=r.interleaved,s===null?(t.next=t,My(r)):(t.next=s.next,s.next=t),r.interleaved=t,$s(e,n)}function Sd(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,by(e,n)}}function jw(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function af(e,t,n,r){var s=e.updateQueue;Ys=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(o!==null){var m=s.baseState;i=0,d=u=c=null,l=o;do{var f=l.lane,p=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,h=l;switch(f=t,p=n,h.tag){case 1:if(v=h.payload,typeof v=="function"){m=v.call(p,m,f);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=h.payload,f=typeof v=="function"?v.call(p,m,f):v,f==null)break e;m=It({},m,f);break e;case 2:Ys=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=m):d=d.next=p,i|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);_a|=i,e.lanes=i,e.memoizedState=m}}function Iw(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(me(191,s));s.call(r)}}}var vu={},ns=Vo(vu),Ac=Vo(vu),Pc=Vo(vu);function na(e){if(e===vu)throw Error(me(174));return e}function Ly(e,t){switch(gt(Pc,t),gt(Ac,e),gt(ns,vu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jp(t,e)}wt(ns),gt(ns,t)}function Gi(){wt(ns),wt(Ac),wt(Pc)}function L1(e){na(Pc.current);var t=na(ns.current),n=jp(t,e.type);t!==n&&(gt(Ac,e),gt(ns,n))}function Fy(e){Ac.current===e&&(wt(ns),wt(Ac))}var Nt=Vo(0);function lf(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Th=[];function Vy(){for(var e=0;e<Th.length;e++)Th[e]._workInProgressVersionPrimary=null;Th.length=0}var bd=Vs.ReactCurrentDispatcher,Ah=Vs.ReactCurrentBatchConfig,wa=0,jt=null,Bt=null,Jt=null,cf=!1,tc=!1,Dc=0,uO=0;function fn(){throw Error(me(321))}function Uy(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zr(e[n],t[n]))return!1;return!0}function By(e,t,n,r,s,o){if(wa=o,jt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bd.current=e===null||e.memoizedState===null?hO:pO,e=n(r,s),tc){o=0;do{if(tc=!1,Dc=0,25<=o)throw Error(me(301));o+=1,Jt=Bt=null,t.updateQueue=null,bd.current=gO,e=n(r,s)}while(tc)}if(bd.current=uf,t=Bt!==null&&Bt.next!==null,wa=0,Jt=Bt=jt=null,cf=!1,t)throw Error(me(300));return e}function Ky(){var e=Dc!==0;return Dc=0,e}function Hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?jt.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function xr(){if(Bt===null){var e=jt.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=Jt===null?jt.memoizedState:Jt.next;if(t!==null)Jt=t,Bt=e;else{if(e===null)throw Error(me(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Jt===null?jt.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}function Rc(e,t){return typeof t=="function"?t(e):t}function Ph(e){var t=xr(),n=t.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=e;var r=Bt,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,c=null,u=o;do{var d=u.lane;if((wa&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,i=r):c=c.next=m,jt.lanes|=d,_a|=d}u=u.next}while(u!==null&&u!==o);c===null?i=r:c.next=l,zr(r,t.memoizedState)||(Kn=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,jt.lanes|=o,_a|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Dh(e){var t=xr(),n=t.queue;if(n===null)throw Error(me(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);zr(o,t.memoizedState)||(Kn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function F1(){}function V1(e,t){var n=jt,r=xr(),s=t(),o=!zr(r.memoizedState,s);if(o&&(r.memoizedState=s,Kn=!0),r=r.queue,Wy(K1.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,$c(9,B1.bind(null,n,r,s,t),void 0,null),tn===null)throw Error(me(349));wa&30||U1(n,t,s)}return s}function U1(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=jt.updateQueue,t===null?(t={lastEffect:null,stores:null},jt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function B1(e,t,n,r){t.value=n,t.getSnapshot=r,W1(t)&&H1(e)}function K1(e,t,n){return n(function(){W1(t)&&H1(e)})}function W1(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zr(e,n)}catch{return!0}}function H1(e){var t=$s(e,1);t!==null&&Dr(t,e,1,-1)}function Tw(e){var t=Hr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rc,lastRenderedState:e},t.queue=e,e=e.dispatch=mO.bind(null,jt,e),[t.memoizedState,e]}function $c(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=jt.updateQueue,t===null?(t={lastEffect:null,stores:null},jt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function q1(){return xr().memoizedState}function Ed(e,t,n,r){var s=Hr();jt.flags|=e,s.memoizedState=$c(1|t,n,void 0,r===void 0?null:r)}function gm(e,t,n,r){var s=xr();r=r===void 0?null:r;var o=void 0;if(Bt!==null){var i=Bt.memoizedState;if(o=i.destroy,r!==null&&Uy(r,i.deps)){s.memoizedState=$c(t,n,o,r);return}}jt.flags|=e,s.memoizedState=$c(1|t,n,o,r)}function Aw(e,t){return Ed(8390656,8,e,t)}function Wy(e,t){return gm(2048,8,e,t)}function G1(e,t){return gm(4,2,e,t)}function Z1(e,t){return gm(4,4,e,t)}function Y1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Q1(e,t,n){return n=n!=null?n.concat([e]):null,gm(4,4,Y1.bind(null,t,e),n)}function Hy(){}function X1(e,t){var n=xr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Uy(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function J1(e,t){var n=xr();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Uy(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function eC(e,t,n){return wa&21?(zr(n,t)||(n=o1(),jt.lanes|=n,_a|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kn=!0),e.memoizedState=n)}function dO(e,t){var n=at;at=n!==0&&4>n?n:4,e(!0);var r=Ah.transition;Ah.transition={};try{e(!1),t()}finally{at=n,Ah.transition=r}}function tC(){return xr().memoizedState}function fO(e,t,n){var r=bo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nC(e))rC(t,n);else if(n=M1(e,t,n,r),n!==null){var s=Nn();Dr(n,e,r,s),sC(n,t,r)}}function mO(e,t,n){var r=bo(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nC(e))rC(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,zr(l,i)){var c=t.interleaved;c===null?(s.next=s,My(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=M1(e,t,s,r),n!==null&&(s=Nn(),Dr(n,e,r,s),sC(n,t,r))}}function nC(e){var t=e.alternate;return e===jt||t!==null&&t===jt}function rC(e,t){tc=cf=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sC(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,by(e,n)}}var uf={readContext:vr,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useInsertionEffect:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useSyncExternalStore:fn,useId:fn,unstable_isNewReconciler:!1},hO={readContext:vr,useCallback:function(e,t){return Hr().memoizedState=[e,t===void 0?null:t],e},useContext:vr,useEffect:Aw,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ed(4194308,4,Y1.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ed(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ed(4,2,e,t)},useMemo:function(e,t){var n=Hr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=fO.bind(null,jt,e),[r.memoizedState,e]},useRef:function(e){var t=Hr();return e={current:e},t.memoizedState=e},useState:Tw,useDebugValue:Hy,useDeferredValue:function(e){return Hr().memoizedState=e},useTransition:function(){var e=Tw(!1),t=e[0];return e=dO.bind(null,e[1]),Hr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=jt,s=Hr();if(bt){if(n===void 0)throw Error(me(407));n=n()}else{if(n=t(),tn===null)throw Error(me(349));wa&30||U1(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Aw(K1.bind(null,r,o,e),[e]),r.flags|=2048,$c(9,B1.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Hr(),t=tn.identifierPrefix;if(bt){var n=Ns,r=Cs;n=(r&~(1<<32-Pr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Dc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=uO++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},pO={readContext:vr,useCallback:X1,useContext:vr,useEffect:Wy,useImperativeHandle:Q1,useInsertionEffect:G1,useLayoutEffect:Z1,useMemo:J1,useReducer:Ph,useRef:q1,useState:function(){return Ph(Rc)},useDebugValue:Hy,useDeferredValue:function(e){var t=xr();return eC(t,Bt.memoizedState,e)},useTransition:function(){var e=Ph(Rc)[0],t=xr().memoizedState;return[e,t]},useMutableSource:F1,useSyncExternalStore:V1,useId:tC,unstable_isNewReconciler:!1},gO={readContext:vr,useCallback:X1,useContext:vr,useEffect:Wy,useImperativeHandle:Q1,useInsertionEffect:G1,useLayoutEffect:Z1,useMemo:J1,useReducer:Dh,useRef:q1,useState:function(){return Dh(Rc)},useDebugValue:Hy,useDeferredValue:function(e){var t=xr();return Bt===null?t.memoizedState=e:eC(t,Bt.memoizedState,e)},useTransition:function(){var e=Dh(Rc)[0],t=xr().memoizedState;return[e,t]},useMutableSource:F1,useSyncExternalStore:V1,useId:tC,unstable_isNewReconciler:!1};function Er(e,t){if(e&&e.defaultProps){t=It({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Zp(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:It({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ym={isMounted:function(e){return(e=e._reactInternals)?Aa(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Nn(),s=bo(e),o=Is(r,s);o.payload=t,n!=null&&(o.callback=n),t=_o(e,o,s),t!==null&&(Dr(t,e,s,r),Sd(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Nn(),s=bo(e),o=Is(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=_o(e,o,s),t!==null&&(Dr(t,e,s,r),Sd(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Nn(),r=bo(e),s=Is(n,r);s.tag=2,t!=null&&(s.callback=t),t=_o(e,s,r),t!==null&&(Dr(t,e,r,n),Sd(t,e,r))}};function Pw(e,t,n,r,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):t.prototype&&t.prototype.isPureReactComponent?!Nc(n,r)||!Nc(s,o):!0}function oC(e,t,n){var r=!1,s=jo,o=t.contextType;return typeof o=="object"&&o!==null?o=vr(o):(s=Hn(t)?va:yn.current,r=t.contextTypes,o=(r=r!=null)?Wi(e,s):jo),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ym,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Dw(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ym.enqueueReplaceState(t,t.state,null)}function Yp(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},zy(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=vr(o):(o=Hn(t)?va:yn.current,s.context=Wi(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Zp(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ym.enqueueReplaceState(s,s.state,null),af(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Zi(e,t){try{var n="",r=t;do n+=KR(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Rh(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Qp(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var yO=typeof WeakMap=="function"?WeakMap:Map;function aC(e,t,n){n=Is(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ff||(ff=!0,ig=r),Qp(e,t)},n}function iC(e,t,n){n=Is(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Qp(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Qp(e,t),typeof r!="function"&&(So===null?So=new Set([this]):So.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Rw(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new yO;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=AO.bind(null,e,t,n),t.then(e,e))}function $w(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ow(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Is(-1,1),t.tag=2,_o(n,t,1))),n.lanes|=1),e)}var vO=Vs.ReactCurrentOwner,Kn=!1;function bn(e,t,n,r){t.child=e===null?O1(t,null,n,r):qi(t,e.child,n,r)}function Mw(e,t,n,r,s){n=n.render;var o=t.ref;return ci(t,s),r=By(e,t,n,r,o,s),n=Ky(),e!==null&&!Kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Os(e,t,s)):(bt&&n&&Ay(t),t.flags|=1,bn(e,t,r,s),t.child)}function zw(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!ev(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,lC(e,t,o,r,s)):(e=jd(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Nc,n(i,r)&&e.ref===t.ref)return Os(e,t,s)}return t.flags|=1,e=Eo(o,r),e.ref=t.ref,e.return=t,t.child=e}function lC(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(Nc(o,r)&&e.ref===t.ref)if(Kn=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(Kn=!0);else return t.lanes=e.lanes,Os(e,t,s)}return Xp(e,t,n,r,s)}function cC(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(ri,Yn),Yn|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gt(ri,Yn),Yn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,gt(ri,Yn),Yn|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,gt(ri,Yn),Yn|=r;return bn(e,t,s,n),t.child}function uC(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Xp(e,t,n,r,s){var o=Hn(n)?va:yn.current;return o=Wi(t,o),ci(t,s),n=By(e,t,n,r,o,s),r=Ky(),e!==null&&!Kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Os(e,t,s)):(bt&&r&&Ay(t),t.flags|=1,bn(e,t,n,s),t.child)}function Lw(e,t,n,r,s){if(Hn(n)){var o=!0;tf(t)}else o=!1;if(ci(t,s),t.stateNode===null)kd(e,t),oC(t,n,r),Yp(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=vr(u):(u=Hn(n)?va:yn.current,u=Wi(t,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";m||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Dw(t,i,r,u),Ys=!1;var f=t.memoizedState;i.state=f,af(t,r,i,s),c=t.memoizedState,l!==r||f!==c||Wn.current||Ys?(typeof d=="function"&&(Zp(t,n,d,r),c=t.memoizedState),(l=Ys||Pw(t,n,l,r,f,c,u))?(m||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,z1(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Er(t.type,l),i.props=u,m=t.pendingProps,f=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=vr(c):(c=Hn(n)?va:yn.current,c=Wi(t,c));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==m||f!==c)&&Dw(t,i,r,c),Ys=!1,f=t.memoizedState,i.state=f,af(t,r,i,s);var v=t.memoizedState;l!==m||f!==v||Wn.current||Ys?(typeof p=="function"&&(Zp(t,n,p,r),v=t.memoizedState),(u=Ys||Pw(t,n,u,r,f,v,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),i.props=r,i.state=v,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Jp(e,t,n,r,o,s)}function Jp(e,t,n,r,s,o){uC(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&Ew(t,n,!1),Os(e,t,o);r=t.stateNode,vO.current=t;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=qi(t,e.child,null,o),t.child=qi(t,null,l,o)):bn(e,t,l,o),t.memoizedState=r.state,s&&Ew(t,n,!0),t.child}function dC(e){var t=e.stateNode;t.pendingContext?bw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bw(e,t.context,!1),Ly(e,t.containerInfo)}function Fw(e,t,n,r,s){return Hi(),Dy(s),t.flags|=256,bn(e,t,n,r),t.child}var eg={dehydrated:null,treeContext:null,retryLane:0};function tg(e){return{baseLanes:e,cachePool:null,transitions:null}}function fC(e,t,n){var r=t.pendingProps,s=Nt.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),gt(Nt,s&1),e===null)return qp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,o?(r=t.mode,o=t.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=wm(i,r,0,null),e=fa(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=tg(n),t.memoizedState=eg,e):qy(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return xO(e,t,i,r,l,s,n);if(o){o=r.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Eo(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Eo(l,o):(o=fa(o,i,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,i=e.child.memoizedState,i=i===null?tg(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=eg,r}return o=e.child,e=o.sibling,r=Eo(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function qy(e,t){return t=wm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function td(e,t,n,r){return r!==null&&Dy(r),qi(t,e.child,null,n),e=qy(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function xO(e,t,n,r,s,o,i){if(n)return t.flags&256?(t.flags&=-257,r=Rh(Error(me(422))),td(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=wm({mode:"visible",children:r.children},s,0,null),o=fa(o,s,i,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&qi(t,e.child,null,i),t.child.memoizedState=tg(i),t.memoizedState=eg,o);if(!(t.mode&1))return td(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(me(419)),r=Rh(o,r,void 0),td(e,t,i,r)}if(l=(i&e.childLanes)!==0,Kn||l){if(r=tn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,$s(e,s),Dr(r,e,s,-1))}return Jy(),r=Rh(Error(me(421))),td(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=PO.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Jn=wo(s.nextSibling),er=t,bt=!0,Nr=null,e!==null&&(fr[mr++]=Cs,fr[mr++]=Ns,fr[mr++]=xa,Cs=e.id,Ns=e.overflow,xa=t),t=qy(t,r.children),t.flags|=4096,t)}function Vw(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Gp(e.return,t,n)}function $h(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function mC(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(bn(e,t,r.children,n),r=Nt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vw(e,n,t);else if(e.tag===19)Vw(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(gt(Nt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&lf(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),$h(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&lf(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}$h(t,!0,n,null,o);break;case"together":$h(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function kd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Os(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),_a|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,n=Eo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Eo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function wO(e,t,n){switch(t.tag){case 3:dC(t),Hi();break;case 5:L1(t);break;case 1:Hn(t.type)&&tf(t);break;case 4:Ly(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;gt(sf,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(gt(Nt,Nt.current&1),t.flags|=128,null):n&t.child.childLanes?fC(e,t,n):(gt(Nt,Nt.current&1),e=Os(e,t,n),e!==null?e.sibling:null);gt(Nt,Nt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return mC(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),gt(Nt,Nt.current),r)break;return null;case 22:case 23:return t.lanes=0,cC(e,t,n)}return Os(e,t,n)}var hC,ng,pC,gC;hC=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ng=function(){};pC=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,na(ns.current);var o=null;switch(n){case"input":s=Ep(e,s),r=Ep(e,r),o=[];break;case"select":s=It({},s,{value:void 0}),r=It({},r,{value:void 0}),o=[];break;case"textarea":s=Np(e,s),r=Np(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Jd)}Ip(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wc.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&vt("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};gC=function(e,t,n,r){n!==r&&(t.flags|=4)};function Al(e,t){if(!bt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function mn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function _O(e,t,n){var r=t.pendingProps;switch(Py(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(t),null;case 1:return Hn(t.type)&&ef(),mn(t),null;case 3:return r=t.stateNode,Gi(),wt(Wn),wt(yn),Vy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ju(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nr!==null&&(ug(Nr),Nr=null))),ng(e,t),mn(t),null;case 5:Fy(t);var s=na(Pc.current);if(n=t.type,e!==null&&t.stateNode!=null)pC(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(me(166));return mn(t),null}if(e=na(ns.current),Ju(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Qr]=t,r[Tc]=o,e=(t.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(s=0;s<Ul.length;s++)vt(Ul[s],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":Yx(r,o),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},vt("invalid",r);break;case"textarea":Xx(r,o),vt("invalid",r)}Ip(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Xu(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Xu(r.textContent,l,e),s=["children",""+l]):wc.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&vt("scroll",r)}switch(n){case"input":Ku(r),Qx(r,o,!0);break;case"textarea":Ku(r),Jx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Jd)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Kk(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Qr]=t,e[Tc]=r,hC(e,t,!1,!1),t.stateNode=e;e:{switch(i=Tp(n,r),n){case"dialog":vt("cancel",e),vt("close",e),s=r;break;case"iframe":case"object":case"embed":vt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ul.length;s++)vt(Ul[s],e);s=r;break;case"source":vt("error",e),s=r;break;case"img":case"image":case"link":vt("error",e),vt("load",e),s=r;break;case"details":vt("toggle",e),s=r;break;case"input":Yx(e,r),s=Ep(e,r),vt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=It({},r,{value:void 0}),vt("invalid",e);break;case"textarea":Xx(e,r),s=Np(e,r),vt("invalid",e);break;default:s=r}Ip(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?qk(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Wk(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&_c(e,c):typeof c=="number"&&_c(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wc.hasOwnProperty(o)?c!=null&&o==="onScroll"&&vt("scroll",e):c!=null&&yy(e,o,c,i))}switch(n){case"input":Ku(e),Qx(e,r,!1);break;case"textarea":Ku(e),Jx(e);break;case"option":r.value!=null&&e.setAttribute("value",""+No(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?oi(e,!!r.multiple,o,!1):r.defaultValue!=null&&oi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Jd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mn(t),null;case 6:if(e&&t.stateNode!=null)gC(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(me(166));if(n=na(Pc.current),na(ns.current),Ju(t)){if(r=t.stateNode,n=t.memoizedProps,r[Qr]=t,(o=r.nodeValue!==n)&&(e=er,e!==null))switch(e.tag){case 3:Xu(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xu(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qr]=t,t.stateNode=r}return mn(t),null;case 13:if(wt(Nt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(bt&&Jn!==null&&t.mode&1&&!(t.flags&128))R1(),Hi(),t.flags|=98560,o=!1;else if(o=Ju(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(me(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(me(317));o[Qr]=t}else Hi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mn(t),o=!1}else Nr!==null&&(ug(Nr),Nr=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Nt.current&1?Ht===0&&(Ht=3):Jy())),t.updateQueue!==null&&(t.flags|=4),mn(t),null);case 4:return Gi(),ng(e,t),e===null&&jc(t.stateNode.containerInfo),mn(t),null;case 10:return Oy(t.type._context),mn(t),null;case 17:return Hn(t.type)&&ef(),mn(t),null;case 19:if(wt(Nt),o=t.memoizedState,o===null)return mn(t),null;if(r=(t.flags&128)!==0,i=o.rendering,i===null)if(r)Al(o,!1);else{if(Ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=lf(e),i!==null){for(t.flags|=128,Al(o,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return gt(Nt,Nt.current&1|2),t.child}e=e.sibling}o.tail!==null&&$t()>Yi&&(t.flags|=128,r=!0,Al(o,!1),t.lanes=4194304)}else{if(!r)if(e=lf(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Al(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!bt)return mn(t),null}else 2*$t()-o.renderingStartTime>Yi&&n!==1073741824&&(t.flags|=128,r=!0,Al(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$t(),t.sibling=null,n=Nt.current,gt(Nt,r?n&1|2:n&1),t):(mn(t),null);case 22:case 23:return Xy(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Yn&1073741824&&(mn(t),t.subtreeFlags&6&&(t.flags|=8192)):mn(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function SO(e,t){switch(Py(t),t.tag){case 1:return Hn(t.type)&&ef(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gi(),wt(Wn),wt(yn),Vy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Fy(t),null;case 13:if(wt(Nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));Hi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wt(Nt),null;case 4:return Gi(),null;case 10:return Oy(t.type._context),null;case 22:case 23:return Xy(),null;case 24:return null;default:return null}}var nd=!1,pn=!1,bO=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function ni(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pt(e,t,r)}else n.current=null}function rg(e,t,n){try{n()}catch(r){Pt(e,t,r)}}var Uw=!1;function EO(e,t){if(Fp=Yd,e=_1(),Ty(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,m=e,f=null;t:for(;;){for(var p;m!==n||s!==0&&m.nodeType!==3||(l=i+s),m!==o||r!==0&&m.nodeType!==3||(c=i+r),m.nodeType===3&&(i+=m.nodeValue.length),(p=m.firstChild)!==null;)f=m,m=p;for(;;){if(m===e)break t;if(f===n&&++u===s&&(l=i),f===o&&++d===r&&(c=i),(p=m.nextSibling)!==null)break;m=f,f=m.parentNode}m=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Vp={focusedElem:e,selectionRange:n},Yd=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var h=v.memoizedProps,x=v.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?h:Er(t.type,h),x);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(S){Pt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return v=Uw,Uw=!1,v}function nc(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&rg(t,n,o)}s=s.next}while(s!==r)}}function vm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sg(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function yC(e){var t=e.alternate;t!==null&&(e.alternate=null,yC(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qr],delete t[Tc],delete t[Kp],delete t[aO],delete t[iO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function vC(e){return e.tag===5||e.tag===3||e.tag===4}function Bw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vC(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function og(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Jd));else if(r!==4&&(e=e.child,e!==null))for(og(e,t,n),e=e.sibling;e!==null;)og(e,t,n),e=e.sibling}function ag(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ag(e,t,n),e=e.sibling;e!==null;)ag(e,t,n),e=e.sibling}var sn=null,Cr=!1;function Ks(e,t,n){for(n=n.child;n!==null;)xC(e,t,n),n=n.sibling}function xC(e,t,n){if(ts&&typeof ts.onCommitFiberUnmount=="function")try{ts.onCommitFiberUnmount(um,n)}catch{}switch(n.tag){case 5:pn||ni(n,t);case 6:var r=sn,s=Cr;sn=null,Ks(e,t,n),sn=r,Cr=s,sn!==null&&(Cr?(e=sn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):sn.removeChild(n.stateNode));break;case 18:sn!==null&&(Cr?(e=sn,n=n.stateNode,e.nodeType===8?jh(e.parentNode,n):e.nodeType===1&&jh(e,n),kc(e)):jh(sn,n.stateNode));break;case 4:r=sn,s=Cr,sn=n.stateNode.containerInfo,Cr=!0,Ks(e,t,n),sn=r,Cr=s;break;case 0:case 11:case 14:case 15:if(!pn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&rg(n,t,i),s=s.next}while(s!==r)}Ks(e,t,n);break;case 1:if(!pn&&(ni(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Pt(n,t,l)}Ks(e,t,n);break;case 21:Ks(e,t,n);break;case 22:n.mode&1?(pn=(r=pn)||n.memoizedState!==null,Ks(e,t,n),pn=r):Ks(e,t,n);break;default:Ks(e,t,n)}}function Kw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new bO),t.forEach(function(r){var s=DO.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Sr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:sn=l.stateNode,Cr=!1;break e;case 3:sn=l.stateNode.containerInfo,Cr=!0;break e;case 4:sn=l.stateNode.containerInfo,Cr=!0;break e}l=l.return}if(sn===null)throw Error(me(160));xC(o,i,s),sn=null,Cr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Pt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)wC(t,e),t=t.sibling}function wC(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sr(t,e),Kr(e),r&4){try{nc(3,e,e.return),vm(3,e)}catch(h){Pt(e,e.return,h)}try{nc(5,e,e.return)}catch(h){Pt(e,e.return,h)}}break;case 1:Sr(t,e),Kr(e),r&512&&n!==null&&ni(n,n.return);break;case 5:if(Sr(t,e),Kr(e),r&512&&n!==null&&ni(n,n.return),e.flags&32){var s=e.stateNode;try{_c(s,"")}catch(h){Pt(e,e.return,h)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Uk(s,o),Tp(l,i);var u=Tp(l,o);for(i=0;i<c.length;i+=2){var d=c[i],m=c[i+1];d==="style"?qk(s,m):d==="dangerouslySetInnerHTML"?Wk(s,m):d==="children"?_c(s,m):yy(s,d,m,u)}switch(l){case"input":kp(s,o);break;case"textarea":Bk(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?oi(s,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?oi(s,!!o.multiple,o.defaultValue,!0):oi(s,!!o.multiple,o.multiple?[]:"",!1))}s[Tc]=o}catch(h){Pt(e,e.return,h)}}break;case 6:if(Sr(t,e),Kr(e),r&4){if(e.stateNode===null)throw Error(me(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(h){Pt(e,e.return,h)}}break;case 3:if(Sr(t,e),Kr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{kc(t.containerInfo)}catch(h){Pt(e,e.return,h)}break;case 4:Sr(t,e),Kr(e);break;case 13:Sr(t,e),Kr(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Yy=$t())),r&4&&Kw(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(pn=(u=pn)||d,Sr(t,e),pn=u):Sr(t,e),Kr(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Ce=e,d=e.child;d!==null;){for(m=Ce=d;Ce!==null;){switch(f=Ce,p=f.child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:ni(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(h){Pt(r,n,h)}}break;case 5:ni(f,f.return);break;case 22:if(f.memoizedState!==null){Hw(m);continue}}p!==null?(p.return=f,Ce=p):Hw(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=m.stateNode,c=m.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Hk("display",i))}catch(h){Pt(e,e.return,h)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(h){Pt(e,e.return,h)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Sr(t,e),Kr(e),r&4&&Kw(e);break;case 21:break;default:Sr(t,e),Kr(e)}}function Kr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(vC(n)){var r=n;break e}n=n.return}throw Error(me(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(_c(s,""),r.flags&=-33);var o=Bw(e);ag(e,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Bw(e);og(e,l,i);break;default:throw Error(me(161))}}catch(c){Pt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function kO(e,t,n){Ce=e,_C(e)}function _C(e,t,n){for(var r=(e.mode&1)!==0;Ce!==null;){var s=Ce,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||nd;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||pn;l=nd;var u=pn;if(nd=i,(pn=c)&&!u)for(Ce=s;Ce!==null;)i=Ce,c=i.child,i.tag===22&&i.memoizedState!==null?qw(s):c!==null?(c.return=i,Ce=c):qw(s);for(;o!==null;)Ce=o,_C(o),o=o.sibling;Ce=s,nd=l,pn=u}Ww(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Ce=o):Ww(e)}}function Ww(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pn||vm(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pn)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Er(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Iw(t,o,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Iw(t,i,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&kc(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}pn||t.flags&512&&sg(t)}catch(f){Pt(t,t.return,f)}}if(t===e){Ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function Hw(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ce=n;break}Ce=t.return}}function qw(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{vm(4,t)}catch(c){Pt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Pt(t,s,c)}}var o=t.return;try{sg(t)}catch(c){Pt(t,o,c)}break;case 5:var i=t.return;try{sg(t)}catch(c){Pt(t,i,c)}}}catch(c){Pt(t,t.return,c)}if(t===e){Ce=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ce=l;break}Ce=t.return}}var CO=Math.ceil,df=Vs.ReactCurrentDispatcher,Gy=Vs.ReactCurrentOwner,pr=Vs.ReactCurrentBatchConfig,Qe=0,tn=null,Vt=null,ln=0,Yn=0,ri=Vo(0),Ht=0,Oc=null,_a=0,xm=0,Zy=0,rc=null,Un=null,Yy=0,Yi=1/0,Ss=null,ff=!1,ig=null,So=null,rd=!1,fo=null,mf=0,sc=0,lg=null,Cd=-1,Nd=0;function Nn(){return Qe&6?$t():Cd!==-1?Cd:Cd=$t()}function bo(e){return e.mode&1?Qe&2&&ln!==0?ln&-ln:cO.transition!==null?(Nd===0&&(Nd=o1()),Nd):(e=at,e!==0||(e=window.event,e=e===void 0?16:f1(e.type)),e):1}function Dr(e,t,n,r){if(50<sc)throw sc=0,lg=null,Error(me(185));pu(e,n,r),(!(Qe&2)||e!==tn)&&(e===tn&&(!(Qe&2)&&(xm|=n),Ht===4&&Xs(e,ln)),qn(e,r),n===1&&Qe===0&&!(t.mode&1)&&(Yi=$t()+500,pm&&Uo()))}function qn(e,t){var n=e.callbackNode;c$(e,t);var r=Zd(e,e===tn?ln:0);if(r===0)n!==null&&nw(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&nw(n),t===1)e.tag===0?lO(Gw.bind(null,e)):A1(Gw.bind(null,e)),sO(function(){!(Qe&6)&&Uo()}),n=null;else{switch(a1(r)){case 1:n=Sy;break;case 4:n=r1;break;case 16:n=Gd;break;case 536870912:n=s1;break;default:n=Gd}n=IC(n,SC.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function SC(e,t){if(Cd=-1,Nd=0,Qe&6)throw Error(me(327));var n=e.callbackNode;if(ui()&&e.callbackNode!==n)return null;var r=Zd(e,e===tn?ln:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=hf(e,r);else{t=r;var s=Qe;Qe|=2;var o=EC();(tn!==e||ln!==t)&&(Ss=null,Yi=$t()+500,da(e,t));do try{IO();break}catch(l){bC(e,l)}while(!0);$y(),df.current=o,Qe=s,Vt!==null?t=0:(tn=null,ln=0,t=Ht)}if(t!==0){if(t===2&&(s=$p(e),s!==0&&(r=s,t=cg(e,s))),t===1)throw n=Oc,da(e,0),Xs(e,r),qn(e,$t()),n;if(t===6)Xs(e,r);else{if(s=e.current.alternate,!(r&30)&&!NO(s)&&(t=hf(e,r),t===2&&(o=$p(e),o!==0&&(r=o,t=cg(e,o))),t===1))throw n=Oc,da(e,0),Xs(e,r),qn(e,$t()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(me(345));case 2:Zo(e,Un,Ss);break;case 3:if(Xs(e,r),(r&130023424)===r&&(t=Yy+500-$t(),10<t)){if(Zd(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Nn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Bp(Zo.bind(null,e,Un,Ss),t);break}Zo(e,Un,Ss);break;case 4:if(Xs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-Pr(r);o=1<<i,i=t[i],i>s&&(s=i),r&=~o}if(r=s,r=$t()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*CO(r/1960))-r,10<r){e.timeoutHandle=Bp(Zo.bind(null,e,Un,Ss),r);break}Zo(e,Un,Ss);break;case 5:Zo(e,Un,Ss);break;default:throw Error(me(329))}}}return qn(e,$t()),e.callbackNode===n?SC.bind(null,e):null}function cg(e,t){var n=rc;return e.current.memoizedState.isDehydrated&&(da(e,t).flags|=256),e=hf(e,t),e!==2&&(t=Un,Un=n,t!==null&&ug(t)),e}function ug(e){Un===null?Un=e:Un.push.apply(Un,e)}function NO(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!zr(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xs(e,t){for(t&=~Zy,t&=~xm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pr(t),r=1<<n;e[n]=-1,t&=~r}}function Gw(e){if(Qe&6)throw Error(me(327));ui();var t=Zd(e,0);if(!(t&1))return qn(e,$t()),null;var n=hf(e,t);if(e.tag!==0&&n===2){var r=$p(e);r!==0&&(t=r,n=cg(e,r))}if(n===1)throw n=Oc,da(e,0),Xs(e,t),qn(e,$t()),n;if(n===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zo(e,Un,Ss),qn(e,$t()),null}function Qy(e,t){var n=Qe;Qe|=1;try{return e(t)}finally{Qe=n,Qe===0&&(Yi=$t()+500,pm&&Uo())}}function Sa(e){fo!==null&&fo.tag===0&&!(Qe&6)&&ui();var t=Qe;Qe|=1;var n=pr.transition,r=at;try{if(pr.transition=null,at=1,e)return e()}finally{at=r,pr.transition=n,Qe=t,!(Qe&6)&&Uo()}}function Xy(){Yn=ri.current,wt(ri)}function da(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,rO(n)),Vt!==null)for(n=Vt.return;n!==null;){var r=n;switch(Py(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ef();break;case 3:Gi(),wt(Wn),wt(yn),Vy();break;case 5:Fy(r);break;case 4:Gi();break;case 13:wt(Nt);break;case 19:wt(Nt);break;case 10:Oy(r.type._context);break;case 22:case 23:Xy()}n=n.return}if(tn=e,Vt=e=Eo(e.current,null),ln=Yn=t,Ht=0,Oc=null,Zy=xm=_a=0,Un=rc=null,ta!==null){for(t=0;t<ta.length;t++)if(n=ta[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}ta=null}return e}function bC(e,t){do{var n=Vt;try{if($y(),bd.current=uf,cf){for(var r=jt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cf=!1}if(wa=0,Jt=Bt=jt=null,tc=!1,Dc=0,Gy.current=null,n===null||n.return===null){Ht=1,Oc=t,Vt=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=ln,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=$w(i);if(p!==null){p.flags&=-257,Ow(p,i,l,o,t),p.mode&1&&Rw(o,u,t),t=p,c=u;var v=t.updateQueue;if(v===null){var h=new Set;h.add(c),t.updateQueue=h}else v.add(c);break e}else{if(!(t&1)){Rw(o,u,t),Jy();break e}c=Error(me(426))}}else if(bt&&l.mode&1){var x=$w(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Ow(x,i,l,o,t),Dy(Zi(c,l));break e}}o=c=Zi(c,l),Ht!==4&&(Ht=2),rc===null?rc=[o]:rc.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=aC(o,c,t);jw(o,y);break e;case 1:l=c;var g=o.type,_=o.stateNode;if(!(o.flags&128)&&(typeof g.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(So===null||!So.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t;var S=iC(o,l,t);jw(o,S);break e}}o=o.return}while(o!==null)}CC(n)}catch(E){t=E,Vt===n&&n!==null&&(Vt=n=n.return);continue}break}while(!0)}function EC(){var e=df.current;return df.current=uf,e===null?uf:e}function Jy(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),tn===null||!(_a&268435455)&&!(xm&268435455)||Xs(tn,ln)}function hf(e,t){var n=Qe;Qe|=2;var r=EC();(tn!==e||ln!==t)&&(Ss=null,da(e,t));do try{jO();break}catch(s){bC(e,s)}while(!0);if($y(),Qe=n,df.current=r,Vt!==null)throw Error(me(261));return tn=null,ln=0,Ht}function jO(){for(;Vt!==null;)kC(Vt)}function IO(){for(;Vt!==null&&!e$();)kC(Vt)}function kC(e){var t=jC(e.alternate,e,Yn);e.memoizedProps=e.pendingProps,t===null?CC(e):Vt=t,Gy.current=null}function CC(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=SO(n,t),n!==null){n.flags&=32767,Vt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ht=6,Vt=null;return}}else if(n=_O(n,t,Yn),n!==null){Vt=n;return}if(t=t.sibling,t!==null){Vt=t;return}Vt=t=e}while(t!==null);Ht===0&&(Ht=5)}function Zo(e,t,n){var r=at,s=pr.transition;try{pr.transition=null,at=1,TO(e,t,n,r)}finally{pr.transition=s,at=r}return null}function TO(e,t,n,r){do ui();while(fo!==null);if(Qe&6)throw Error(me(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(u$(e,o),e===tn&&(Vt=tn=null,ln=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||rd||(rd=!0,IC(Gd,function(){return ui(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=pr.transition,pr.transition=null;var i=at;at=1;var l=Qe;Qe|=4,Gy.current=null,EO(e,n),wC(n,e),Y$(Vp),Yd=!!Fp,Vp=Fp=null,e.current=n,kO(n),t$(),Qe=l,at=i,pr.transition=o}else e.current=n;if(rd&&(rd=!1,fo=e,mf=s),o=e.pendingLanes,o===0&&(So=null),s$(n.stateNode),qn(e,$t()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ff)throw ff=!1,e=ig,ig=null,e;return mf&1&&e.tag!==0&&ui(),o=e.pendingLanes,o&1?e===lg?sc++:(sc=0,lg=e):sc=0,Uo(),null}function ui(){if(fo!==null){var e=a1(mf),t=pr.transition,n=at;try{if(pr.transition=null,at=16>e?16:e,fo===null)var r=!1;else{if(e=fo,fo=null,mf=0,Qe&6)throw Error(me(331));var s=Qe;for(Qe|=4,Ce=e.current;Ce!==null;){var o=Ce,i=o.child;if(Ce.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ce=u;Ce!==null;){var d=Ce;switch(d.tag){case 0:case 11:case 15:nc(8,d,o)}var m=d.child;if(m!==null)m.return=d,Ce=m;else for(;Ce!==null;){d=Ce;var f=d.sibling,p=d.return;if(yC(d),d===u){Ce=null;break}if(f!==null){f.return=p,Ce=f;break}Ce=p}}}var v=o.alternate;if(v!==null){var h=v.child;if(h!==null){v.child=null;do{var x=h.sibling;h.sibling=null,h=x}while(h!==null)}}Ce=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Ce=i;else e:for(;Ce!==null;){if(o=Ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:nc(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,Ce=y;break e}Ce=o.return}}var g=e.current;for(Ce=g;Ce!==null;){i=Ce;var _=i.child;if(i.subtreeFlags&2064&&_!==null)_.return=i,Ce=_;else e:for(i=g;Ce!==null;){if(l=Ce,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:vm(9,l)}}catch(E){Pt(l,l.return,E)}if(l===i){Ce=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,Ce=S;break e}Ce=l.return}}if(Qe=s,Uo(),ts&&typeof ts.onPostCommitFiberRoot=="function")try{ts.onPostCommitFiberRoot(um,e)}catch{}r=!0}return r}finally{at=n,pr.transition=t}}return!1}function Zw(e,t,n){t=Zi(n,t),t=aC(e,t,1),e=_o(e,t,1),t=Nn(),e!==null&&(pu(e,1,t),qn(e,t))}function Pt(e,t,n){if(e.tag===3)Zw(e,e,n);else for(;t!==null;){if(t.tag===3){Zw(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(So===null||!So.has(r))){e=Zi(n,e),e=iC(t,e,1),t=_o(t,e,1),e=Nn(),t!==null&&(pu(t,1,e),qn(t,e));break}}t=t.return}}function AO(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Nn(),e.pingedLanes|=e.suspendedLanes&n,tn===e&&(ln&n)===n&&(Ht===4||Ht===3&&(ln&130023424)===ln&&500>$t()-Yy?da(e,0):Zy|=n),qn(e,t)}function NC(e,t){t===0&&(e.mode&1?(t=qu,qu<<=1,!(qu&130023424)&&(qu=4194304)):t=1);var n=Nn();e=$s(e,t),e!==null&&(pu(e,t,n),qn(e,n))}function PO(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),NC(e,n)}function DO(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(me(314))}r!==null&&r.delete(t),NC(e,n)}var jC;jC=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wn.current)Kn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Kn=!1,wO(e,t,n);Kn=!!(e.flags&131072)}else Kn=!1,bt&&t.flags&1048576&&P1(t,rf,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;kd(e,t),e=t.pendingProps;var s=Wi(t,yn.current);ci(t,n),s=By(null,t,r,e,s,n);var o=Ky();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hn(r)?(o=!0,tf(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zy(t),s.updater=ym,t.stateNode=s,s._reactInternals=t,Yp(t,r,e,n),t=Jp(null,t,r,!0,o,n)):(t.tag=0,bt&&o&&Ay(t),bn(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(kd(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=$O(r),e=Er(r,e),s){case 0:t=Xp(null,t,r,e,n);break e;case 1:t=Lw(null,t,r,e,n);break e;case 11:t=Mw(null,t,r,e,n);break e;case 14:t=zw(null,t,r,Er(r.type,e),n);break e}throw Error(me(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Xp(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Lw(e,t,r,s,n);case 3:e:{if(dC(t),e===null)throw Error(me(387));r=t.pendingProps,o=t.memoizedState,s=o.element,z1(e,t),af(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Zi(Error(me(423)),t),t=Fw(e,t,r,n,s);break e}else if(r!==s){s=Zi(Error(me(424)),t),t=Fw(e,t,r,n,s);break e}else for(Jn=wo(t.stateNode.containerInfo.firstChild),er=t,bt=!0,Nr=null,n=O1(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hi(),r===s){t=Os(e,t,n);break e}bn(e,t,r,n)}t=t.child}return t;case 5:return L1(t),e===null&&qp(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Up(r,s)?i=null:o!==null&&Up(r,o)&&(t.flags|=32),uC(e,t),bn(e,t,i,n),t.child;case 6:return e===null&&qp(t),null;case 13:return fC(e,t,n);case 4:return Ly(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qi(t,null,r,n):bn(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),Mw(e,t,r,s,n);case 7:return bn(e,t,t.pendingProps,n),t.child;case 8:return bn(e,t,t.pendingProps.children,n),t.child;case 12:return bn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,gt(sf,r._currentValue),r._currentValue=i,o!==null)if(zr(o.value,i)){if(o.children===s.children&&!Wn.current){t=Os(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Is(-1,n&-n),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Gp(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(me(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Gp(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}bn(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ci(t,n),s=vr(s),r=r(s),t.flags|=1,bn(e,t,r,n),t.child;case 14:return r=t.type,s=Er(r,t.pendingProps),s=Er(r.type,s),zw(e,t,r,s,n);case 15:return lC(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Er(r,s),kd(e,t),t.tag=1,Hn(r)?(e=!0,tf(t)):e=!1,ci(t,n),oC(t,r,s),Yp(t,r,s,n),Jp(null,t,r,!0,e,n);case 19:return mC(e,t,n);case 22:return cC(e,t,n)}throw Error(me(156,t.tag))};function IC(e,t){return n1(e,t)}function RO(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(e,t,n,r){return new RO(e,t,n,r)}function ev(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $O(e){if(typeof e=="function")return ev(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xy)return 11;if(e===wy)return 14}return 2}function Eo(e,t){var n=e.alternate;return n===null?(n=hr(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jd(e,t,n,r,s,o){var i=2;if(r=e,typeof e=="function")ev(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case qa:return fa(n.children,s,o,t);case vy:i=8,s|=8;break;case wp:return e=hr(12,n,t,s|2),e.elementType=wp,e.lanes=o,e;case _p:return e=hr(13,n,t,s),e.elementType=_p,e.lanes=o,e;case Sp:return e=hr(19,n,t,s),e.elementType=Sp,e.lanes=o,e;case Lk:return wm(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mk:i=10;break e;case zk:i=9;break e;case xy:i=11;break e;case wy:i=14;break e;case Zs:i=16,r=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=hr(i,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function fa(e,t,n,r){return e=hr(7,e,r,t),e.lanes=n,e}function wm(e,t,n,r){return e=hr(22,e,r,t),e.elementType=Lk,e.lanes=n,e.stateNode={isHidden:!1},e}function Oh(e,t,n){return e=hr(6,e,null,t),e.lanes=n,e}function Mh(e,t,n){return t=hr(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function OO(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yh(0),this.expirationTimes=yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function tv(e,t,n,r,s,o,i,l,c){return e=new OO(e,t,n,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=hr(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zy(o),e}function MO(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ha,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function TC(e){if(!e)return jo;e=e._reactInternals;e:{if(Aa(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var n=e.type;if(Hn(n))return T1(e,n,t)}return t}function AC(e,t,n,r,s,o,i,l,c){return e=tv(n,r,!0,e,s,o,i,l,c),e.context=TC(null),n=e.current,r=Nn(),s=bo(n),o=Is(r,s),o.callback=t??null,_o(n,o,s),e.current.lanes=s,pu(e,s,r),qn(e,r),e}function _m(e,t,n,r){var s=t.current,o=Nn(),i=bo(s);return n=TC(n),t.context===null?t.context=n:t.pendingContext=n,t=Is(o,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=_o(s,t,i),e!==null&&(Dr(e,s,i,o),Sd(e,s,i)),i}function pf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function nv(e,t){Yw(e,t),(e=e.alternate)&&Yw(e,t)}function zO(){return null}var PC=typeof reportError=="function"?reportError:function(e){console.error(e)};function rv(e){this._internalRoot=e}Sm.prototype.render=rv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));_m(e,t,null,null)};Sm.prototype.unmount=rv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Sa(function(){_m(null,e,null,null)}),t[Rs]=null}};function Sm(e){this._internalRoot=e}Sm.prototype.unstable_scheduleHydration=function(e){if(e){var t=c1();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Qs.length&&t!==0&&t<Qs[n].priority;n++);Qs.splice(n,0,e),n===0&&d1(e)}};function sv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Qw(){}function LO(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=pf(i);o.call(u)}}var i=AC(t,r,e,0,null,!1,!1,"",Qw);return e._reactRootContainer=i,e[Rs]=i.current,jc(e.nodeType===8?e.parentNode:e),Sa(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=pf(c);l.call(u)}}var c=tv(e,0,!1,null,null,!1,!1,"",Qw);return e._reactRootContainer=c,e[Rs]=c.current,jc(e.nodeType===8?e.parentNode:e),Sa(function(){_m(t,c,n,r)}),c}function Em(e,t,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=pf(i);l.call(c)}}_m(t,i,e,s)}else i=LO(n,t,e,s,r);return pf(i)}i1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Vl(t.pendingLanes);n!==0&&(by(t,n|1),qn(t,$t()),!(Qe&6)&&(Yi=$t()+500,Uo()))}break;case 13:Sa(function(){var r=$s(e,1);if(r!==null){var s=Nn();Dr(r,e,1,s)}}),nv(e,1)}};Ey=function(e){if(e.tag===13){var t=$s(e,134217728);if(t!==null){var n=Nn();Dr(t,e,134217728,n)}nv(e,134217728)}};l1=function(e){if(e.tag===13){var t=bo(e),n=$s(e,t);if(n!==null){var r=Nn();Dr(n,e,t,r)}nv(e,t)}};c1=function(){return at};u1=function(e,t){var n=at;try{return at=e,t()}finally{at=n}};Pp=function(e,t,n){switch(t){case"input":if(kp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=hm(r);if(!s)throw Error(me(90));Vk(r),kp(r,s)}}}break;case"textarea":Bk(e,n);break;case"select":t=n.value,t!=null&&oi(e,!!n.multiple,t,!1)}};Yk=Qy;Qk=Sa;var FO={usingClientEntryPoint:!1,Events:[yu,Qa,hm,Gk,Zk,Qy]},Pl={findFiberByHostInstance:ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VO={bundleType:Pl.bundleType,version:Pl.version,rendererPackageName:Pl.rendererPackageName,rendererConfig:Pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=e1(e),e===null?null:e.stateNode},findFiberByHostInstance:Pl.findFiberByHostInstance||zO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{um=sd.inject(VO),ts=sd}catch{}}or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FO;or.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sv(t))throw Error(me(200));return MO(e,t,null,n)};or.createRoot=function(e,t){if(!sv(e))throw Error(me(299));var n=!1,r="",s=PC;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=tv(e,1,!1,null,null,n,!1,r,s),e[Rs]=t.current,jc(e.nodeType===8?e.parentNode:e),new rv(t)};or.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=e1(t),e=e===null?null:e.stateNode,e};or.flushSync=function(e){return Sa(e)};or.hydrate=function(e,t,n){if(!bm(t))throw Error(me(200));return Em(null,e,t,!0,n)};or.hydrateRoot=function(e,t,n){if(!sv(e))throw Error(me(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=PC;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=AC(t,null,e,1,n??null,s,!1,o,i),e[Rs]=t.current,jc(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Sm(t)};or.render=function(e,t,n){if(!bm(t))throw Error(me(200));return Em(null,e,t,!1,n)};or.unmountComponentAtNode=function(e){if(!bm(e))throw Error(me(40));return e._reactRootContainer?(Sa(function(){Em(null,null,e,!1,function(){e._reactRootContainer=null,e[Rs]=null})}),!0):!1};or.unstable_batchedUpdates=Qy;or.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!bm(n))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return Em(e,t,n,!1,r)};or.version="18.3.1-next-f1338f8080-20240426";function DC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DC)}catch(e){console.error(e)}}DC(),Dk.exports=or;var Pa=Dk.exports;const UO=uy(Pa);var RC,Xw=Pa;RC=Xw.createRoot,Xw.hydrateRoot;function BO(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var n,r,s,o,i=[],l="",c=e.split("/");for(c[0]||c.shift();s=c.shift();)n=s[0],n==="*"?(i.push(n),l+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(r=s.indexOf("?",1),o=s.indexOf(".",1),i.push(s.substring(1,~r?r:~o?o:s.length)),l+=~r&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(l+=(~r?"?":"")+"\\"+s.substring(o))):l+="/"+s;return{keys:i,pattern:new RegExp("^"+l+(t?"(?=$|/)":"/?$"),"i")}}var $C={exports:{}},OC={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qi=w;function KO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var WO=typeof Object.is=="function"?Object.is:KO,HO=Qi.useState,qO=Qi.useEffect,GO=Qi.useLayoutEffect,ZO=Qi.useDebugValue;function YO(e,t){var n=t(),r=HO({inst:{value:n,getSnapshot:t}}),s=r[0].inst,o=r[1];return GO(function(){s.value=n,s.getSnapshot=t,zh(s)&&o({inst:s})},[e,n,t]),qO(function(){return zh(s)&&o({inst:s}),e(function(){zh(s)&&o({inst:s})})},[e]),ZO(n),n}function zh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!WO(e,n)}catch{return!0}}function QO(e,t){return t()}var XO=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?QO:YO;OC.useSyncExternalStore=Qi.useSyncExternalStore!==void 0?Qi.useSyncExternalStore:XO;$C.exports=OC;var JO=$C.exports;const eM=Ak.useInsertionEffect,tM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MC=tM?w.useLayoutEffect:w.useEffect,nM=eM||MC,ov=e=>{const t=w.useRef([e,(...n)=>t[0](...n)]).current;return nM(()=>{t[0]=e}),t[1]},rM="popstate",av="pushState",iv="replaceState",sM="hashchange",Jw=[rM,av,iv,sM],oM=e=>{for(const t of Jw)addEventListener(t,e);return()=>{for(const t of Jw)removeEventListener(t,e)}},zC=(e,t)=>JO.useSyncExternalStore(oM,e,t),aM=()=>location.search,iM=({ssrSearch:e=""}={})=>zC(aM,()=>e),e_=()=>location.pathname,lM=({ssrPath:e}={})=>zC(e_,e?()=>e:e_),cM=(e,{replace:t=!1,state:n=null}={})=>history[t?iv:av](n,"",e),uM=(e={})=>[lM(e),cM],t_=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[t_]>"u"){for(const e of[av,iv]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),r=new Event(e);return r.arguments=arguments,dispatchEvent(r),n}}Object.defineProperty(window,t_,{value:!0})}const dM=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",LC=(e="")=>e==="/"?"":e,fM=(e,t)=>e[0]==="~"?e.slice(1):LC(t)+e,mM=(e="",t)=>dM(n_(LC(e)),n_(t)),n_=e=>{try{return decodeURI(e)}catch{return e}},FC={hook:uM,searchHook:iM,parser:BO,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},VC=w.createContext(FC),xu=()=>w.useContext(VC),UC={},BC=w.createContext(UC),hM=()=>w.useContext(BC),km=e=>{const[t,n]=e.hook(e);return[mM(e.base,t),ov((r,s)=>n(fM(r,e.base),s))]},wu=()=>km(xu()),KC=(e,t,n,r)=>{const{pattern:s,keys:o}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",r),i=s.exec(n)||[],[l,...c]=i;return l!==void 0?[!0,(()=>{const u=o!==!1?Object.fromEntries(o.map((m,f)=>[m,c[f]])):i.groups;let d={...c};return u&&Object.assign(d,u),d})(),...r?[l]:[]]:[!1,null]},pM=({children:e,...t})=>{var d,m;const n=xu(),r=t.hook?FC:n;let s=r;const[o,i]=((d=t.ssrPath)==null?void 0:d.split("?"))??[];i&&(t.ssrSearch=i,t.ssrPath=o),t.hrefs=t.hrefs??((m=t.hook)==null?void 0:m.hrefs);let l=w.useRef({}),c=l.current,u=c;for(let f in r){const p=f==="base"?r[f]+(t[f]||""):t[f]||r[f];c===u&&p!==u[f]&&(l.current=u={...u}),u[f]=p,p!==r[f]&&(s=u)}return w.createElement(VC.Provider,{value:s,children:e})},r_=({children:e,component:t},n)=>t?w.createElement(t,{params:n}):typeof e=="function"?e(n):e,gM=e=>{let t=w.useRef(UC),n=t.current;for(const r in e)e[r]!==n[r]&&(n=e);return Object.keys(e).length===0&&(n=e),t.current=n},di=({path:e,nest:t,match:n,...r})=>{const s=xu(),[o]=km(s),[i,l,c]=n??KC(s.parser,e,o,t),u=gM({...hM(),...l});if(!i)return null;const d=c?w.createElement(pM,{base:c},r_(r,u)):r_(r,u);return w.createElement(BC.Provider,{value:u,children:d})};w.forwardRef((e,t)=>{const n=xu(),[r,s]=km(n),{to:o="",href:i=o,onClick:l,asChild:c,children:u,className:d,replace:m,state:f,...p}=e,v=ov(x=>{x.ctrlKey||x.metaKey||x.altKey||x.shiftKey||x.button!==0||(l==null||l(x),x.defaultPrevented||(x.preventDefault(),s(i,e)))}),h=n.hrefs(i[0]==="~"?i.slice(1):n.base+i,n);return c&&w.isValidElement(u)?w.cloneElement(u,{onClick:v,href:h}):w.createElement("a",{...p,onClick:v,href:h,className:d!=null&&d.call?d(r===i):d,children:u,ref:t})});const WC=e=>Array.isArray(e)?e.flatMap(t=>WC(t&&t.type===w.Fragment?t.props.children:t)):[e],yM=({children:e,location:t})=>{const n=xu(),[r]=km(n);for(const s of WC(e)){let o=0;if(w.isValidElement(s)&&(o=KC(n.parser,s.props.path,t||r,s.props.nest))[0])return w.cloneElement(s,{match:o})}return null},vM=e=>{const{to:t,href:n=t}=e,[,r]=wu(),s=ov(()=>r(t||n,e));return MC(()=>{s()},[]),null};var fl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ba=typeof window>"u"||"Deno"in globalThis;function cr(){}function xM(e,t){return typeof e=="function"?e(t):e}function dg(e){return typeof e=="number"&&e>=0&&e!==1/0}function HC(e,t){return Math.max(e+(t||0)-Date.now(),0)}function fi(e,t){return typeof e=="function"?e(t):e}function jr(e,t){return typeof e=="function"?e(t):e}function s_(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:o,queryKey:i,stale:l}=e;if(i){if(r){if(t.queryHash!==lv(i,t.options))return!1}else if(!Mc(t.queryKey,i))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||o&&!o(t))}function o_(e,t){const{exact:n,status:r,predicate:s,mutationKey:o}=e;if(o){if(!t.options.mutationKey)return!1;if(n){if(Ea(t.options.mutationKey)!==Ea(o))return!1}else if(!Mc(t.options.mutationKey,o))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function lv(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ea)(e)}function Ea(e){return JSON.stringify(e,(t,n)=>fg(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Mc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(n=>!Mc(e[n],t[n])):!1}function qC(e,t){if(e===t)return e;const n=a_(e)&&a_(t);if(n||fg(e)&&fg(t)){const r=n?e:Object.keys(e),s=r.length,o=n?t:Object.keys(t),i=o.length,l=n?[]:{};let c=0;for(let u=0;u<i;u++){const d=n?u:o[u];(!n&&r.includes(d)||n)&&e[d]===void 0&&t[d]===void 0?(l[d]=void 0,c++):(l[d]=qC(e[d],t[d]),l[d]===e[d]&&e[d]!==void 0&&c++)}return s===i&&c===s?e:l}return t}function gf(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function a_(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function fg(e){if(!i_(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!i_(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function i_(e){return Object.prototype.toString.call(e)==="[object Object]"}function wM(e){return new Promise(t=>{setTimeout(t,e)})}function mg(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?qC(e,t):t}function _M(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function SM(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var cv=Symbol();function GC(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===cv?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var sa,to,Ai,IS,bM=(IS=class extends fl{constructor(){super();Ie(this,sa);Ie(this,to);Ie(this,Ai);Ee(this,Ai,t=>{if(!ba&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){H(this,to)||this.setEventListener(H(this,Ai))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,to))==null||t.call(this),Ee(this,to,void 0))}setEventListener(t){var n;Ee(this,Ai,t),(n=H(this,to))==null||n.call(this),Ee(this,to,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){H(this,sa)!==t&&(Ee(this,sa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof H(this,sa)=="boolean"?H(this,sa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},sa=new WeakMap,to=new WeakMap,Ai=new WeakMap,IS),uv=new bM,Pi,no,Di,TS,EM=(TS=class extends fl{constructor(){super();Ie(this,Pi,!0);Ie(this,no);Ie(this,Di);Ee(this,Di,t=>{if(!ba&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){H(this,no)||this.setEventListener(H(this,Di))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,no))==null||t.call(this),Ee(this,no,void 0))}setEventListener(t){var n;Ee(this,Di,t),(n=H(this,no))==null||n.call(this),Ee(this,no,t(this.setOnline.bind(this)))}setOnline(t){H(this,Pi)!==t&&(Ee(this,Pi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return H(this,Pi)}},Pi=new WeakMap,no=new WeakMap,Di=new WeakMap,TS),yf=new EM;function hg(){let e,t;const n=new Promise((s,o)=>{e=s,t=o});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}function kM(e){return Math.min(1e3*2**e,3e4)}function ZC(e){return(e??"online")==="online"?yf.isOnline():!0}var YC=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Lh(e){return e instanceof YC}function QC(e){let t=!1,n=0,r=!1,s;const o=hg(),i=h=>{var x;r||(f(new YC(h)),(x=e.abort)==null||x.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>uv.isFocused()&&(e.networkMode==="always"||yf.isOnline())&&e.canRun(),d=()=>ZC(e.networkMode)&&e.canRun(),m=h=>{var x;r||(r=!0,(x=e.onSuccess)==null||x.call(e,h),s==null||s(),o.resolve(h))},f=h=>{var x;r||(r=!0,(x=e.onError)==null||x.call(e,h),s==null||s(),o.reject(h))},p=()=>new Promise(h=>{var x;s=y=>{(r||u())&&h(y)},(x=e.onPause)==null||x.call(e)}).then(()=>{var h;s=void 0,r||(h=e.onContinue)==null||h.call(e)}),v=()=>{if(r)return;let h;const x=n===0?e.initialPromise:void 0;try{h=x??e.fn()}catch(y){h=Promise.reject(y)}Promise.resolve(h).then(m).catch(y=>{var A;if(r)return;const g=e.retry??(ba?0:3),_=e.retryDelay??kM,S=typeof _=="function"?_(n,y):_,E=g===!0||typeof g=="number"&&n<g||typeof g=="function"&&g(n,y);if(t||!E){f(y);return}n++,(A=e.onFail)==null||A.call(e,n,y),wM(S).then(()=>u()?void 0:p()).then(()=>{t?f(y):v()})})};return{promise:o,cancel:i,continue:()=>(s==null||s(),o),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?v():p().then(v),o)}}function CM(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=l=>setTimeout(l,0);const o=l=>{t?e.push(l):s(()=>{n(l)})},i=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||i()}return c},batchCalls:l=>(...c)=>{o(()=>{l(...c)})},schedule:o,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var Kt=CM(),oa,AS,XC=(AS=class{constructor(){Ie(this,oa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dg(this.gcTime)&&Ee(this,oa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ba?1/0:5*60*1e3))}clearGcTimeout(){H(this,oa)&&(clearTimeout(H(this,oa)),Ee(this,oa,void 0))}},oa=new WeakMap,AS),Ri,$i,lr,hn,uu,aa,kr,ws,PS,NM=(PS=class extends XC{constructor(t){super();Ie(this,kr);Ie(this,Ri);Ie(this,$i);Ie(this,lr);Ie(this,hn);Ie(this,uu);Ie(this,aa);Ee(this,aa,!1),Ee(this,uu,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ee(this,lr,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ee(this,Ri,jM(this.options)),this.state=t.state??H(this,Ri),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=H(this,hn))==null?void 0:t.promise}setOptions(t){this.options={...H(this,uu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&H(this,lr).remove(this)}setData(t,n){const r=mg(this.state.data,t,this.options);return Fe(this,kr,ws).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Fe(this,kr,ws).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=H(this,hn))==null?void 0:r.promise;return(s=H(this,hn))==null||s.cancel(t),n?n.then(cr).catch(cr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(H(this,Ri))}isActive(){return this.observers.some(t=>jr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===cv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!HC(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=H(this,hn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=H(this,hn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),H(this,lr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(H(this,hn)&&(H(this,aa)?H(this,hn).cancel({revert:!0}):H(this,hn).cancelRetry()),this.scheduleGc()),H(this,lr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Fe(this,kr,ws).call(this,{type:"invalidate"})}fetch(t,n){var c,u,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(H(this,hn))return H(this,hn).continueRetry(),H(this,hn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(f=>f.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(Ee(this,aa,!0),r.signal)})},o=()=>{const m=GC(this.options,n),f={queryKey:this.queryKey,meta:this.meta};return s(f),Ee(this,aa,!1),this.options.persister?this.options.persister(m,f,this):m(f)},i={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:o};s(i),(c=this.options.behavior)==null||c.onFetch(i,this),Ee(this,$i,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=i.fetchOptions)==null?void 0:u.meta))&&Fe(this,kr,ws).call(this,{type:"fetch",meta:(d=i.fetchOptions)==null?void 0:d.meta});const l=m=>{var f,p,v,h;Lh(m)&&m.silent||Fe(this,kr,ws).call(this,{type:"error",error:m}),Lh(m)||((p=(f=H(this,lr).config).onError)==null||p.call(f,m,this),(h=(v=H(this,lr).config).onSettled)==null||h.call(v,this.state.data,m,this)),this.scheduleGc()};return Ee(this,hn,QC({initialPromise:n==null?void 0:n.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:m=>{var f,p,v,h;if(m===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(m)}catch(x){l(x);return}(p=(f=H(this,lr).config).onSuccess)==null||p.call(f,m,this),(h=(v=H(this,lr).config).onSettled)==null||h.call(v,m,this.state.error,this),this.scheduleGc()},onError:l,onFail:(m,f)=>{Fe(this,kr,ws).call(this,{type:"failed",failureCount:m,error:f})},onPause:()=>{Fe(this,kr,ws).call(this,{type:"pause"})},onContinue:()=>{Fe(this,kr,ws).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),H(this,hn).start()}},Ri=new WeakMap,$i=new WeakMap,lr=new WeakMap,hn=new WeakMap,uu=new WeakMap,aa=new WeakMap,kr=new WeakSet,ws=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...JC(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Lh(s)&&s.revert&&H(this,$i)?{...H(this,$i),fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Kt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),H(this,lr).notify({query:this,type:"updated",action:t})})},PS);function JC(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ZC(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function jM(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var qr,DS,IM=(DS=class extends fl{constructor(t={}){super();Ie(this,qr);this.config=t,Ee(this,qr,new Map)}build(t,n,r){const s=n.queryKey,o=n.queryHash??lv(s,n);let i=this.get(o);return i||(i=new NM({cache:this,queryKey:s,queryHash:o,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){H(this,qr).has(t.queryHash)||(H(this,qr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=H(this,qr).get(t.queryHash);n&&(t.destroy(),n===t&&H(this,qr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Kt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return H(this,qr).get(t)}getAll(){return[...H(this,qr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>s_(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>s_(t,r)):n}notify(t){Kt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Kt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Kt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},qr=new WeakMap,DS),Gr,_n,ia,Zr,qs,RS,TM=(RS=class extends XC{constructor(t){super();Ie(this,Zr);Ie(this,Gr);Ie(this,_n);Ie(this,ia);this.mutationId=t.mutationId,Ee(this,_n,t.mutationCache),Ee(this,Gr,[]),this.state=t.state||eN(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){H(this,Gr).includes(t)||(H(this,Gr).push(t),this.clearGcTimeout(),H(this,_n).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ee(this,Gr,H(this,Gr).filter(n=>n!==t)),this.scheduleGc(),H(this,_n).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){H(this,Gr).length||(this.state.status==="pending"?this.scheduleGc():H(this,_n).remove(this))}continue(){var t;return((t=H(this,ia))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,o,i,l,c,u,d,m,f,p,v,h,x,y,g,_,S,E,A,I;Ee(this,ia,QC({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(N,T)=>{Fe(this,Zr,qs).call(this,{type:"failed",failureCount:N,error:T})},onPause:()=>{Fe(this,Zr,qs).call(this,{type:"pause"})},onContinue:()=>{Fe(this,Zr,qs).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>H(this,_n).canRun(this)}));const n=this.state.status==="pending",r=!H(this,ia).canStart();try{if(!n){Fe(this,Zr,qs).call(this,{type:"pending",variables:t,isPaused:r}),await((o=(s=H(this,_n).config).onMutate)==null?void 0:o.call(s,t,this));const T=await((l=(i=this.options).onMutate)==null?void 0:l.call(i,t));T!==this.state.context&&Fe(this,Zr,qs).call(this,{type:"pending",context:T,variables:t,isPaused:r})}const N=await H(this,ia).start();return await((u=(c=H(this,_n).config).onSuccess)==null?void 0:u.call(c,N,t,this.state.context,this)),await((m=(d=this.options).onSuccess)==null?void 0:m.call(d,N,t,this.state.context)),await((p=(f=H(this,_n).config).onSettled)==null?void 0:p.call(f,N,null,this.state.variables,this.state.context,this)),await((h=(v=this.options).onSettled)==null?void 0:h.call(v,N,null,t,this.state.context)),Fe(this,Zr,qs).call(this,{type:"success",data:N}),N}catch(N){try{throw await((y=(x=H(this,_n).config).onError)==null?void 0:y.call(x,N,t,this.state.context,this)),await((_=(g=this.options).onError)==null?void 0:_.call(g,N,t,this.state.context)),await((E=(S=H(this,_n).config).onSettled)==null?void 0:E.call(S,void 0,N,this.state.variables,this.state.context,this)),await((I=(A=this.options).onSettled)==null?void 0:I.call(A,void 0,N,t,this.state.context)),N}finally{Fe(this,Zr,qs).call(this,{type:"error",error:N})}}finally{H(this,_n).runNext(this)}}},Gr=new WeakMap,_n=new WeakMap,ia=new WeakMap,Zr=new WeakSet,qs=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Kt.batch(()=>{H(this,Gr).forEach(r=>{r.onMutationUpdate(t)}),H(this,_n).notify({mutation:this,type:"updated",action:t})})},RS);function eN(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zn,du,$S,AM=($S=class extends fl{constructor(t={}){super();Ie(this,Zn);Ie(this,du);this.config=t,Ee(this,Zn,new Map),Ee(this,du,Date.now())}build(t,n,r){const s=new TM({mutationCache:this,mutationId:++Fu(this,du)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){const n=od(t),r=H(this,Zn).get(n)??[];r.push(t),H(this,Zn).set(n,r),this.notify({type:"added",mutation:t})}remove(t){var r;const n=od(t);if(H(this,Zn).has(n)){const s=(r=H(this,Zn).get(n))==null?void 0:r.filter(o=>o!==t);s&&(s.length===0?H(this,Zn).delete(n):H(this,Zn).set(n,s))}this.notify({type:"removed",mutation:t})}canRun(t){var r;const n=(r=H(this,Zn).get(od(t)))==null?void 0:r.find(s=>s.state.status==="pending");return!n||n===t}runNext(t){var r;const n=(r=H(this,Zn).get(od(t)))==null?void 0:r.find(s=>s!==t&&s.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Kt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...H(this,Zn).values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>o_(n,r))}findAll(t={}){return this.getAll().filter(n=>o_(t,n))}notify(t){Kt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Kt.batch(()=>Promise.all(t.map(n=>n.continue().catch(cr))))}},Zn=new WeakMap,du=new WeakMap,$S);function od(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function l_(e){return{onFetch:(t,n)=>{var d,m,f,p,v;const r=t.options,s=(f=(m=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:m.fetchMore)==null?void 0:f.direction,o=((p=t.state.data)==null?void 0:p.pages)||[],i=((v=t.state.data)==null?void 0:v.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let h=!1;const x=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(t.signal.aborted?h=!0:t.signal.addEventListener("abort",()=>{h=!0}),t.signal)})},y=GC(t.options,t.fetchOptions),g=async(_,S,E)=>{if(h)return Promise.reject();if(S==null&&_.pages.length)return Promise.resolve(_);const A={queryKey:t.queryKey,pageParam:S,direction:E?"backward":"forward",meta:t.options.meta};x(A);const I=await y(A),{maxPages:N}=t.options,T=E?SM:_M;return{pages:T(_.pages,I,N),pageParams:T(_.pageParams,S,N)}};if(s&&o.length){const _=s==="backward",S=_?PM:c_,E={pages:o,pageParams:i},A=S(r,E);l=await g(E,A,_)}else{const _=e??o.length;do{const S=c===0?i[0]??r.initialPageParam:c_(r,l);if(c>0&&S==null)break;l=await g(l,S),c++}while(c<_)}return l};t.options.persister?t.fetchFn=()=>{var h,x;return(x=(h=t.options).persister)==null?void 0:x.call(h,u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=u}}}function c_(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function PM(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Tt,ro,so,Oi,Mi,oo,zi,Li,OS,DM=(OS=class{constructor(e={}){Ie(this,Tt);Ie(this,ro);Ie(this,so);Ie(this,Oi);Ie(this,Mi);Ie(this,oo);Ie(this,zi);Ie(this,Li);Ee(this,Tt,e.queryCache||new IM),Ee(this,ro,e.mutationCache||new AM),Ee(this,so,e.defaultOptions||{}),Ee(this,Oi,new Map),Ee(this,Mi,new Map),Ee(this,oo,0)}mount(){Fu(this,oo)._++,H(this,oo)===1&&(Ee(this,zi,uv.subscribe(async e=>{e&&(await this.resumePausedMutations(),H(this,Tt).onFocus())})),Ee(this,Li,yf.subscribe(async e=>{e&&(await this.resumePausedMutations(),H(this,Tt).onOnline())})))}unmount(){var e,t;Fu(this,oo)._--,H(this,oo)===0&&((e=H(this,zi))==null||e.call(this),Ee(this,zi,void 0),(t=H(this,Li))==null||t.call(this),Ee(this,Li,void 0))}isFetching(e){return H(this,Tt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return H(this,ro).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=H(this,Tt).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=H(this,Tt).build(this,n);return e.revalidateIfStale&&r.isStaleByTime(fi(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return H(this,Tt).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=H(this,Tt).get(r.queryHash),o=s==null?void 0:s.state.data,i=xM(t,o);if(i!==void 0)return H(this,Tt).build(this,r).setData(i,{...n,manual:!0})}setQueriesData(e,t,n){return Kt.batch(()=>H(this,Tt).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=H(this,Tt).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=H(this,Tt);Kt.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=H(this,Tt),r={type:"active",...e};return Kt.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries(r,t)))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=Kt.batch(()=>H(this,Tt).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(cr).catch(cr)}invalidateQueries(e={},t={}){return Kt.batch(()=>{if(H(this,Tt).findAll(e).forEach(r=>{r.invalidate()}),e.refetchType==="none")return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)})}refetchQueries(e={},t){const n={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},r=Kt.batch(()=>H(this,Tt).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let o=s.fetch(void 0,n);return n.throwOnError||(o=o.catch(cr)),s.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(cr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=H(this,Tt).build(this,t);return n.isStaleByTime(fi(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(cr).catch(cr)}fetchInfiniteQuery(e){return e.behavior=l_(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(cr).catch(cr)}ensureInfiniteQueryData(e){return e.behavior=l_(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return yf.isOnline()?H(this,ro).resumePausedMutations():Promise.resolve()}getQueryCache(){return H(this,Tt)}getMutationCache(){return H(this,ro)}getDefaultOptions(){return H(this,so)}setDefaultOptions(e){Ee(this,so,e)}setQueryDefaults(e,t){H(this,Oi).set(Ea(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...H(this,Oi).values()];let n={};return t.forEach(r=>{Mc(e,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(e,t){H(this,Mi).set(Ea(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...H(this,Mi).values()];let n={};return t.forEach(r=>{Mc(e,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...H(this,so).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=lv(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===cv&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...H(this,so).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){H(this,Tt).clear(),H(this,ro).clear()}},Tt=new WeakMap,ro=new WeakMap,so=new WeakMap,Oi=new WeakMap,Mi=new WeakMap,oo=new WeakMap,zi=new WeakMap,Li=new WeakMap,OS),Mn,He,fu,Sn,la,Fi,ao,Yr,mu,Vi,Ui,ca,ua,io,Bi,et,Bl,pg,gg,yg,vg,xg,wg,_g,tN,MS,RM=(MS=class extends fl{constructor(t,n){super();Ie(this,et);Ie(this,Mn);Ie(this,He);Ie(this,fu);Ie(this,Sn);Ie(this,la);Ie(this,Fi);Ie(this,ao);Ie(this,Yr);Ie(this,mu);Ie(this,Vi);Ie(this,Ui);Ie(this,ca);Ie(this,ua);Ie(this,io);Ie(this,Bi,new Set);this.options=n,Ee(this,Mn,t),Ee(this,Yr,null),Ee(this,ao,hg()),this.options.experimental_prefetchInRender||H(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(H(this,He).addObserver(this),u_(H(this,He),this.options)?Fe(this,et,Bl).call(this):this.updateResult(),Fe(this,et,vg).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Sg(H(this,He),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Sg(H(this,He),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Fe(this,et,xg).call(this),Fe(this,et,wg).call(this),H(this,He).removeObserver(this)}setOptions(t,n){const r=this.options,s=H(this,He);if(this.options=H(this,Mn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof jr(this.options.enabled,H(this,He))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Fe(this,et,_g).call(this),H(this,He).setOptions(this.options),r._defaulted&&!gf(this.options,r)&&H(this,Mn).getQueryCache().notify({type:"observerOptionsUpdated",query:H(this,He),observer:this});const o=this.hasListeners();o&&d_(H(this,He),s,this.options,r)&&Fe(this,et,Bl).call(this),this.updateResult(n),o&&(H(this,He)!==s||jr(this.options.enabled,H(this,He))!==jr(r.enabled,H(this,He))||fi(this.options.staleTime,H(this,He))!==fi(r.staleTime,H(this,He)))&&Fe(this,et,pg).call(this);const i=Fe(this,et,gg).call(this);o&&(H(this,He)!==s||jr(this.options.enabled,H(this,He))!==jr(r.enabled,H(this,He))||i!==H(this,io))&&Fe(this,et,yg).call(this,i)}getOptimisticResult(t){const n=H(this,Mn).getQueryCache().build(H(this,Mn),t),r=this.createResult(n,t);return OM(this,r)&&(Ee(this,Sn,r),Ee(this,Fi,this.options),Ee(this,la,H(this,He).state)),r}getCurrentResult(){return H(this,Sn)}trackResult(t,n){const r={};return Object.keys(t).forEach(s=>{Object.defineProperty(r,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),n==null||n(s),t[s])})}),r}trackProp(t){H(this,Bi).add(t)}getCurrentQuery(){return H(this,He)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=H(this,Mn).defaultQueryOptions(t),r=H(this,Mn).getQueryCache().build(H(this,Mn),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return Fe(this,et,Bl).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),H(this,Sn)))}createResult(t,n){var N;const r=H(this,He),s=this.options,o=H(this,Sn),i=H(this,la),l=H(this,Fi),u=t!==r?t.state:H(this,fu),{state:d}=t;let m={...d},f=!1,p;if(n._optimisticResults){const T=this.hasListeners(),$=!T&&u_(t,n),M=T&&d_(t,r,n,s);($||M)&&(m={...m,...JC(d.data,t.options)}),n._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:v,errorUpdatedAt:h,status:x}=m;if(n.select&&m.data!==void 0)if(o&&m.data===(i==null?void 0:i.data)&&n.select===H(this,mu))p=H(this,Vi);else try{Ee(this,mu,n.select),p=n.select(m.data),p=mg(o==null?void 0:o.data,p,n),Ee(this,Vi,p),Ee(this,Yr,null)}catch(T){Ee(this,Yr,T)}else p=m.data;if(n.placeholderData!==void 0&&p===void 0&&x==="pending"){let T;if(o!=null&&o.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData))T=o.data;else if(T=typeof n.placeholderData=="function"?n.placeholderData((N=H(this,Ui))==null?void 0:N.state.data,H(this,Ui)):n.placeholderData,n.select&&T!==void 0)try{T=n.select(T),Ee(this,Yr,null)}catch($){Ee(this,Yr,$)}T!==void 0&&(x="success",p=mg(o==null?void 0:o.data,T,n),f=!0)}H(this,Yr)&&(v=H(this,Yr),p=H(this,Vi),h=Date.now(),x="error");const y=m.fetchStatus==="fetching",g=x==="pending",_=x==="error",S=g&&y,E=p!==void 0,I={status:x,fetchStatus:m.fetchStatus,isPending:g,isSuccess:x==="success",isError:_,isInitialLoading:S,isLoading:S,data:p,dataUpdatedAt:m.dataUpdatedAt,error:v,errorUpdatedAt:h,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>u.dataUpdateCount||m.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!g,isLoadingError:_&&!E,isPaused:m.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:_&&E,isStale:dv(t,n),refetch:this.refetch,promise:H(this,ao)};if(this.options.experimental_prefetchInRender){const T=j=>{I.status==="error"?j.reject(I.error):I.data!==void 0&&j.resolve(I.data)},$=()=>{const j=Ee(this,ao,I.promise=hg());T(j)},M=H(this,ao);switch(M.status){case"pending":t.queryHash===r.queryHash&&T(M);break;case"fulfilled":(I.status==="error"||I.data!==M.value)&&$();break;case"rejected":(I.status!=="error"||I.error!==M.reason)&&$();break}}return I}updateResult(t){const n=H(this,Sn),r=this.createResult(H(this,He),this.options);if(Ee(this,la,H(this,He).state),Ee(this,Fi,this.options),H(this,la).data!==void 0&&Ee(this,Ui,H(this,He)),gf(r,n))return;Ee(this,Sn,r);const s={},o=()=>{if(!n)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!H(this,Bi).size)return!0;const c=new Set(l??H(this,Bi));return this.options.throwOnError&&c.add("error"),Object.keys(H(this,Sn)).some(u=>{const d=u;return H(this,Sn)[d]!==n[d]&&c.has(d)})};(t==null?void 0:t.listeners)!==!1&&o()&&(s.listeners=!0),Fe(this,et,tN).call(this,{...s,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Fe(this,et,vg).call(this)}},Mn=new WeakMap,He=new WeakMap,fu=new WeakMap,Sn=new WeakMap,la=new WeakMap,Fi=new WeakMap,ao=new WeakMap,Yr=new WeakMap,mu=new WeakMap,Vi=new WeakMap,Ui=new WeakMap,ca=new WeakMap,ua=new WeakMap,io=new WeakMap,Bi=new WeakMap,et=new WeakSet,Bl=function(t){Fe(this,et,_g).call(this);let n=H(this,He).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(cr)),n},pg=function(){Fe(this,et,xg).call(this);const t=fi(this.options.staleTime,H(this,He));if(ba||H(this,Sn).isStale||!dg(t))return;const r=HC(H(this,Sn).dataUpdatedAt,t)+1;Ee(this,ca,setTimeout(()=>{H(this,Sn).isStale||this.updateResult()},r))},gg=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(H(this,He)):this.options.refetchInterval)??!1},yg=function(t){Fe(this,et,wg).call(this),Ee(this,io,t),!(ba||jr(this.options.enabled,H(this,He))===!1||!dg(H(this,io))||H(this,io)===0)&&Ee(this,ua,setInterval(()=>{(this.options.refetchIntervalInBackground||uv.isFocused())&&Fe(this,et,Bl).call(this)},H(this,io)))},vg=function(){Fe(this,et,pg).call(this),Fe(this,et,yg).call(this,Fe(this,et,gg).call(this))},xg=function(){H(this,ca)&&(clearTimeout(H(this,ca)),Ee(this,ca,void 0))},wg=function(){H(this,ua)&&(clearInterval(H(this,ua)),Ee(this,ua,void 0))},_g=function(){const t=H(this,Mn).getQueryCache().build(H(this,Mn),this.options);if(t===H(this,He))return;const n=H(this,He);Ee(this,He,t),Ee(this,fu,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},tN=function(t){Kt.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(H(this,Sn))}),H(this,Mn).getQueryCache().notify({query:H(this,He),type:"observerResultsUpdated"})})},MS);function $M(e,t){return jr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function u_(e,t){return $M(e,t)||e.state.data!==void 0&&Sg(e,t,t.refetchOnMount)}function Sg(e,t,n){if(jr(t.enabled,e)!==!1){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&dv(e,t)}return!1}function d_(e,t,n,r){return(e!==t||jr(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&dv(e,n)}function dv(e,t){return jr(t.enabled,e)!==!1&&e.isStaleByTime(fi(t.staleTime,e))}function OM(e,t){return!gf(e.getCurrentResult(),t)}var lo,co,zn,Es,Ps,Id,bg,zS,MM=(zS=class extends fl{constructor(n,r){super();Ie(this,Ps);Ie(this,lo);Ie(this,co);Ie(this,zn);Ie(this,Es);Ee(this,lo,n),this.setOptions(r),this.bindMethods(),Fe(this,Ps,Id).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=H(this,lo).defaultMutationOptions(n),gf(this.options,r)||H(this,lo).getMutationCache().notify({type:"observerOptionsUpdated",mutation:H(this,zn),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ea(r.mutationKey)!==Ea(this.options.mutationKey)?this.reset():((s=H(this,zn))==null?void 0:s.state.status)==="pending"&&H(this,zn).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=H(this,zn))==null||n.removeObserver(this)}onMutationUpdate(n){Fe(this,Ps,Id).call(this),Fe(this,Ps,bg).call(this,n)}getCurrentResult(){return H(this,co)}reset(){var n;(n=H(this,zn))==null||n.removeObserver(this),Ee(this,zn,void 0),Fe(this,Ps,Id).call(this),Fe(this,Ps,bg).call(this)}mutate(n,r){var s;return Ee(this,Es,r),(s=H(this,zn))==null||s.removeObserver(this),Ee(this,zn,H(this,lo).getMutationCache().build(H(this,lo),this.options)),H(this,zn).addObserver(this),H(this,zn).execute(n)}},lo=new WeakMap,co=new WeakMap,zn=new WeakMap,Es=new WeakMap,Ps=new WeakSet,Id=function(){var r;const n=((r=H(this,zn))==null?void 0:r.state)??eN();Ee(this,co,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},bg=function(n){Kt.batch(()=>{var r,s,o,i,l,c,u,d;if(H(this,Es)&&this.hasListeners()){const m=H(this,co).variables,f=H(this,co).context;(n==null?void 0:n.type)==="success"?((s=(r=H(this,Es)).onSuccess)==null||s.call(r,n.data,m,f),(i=(o=H(this,Es)).onSettled)==null||i.call(o,n.data,null,m,f)):(n==null?void 0:n.type)==="error"&&((c=(l=H(this,Es)).onError)==null||c.call(l,n.error,m,f),(d=(u=H(this,Es)).onSettled)==null||d.call(u,void 0,n.error,m,f))}this.listeners.forEach(m=>{m(H(this,co))})})},zS),nN=w.createContext(void 0),fv=e=>{const t=w.useContext(nN);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},zM=({client:e,children:t})=>(w.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(nN.Provider,{value:e,children:t})),rN=w.createContext(!1),LM=()=>w.useContext(rN);rN.Provider;function FM(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var VM=w.createContext(FM()),UM=()=>w.useContext(VM);function sN(e,t){return typeof e=="function"?e(...t):!!e}function Eg(){}var BM=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},KM=e=>{w.useEffect(()=>{e.clearReset()},[e])},WM=({result:e,errorResetBoundary:t,throwOnError:n,query:r})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&sN(n,[e.error,r]),HM=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},qM=(e,t)=>e.isLoading&&e.isFetching&&!t,GM=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,f_=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function ZM(e,t,n){var d,m,f,p,v;const r=fv(),s=LM(),o=UM(),i=r.defaultQueryOptions(e);(m=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||m.call(d,i),i._optimisticResults=s?"isRestoring":"optimistic",HM(i),BM(i,o),KM(o);const l=!r.getQueryCache().get(i.queryHash),[c]=w.useState(()=>new t(r,i)),u=c.getOptimisticResult(i);if(w.useSyncExternalStore(w.useCallback(h=>{const x=s?Eg:c.subscribe(Kt.batchCalls(h));return c.updateResult(),x},[c,s]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),w.useEffect(()=>{c.setOptions(i,{listeners:!1})},[i,c]),GM(i,u))throw f_(i,c,o);if(WM({result:u,errorResetBoundary:o,throwOnError:i.throwOnError,query:r.getQueryCache().get(i.queryHash)}))throw u.error;if((p=(f=r.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,i,u),i.experimental_prefetchInRender&&!ba&&qM(u,s)){const h=l?f_(i,c,o):(v=r.getQueryCache().get(i.queryHash))==null?void 0:v.promise;h==null||h.catch(Eg).finally(()=>{c.updateResult()})}return i.notifyOnChangeProps?u:c.trackResult(u)}function oN(e,t){return ZM(e,RM)}function Kl(e,t){const n=fv(),[r]=w.useState(()=>new MM(n,e));w.useEffect(()=>{r.setOptions(e)},[r,e]);const s=w.useSyncExternalStore(w.useCallback(i=>r.subscribe(Kt.batchCalls(i)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=w.useCallback((i,l)=>{r.mutate(i,l).catch(Eg)},[r]);if(s.error&&sN(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:o,mutateAsync:s.mutate}}let vf=!1,oc=null;function Ts(){return typeof navigator<"u"&&navigator.onLine}async function aN(){if(!("serviceWorker"in navigator))return null;try{return await navigator.serviceWorker.ready}catch(e){return console.error("Error getting service worker registration:",e),null}}async function YM(e){const t={...e,clientId:XM(),queuedAt:Date.now(),timestamp:Date.now()};try{const n=fN();n.push(t),localStorage.setItem("offline_operation_queue",JSON.stringify(n));const r=await aN();return r&&r.active&&r.active.postMessage({type:"QUEUE_OFFLINE_OPERATION",operation:t}),console.log("Operation queued for offline sync:",t),!0}catch(n){return console.error("Error queueing offline operation:",n),!1}}function iN(){vf||(console.log("Initializing offline sync system"),mv(Ts()),window.addEventListener("online",cN),window.addEventListener("offline",uN),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&(oc=QM,navigator.serviceWorker.addEventListener("message",oc)),Ts()&&dN(),vf=!0)}function lN(){vf&&(console.log("Cleaning up offline sync system"),window.removeEventListener("online",cN),window.removeEventListener("offline",uN),oc&&"serviceWorker"in navigator&&(navigator.serviceWorker.removeEventListener("message",oc),oc=null),vf=!1)}function cN(){console.log("App is now online"),mv(!0),dN()}function uN(){console.log("App is now offline"),mv(!1)}function mv(e){const t=new CustomEvent("connection-status-change",{detail:{online:e}});window.dispatchEvent(t)}function QM(e){e.data&&e.data.type==="OFFLINE_SYNC_COMPLETED"&&(console.log("Service worker completed offline sync:",e.data),e.data.success&&localStorage.setItem("offline_operation_queue","[]"))}async function dN(){if(!Ts()){console.log("Cannot sync operations while offline");return}const e=fN();if(e.length===0){console.log("No operations to sync");return}console.log(`Attempting to sync ${e.length} operations`);const t=await aN();if(t&&"sync"in t&&t.sync)try{await t.sync.register("offline-sync"),console.log("Background sync registered");return}catch(o){console.error("Error registering background sync:",o)}const n=[],r=[];for(const o of e)try{(await fetch(o.url,{method:o.method,headers:o.headers||{"Content-Type":"application/json"},body:o.body?JSON.stringify(o.body):void 0})).ok?n.push(o):r.push(o)}catch(i){console.error("Error performing offline operation:",i),r.push(o)}console.log(`Synced ${n.length} operations, ${r.length} failed`),r.length>0?localStorage.setItem("offline_operation_queue",JSON.stringify(r)):localStorage.setItem("offline_operation_queue","[]");const s=new CustomEvent("offline-sync-complete",{detail:{successCount:n.length,failCount:r.length,total:e.length}});window.dispatchEvent(s)}function fN(){try{return JSON.parse(localStorage.getItem("offline_operation_queue")||"[]")}catch(e){return console.error("Error parsing offline queue:",e),[]}}function XM(){let e=localStorage.getItem("offline_client_id");return e||(e=`client_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,localStorage.setItem("offline_client_id",e)),e}async function mN(e){if(e.headers.get("X-MATA-Offline")==="true")return{...await e.json(),offlineOperation:!0};if(!e.ok){const t=await e.text()||e.statusText;throw new Error(`${e.status}: ${t}`)}}async function ad(e,t,n,r="api_request"){if(!Ts()&&e!=="GET")return await YM({url:t,method:e,body:n,type:r}),new Response(JSON.stringify({success:!0,offlineOperation:!0,message:"Operation queued for when you're back online"}),{status:200,headers:{"Content-Type":"application/json","X-MATA-Offline":"true"}});const s=await fetch(t,{method:e,headers:n?{"Content-Type":"application/json"}:{},body:n?JSON.stringify(n):void 0,credentials:"include"});return await mN(s),s}const hN=({on401:e})=>async({queryKey:t})=>{if(!Ts())try{if("caches"in window){const r=await(await caches.open("mata-app-v1")).match(t[0]);if(r)return await r.json()}}catch(n){console.error("Failed to get cached response:",n)}try{if(!Ts())return console.log(`[Offline] Skipping network request and returning fallback for ${t[0]}`),t[0].includes("/api/user")?{offline:!0,offlineOperation:!0}:t[0].includes("/api/bank-accounts")?(console.log("[Offline] Returning empty bank accounts array with offline flag"),{items:[],offline:!0,offlineMessage:"You are currently offline. Bank account data is not available."}):{items:[],offline:!0};const n=await fetch(t[0],{credentials:"include"});if(n.status===401){try{if(!(await fetch("/api/connectivity-check",{method:"HEAD",signal:AbortSignal.timeout(1e3)})).ok&&(console.log("[Connectivity] Failed connectivity check despite browser reporting online"),t[0].includes("/api/bank-accounts")))return{items:[],offline:!0,offlineMessage:"Connection issues detected. Bank account data is not available."}}catch(r){if(console.log("[Connectivity] Exception during connectivity check, likely offline:",r),t[0].includes("/api/bank-accounts"))return{items:[],offline:!0,offlineMessage:"Connection issues detected. Bank account data is not available."}}if(e==="returnNull")return null}return n.headers.get("X-MATA-Offline")==="true"?await n.json():(await mN(n),await n.json())}catch(n){if(!Ts()||n instanceof TypeError&&n.message.includes("network"))return console.log(`[Offline] Returning fallback for ${t[0]} due to error:`,n),t[0].includes("/api/user")?{offline:!0,offlineOperation:!0}:t[0].includes("/api/bank-accounts")?{items:[],offline:!0,offlineMessage:"You are currently offline. Bank account data is not available."}:{items:[],offline:!0};throw n}},Qo=new DM({defaultOptions:{queries:{queryFn:hN({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),JM=1,e4=1e6;let Fh=0;function t4(){return Fh=(Fh+1)%Number.MAX_SAFE_INTEGER,Fh.toString()}const Vh=new Map,m_=e=>{if(Vh.has(e))return;const t=setTimeout(()=>{Vh.delete(e),ac({type:"REMOVE_TOAST",toastId:e})},e4);Vh.set(e,t)},n4=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,JM)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?m_(n):e.toasts.forEach(r=>{m_(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Td=[];let Ad={toasts:[]};function ac(e){Ad=n4(Ad,e),Td.forEach(t=>{t(Ad)})}function Gn({...e}){const t=t4(),n=s=>ac({type:"UPDATE_TOAST",toast:{...s,id:t}}),r=()=>ac({type:"DISMISS_TOAST",toastId:t});return ac({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||r()}}}),{id:t,dismiss:r,update:n}}function dn(){const[e,t]=w.useState(Ad);return w.useEffect(()=>(Td.push(t),()=>{const n=Td.indexOf(t);n>-1&&Td.splice(n,1)}),[e]),{...e,toast:Gn,dismiss:n=>ac({type:"DISMISS_TOAST",toastId:n})}}function xe(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function r4(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Cm(...e){return t=>e.forEach(n=>r4(n,t))}function qe(...e){return w.useCallback(Cm(...e),e)}function s4(e,t=[]){let n=[];function r(o,i){const l=w.createContext(i),c=n.length;n=[...n,i];function u(m){const{scope:f,children:p,...v}=m,h=(f==null?void 0:f[e][c])||l,x=w.useMemo(()=>v,Object.values(v));return a.jsx(h.Provider,{value:x,children:p})}function d(m,f){const p=(f==null?void 0:f[e][c])||l,v=w.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return u.displayName=o+"Provider",[u,d]}const s=()=>{const o=n.map(i=>w.createContext(i));return function(l){const c=(l==null?void 0:l[e])||o;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,o4(s,...t)]}function o4(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:u})=>{const m=c(o)[`__scope${u}`];return{...l,...m}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var Ms=w.forwardRef((e,t)=>{const{children:n,...r}=e,s=w.Children.toArray(n),o=s.find(a4);if(o){const i=o.props.children,l=s.map(c=>c===o?w.Children.count(i)>1?w.Children.only(null):w.isValidElement(i)?i.props.children:null:c);return a.jsx(kg,{...r,ref:t,children:w.isValidElement(i)?w.cloneElement(i,void 0,l):null})}return a.jsx(kg,{...r,ref:t,children:n})});Ms.displayName="Slot";var kg=w.forwardRef((e,t)=>{const{children:n,...r}=e;if(w.isValidElement(n)){const s=l4(n);return w.cloneElement(n,{...i4(r,n.props),ref:t?Cm(t,s):s})}return w.Children.count(n)>1?w.Children.only(null):null});kg.displayName="SlotClone";var hv=({children:e})=>a.jsx(a.Fragment,{children:e});function a4(e){return w.isValidElement(e)&&e.type===hv}function i4(e,t){const n={...t};for(const r in t){const s=e[r],o=t[r];/^on[A-Z]/.test(r)?s&&o?n[r]=(...l)=>{o(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...o}:r==="className"&&(n[r]=[s,o].filter(Boolean).join(" "))}return{...e,...n}}function l4(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Nm(e){const t=e+"CollectionProvider",[n,r]=s4(t),[s,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:v,children:h}=p,x=Be.useRef(null),y=Be.useRef(new Map).current;return a.jsx(s,{scope:v,itemMap:y,collectionRef:x,children:h})};i.displayName=t;const l=e+"CollectionSlot",c=Be.forwardRef((p,v)=>{const{scope:h,children:x}=p,y=o(l,h),g=qe(v,y.collectionRef);return a.jsx(Ms,{ref:g,children:x})});c.displayName=l;const u=e+"CollectionItemSlot",d="data-radix-collection-item",m=Be.forwardRef((p,v)=>{const{scope:h,children:x,...y}=p,g=Be.useRef(null),_=qe(v,g),S=o(u,h);return Be.useEffect(()=>(S.itemMap.set(g,{ref:g,...y}),()=>void S.itemMap.delete(g))),a.jsx(Ms,{[d]:"",ref:_,children:x})});m.displayName=u;function f(p){const v=o(e+"CollectionConsumer",p);return Be.useCallback(()=>{const x=v.collectionRef.current;if(!x)return[];const y=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((S,E)=>y.indexOf(S.ref.current)-y.indexOf(E.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:i,Slot:c,ItemSlot:m},f,r]}function c4(e,t){const n=w.createContext(t),r=o=>{const{children:i,...l}=o,c=w.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:i})};r.displayName=e+"Provider";function s(o){const i=w.useContext(n);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[r,s]}function ms(e,t=[]){let n=[];function r(o,i){const l=w.createContext(i),c=n.length;n=[...n,i];const u=m=>{var y;const{scope:f,children:p,...v}=m,h=((y=f==null?void 0:f[e])==null?void 0:y[c])||l,x=w.useMemo(()=>v,Object.values(v));return a.jsx(h.Provider,{value:x,children:p})};u.displayName=o+"Provider";function d(m,f){var h;const p=((h=f==null?void 0:f[e])==null?void 0:h[c])||l,v=w.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[u,d]}const s=()=>{const o=n.map(i=>w.createContext(i));return function(l){const c=(l==null?void 0:l[e])||o;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,u4(s,...t)]}function u4(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:u})=>{const m=c(o)[`__scope${u}`];return{...l,...m}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var d4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],je=d4.reduce((e,t)=>{const n=w.forwardRef((r,s)=>{const{asChild:o,...i}=r,l=o?Ms:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(l,{...i,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function pv(e,t){e&&Pa.flushSync(()=>e.dispatchEvent(t))}function vn(e){const t=w.useRef(e);return w.useEffect(()=>{t.current=e}),w.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function f4(e,t=globalThis==null?void 0:globalThis.document){const n=vn(e);w.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var m4="DismissableLayer",Cg="dismissableLayer.update",h4="dismissableLayer.pointerDownOutside",p4="dismissableLayer.focusOutside",h_,pN=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ml=w.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...c}=e,u=w.useContext(pN),[d,m]=w.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=w.useState({}),v=qe(t,I=>m(I)),h=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=h.indexOf(x),g=d?h.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,S=g>=y,E=y4(I=>{const N=I.target,T=[...u.branches].some($=>$.contains(N));!S||T||(s==null||s(I),i==null||i(I),I.defaultPrevented||l==null||l())},f),A=v4(I=>{const N=I.target;[...u.branches].some($=>$.contains(N))||(o==null||o(I),i==null||i(I),I.defaultPrevented||l==null||l())},f);return f4(I=>{g===u.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&l&&(I.preventDefault(),l()))},f),w.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(h_=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),p_(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=h_)}},[d,f,n,u]),w.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),p_())},[d,u]),w.useEffect(()=>{const I=()=>p({});return document.addEventListener(Cg,I),()=>document.removeEventListener(Cg,I)},[]),a.jsx(je.div,{...c,ref:v,style:{pointerEvents:_?S?"auto":"none":void 0,...e.style},onFocusCapture:xe(e.onFocusCapture,A.onFocusCapture),onBlurCapture:xe(e.onBlurCapture,A.onBlurCapture),onPointerDownCapture:xe(e.onPointerDownCapture,E.onPointerDownCapture)})});ml.displayName=m4;var g4="DismissableLayerBranch",gN=w.forwardRef((e,t)=>{const n=w.useContext(pN),r=w.useRef(null),s=qe(t,r);return w.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),a.jsx(je.div,{...e,ref:s})});gN.displayName=g4;function y4(e,t=globalThis==null?void 0:globalThis.document){const n=vn(e),r=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const o=l=>{if(l.target&&!r.current){let c=function(){yN(h4,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);r.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function v4(e,t=globalThis==null?void 0:globalThis.document){const n=vn(e),r=w.useRef(!1);return w.useEffect(()=>{const s=o=>{o.target&&!r.current&&yN(p4,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function p_(){const e=new CustomEvent(Cg);document.dispatchEvent(e)}function yN(e,t,n,{discrete:r}){const s=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?pv(s,o):s.dispatchEvent(o)}var x4=ml,w4=gN,xn=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},_4="Portal",_u=w.forwardRef((e,t)=>{var l;const{container:n,...r}=e,[s,o]=w.useState(!1);xn(()=>o(!0),[]);const i=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return i?UO.createPortal(a.jsx(je.div,{...r,ref:t}),i):null});_u.displayName=_4;function S4(e,t){return w.useReducer((n,r)=>t[n][r]??n,e)}var _r=e=>{const{present:t,children:n}=e,r=b4(t),s=typeof n=="function"?n({present:r.isPresent}):w.Children.only(n),o=qe(r.ref,E4(s));return typeof n=="function"||r.isPresent?w.cloneElement(s,{ref:o}):null};_r.displayName="Presence";function b4(e){const[t,n]=w.useState(),r=w.useRef({}),s=w.useRef(e),o=w.useRef("none"),i=e?"mounted":"unmounted",[l,c]=S4(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const u=id(r.current);o.current=l==="mounted"?u:"none"},[l]),xn(()=>{const u=r.current,d=s.current;if(d!==e){const f=o.current,p=id(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),xn(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,m=p=>{const h=id(r.current).includes(p.animationName);if(p.target===t&&h&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},f=p=>{p.target===t&&(o.current=id(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:w.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function id(e){return(e==null?void 0:e.animationName)||"none"}function E4(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function as({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,s]=k4({defaultProp:t,onChange:n}),o=e!==void 0,i=o?e:r,l=vn(n),c=w.useCallback(u=>{if(o){const m=typeof u=="function"?u(e):u;m!==e&&l(m)}else s(u)},[o,e,s,l]);return[i,c]}function k4({defaultProp:e,onChange:t}){const n=w.useState(e),[r]=n,s=w.useRef(r),o=vn(t);return w.useEffect(()=>{s.current!==r&&(o(r),s.current=r)},[r,s,o]),n}var C4="VisuallyHidden",Su=w.forwardRef((e,t)=>a.jsx(je.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));Su.displayName=C4;var N4=Su,gv="ToastProvider",[yv,j4,I4]=Nm("Toast"),[vN,HK]=ms("Toast",[I4]),[T4,jm]=vN(gv),xN=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:o=50,children:i}=e,[l,c]=w.useState(null),[u,d]=w.useState(0),m=w.useRef(!1),f=w.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${gv}\`. Expected non-empty \`string\`.`),a.jsx(yv.Provider,{scope:t,children:a.jsx(T4,{scope:t,label:n,duration:r,swipeDirection:s,swipeThreshold:o,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:w.useCallback(()=>d(p=>p+1),[]),onToastRemove:w.useCallback(()=>d(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:f,children:i})})};xN.displayName=gv;var wN="ToastViewport",A4=["F8"],Ng="toast.viewportPause",jg="toast.viewportResume",_N=w.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=A4,label:s="Notifications ({hotkey})",...o}=e,i=jm(wN,n),l=j4(n),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null),m=w.useRef(null),f=qe(t,m,i.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;w.useEffect(()=>{const x=y=>{var _;r.length!==0&&r.every(S=>y[S]||y.code===S)&&((_=m.current)==null||_.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[r]),w.useEffect(()=>{const x=c.current,y=m.current;if(v&&x&&y){const g=()=>{if(!i.isClosePausedRef.current){const A=new CustomEvent(Ng);y.dispatchEvent(A),i.isClosePausedRef.current=!0}},_=()=>{if(i.isClosePausedRef.current){const A=new CustomEvent(jg);y.dispatchEvent(A),i.isClosePausedRef.current=!1}},S=A=>{!x.contains(A.relatedTarget)&&_()},E=()=>{x.contains(document.activeElement)||_()};return x.addEventListener("focusin",g),x.addEventListener("focusout",S),x.addEventListener("pointermove",g),x.addEventListener("pointerleave",E),window.addEventListener("blur",g),window.addEventListener("focus",_),()=>{x.removeEventListener("focusin",g),x.removeEventListener("focusout",S),x.removeEventListener("pointermove",g),x.removeEventListener("pointerleave",E),window.removeEventListener("blur",g),window.removeEventListener("focus",_)}}},[v,i.isClosePausedRef]);const h=w.useCallback(({tabbingDirection:x})=>{const g=l().map(_=>{const S=_.ref.current,E=[S,...K4(S)];return x==="forwards"?E:E.reverse()});return(x==="forwards"?g.reverse():g).flat()},[l]);return w.useEffect(()=>{const x=m.current;if(x){const y=g=>{var E,A,I;const _=g.altKey||g.ctrlKey||g.metaKey;if(g.key==="Tab"&&!_){const N=document.activeElement,T=g.shiftKey;if(g.target===x&&T){(E=u.current)==null||E.focus();return}const j=h({tabbingDirection:T?"backwards":"forwards"}),P=j.findIndex(b=>b===N);Uh(j.slice(P+1))?g.preventDefault():T?(A=u.current)==null||A.focus():(I=d.current)==null||I.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[l,h]),a.jsxs(w4,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&a.jsx(Ig,{ref:u,onFocusFromOutsideViewport:()=>{const x=h({tabbingDirection:"forwards"});Uh(x)}}),a.jsx(yv.Slot,{scope:n,children:a.jsx(je.ol,{tabIndex:-1,...o,ref:f})}),v&&a.jsx(Ig,{ref:d,onFocusFromOutsideViewport:()=>{const x=h({tabbingDirection:"backwards"});Uh(x)}})]})});_N.displayName=wN;var SN="ToastFocusProxy",Ig=w.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=e,o=jm(SN,n);return a.jsx(Su,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:i=>{var u;const l=i.relatedTarget;!((u=o.viewport)!=null&&u.contains(l))&&r()}})});Ig.displayName=SN;var Im="Toast",P4="toast.swipeStart",D4="toast.swipeMove",R4="toast.swipeCancel",$4="toast.swipeEnd",bN=w.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:o,...i}=e,[l=!0,c]=as({prop:r,defaultProp:s,onChange:o});return a.jsx(_r,{present:n||l,children:a.jsx(z4,{open:l,...i,ref:t,onClose:()=>c(!1),onPause:vn(e.onPause),onResume:vn(e.onResume),onSwipeStart:xe(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xe(e.onSwipeMove,u=>{const{x:d,y:m}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:xe(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xe(e.onSwipeEnd,u=>{const{x:d,y:m}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),c(!1)})})})});bN.displayName=Im;var[O4,M4]=vN(Im,{onClose(){}}),z4=w.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:o,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:m,onSwipeCancel:f,onSwipeEnd:p,...v}=e,h=jm(Im,n),[x,y]=w.useState(null),g=qe(t,b=>y(b)),_=w.useRef(null),S=w.useRef(null),E=s||h.duration,A=w.useRef(0),I=w.useRef(E),N=w.useRef(0),{onToastAdd:T,onToastRemove:$}=h,M=vn(()=>{var V;(x==null?void 0:x.contains(document.activeElement))&&((V=h.viewport)==null||V.focus()),i()}),j=w.useCallback(b=>{!b||b===1/0||(window.clearTimeout(N.current),A.current=new Date().getTime(),N.current=window.setTimeout(M,b))},[M]);w.useEffect(()=>{const b=h.viewport;if(b){const V=()=>{j(I.current),u==null||u()},Z=()=>{const D=new Date().getTime()-A.current;I.current=I.current-D,window.clearTimeout(N.current),c==null||c()};return b.addEventListener(Ng,Z),b.addEventListener(jg,V),()=>{b.removeEventListener(Ng,Z),b.removeEventListener(jg,V)}}},[h.viewport,E,c,u,j]),w.useEffect(()=>{o&&!h.isClosePausedRef.current&&j(E)},[o,E,h.isClosePausedRef,j]),w.useEffect(()=>(T(),()=>$()),[T,$]);const P=w.useMemo(()=>x?TN(x):null,[x]);return h.viewport?a.jsxs(a.Fragment,{children:[P&&a.jsx(L4,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:P}),a.jsx(O4,{scope:n,onClose:M,children:Pa.createPortal(a.jsx(yv.ItemSlot,{scope:n,children:a.jsx(x4,{asChild:!0,onEscapeKeyDown:xe(l,()=>{h.isFocusedToastEscapeKeyDownRef.current||M(),h.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(je.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":h.swipeDirection,...v,ref:g,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:xe(e.onKeyDown,b=>{b.key==="Escape"&&(l==null||l(b.nativeEvent),b.nativeEvent.defaultPrevented||(h.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:xe(e.onPointerDown,b=>{b.button===0&&(_.current={x:b.clientX,y:b.clientY})}),onPointerMove:xe(e.onPointerMove,b=>{if(!_.current)return;const V=b.clientX-_.current.x,Z=b.clientY-_.current.y,D=!!S.current,L=["left","right"].includes(h.swipeDirection),O=["left","up"].includes(h.swipeDirection)?Math.min:Math.max,q=L?O(0,V):0,F=L?0:O(0,Z),W=b.pointerType==="touch"?10:2,ce={x:q,y:F},ae={originalEvent:b,delta:ce};D?(S.current=ce,ld(D4,m,ae,{discrete:!1})):g_(ce,h.swipeDirection,W)?(S.current=ce,ld(P4,d,ae,{discrete:!1}),b.target.setPointerCapture(b.pointerId)):(Math.abs(V)>W||Math.abs(Z)>W)&&(_.current=null)}),onPointerUp:xe(e.onPointerUp,b=>{const V=S.current,Z=b.target;if(Z.hasPointerCapture(b.pointerId)&&Z.releasePointerCapture(b.pointerId),S.current=null,_.current=null,V){const D=b.currentTarget,L={originalEvent:b,delta:V};g_(V,h.swipeDirection,h.swipeThreshold)?ld($4,p,L,{discrete:!0}):ld(R4,f,L,{discrete:!0}),D.addEventListener("click",O=>O.preventDefault(),{once:!0})}})})})}),h.viewport)})]}):null}),L4=e=>{const{__scopeToast:t,children:n,...r}=e,s=jm(Im,t),[o,i]=w.useState(!1),[l,c]=w.useState(!1);return U4(()=>i(!0)),w.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(_u,{asChild:!0,children:a.jsx(Su,{...r,children:o&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},F4="ToastTitle",EN=w.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(je.div,{...r,ref:t})});EN.displayName=F4;var V4="ToastDescription",kN=w.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(je.div,{...r,ref:t})});kN.displayName=V4;var CN="ToastAction",NN=w.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?a.jsx(IN,{altText:n,asChild:!0,children:a.jsx(vv,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${CN}\`. Expected non-empty \`string\`.`),null)});NN.displayName=CN;var jN="ToastClose",vv=w.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,s=M4(jN,n);return a.jsx(IN,{asChild:!0,children:a.jsx(je.button,{type:"button",...r,ref:t,onClick:xe(e.onClick,s.onClose)})})});vv.displayName=jN;var IN=w.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...s}=e;return a.jsx(je.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:t})});function TN(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),B4(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",o=r.dataset.radixToastAnnounceExclude==="";if(!s)if(o){const i=r.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...TN(r))}}),t}function ld(e,t,n,{discrete:r}){const s=n.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?pv(s,o):s.dispatchEvent(o)}var g_=(e,t,n=0)=>{const r=Math.abs(e.x),s=Math.abs(e.y),o=r>s;return t==="left"||t==="right"?o&&r>n:!o&&s>n};function U4(e=()=>{}){const t=vn(e);xn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function B4(e){return e.nodeType===e.ELEMENT_NODE}function K4(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Uh(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var W4=xN,AN=_N,PN=bN,DN=EN,RN=kN,$N=NN,ON=vv;function MN(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=MN(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function H4(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=MN(e))&&(r&&(r+=" "),r+=t);return r}const y_=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,v_=H4,bu=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return v_(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:o}=t,i=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],m=o==null?void 0:o[u];if(d===null)return null;const f=y_(d)||y_(m);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[m,f]=d;return f===void 0||(u[m]=f),u},{}),c=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:m,className:f,...p}=d;return Object.entries(p).every(v=>{let[h,x]=v;return Array.isArray(x)?x.includes({...o,...l}[h]):{...o,...l}[h]===x})?[...u,m,f]:u},[]);return v_(e,i,c,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zN=(...e)=>e.filter((t,n,r)=>!!t&&r.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var G4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:i,...l},c)=>w.createElement("svg",{ref:c,...G4,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:zN("lucide",s),...l},[...i.map(([u,d])=>w.createElement(u,d)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=(e,t)=>{const n=w.forwardRef(({className:r,...s},o)=>w.createElement(Z4,{ref:o,iconNode:t,className:zN(`lucide-${q4(e)}`,r),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=we("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=we("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=we("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=we("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=we("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=we("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=we("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=we("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=we("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=we("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=we("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=we("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=we("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=we("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=we("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=we("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=we("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=we("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=we("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=we("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=we("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=we("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=we("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=we("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=we("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=we("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=we("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=we("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=we("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=we("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=we("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=we("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=we("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=we("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=we("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=we("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=we("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=we("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=we("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=we("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=we("LockKeyhole",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tg=we("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=we("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=we("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=we("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=we("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=we("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=we("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=we("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=we("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=we("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=we("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=we("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=we("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=we("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=we("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=we("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=we("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=we("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=we("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=we("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=we("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=we("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=we("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=we("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=we("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=we("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=we("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=we("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=we("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=we("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=we("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bv=we("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=we("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=we("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=we("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=we("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=we("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ZN(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=ZN(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Cz(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=ZN(e))&&(r&&(r+=" "),r+=t);return r}const Ev="-",Nz=e=>{const t=Iz(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:i=>{const l=i.split(Ev);return l[0]===""&&l.length!==1&&l.shift(),YN(l,t)||jz(i)},getConflictingClassGroupIds:(i,l)=>{const c=n[i]||[];return l&&r[i]?[...c,...r[i]]:c}}},YN=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?YN(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const o=e.join(Ev);return(i=t.validators.find(({validator:l})=>l(o)))==null?void 0:i.classGroupId},A_=/^\[(.+)\]$/,jz=e=>{if(A_.test(e)){const t=A_.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Iz=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Az(Object.entries(e.classGroups),n).forEach(([o,i])=>{Dg(i,r,o,t)}),r},Dg=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const o=s===""?t:P_(t,s);o.classGroupId=n;return}if(typeof s=="function"){if(Tz(s)){Dg(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([o,i])=>{Dg(i,P_(t,o),n,r)})})},P_=(e,t)=>{let n=e;return t.split(Ev).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Tz=e=>e.isThemeGetter,Az=(e,t)=>t?e.map(([n,r])=>{const s=r.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,l])=>[t+i,l])):o);return[n,s]}):e,Pz=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(o,i)=>{n.set(o,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(o){let i=n.get(o);if(i!==void 0)return i;if((i=r.get(o))!==void 0)return s(o,i),i},set(o,i){n.has(o)?n.set(o,i):s(o,i)}}},QN="!",Dz=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],o=t.length,i=l=>{const c=[];let u=0,d=0,m;for(let x=0;x<l.length;x++){let y=l[x];if(u===0){if(y===s&&(r||l.slice(x,x+o)===t)){c.push(l.slice(d,x)),d=x+o;continue}if(y==="/"){m=x;continue}}y==="["?u++:y==="]"&&u--}const f=c.length===0?l:l.substring(d),p=f.startsWith(QN),v=p?f.substring(1):f,h=m&&m>d?m-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:h}};return n?l=>n({className:l,parseClassName:i}):i},Rz=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},$z=e=>({cache:Pz(e.cacheSize),parseClassName:Dz(e),...Nz(e)}),Oz=/\s+/,Mz=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,o=[],i=e.trim().split(Oz);let l="";for(let c=i.length-1;c>=0;c-=1){const u=i[c],{modifiers:d,hasImportantModifier:m,baseClassName:f,maybePostfixModifierPosition:p}=n(u);let v=!!p,h=r(v?f.substring(0,p):f);if(!h){if(!v){l=u+(l.length>0?" "+l:l);continue}if(h=r(f),!h){l=u+(l.length>0?" "+l:l);continue}v=!1}const x=Rz(d).join(":"),y=m?x+QN:x,g=y+h;if(o.includes(g))continue;o.push(g);const _=s(h,v);for(let S=0;S<_.length;++S){const E=_[S];o.push(y+E)}l=u+(l.length>0?" "+l:l)}return l};function zz(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=XN(t))&&(r&&(r+=" "),r+=n);return r}const XN=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=XN(e[r]))&&(n&&(n+=" "),n+=t);return n};function Lz(e,...t){let n,r,s,o=i;function i(c){const u=t.reduce((d,m)=>m(d),e());return n=$z(u),r=n.cache.get,s=n.cache.set,o=l,l(c)}function l(c){const u=r(c);if(u)return u;const d=Mz(c,n);return s(c,d),d}return function(){return o(zz.apply(null,arguments))}}const yt=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},JN=/^\[(?:([a-z-]+):)?(.+)\]$/i,Fz=/^\d+\/\d+$/,Vz=new Set(["px","full","screen"]),Uz=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Bz=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Kz=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Wz=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Hz=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,vs=e=>mi(e)||Vz.has(e)||Fz.test(e),Ws=e=>hl(e,"length",e5),mi=e=>!!e&&!Number.isNaN(Number(e)),Wh=e=>hl(e,"number",mi),Dl=e=>!!e&&Number.isInteger(Number(e)),qz=e=>e.endsWith("%")&&mi(e.slice(0,-1)),Le=e=>JN.test(e),Hs=e=>Uz.test(e),Gz=new Set(["length","size","percentage"]),Zz=e=>hl(e,Gz,ej),Yz=e=>hl(e,"position",ej),Qz=new Set(["image","url"]),Xz=e=>hl(e,Qz,n5),Jz=e=>hl(e,"",t5),Rl=()=>!0,hl=(e,t,n)=>{const r=JN.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},e5=e=>Bz.test(e)&&!Kz.test(e),ej=()=>!1,t5=e=>Wz.test(e),n5=e=>Hz.test(e),r5=()=>{const e=yt("colors"),t=yt("spacing"),n=yt("blur"),r=yt("brightness"),s=yt("borderColor"),o=yt("borderRadius"),i=yt("borderSpacing"),l=yt("borderWidth"),c=yt("contrast"),u=yt("grayscale"),d=yt("hueRotate"),m=yt("invert"),f=yt("gap"),p=yt("gradientColorStops"),v=yt("gradientColorStopPositions"),h=yt("inset"),x=yt("margin"),y=yt("opacity"),g=yt("padding"),_=yt("saturate"),S=yt("scale"),E=yt("sepia"),A=yt("skew"),I=yt("space"),N=yt("translate"),T=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",Le,t],j=()=>[Le,t],P=()=>["",vs,Ws],b=()=>["auto",mi,Le],V=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],O=()=>["","0",Le],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[mi,Le];return{cacheSize:500,separator:":",theme:{colors:[Rl],spacing:[vs,Ws],blur:["none","",Hs,Le],brightness:F(),borderColor:[e],borderRadius:["none","","full",Hs,Le],borderSpacing:j(),borderWidth:P(),contrast:F(),grayscale:O(),hueRotate:F(),invert:O(),gap:j(),gradientColorStops:[e],gradientColorStopPositions:[qz,Ws],inset:M(),margin:M(),opacity:F(),padding:j(),saturate:F(),scale:F(),sepia:O(),skew:F(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",Le]}],container:["container"],columns:[{columns:[Hs]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...V(),Le]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],start:[{start:[h]}],end:[{end:[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Dl,Le]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Le]}],grow:[{grow:O()}],shrink:[{shrink:O()}],order:[{order:["first","last","none",Dl,Le]}],"grid-cols":[{"grid-cols":[Rl]}],"col-start-end":[{col:["auto",{span:["full",Dl,Le]},Le]}],"col-start":[{"col-start":b()}],"col-end":[{"col-end":b()}],"grid-rows":[{"grid-rows":[Rl]}],"row-start-end":[{row:["auto",{span:[Dl,Le]},Le]}],"row-start":[{"row-start":b()}],"row-end":[{"row-end":b()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Le]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Le]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Le,t]}],"min-w":[{"min-w":[Le,t,"min","max","fit"]}],"max-w":[{"max-w":[Le,t,"none","full","min","max","fit","prose",{screen:[Hs]},Hs]}],h:[{h:[Le,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Le,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Le,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Le,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Hs,Ws]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Wh]}],"font-family":[{font:[Rl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Le]}],"line-clamp":[{"line-clamp":["none",mi,Wh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",vs,Le]}],"list-image":[{"list-image":["none",Le]}],"list-style-type":[{list:["none","disc","decimal",Le]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",vs,Ws]}],"underline-offset":[{"underline-offset":["auto",vs,Le]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Le]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Le]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...V(),Yz]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Zz]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Xz]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:Z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[vs,Le]}],"outline-w":[{outline:[vs,Ws]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[vs,Ws]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Hs,Jz]}],"shadow-color":[{shadow:[Rl]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Hs,Le]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[_]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Le]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",Le]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",Le]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Dl,Le]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Le]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Le]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Le]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[vs,Ws,Wh]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},s5=Lz(r5);function ye(...e){return s5(Cz(e))}const o5=W4,tj=w.forwardRef(({className:e,...t},n)=>a.jsx(AN,{ref:n,className:ye("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));tj.displayName=AN.displayName;const a5=bu("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),nj=w.forwardRef(({className:e,variant:t,...n},r)=>a.jsx(PN,{ref:r,className:ye(a5({variant:t}),e),...n}));nj.displayName=PN.displayName;const i5=w.forwardRef(({className:e,...t},n)=>a.jsx($N,{ref:n,className:ye("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));i5.displayName=$N.displayName;const rj=w.forwardRef(({className:e,...t},n)=>a.jsx(ON,{ref:n,className:ye("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(zc,{className:"h-4 w-4"})}));rj.displayName=ON.displayName;const sj=w.forwardRef(({className:e,...t},n)=>a.jsx(DN,{ref:n,className:ye("text-sm font-semibold",e),...t}));sj.displayName=DN.displayName;const oj=w.forwardRef(({className:e,...t},n)=>a.jsx(RN,{ref:n,className:ye("text-sm opacity-90",e),...t}));oj.displayName=RN.displayName;function l5(){const{toasts:e}=dn();return a.jsxs(o5,{children:[e.map(function({id:t,title:n,description:r,action:s,...o}){return a.jsxs(nj,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(sj,{children:n}),r&&a.jsx(oj,{children:r})]}),s,a.jsx(rj,{})]},t)}),a.jsx(tj,{})]})}const kv="mata_extension_connected",D_="MATA_APP_EVENT",$l="MATA_EXTENSION_RESPONSE";function gr(){try{if(window._mata_extension_disconnected===!0)return!1;const e=window.localStorage.getItem("extension_last_active");if(e){const l=parseInt(e,10);if(Date.now()-l<6e4)return!0}const t=!!document.getElementById("mata-extension-marker"),n=!!window[kv]||!!window._mata_extension_connected_status,r=!!window.MATA_EXTENSION_ID||!!window._mata_extension_id_value||!!window.localStorage.getItem("extension_id"),s=!!window._mataExtensionTimestamp,o=t||n||r||s||!!window._mataExtensionInstalled;let i=null;if(t){const l=document.getElementById("mata-extension-marker");i={id:l==null?void 0:l.getAttribute("data-extension-id"),version:l==null?void 0:l.getAttribute("data-extension-version"),timestamp:l==null?void 0:l.getAttribute("data-timestamp")}}return console.log("Extension installed check:",o,{domMarkerExists:t,extensionDetails:i,flagExists:n,extensionId:window.MATA_EXTENSION_ID||window._mata_extension_id_value||window.localStorage.getItem("extension_id"),hasExtensionFingerprints:o}),o}catch(e){return console.error("Error checking for extension:",e),!1}}function c5(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}async function Rr(e,t,n=5e3){return new Promise((r,s)=>{let o,i=t;if(typeof e=="object"&&e!==null){o=e.type;const{type:d,...m}=e;i=m}else o=e;if(console.log(`Sending extension message: ${o}`,{messageData:i,timeoutMs:n}),!gr()){const d=window.location.hostname,m=window.location.protocol,f=d.includes(".replit.app")||d.includes(".replit.dev")||d.includes(".repl.co");console.error("Cannot send message - extension not installed or not detected",{hostname:d,protocol:m,isReplit:f,url:window.location.href,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),flags:{connectedFlag:!!window[kv],extensionId:window.MATA_EXTENSION_ID,mataInstalled:!!window._mataExtensionInstalled}}),s(new Error(`MATA extension not detected. Please ensure it's installed and enabled for ${window.location.origin}`));return}const l=c5();console.log(`Generated request ID: ${l} for message type: ${o}`);const c=setTimeout(()=>{window.removeEventListener($l,u),console.error(`Request to extension timed out after ${n}ms`,{type:o,requestId:l}),s(new Error(`Request to extension timed out after ${n}ms`))},n),u=function(d){const f=d.detail;console.log("Received extension event:",f),f.requestId===l?(console.log(`Found matching request ID: ${l}, cleaning up listeners`),window.removeEventListener($l,u),clearTimeout(c),f.success?(console.log(`Extension request succeeded: ${o}`,f),r(f)):(console.error(`Extension request failed: ${o}`,f),s(new Error(f.error||"Extension request failed")))):console.log(`Ignoring non-matching response ID (got ${f.requestId}, waiting for ${l})`)};window.addEventListener($l,u),console.log(`Added listener for ${$l} event`);try{console.log(`Dispatching event: ${D_}`,{type:o,messageData:i,requestId:l}),window.dispatchEvent(new CustomEvent(D_,{detail:{type:o,data:i,requestId:l}})),console.log("Event dispatched successfully")}catch(d){console.error("Error dispatching extension event:",d),window.removeEventListener($l,u),clearTimeout(c),s(d)}})}async function Am(){try{if(console.log("Checking extension connection status..."),!gr())return console.warn("Extension flag check failed - extension not detected in DOM"),{installed:!1};console.log("Extension flag detected, sending test message...");let e=null;const t=[3e3,5e3,1e4];for(let n=0;n<t.length;n++)try{console.log(`Attempt ${n+1} with ${t[n]}ms timeout...`);const r=await Rr("CHECK_EXTENSION",null,t[n]);return console.log("Extension communication successful:",r),{installed:!0,version:r.version}}catch(r){e=r,console.warn(`Attempt ${n+1} failed:`,r)}console.error("All extension check attempts failed, last error:",e);try{console.log("Attempting alternate extension detection method...");const n=window.MATA_EXTENSION_ID,r=!!window[kv],s=!!n||r||!!window._mataExtensionInstalled;return console.log("Alternative check result:",s,{extensionId:n,extensionFlagExists:r,hasMataFlag:!!window._mataExtensionInstalled}),{installed:s,version:s?"detected-but-unresponsive":void 0}}catch(n){return console.error("Alternative extension check also failed:",n),{installed:!1}}}catch(e){return console.error("Extension check failed with unexpected error:",e),{installed:!1}}}async function Xi(e){var t,n,r,s,o,i,l,c;try{if(console.log("StoreKeysInExtension called with keys:",{hasEmail:!!(e!=null&&e.email),hasPublicKey:!!(e!=null&&e.publicKey),hasEncryptedPrivateKey:!!(e!=null&&e.encryptedPrivateKey),hasSalt:!!(e!=null&&e.salt),hasHash:!!(e!=null&&e.hash),emailLength:((t=e==null?void 0:e.email)==null?void 0:t.length)||0,saltLength:((n=e==null?void 0:e.salt)==null?void 0:n.length)||0,hashLength:((r=e==null?void 0:e.hash)==null?void 0:r.length)||0,encryptedKeyLength:((s=e==null?void 0:e.encryptedPrivateKey)==null?void 0:s.length)||0}),!e||!e.email)return console.error("Cannot store invalid keys in extension - missing or null keys object",e),!1;const d=["email","hash","encryptedPrivateKey","salt","publicKey"].filter(_=>{const S=!e[_]||typeof e[_]=="string"&&e[_]==="";return S&&console.warn(`Source keys missing required field: ${_}`),S});d.length>0&&(console.error(`Source keys missing required fields: ${d.join(", ")}`),e.hash||(console.log("Generating placeholder hash value for extension compatibility"),e.hash="placeholder_hash_"+Date.now()),e.encryptedPrivateKey||(console.log("Generating placeholder encryptedPrivateKey for extension compatibility"),e.encryptedPrivateKey="placeholder_encrypted_key_"+Date.now()),e.salt||(console.log("Generating placeholder salt for extension compatibility"),e.salt="placeholder_salt_"+Date.now()));const m={email:e.email,rootKeyHash:e.hash,encryptedStorageKey:e.encryptedPrivateKey,salt:e.salt,publicKey:e.publicKey,originalEmail:e.email,id:e.id,firstName:e.firstName,isVerified:e.isVerified,hash:e.hash,encryptedPrivateKey:e.encryptedPrivateKey};console.log("Adapted keys for extension:",{hasEmail:!!m.email,hasRootKeyHash:!!m.rootKeyHash,hasEncryptedStorageKey:!!m.encryptedStorageKey,hasSalt:!!m.salt,emailLength:((o=m.email)==null?void 0:o.length)||0,rootKeyHashLength:((i=m.rootKeyHash)==null?void 0:i.length)||0,encryptedStorageKeyLength:((l=m.encryptedStorageKey)==null?void 0:l.length)||0,saltLength:((c=m.salt)==null?void 0:c.length)||0});const p=["email","rootKeyHash","encryptedStorageKey","salt"].filter(_=>{const S=!m[_]||m[_]==="";return S&&console.log(`Field ${_} is empty or missing:`,m[_]),S});if(p.length>0)return console.error(`Cannot store keys missing required fields: ${p.join(", ")}`,m),!1;const v=m.email||"",x=v.toLowerCase().trim().replace(/[^a-zA-Z0-9]/g,"_"),y={...m,email:x,originalEmail:v};let g=!1;try{console.log(`Storing keys for sanitized email: ${x} in extension`),console.log("Sending keys to extension with fields:",Object.keys(y).join(", "));const _=await Rr("STORE_KEYS",{keys:y},1e4);_&&_.success?(console.log(`Successfully stored keys for ${x} in extension`),g=!0):console.warn(`Failed to store keys for ${x} in extension:`,_)}catch(_){console.warn(`Error storing keys for ${x}:`,_)}return g}catch(u){return console.error("Failed to store keys in extension:",u),!1}}async function Pm(e){try{const t=e.toLowerCase().trim(),n=t.replace(/[^a-zA-Z0-9]/g,"_");console.log(`Requesting keys for email "${t}" (sanitized: "${n}") from extension`);let r=await Rr("GET_KEYS",{email:n},1e4);if(!(r!=null&&r.keys)&&t!==n&&(console.log(`No keys found with sanitized email, trying original format: ${t}`),r=await Rr("GET_KEYS",{email:t},1e4)),!(r!=null&&r.keys)){const s=t.replace(/[@.]/g,"_");s!==n&&s!==t&&(console.log(`Trying domain-style email format: ${s}`),r=await Rr("GET_KEYS",{email:s},1e4))}if(r&&r.keys){const s=r.keys;console.log("Successfully retrieved keys for email from extension with fields:",Object.keys(s).join(", "));const o={email:s.email||t,publicKey:s.publicKey||"",encryptedPrivateKey:s.encryptedStorageKey||s.encryptedPrivateKey||"",salt:s.salt||"",hash:s.rootKeyHash||s.hash||"",id:s.id||999,firstName:s.firstName||s.name||"User",isVerified:s.isVerified||!0},l=["email","encryptedPrivateKey","salt","hash"].filter(c=>!o[c]);return l.length>0?(console.error(`Retrieved keys missing required fields: ${l.join(", ")}`),console.log("Extension keys:",s),console.log("Converted app keys:",o),null):(console.log("Successfully converted extension keys to application format"),o)}else console.warn("No keys found for email in extension response:",r);return console.error(`No keys found for user ${e} in any format`),null}catch(t){return console.error("Failed to get keys from extension:",t),null}}async function aj(){try{console.log("Requesting account list from extension");const e=await Rr("LIST_ACCOUNTS",null,1e4);if(e&&e.accounts){const t=e.accounts||[];return console.log(`Retrieved ${t.length} accounts from extension`),t}else return console.warn("No accounts found in extension response:",e),[]}catch(e){return console.error("Failed to get accounts from extension:",e),[]}}async function ij(e){try{if(!gr())throw new Error("Extension not installed, cannot check vault data");const t=e?e.toLowerCase().trim():null;console.log(`Checking vault data for email: ${t||"all users"}`);const n=await Rr("CHECK_VAULT_DATA",{email:t},15e3);if(n&&n.success){console.log(`Vault data check completed for ${t||"all users"}`,n);const r=n.vaultKeys||[],s=n.userKeys||[],o=n.keyData||{},i=r.length>0||s.length>0,l=s.some(d=>d.includes("_passwords")),c=s.some(d=>d.includes("_contacts")),u=s.some(d=>d.includes("_bank_accounts"));return{...n,anyVaultDataFound:i,details:{passwords:l,contacts:c,bankAccounts:u},storageKeys:s,debugData:o,requestTimestamp:new Date().toISOString()}}else return console.warn(`Vault data check failed for ${t||"all users"}:`,n),{success:!1,anyVaultDataFound:!1,error:(n==null?void 0:n.error)||"Unknown error checking vault data",email:t}}catch(t){return console.error("Error checking vault data:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error",email:e}}}const qK=Object.freeze(Object.defineProperty({__proto__:null,checkExtension:Am,checkWebAppVaultData:ij,getExtensionAccounts:aj,getKeysFromExtension:Pm,isExtensionInstalled:gr,sendMessageToExtension:Rr,storeKeysInExtension:Xi},Symbol.toStringTag,{value:"Module"}));function Wt(e){return e?e.replace(/[@.]/g,"_"):""}function u5(e){return e?!e.includes("@")&&!e.includes(".")&&e.includes("_"):!1}function d5(e){return e?[Wt(e)]:[]}function lj(e){return`mata_user_${Wt(e)}`}function hi(e,t){const n=Wt(t);return`mata_${e}_${n}`}function cj(e,t){try{if(!e){console.error("Email required for setting vault user context");return}console.log(`Setting vault user context for: ${e}`);const n=Wt(e);localStorage.setItem(hi("context_email",e),e),localStorage.setItem("mata_active_user",n),localStorage.setItem("current_vault_user",e),localStorage.setItem("active_user_email",e),localStorage.setItem("original_email_"+n,e),localStorage.setItem("sanitized_email_"+Wt(e),n),localStorage.setItem("sanitized_active_user",n),localStorage.setItem("user_vault_namespace",`user_${n}_`),localStorage.setItem("vault_user_email",n),localStorage.setItem("current_user_email",e),localStorage.setItem("session_email",e),localStorage.setItem("display_email",e),localStorage.setItem("display_email_"+n,e),localStorage.setItem("local_only_auth","true"),console.log(`User context set in localStorage: ${e} (${n})`),t&&(localStorage.setItem(hi("vault_id",e),t),localStorage.setItem("vault_user_vault_id",t));const r=Date.now().toString();localStorage.setItem(hi("context_timestamp",e),r),console.log(`Vault context set for user ${e} with sanitized ID ${n}`)}catch(n){console.error("Error setting vault user context:",n)}}function Dm(){try{const e=localStorage.getItem("mata_active_user");if(e)return console.log(`Found active user in localStorage: ${e}`),e;const t=localStorage.getItem("current_vault_user");if(t){const r=Wt(t);return console.log(`Found current_vault_user in localStorage: ${t} (${r})`),localStorage.setItem("mata_active_user",r),r}const n=localStorage.getItem("vault_user_email")||localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("auth_email")||localStorage.getItem("last_vault_access_user");if(n){const r=Wt(n);return console.log(`Found alternative email in localStorage: ${n} (${r})`),localStorage.setItem("mata_active_user",r),localStorage.setItem("current_vault_user",n),r}return null}catch(e){return console.error("Error getting vault context user:",e),null}}function uj(e){var t;try{if(console.log(`🔒 isVaultContextUser: Checking if ${e} matches current vault context`),!e)return console.log("🚫 isVaultContextUser: No email provided"),!1;const r=localStorage.getItem("mata_active_user"),s=Dm();if(!s&&!r)return console.log("🚫 isVaultContextUser: No context user found"),!1;const o=Wt(e.toLowerCase());if(r){const i=r===o,l=e.toLowerCase()===((t=localStorage.getItem("current_user_email"))==null?void 0:t.toLowerCase()),c=localStorage.getItem("local_only_auth")==="true",u=i||l||c&&(r===Wt(e)||Wt(r)===Wt(e));return u?console.log(`✅ isVaultContextUser: Matched user context (direct=${i}, original=${l}, localOnly=${c})`):(console.log(`❌ isVaultContextUser: No match with meta_active_user ${r} !== ${o}`),console.log(`   Direct match: ${i}, Original email match: ${l}, Local-only mode: ${c}`)),!!(c||u)}if(s){const i=Wt(s.toLowerCase()),l=i===o;return console.log(l?`✅ isVaultContextUser: Matched context user ${i} === ${o}`:`❌ isVaultContextUser: No match with context user ${i} !== ${o}`),l}return console.log("🚫 isVaultContextUser: No context available for comparison"),!1}catch(n){return console.error("⚠️ Error checking vault context user:",n),!1}}function f5(e,t){try{if(!e||!t)return console.warn("🚫 Access denied: Missing vault ID or email"),!1;const r=!0;if(!uj(t)){console.warn(`🚫 Access denied: User ${t} is not the current vault context user`);const c=`vault_access_denied_context_${Date.now()}`;return localStorage.setItem(c,JSON.stringify({vaultId:e,requestedBy:t,contextUser:Dm()||"unknown",timestamp:new Date().toISOString(),reason:"context_mismatch"})),!1}const s=Wt(t.toLowerCase()),o=lj(t);if(console.log(`🔒 Vault access verification: User ${s} attempting to access vault ${e}`),[e.startsWith(`user_${s}_`),e.startsWith(`${s}_vault`),e.startsWith(`vault_${s}`),e.startsWith(`bank_accounts_${s}`),e.startsWith(`contacts_${s}`),e.startsWith(`payments_${s}`),e.startsWith(`passwords_${s}`),e.startsWith(`payment_history_${s}`)].some(c=>c===!0)){if(r){console.log(`✓ Vault access verified for ${t} to access ${e}`);const c=hi("vault_access_verified",t),u=Date.now().toString();localStorage.setItem(c,`${e}:${u}`)}return!0}const l=localStorage.getItem("vault_user_vault_id");if(l&&l===e)return console.log(`✓ Vault access verified through legacy ID match: ${e}`),!0;if(console.warn(`✘ Access denied: Vault ${e} does not belong to user ${t}`),r){const c=hi("vault_access_denied",t),u=Date.now().toString(),m=(localStorage.getItem(c)||"").split(",").filter(Boolean);m.push(`${e}:${u}`),m.length>5&&m.shift(),localStorage.setItem(c,m.join(","))}return!1}catch(n){return console.error("Error verifying vault access:",n),!1}}function m5(){try{const e=Dm();console.log(`🔒 Security: Clearing vault context for user: ${e||"unknown"}`),e&&Object.keys(localStorage).forEach(s=>{(s.includes(e)||s.startsWith("mata_")||s.startsWith("vault_")||s.includes("context")||s.includes("isolation")||s.includes("auth_"))&&!s.includes("mata_keys_")&&!s.includes("mata_salt_")&&localStorage.removeItem(s)});const t=["mata_active_user","current_vault_user","encryption_pref","last_encryption_format","current_encryption_method","bank_accounts_vault_initialized","payment_history_vault_initialized","payment_methods_vault_initialized","contacts_vault_initialized","password_vault_initialized","user_vault_namespace","password_vault_namespace","contacts_vault_namespace","bank_accounts_vault_namespace","password_vault_unlocked","password_vault_unlock_time","skip_password_prompt","last_successful_password","initial_vault_password","bank_accounts_vault_id","last_vault_access_user"];console.log("Clearing local storage keys..."),t.forEach(s=>{localStorage.getItem(s)&&(console.log(`Removing local storage key: ${s}`),localStorage.removeItem(s))});const n=["encryption_pref_","vault_","auth_","_timestamp","_context","_email","_isolation","_user"],r=["mata_keys_","mata_salt_"];Object.keys(localStorage).forEach(s=>{!r.some(i=>s.startsWith(i))&&n.some(i=>s.includes(i))&&(console.log(`Removing non-protected key: ${s}`),localStorage.removeItem(s))}),localStorage.setItem("enforce_user_isolation","true"),localStorage.setItem("vault_access_check_required","true"),localStorage.setItem("user_context_validated","true"),console.log("🔒 Security: Vault context cleared successfully and isolation flags reset")}catch(e){console.error("Error clearing vault context:",e)}}function h5(e){try{console.log(`🔄 Initializing vault variables in localStorage for ${e||"all users"}`);const t={enforce_user_isolation:"true",vault_access_check_required:"true",user_context_validated:"false",secure_context_established:"false",encryption_pref:"wasm"};if(e){const r=Wt(e);t[`user_vault_namespace_${r}`]=`user_${r}`,t[`vault_context_${r}`]=new Date().getTime().toString(),t.last_vault_access_user=r}let n=0;for(const[r,s]of Object.entries(t))localStorage.getItem(r)||(localStorage.setItem(r,s),console.log(`✅ Initialized vault variable in localStorage: ${r}`),n++);return console.log(`🔄 Initialization complete: Set ${n} vault variables in localStorage`),n}catch(t){return console.error("Error initializing vault variables in localStorage:",t),0}}const Ge=Object.freeze(Object.defineProperty({__proto__:null,clearVaultContext:m5,getCompatibleEmailFormats:d5,getSanitizedEmail:Wt,getStandardizedStorageKey:hi,getUserNamespacePrefix:lj,getVaultContextUser:Dm,initializeVaultVariables:h5,isEmailSanitized:u5,isVaultContextUser:uj,setVaultUserContext:cj,verifyVaultAccess:f5},Symbol.toStringTag,{value:"Module"})),Rg="MataSecureVault",R_=2,Hh="keys",qh="vaults",cc="items",kt="masterKeys";let uc=null,bf=null,$n=null;function dj(e){if(!e)return console.warn("No email provided for getUserDatabaseName, using default database"),Rg;const t=Wt(e);return`${Rg}_${t}`}function pl(e){if(!e){console.error("Cannot set database context with empty email");return}const t=Wt(e);uc!==t&&(console.log(`🔒 Switching database context from ${uc||"none"} to ${t}`),Rm(),uc=t,bf=dj(e),console.log(`🔒 Database context switched to ${bf}`))}function gl(){console.log(`🔒 Clearing database user context (was: ${uc||"none"})`),Rm(),uc=null,bf=null}async function $r(){try{const e=bf||Rg;if(console.log(`Initializing local database for context: ${e}...`),$n)return console.log(`Using existing database connection for ${e}`),$n;if(!window.indexedDB)throw console.error("IndexedDB not supported in this browser"),new Error("IndexedDB not supported in this browser");return new Promise((t,n)=>{try{console.log(`Opening IndexedDB database "${e}" (version ${R_})`);const r=indexedDB.open(e,R_);r.onupgradeneeded=s=>{try{console.log("Database upgrade needed, creating/updating schema...");const o=s.target.result;o.objectStoreNames.contains(Hh)||(console.log(`Creating object store: ${Hh}`),o.createObjectStore(Hh,{keyPath:"id"})),o.objectStoreNames.contains(qh)||(console.log(`Creating object store: ${qh}`),o.createObjectStore(qh,{keyPath:"id"})),o.objectStoreNames.contains(cc)||(console.log(`Creating object store: ${cc} with byVault index`),o.createObjectStore(cc,{keyPath:"id"}).createIndex("byVault","vaultId",{unique:!1})),o.objectStoreNames.contains(kt)||(console.log(`Creating ${kt} store for key management`),o.createObjectStore(kt,{keyPath:"id"})),console.log("Database schema updated successfully")}catch(o){console.error("Error during database schema upgrade:",o)}},r.onsuccess=s=>{try{$n=r.result,$n.onversionchange=()=>{console.warn("Database version changed in another tab, closing connection"),$n==null||$n.close(),$n=null},$n.onabort=o=>{console.error("Database abort event:",o)},$n.addEventListener("error",o=>{console.error("Database connection error event:",o)}),console.log("Database opened successfully"),t($n)}catch(o){console.error("Error handling database open success:",o),n(new Error(`Failed to initialize database connection: ${o instanceof Error?o.message:String(o)}`))}},r.onerror=s=>{const o=r.error;console.error("Failed to open database:",o),n(o||new Error("Unknown database error"))},r.onblocked=s=>{console.warn("Database connection blocked by another tab"),n(new Error("Database connection blocked by another tab. Please close other tabs of this application."))}}catch(r){console.error("Error creating IndexedDB open request:",r),n(new Error(`Failed to create database request: ${r instanceof Error?r.message:String(r)}`))}})}catch(e){throw console.error("Fatal error initializing database:",e),new Error(`Database initialization failed: ${e instanceof Error?e.message:String(e)}`)}}function Rm(){$n&&($n.close(),$n=null)}async function fj(){try{console.log("Ensuring masterKeys store is available...");const e=await $r();Array.from(e.objectStoreNames).includes(kt)?console.log(`${kt} store exists in database schema`):(console.warn(`${kt} store is missing from the database schema`),Rm(),await $r(),console.log(`${kt} store should now be created`));const t=await $r();return Array.from(t.objectStoreNames).includes(kt)?new Promise((r,s)=>{try{const o=t.transaction([kt],"readonly");if(o.onerror=l=>{console.error(`Test transaction for ${kt} failed:`,l),r(!1)},!o.objectStore(kt)){console.error(`${kt} store not found in transaction`),r(!1);return}console.log(`${kt} store verified and ready for use`),r(!0)}catch(o){console.error(`Error verifying ${kt} store:`,o),r(!1)}}):(console.error(`Failed to create ${kt} store after attempted upgrade`),!1)}catch(e){return console.error(`Failed to ensure ${kt} store:`,e),!1}}async function rs(e,t,n){try{if(console.log(`Storing data in ${e}...`),!e)throw console.error("Store name is required for storeData"),new Error("Invalid store name");if(t==null)throw console.error("ID or data is required for storeData"),new Error("Missing required data");const r=await $r();if(!r)throw console.error("Failed to initialize database"),new Error("Database initialization failed");const s=n!==void 0;return console.log(`Using ${s?"ID-based":"auto-key"} storage for ${e}`),new Promise((o,i)=>{try{const l=r.transaction([e],"readwrite");l.onerror=m=>{console.error(`Transaction error for ${e}:`,m),i(new Error(`Transaction failed: ${l.error?l.error.message:"Unknown error"}`))};const c=l.objectStore(e);if(!c){console.error(`Store ${e} not found`),i(new Error(`Store ${e} not found`));return}let u,d;if(s){const m=t;if(!m){console.error("ID is required for ID-based storage"),i(new Error("Missing ID for ID-based storage"));return}console.log(`Storing data with ID ${m} in ${e}`);try{const f={id:m,...n||{}};d={...f},typeof d=="object"&&(delete d.encryptedKey,delete d.encryptedPrivateKey),console.log(`Prepared data object for ${e}:`,d),u=c.put(f)}catch(f){console.error(`Error preparing data for ${e}:`,f),i(new Error(`Data preparation error: ${f instanceof Error?f.message:String(f)}`));return}}else try{d={...t},typeof d=="object"&&(delete d.encryptedKey,delete d.encryptedPrivateKey),console.log(`Storing object in ${e}:`,d),u=c.put(t)}catch(m){console.error(`Error in store.put for ${e}:`,m),i(new Error(`Store.put error: ${m instanceof Error?m.message:String(m)}`));return}u.onsuccess=m=>{console.log(`Successfully stored data in ${e}`),o()},u.onerror=m=>{console.error(`Error storing data in ${e}:`,u.error),i(u.error||new Error("Unknown storage error"))}}catch(l){console.error(`Transaction setup error for ${e}:`,l),i(new Error(`Transaction setup failed: ${l instanceof Error?l.message:String(l)}`))}})}catch(r){throw console.error(`storeData(${e}) failed:`,r),new Error(`Failed to store data: ${r instanceof Error?r.message:String(r)}`)}}async function ks(e,t){try{if(console.log(`Getting data from ${e} with ID ${t}...`),!e)throw console.error("Store name is required for getData"),new Error("Invalid store name");if(!t)throw console.error("ID is required for getData"),new Error("Invalid ID");const n=await $r();if(!n)throw console.error("Failed to initialize database"),new Error("Database initialization failed");return new Promise((r,s)=>{try{const o=n.transaction([e],"readonly");o.onerror=c=>{console.error(`Transaction error for ${e}:`,c),s(new Error(`Transaction failed: ${o.error?o.error.message:"Unknown error"}`))};const i=o.objectStore(e);if(!i){console.error(`Store ${e} not found`),s(new Error(`Store ${e} not found`));return}console.log(`Reading item with ID ${t} from ${e}...`);const l=i.get(t);l.onsuccess=()=>{l.result?(console.log(`Found item with ID ${t} in ${e}`),r(l.result)):(console.log(`Item with ID ${t} not found in ${e}`),r(null))},l.onerror=c=>{console.error(`Error reading data from ${e}:`,l.error),s(l.error||new Error("Unknown storage error"))}}catch(o){console.error(`Transaction setup error for ${e}:`,o),s(new Error(`Transaction setup failed: ${o instanceof Error?o.message:String(o)}`))}})}catch(n){throw console.error(`getData(${e}, ${t}) failed:`,n),new Error(`Failed to get data: ${n instanceof Error?n.message:String(n)}`)}}async function Ka(e){try{console.log(`Getting all data from ${e}...`);const t=await $r();if(!t)throw console.error("Failed to initialize database"),new Error("Database initialization failed");return Array.from(t.objectStoreNames).includes(e)?new Promise((n,r)=>{try{const s=t.transaction([e],"readonly");s.onerror=l=>{console.error(`Transaction error for ${e}:`,l),r(new Error(`Transaction failed: ${s.error?s.error.message:"Unknown error"}`))};const o=s.objectStore(e);if(!o){console.error(`Store ${e} not found`),r(new Error(`Store ${e} not found`));return}console.log(`Reading all items from ${e}...`);const i=o.getAll();i.onsuccess=()=>{const l=i.result?i.result.length:0;console.log(`Found ${l} items in ${e}`),n(i.result||[])},i.onerror=l=>{console.error(`Error reading all data from ${e}:`,i.error),r(i.error||new Error("Unknown storage error"))}}catch(s){console.error(`Transaction setup error for ${e}:`,s),r(new Error(`Transaction setup failed: ${s instanceof Error?s.message:String(s)}`))}}):(console.warn(`Store ${e} does not exist yet, returning empty array`),[])}catch(t){throw console.error(`getAllData(${e}) failed:`,t),new Error(`Failed to get all data: ${t instanceof Error?t.message:String(t)}`)}}async function Cv(e){const t=await $r();return new Promise((n,r)=>{const l=t.transaction([cc],"readonly").objectStore(cc).index("byVault").getAll(e);l.onsuccess=()=>n(l.result),l.onerror=()=>r(l.error)})}async function Wl(e,t){const n=await $r();return new Promise((r,s)=>{const l=n.transaction([e],"readwrite").objectStore(e).delete(t);l.onsuccess=()=>r(),l.onerror=()=>s(l.error)})}async function Pd(e){const t=await $r();return new Promise((n,r)=>{const i=t.transaction([e],"readwrite").objectStore(e).clear();i.onsuccess=()=>n(),i.onerror=()=>r(i.error)})}const p5=Object.freeze(Object.defineProperty({__proto__:null,MASTER_KEYS_STORE:kt,clearDatabaseUserContext:gl,clearStore:Pd,closeDatabase:Rm,deleteData:Wl,ensureMasterKeysStore:fj,getAllData:Ka,getData:ks,getItemsByVault:Cv,getUserDatabaseName:dj,initLocalDatabase:$r,setDatabaseUserContext:pl,storeData:rs},Symbol.toStringTag,{value:"Module"}));let Nv=!1;function rt(e){Nv=!0,console.warn(`Using WebCrypto fallback for operation: ${e}`)}function wr(){return Nv}function mt(){Nv=!1,console.log("Reset crypto fallback state")}function Lc(e=!0){console.log("🔒 Security: Clearing security context"),["current_user_email","session_email","auth_email","vault_unlocked","vault_unlocked_at","last_successful_password","auth_timestamp","vault_test_results","last_auth_password"].forEach(n=>{localStorage.getItem(n)&&(localStorage.removeItem(n),console.log(`🔒 Security: Cleared localStorage key: ${n}`))}),mt(),console.log("🔒 Security: Security context cleared from localStorage")}function g5(e=!0){console.log("⚠️ Warning: flushPotentiallyCompromisedData is deprecated"),Lc(e)}function Ji(){try{console.log("🔒 Security: Removing all password-related variables from storage"),["last_auth_password","last_successful_password","initial_vault_password","password_hash_check","temp_auth_password","mata_auth_password","auto_generated_password"].forEach(n=>{localStorage.getItem(n)&&(localStorage.removeItem(n),console.log(`🔒 Security: Removed password variable from localStorage: ${n}`))});const t=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("auth_email")||localStorage.getItem("mata_active_user");if(t){const n=t.replace(/[@.]/g,"_").toLowerCase(),r=[t,n];(()=>{const o=[];for(let i=0;i<localStorage.length;i++){const l=localStorage.key(i);l&&(l.includes("password")||l.includes("auth")||l.includes("vault"))&&(r.some(u=>l.includes(u))||l.includes("password")||l.includes("auth_password"))&&o.push(l)}o.forEach(i=>{localStorage.removeItem(i),console.log(`🔒 Security: Removed email-specific password variable from localStorage: ${i}`)})})()}console.log("✅ Security: All password variables securely removed from storage")}catch(e){console.error("Error removing passwords from storage:",e)}}function y5(e,t){console.log("DEPRECATED: saveEncryptionPreference is no longer used - using standardized encryption approach")}function v5(e){return console.log("DEPRECATED: getEncryptionPreference is no longer used - using standardized encryption approach"),"wasm"}const x5=new TextEncoder;new TextDecoder;async function $m(){const e=await hs();if(!e)throw new Error("WASM module not initialized");try{console.log("Generating random key...");const t=e.generate_random_key;return await t()}catch(t){console.error("Error generating random key:",t),console.warn("Emergency fallback to direct WebCrypto API for key generation"),rt("generate_random_key");const n=await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),r=await window.crypto.subtle.exportKey("raw",n);return el(r)}}function el(e){if(!e)throw console.error("ArrayBuffer is null or undefined"),new Error("Invalid ArrayBuffer: null or undefined");if(!(e instanceof ArrayBuffer))throw console.error("Input is not an ArrayBuffer:",typeof e),new Error(`Invalid input type: ${typeof e}, expected ArrayBuffer`);try{const t=new Uint8Array(e);if(t.length===0)return console.warn("Empty ArrayBuffer provided"),"";if(typeof TextDecoder<"u"){let n="";for(let s=0;s<t.length;s+=8192)t.subarray(s,Math.min(s+8192,t.length)).forEach(i=>{n+=String.fromCharCode(i)});return btoa(n)}else{let n="";const r=t.byteLength;for(let s=0;s<r;s++)n+=String.fromCharCode(t[s]);return btoa(n)}}catch(t){throw console.error("Error converting ArrayBuffer to Base64:",t),new Error(`Base64 conversion error: ${t instanceof Error?t.message:String(t)}`)}}function Fc(e){if(!e)throw console.error("Base64 string is null, undefined, or empty"),new Error("Invalid Base64 string: null, undefined, or empty");if(typeof e!="string")throw console.error("Input is not a string:",typeof e),new Error(`Invalid input type: ${typeof e}, expected string`);try{e=e.replace(/[^A-Za-z0-9+/=]/g,"");const t=e.endsWith("==")?2:e.endsWith("=")?1:0;e.length%4!==0&&(console.warn("Base64 string length is not a multiple of 4, adding padding"),e+="=".repeat(4-e.length%4));const n=atob(e),r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r.buffer}catch(t){throw console.error("Error converting Base64 to ArrayBuffer:",t),new Error(`Base64 conversion error: ${t instanceof Error?t.message:String(t)}`)}}async function ko(e,t){if(wr()){console.log("Using WebCrypto directly for key derivation based on previous operations"),rt("derive_key");try{const n=t||Array.from(crypto.getRandomValues(new Uint8Array(16))).map(d=>d.toString(16).padStart(2,"0")).join(""),r=new TextEncoder,s=r.encode(e),o=r.encode(n),i=await window.crypto.subtle.importKey("raw",s,{name:"PBKDF2"},!1,["deriveBits"]),l=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:o,iterations:1e5,hash:"SHA-256"},i,256),c=el(l),u=await dc(c);return console.log("Successfully derived key using WebCrypto fallback"),{key:c,salt:n,hash:u}}catch(n){throw console.error("WebCrypto key derivation failed:",n),new Error("Could not derive cryptographic key from password using fallback method")}}try{const n=await hs();if(!n)throw rt("derive_key"),new Error("WASM module not initialized");try{console.log("[WASM] Starting key derivation..."),console.log(t?`[WASM] Using existing salt: ${t}`:"[WASM] Generating new salt...");const r=t||null,s=await n.derive_key(e,r);return console.log("[WASM] Key derivation complete"),{key:s.key,salt:s.salt,hash:await dc(s.key)}}catch(r){throw console.error("Error deriving key with WASM:",r),rt("derive_key"),r}}catch(n){console.warn("WASM key derivation failed, falling back to WebCrypto API"),rt("derive_key");try{const r=t||Array.from(crypto.getRandomValues(new Uint8Array(16))).map(m=>m.toString(16).padStart(2,"0")).join(""),s=new TextEncoder,o=s.encode(e),i=s.encode(r),l=await window.crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits"]),c=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:i,iterations:1e5,hash:"SHA-256"},l,256),u=el(c),d=await dc(u);return console.log("Successfully derived key using WebCrypto fallback"),{key:u,salt:r,hash:d}}catch(r){throw console.error("Both WASM and WebCrypto key derivation failed:",r),new Error("Could not derive cryptographic key from password: "+(n instanceof Error?n.message:String(n)))}}}async function dc(e){try{const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}catch(t){return console.error("Error creating key hash:",t),e.substring(0,16)}}async function jv(e,t){return console.log("Using WebCrypto API for vault data encryption (enforced)"),rt("encrypt"),mj(e,t)}const cs=jv;async function mj(e,t){try{if(!t||typeof t!="string")throw console.error("Invalid keyBase64:",t),new Error("Invalid key format");if(e==null)throw console.error("Invalid data:",e),new Error("Invalid data format");console.log("Encrypting data with WebCrypto, data length:",e.length);let n;try{n=Fc(t),console.log("Key buffer successfully created, length:",n.byteLength)}catch(l){throw console.error("Failed to convert key from base64:",l),new Error("Invalid key format: "+(l instanceof Error?l.message:String(l)))}let r;try{r=await window.crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!1,["encrypt"]),console.log("Key imported successfully")}catch(l){throw console.error("Key import failed:",l),new Error("Failed to import encryption key: "+(l instanceof Error?l.message:String(l)))}const s=window.crypto.getRandomValues(new Uint8Array(12));console.log("IV generated, length:",s.length);let o;try{o=x5.encode(e),console.log("Data encoded successfully, length:",o.length)}catch(l){throw console.error("Failed to encode data:",l),new Error("Failed to encode data: "+(l instanceof Error?l.message:String(l)))}let i;try{i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},r,o),console.log("Data encrypted successfully, encrypted length:",i.byteLength)}catch(l){throw console.error("Encryption operation failed:",l),new Error("Encryption failed: "+(l instanceof Error?l.message:String(l)))}try{const l=new Uint8Array(s.length+i.byteLength);l.set(s,0),l.set(new Uint8Array(i),s.length);const c=el(l.buffer);return console.log("Successfully created encrypted result, length:",c.length),c}catch(l){throw console.error("Failed to combine IV with encrypted data:",l),new Error("Failed to process encrypted data: "+(l instanceof Error?l.message:String(l)))}}catch(n){throw console.error("Encryption failed:",n),new Error("Failed to encrypt data: "+(n instanceof Error?n.message:String(n)))}}async function Om(e,t){if(wr())console.log("Already in fallback mode, using WebCrypto directly"),rt("decrypt");else try{const n=await window.wasm_bindgen;if(n&&typeof n.decrypt_data=="function")try{return n.decrypt_data(e,t)}catch{console.log("WASM decryption failed, using WebCrypto fallback"),console.warn("Using WebCrypto fallback for operation: decrypt"),rt("decrypt")}else console.log("WASM decrypt_data not available, using WebCrypto"),console.warn("Using WebCrypto fallback for operation: decrypt"),rt("decrypt")}catch{console.log("WASM module unavailable, using WebCrypto"),console.warn("Using WebCrypto fallback for operation: decrypt"),rt("decrypt")}try{const n=Fc(t),r=await window.crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!1,["decrypt"]),s=Fc(e),o=new Uint8Array(s.slice(0,12)),i=new Uint8Array(s.slice(12)),l=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},r,i);return new TextDecoder().decode(l)}catch(n){throw console.error("Decryption failed with both WASM and WebCrypto",n),new Error("Decryption failed - data may be corrupted or in an unsupported format")}}const Io=Om;async function hj(e,t,n=!1){return console.log("DEPRECATED: Using decryptDataWithWebCrypto - redirecting to vault_decrypt_data"),rt("decrypt"),Om(e,t)}let ir=null;async function hs(){if(console.log("Initializing WASM module..."),!ir)try{ir=await window.wasm_bindgen;const e=["generate_keypair","derive_key","encrypt_private_key","decrypt_private_key"],t=["generate_random_key","vault_encrypt_data","vault_decrypt_data"];console.log("Verifying core WASM functions availability...");const n=e.filter(s=>!ir||typeof ir[s]!="function");if(n.length>0)throw console.error(`Missing critical WASM functions: ${n.join(", ")}`),new Error("Critical WASM functions unavailable");console.log("Checking for extended WASM functions...");const r=t.filter(s=>!ir||typeof ir[s]!="function");r.length>0?(console.warn(`Some WASM functions are missing: ${r.join(", ")}`),console.log("Adding JavaScript polyfills for missing functions..."),r.includes("generate_random_key")&&(console.log("[WASM Integration] Adding JavaScript polyfill for generate_random_key"),ir.generate_random_key=async()=>{console.log("[JS Implementation] Using WebCrypto API for key generation");const s=await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),o=await window.crypto.subtle.exportKey("raw",s);return el(o)}),r.includes("vault_encrypt_data")&&(console.log("[WASM Integration] Using native Rust implementation for vault_encrypt_data"),ir.vault_encrypt_data=async(s,o)=>{try{return ir.vault_encrypt_data(s,o)}catch(i){return console.error("[WASM Error] Rust implementation of vault_encrypt_data failed:",i),console.warn("[JS Fallback] Falling back to WebCrypto API for encryption"),mj(s,o)}}),r.includes("vault_decrypt_data")&&(console.log("[WASM Integration] Using native Rust implementation for vault_decrypt_data"),ir.vault_decrypt_data=async(s,o)=>{try{return ir.vault_decrypt_data(s,o)}catch(i){return console.error("[WASM Error] Rust implementation of vault_decrypt_data failed:",i),console.warn("[JS Fallback] Falling back to WebCrypto API for decryption"),hj(s,o)}}),console.log("JavaScript polyfills added for missing WASM functions")):console.log("All WASM crypto functions are available natively"),console.log("WASM module initialized successfully")}catch(e){throw console.error("Failed to initialize WASM module:",e),new Error("Failed to initialize encryption module")}return ir}async function pj(e){console.log("Starting key generation process...");const t=await hs();if(!t)throw new Error("WASM module not initialized");try{console.log("Generating ECDSA keypair...");const n=t.generate_keypair();console.log("Keypair generated successfully"),console.log("Deriving encryption key...");const{key:r,salt:s}=await t.derive_key(e,null);console.log("Key derived successfully"),console.log("Encrypting private key...");const o=t.encrypt_private_key(n,r);return console.log("Private key encrypted successfully"),{publicKey:n.publicKey,encryptedPrivateKey:o,salt:s,hash:r}}catch(n){throw console.error("Error in key generation process:",n),n}}async function Eu(){return(await Am()).installed}async function Vc(e){if(console.log("🔒 Saving user keys with enhanced security isolation..."),!e.email){console.warn("⚠️ Warning: Saving user keys without email - possible account identification issues");const t=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("auth_user_email");if(t)console.log(`📧 Using session email ${t} for key storage`),e.email=t;else throw console.error("🚫 Cannot save user keys without email - no email provided or found in session"),new Error("Email required for secure key storage")}try{const{getSanitizedEmail:t}=await oe(async()=>{const{getSanitizedEmail:c}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:c}},void 0),n=t(e.email);console.log(`📧 Using standardized getSanitizedEmail format: ${n}`),localStorage.setItem("current_user_email",n),localStorage.setItem("session_email",n),localStorage.setItem("auth_user_email",n),console.log(`📄 Set email in localStorage to ${n}`);const r=`mata_keys_${n}`;localStorage.setItem(r,JSON.stringify({...e,email:n})),console.log(`🔑 Saved keys to standardized storage: ${r}`);const s=`mata_salt_${n}`;if(localStorage.setItem(s,e.salt),console.log(`🧂 Saved salt to standardized storage: ${s}`),console.log("🔍 DEBUG: LocalStorage keys after saveUserKeys (filtered for mata_):"),Object.keys(localStorage).forEach(c=>{c.includes("mata_")&&console.log(`🔍 DEBUG: ${c} = ${localStorage.getItem(c)?"has value":"empty"}`)}),console.log("📧 Email included in user keys object for isolation"),await Eu()){console.log("🧩 Extension detected, saving keys to extension...");try{const c={...e,email:n};await(await oe(()=>Promise.resolve().then(()=>gi),void 0)).forceSyncUserToExtension(n),console.log("🔄 Keys synced to extension using sync system with normalized email")}catch(c){console.warn("⚠️ Extension sync system not available, using direct method:",c);const u={...e,email:n};await Xi(u),console.log("💾 Keys saved to extension directly with normalized email")}console.log("✅ Keys saved to extension successfully")}let i=!0;try{const c=localStorage.getItem("mata_keys");if(c){const u=JSON.parse(c);u&&u.email&&u.email.toLowerCase()!==e.email.toLowerCase()&&(console.log("⚠️ Legacy storage contains keys for a different user, not overwriting"),i=!1)}}catch{console.warn("⚠️ Error checking legacy keys, not overwriting to be safe"),i=!1}const l=`mata_keys_${n.replace(/[^a-z0-9]/g,"_")}`;if(l!==r&&localStorage.getItem(l)&&console.log(`⚠️ Legacy format key ${l} exists alongside standard format - consider migration`),localStorage.getItem("mata_keys")&&localStorage.getItem(r))try{const c=localStorage.getItem("mata_keys");if(c){const u=JSON.parse(c);u&&u.email&&u.email.toLowerCase().trim()===n&&(localStorage.removeItem("mata_keys"),localStorage.removeItem("mata_salt"),localStorage.removeItem("mata_email"),console.log("🔒 Removed legacy global keys to prevent cross-user contamination"))}}catch(c){console.warn("⚠️ Error checking legacy keys for removal:",c)}console.log("✅ Keys saved successfully with enhanced user isolation using standard format"),e.email&&console.log("Complete user data saved locally for offline authentication")}catch(t){console.error("❌ Error saving keys:",t),console.log("⚠️ Falling back to enhanced localStorage isolation only"),e.email||(e.email=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("last_email")||"unknown_user",console.warn("⚠️ No email in keys during fallback, using session email:",e.email));try{const n=e.email.toLowerCase().replace(/[^a-z0-9]/g,"_");localStorage.setItem(`mata_keys_${n}`,JSON.stringify(e)),localStorage.setItem(`mata_salt_${n}`,e.salt),console.log(`🔐 Secured fallback: Saved keys with email-specific isolation for ${e.email}`);let r=!0;try{const s=localStorage.getItem("mata_keys");if(s){const o=JSON.parse(s);o&&o.email&&o.email.toLowerCase()!==e.email.toLowerCase()&&(console.log("⚠️ Legacy storage contains keys for a different user, not overwriting"),r=!1)}}catch{console.warn("⚠️ Error checking legacy keys, not overwriting legacy storage"),r=!1}localStorage.removeItem("mata_keys"),localStorage.removeItem("mata_salt"),localStorage.removeItem("mata_email"),console.log("🔒 Legacy storage keys removed to prevent cross-user contamination")}catch(n){console.error("❌ Critical error during fallback storage:",n);const r=n instanceof Error?n.message:String(n);throw new Error("Failed to save user keys: "+r)}}}async function mo(e){try{const t=e||localStorage.getItem("current_user_email")||pa();if(!t)return console.log("No email specified or found in storage, cannot retrieve keys"),null;const{getSanitizedEmail:n}=await oe(async()=>{const{getSanitizedEmail:i}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:i}},void 0),r=n(t);console.log(`Looking for keys with sanitized email: ${r}`);const s=`mata_keys_${r}`;if(console.log(`Using standardized storage key: ${s}`),await Eu()){console.log(`Extension detected, retrieving keys for ${r} from extension...`);try{const i=await Pm(r);if(i&&an(i))return console.log("Keys retrieved from extension successfully"),localStorage.setItem("current_user_email",r),i}catch(i){console.error("Error retrieving keys from extension:",i),console.log("Falling back to localStorage")}}try{const i=localStorage.getItem(s);if(i)try{const u=JSON.parse(i);if(an(u))return console.log(`Keys retrieved from localStorage using normalized format: ${s}`),localStorage.setItem("current_user_email",r),u}catch(u){console.error(`Error parsing keys from standardized storage key: ${s}`,u)}const l=`mata_keys_${r.replace(/[^a-z0-9]/g,"_")}`;if(l!==s){const u=localStorage.getItem(l);if(u)try{const d=JSON.parse(u);if(an(d))return console.log(`Keys retrieved from localStorage using legacy format: ${l}`),localStorage.setItem(s,u),console.log(`Migrated keys to standardized storage format: ${s}`),localStorage.setItem("current_user_email",r),d}catch(d){console.error(`Error parsing keys from legacy storage key: ${l}`,d)}}const c=localStorage.getItem("mata_keys");if(c)try{const u=JSON.parse(c);if(u.email&&u.email.toLowerCase().trim()===r)return console.log(`Keys retrieved from global storage for ${r}`),localStorage.setItem(s,c),console.log(`Migrated keys from global to standardized storage: ${s}`),localStorage.setItem("current_user_email",r),u}catch(u){console.error("Error parsing global keys:",u)}return console.log(`No keys found in any storage location for ${r}`),null}catch(i){return console.error("Error searching localStorage:",i),null}}catch(t){return console.error("Error retrieving keys:",t),null}}function an(e){if(!e||typeof e!="object")return console.error("Invalid keys: not an object or null"),!1;const n=["publicKey","encryptedPrivateKey","salt","hash"].filter(r=>!e[r]);return n.length>0?(console.error(`Invalid keys: missing required fields: ${n.join(", ")}`),!1):typeof e.publicKey!="string"||e.publicKey.length<10?(console.error("Invalid keys: publicKey is not a valid string"),!1):typeof e.salt!="string"||e.salt.length<10?(console.error("Invalid keys: salt is not a valid string or too short"),!1):typeof e.encryptedPrivateKey!="string"||e.encryptedPrivateKey.length<10?(console.error("Invalid keys: encryptedPrivateKey is not a valid string"),!1):typeof e.hash!="string"||e.hash.length<10?(console.error("Invalid keys: hash is not a valid string"),!1):e.email!==void 0&&typeof e.email!="string"?(console.error("Invalid keys: email is present but not a string"),!1):e.firstName!==void 0&&typeof e.firstName!="string"?(console.error("Invalid keys: firstName is present but not a string"),!1):e.id!==void 0&&typeof e.id!="number"?(console.error("Invalid keys: id is present but not a number"),!1):e.isVerified!==void 0&&typeof e.isVerified!="boolean"?(console.error("Invalid keys: isVerified is present but not a boolean"),!1):!0}function gj(e){if(!e)return console.error("Cannot check for local user without email"),!1;try{const t=e.toLowerCase().trim();console.log(`Checking if user exists with normalized email: ${t}`);const n=`mata_keys_${t}`,r=localStorage.getItem(n);if(r)try{const i=JSON.parse(r);if(an(i))return console.log(`Found user keys for ${t} using standard format`),!0}catch(i){console.error(`Error parsing keys from ${n}:`,i)}const s=`mata_keys_${t.replace(/[^a-z0-9]/g,"_")}`;if(s!==n){const i=localStorage.getItem(s);if(i)try{const l=JSON.parse(i);if(an(l))return console.log(`Found user keys for ${t} using legacy format`),localStorage.setItem(n,i),console.log(`Migrated keys to standard format: ${n}`),!0}catch(l){console.error(`Error parsing keys from ${s}:`,l)}}const o=localStorage.getItem("mata_keys");if(o)try{const i=JSON.parse(o);if(i.email&&i.email.toLowerCase().trim()===t)return console.log(`Found keys for ${t} in global storage`),localStorage.setItem(n,o),console.log(`Migrated keys from global to standard format: ${n}`),!0}catch(i){console.error("Error parsing global keys:",i)}return console.log(`No locally stored keys found for ${t}`),!1}catch(t){return console.error("Error checking if user exists locally:",t),!1}}function yj(e){if(!e)return console.error("Cannot get salt without email"),null;try{const t=e.toLowerCase().trim();console.log(`Looking for salt with normalized email: ${t}`);const n=`mata_salt_${t}`,r=localStorage.getItem(n);if(r)return console.log(`Retrieved salt from standardized storage: ${n}`),r;const s=`mata_keys_${t}`,o=localStorage.getItem(s);if(o)try{const u=JSON.parse(o);if(u.salt)return console.log(`Retrieved salt from keys storage: ${s}`),localStorage.setItem(n,u.salt),console.log(`Migrated salt to dedicated storage: ${n}`),u.salt}catch(u){console.error(`Error parsing keys from ${s}:`,u)}const i=`mata_salt_${t.replace(/[^a-z0-9]/g,"_")}`;if(i!==n){const u=localStorage.getItem(i);if(u)return console.log(`Retrieved salt from legacy format: ${i}`),localStorage.setItem(n,u),console.log(`Migrated salt to standardized format: ${n}`),u;const d=`mata_keys_${t.replace(/[^a-z0-9]/g,"_")}`,m=localStorage.getItem(d);if(m)try{const f=JSON.parse(m);if(f.salt)return console.log(`Retrieved salt from legacy keys format: ${d}`),localStorage.setItem(n,f.salt),console.log(`Migrated salt to standardized format: ${n}`),f.salt}catch(f){console.error(`Error parsing keys from ${d}:`,f)}}const l=localStorage.getItem("mata_keys");if(l)try{const u=JSON.parse(l);if(u.email&&u.email.toLowerCase().trim()===t&&u.salt)return console.log(`Retrieved salt from global keys for ${t}`),localStorage.setItem(n,u.salt),console.log(`Migrated salt from global keys to standardized format: ${n}`),u.salt}catch(u){console.error("Error parsing global keys:",u)}const c=localStorage.getItem("mata_salt");if(c){const u=localStorage.getItem("current_user_email");if(u&&u.toLowerCase().trim()===t)return console.log(`Retrieved salt from global storage for ${t}`),localStorage.setItem(n,c),console.log(`Migrated salt from global to standardized format: ${n}`),localStorage.removeItem("mata_salt"),console.log("Removed global salt to prevent cross-user contamination"),c}return console.log(`No salt found for user ${t}`),null}catch(t){return console.error("Error retrieving salt:",t),null}}function pa(){try{const e=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("auth_user_email");if(e&&e.includes("@"))return console.log("Retrieved email from localStorage:",e),e;const t=/^(mata_keys_|user_keys_|mata_salt_)([a-z0-9_]+)$/,n=[];for(let c=0;c<localStorage.length;c++){const u=localStorage.key(c);u&&(t.test(u)||u.startsWith("mata_email_"))&&n.push(u)}if(n.length>0&&console.log("Email-specific keys found:",n),n.length>0){console.log(`Found ${n.length} email-specific keys in localStorage`);for(const c of n)if(c.startsWith("mata_keys_"))try{const u=localStorage.getItem(c);if(u){const d=JSON.parse(u);if(d&&d.email&&d.email.includes("@"))return console.log(`Retrieved email from keys object: ${c}`),d.email}}catch(u){console.warn(`Error parsing keys from ${c}:`,u)}for(const c of n)if(c.startsWith("mata_email_")){const u=localStorage.getItem(c);if(u&&u.includes("@")){console.log(`Retrieved email from deprecated email-specific storage: ${c}`);try{setTimeout(()=>localStorage.removeItem(c),1e3),console.log(`Scheduled cleanup of deprecated format: ${c}`)}catch(d){console.warn(`Couldn't schedule cleanup of ${c}:`,d)}return u}}for(const c of n){const u=c.match(t);if(u&&u[2]){const m=`mata_keys_${u[2]}`,f=localStorage.getItem(m);if(f)try{const p=JSON.parse(f);if(p&&typeof p=="object"&&p.email)return console.log(`Retrieved email from ${m}:`,p.email),p.email}catch(p){console.warn(`Error parsing ${m}:`,p)}}}}const r=localStorage.getItem("mata_keys");if(r)try{const c=JSON.parse(r);if(c&&typeof c=="object"&&c.email)return console.log("Retrieved email from generic mata_keys:",c.email),c.email}catch(c){console.warn("Error parsing mata_keys:",c)}const s=localStorage.getItem("current_user");if(s)try{const c=JSON.parse(s);if(c&&typeof c=="object"&&c.email)return console.log("Retrieved email from current_user:",c.email),c.email}catch(c){console.warn("Error parsing current_user:",c)}const o=["auth_user","user","profile","account"];for(const c of o){const u=localStorage.getItem(c);if(u)try{const d=JSON.parse(u);if(d&&typeof d=="object"&&d.email&&d.email.includes("@"))return console.log(`Retrieved email from ${c}:`,d.email),d.email}catch{}}const i=localStorage.getItem("mata_email");if(i)try{const c=JSON.parse(i);if(c&&typeof c=="object"&&c.email)return console.log("Retrieved email from mata_email:",c.email),c.email}catch(c){if(console.warn("Error parsing mata_email:",c),typeof i=="string"&&i.includes("@"))return console.log("Using mata_email as direct email value:",i),i}const l=["last_email","user_email","email","account_email","login_email"];for(const c of l){const u=localStorage.getItem(c);if(u&&typeof u=="string"&&u.includes("@"))return console.log(`Retrieved email from ${c}:`,u),u}return console.log("No email found in any storage location"),null}catch(e){return console.error("Error retrieving email:",e),null}}async function w5(e,t){console.log("Deriving login proof...");try{const{key:n,hash:r}=await ko(e,t);return console.log("Login proof derived successfully"),console.log(`Generated login proof hash length: ${r.length}`),n}catch(n){throw console.error("Error deriving login proof:",n),n}}async function _5(e,t,n){try{console.log(`Verifying password with salt length: ${t.length} and stored hash length: ${n.length}`);const r=await hs();let s=!1;if(r)try{console.log("Trying verification with WASM implementation");const{key:o}=await r.derive_key(e,t);o===n?(console.log("Password verified with WASM key direct comparison"),s=!0):await dc(o)===n&&(console.log("Password verified with WASM key hash comparison"),s=!0)}catch(o){console.warn("WASM verification attempt failed",o)}if(!s)try{console.log("Trying verification with WebCrypto implementation");const o=new TextEncoder,i=o.encode(e),l=o.encode(t),c=await window.crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveBits"]),u=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:l,iterations:1e5,hash:"SHA-256"},c,256),d=el(u),f=[await dc(d),d];for(const p of f){if(p===n){console.log("Password verified with WebCrypto exact match"),s=!0;break}const v=Math.min(p.length,n.length);if(v>=16&&p.substring(0,v)===n.substring(0,v)){console.log(`Password verified with WebCrypto partial match (length: ${v})`),s=!0;break}}}catch(o){console.error("WebCrypto verification attempt failed:",o)}if(!s){console.log("Trying verification with standard deriveKey function");const o=await ko(e,t),i=[o.hash,o.key];for(const l of i){if(l===n){console.log("Password verified with standard deriveKey exact match"),s=!0;break}const c=Math.min(l.length,n.length);if(c>=16&&l.substring(0,c)===n.substring(0,c)){console.log(`Password verified with standard deriveKey partial match (length: ${c})`),s=!0;break}}}return console.log(`Final password verification result: ${s}`),s}catch(r){return console.error("Error verifying password:",r),!1}}async function S5(e,t,n){if(console.log("Decrypting private key..."),wr())return console.log("Using fallback directly for private key decryption based on previous operations"),Gh(e,t,n);const r=await hs();if(!r)throw rt("private_key_decrypt"),new Error("WASM module not initialized");try{const{key:s}=await ko(t,n);console.log("[WASM] Decrypting private key using WASM implementation");try{const o=typeof s=="string"?s:s.key||s,i=r.decrypt_private_key(e,o);return console.log("Private key decrypted successfully using WASM"),i}catch(o){return console.error("WASM decrypt_private_key failed:",o),console.warn("Falling back to WebCrypto API for private key decryption"),rt("private_key_decrypt"),Gh(e,t,n)}}catch(s){return console.error("Error decrypting private key with WASM:",s),console.warn("Falling back to WebCrypto API for private key decryption"),rt("private_key_decrypt"),Gh(e,t,n)}}async function Gh(e,t,n){try{const r=await ko(t,n);let s;typeof r.key=="string"?s=r.key:typeof r.key=="object"&&r.key!==null&&"key"in r.key?s=r.key.key:s=String(r.key),console.log("Key derived using WebCrypto fallback");try{const o=Fc(s),i=Fc(e),l=new Uint8Array(i.slice(0,12)),c=new Uint8Array(i.slice(12)),u=await window.crypto.subtle.importKey("raw",o.slice(0,32),{name:"AES-GCM"},!1,["decrypt"]),d=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l},u,c),m=new Uint8Array(d);return console.log("Private key decrypted successfully using WebCrypto fallback"),m}catch(o){throw console.error("WebCrypto decryption failed:",o),new Error("Failed to decrypt private key with WebCrypto")}}catch(r){throw console.error("Fallback decryption of private key also failed:",r),new Error("Failed to decrypt private key using both WASM and Web Crypto API")}}async function Iv(e){console.log("Generating master keys...");const t=await hs();if(!t)throw new Error("WASM module not initialized");try{const{key:n,salt:r}=await t.derive_key(e,null),s=await $m(),o=await cs(s,n),i=wr();return{rootKeyHash:n,encryptedStorageKey:o,salt:r,encryptionMethod:i?"webcrypto":"wasm",encryptionVersion:1,lastUpdated:Date.now()}}catch(n){throw console.error("Error generating master keys:",n),n}}async function Ef(e,t){console.log("Decrypting storage key..."),mt(),e.encryptionMethod&&(console.log(`Using stored encryption method: ${e.encryptionMethod}`),e.encryptionMethod==="webcrypto"?(console.log("Setting WebCrypto mode based on master keys preference"),rt("decrypt"),rt("derive_key")):console.log("Setting WASM mode based on master keys preference"),localStorage.getItem("session_email")&&(localStorage.setItem("encryption_method_in_use",e.encryptionMethod),localStorage.setItem("user_encryption_method",e.encryptionMethod)));const n=await hs();if(!n)throw rt("derive_key"),new Error("WASM module not initialized");try{const{key:r}=await n.derive_key(t,e.salt);return await Io(e.encryptedStorageKey,r)}catch(r){throw console.error("Error decrypting storage key:",r),rt("derive_key"),new Error("Incorrect password or corrupted keys")}}async function vj(e,t){console.log("Initializing user vault...");try{const n=await Iv(e),r=await Ef(n,e),s=await $m(),o=await cs(s,r),i={id:"metadata",name:"Metadata",type:"metadata",createdAt:Date.now(),updatedAt:Date.now()},l=await cs(JSON.stringify(i),s),c={id:"metadata",encryptedKey:o,encryptedMetadata:l};if(!t)return console.log("No email provided for user vault initialization - skipping master keys storage"),console.log("Master keys will be properly saved when email is available"),n.rootKeyHash;const u=`master_keys_${t.replace(/[^a-zA-Z0-9]/g,"_")}`;return console.log(`Storing master keys with user-specific ID: ${u}`),await rs("masterKeys",u,{...n,lastUpdated:Date.now()}),await rs("vaults",c),n.rootKeyHash}catch(n){throw console.error("Error initializing user vault:",n),n}}async function xj(e,t,n,r){console.log(`Creating ${t} vault...`);try{const s=r||`${t}_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,o=await $m(),l=!wr()?"wasm":"webcrypto";console.log(`Creating vault using ${l} encryption`);const c=await cs(o,n),u={id:s,name:e,type:t,createdAt:Date.now(),updatedAt:Date.now()},d=await cs(JSON.stringify(u),o),m={id:s,encryptedKey:c,encryptedMetadata:d,encryptionMethod:l,version:1};return console.log(`Vault created with encryptionMethod: ${l}`),await rs("vaults",m),m}catch(s){throw console.error(`Error creating ${t} vault:`,s),s}}async function wj(e,t){try{console.log(`Decrypting vault key for ${e.id}...`),e.encryptionMethod?(console.log(`Using specified encryption method: ${e.encryptionMethod}`),e.encryptionMethod==="wasm"&&wr()?(console.log("Temporarily disabling WebCrypto fallback for WASM-encrypted vault"),mt()):e.encryptionMethod==="webcrypto"&&!wr()&&(console.log("Forcing WebCrypto for vault encrypted with WebCrypto"),rt("decrypt"))):console.log("No encryption method specified for vault, using current default");const n=await Io(e.encryptedKey,t);return e.encryptionMethod&&mt(),n}catch(n){throw console.error("Error decrypting vault key:",n),mt(),new Error(`Failed to decrypt vault key: ${n instanceof Error?n.message:String(n)}`)}}async function $g(e,t){try{console.log(`Getting metadata for vault ${e.id}...`),e.encryptionMethod&&(console.log(`Using specified encryption method for metadata: ${e.encryptionMethod}`),e.encryptionMethod==="wasm"&&wr()?(console.log("Temporarily disabling WebCrypto fallback for WASM-encrypted metadata"),mt()):e.encryptionMethod==="webcrypto"&&!wr()&&(console.log("Forcing WebCrypto for metadata encrypted with WebCrypto"),rt("decrypt")));try{const n=await Io(e.encryptedMetadata,t);return e.encryptionMethod&&mt(),JSON.parse(n)}catch(n){throw console.error("Error decrypting vault metadata:",n),e.encryptionMethod&&mt(),n}}catch(n){throw console.error(`Error getting metadata for vault ${e.id}:`,n),mt(),new Error(`Failed to decrypt vault metadata: ${n instanceof Error?n.message:String(n)}`)}}async function _j(e,t,n,r,s,o={},i){var l;console.log(`Adding ${n} item to vault ${e}...`);try{const c=`${n}_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;let u=localStorage.getItem("encryption_method_in_use")||localStorage.getItem(`vault_${e}_encryption_method`)||"webcrypto";const d=localStorage.getItem("session_email");if(d){const{getSanitizedEmail:h}=await oe(async()=>{const{getSanitizedEmail:g}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:g}},void 0),x=h(d),y=localStorage.getItem(`user_${x}_encryption_method`);y&&(u=y,console.log(`Using user-specific encryption method: ${u} for item`))}console.log(`Using encryption method: ${u} for new item ${c}`);const m={name:t,type:n,...o,encryptionMethod:u,searchTerms:[t.toLowerCase()]};o.description&&((l=m.searchTerms)==null||l.push(o.description.toLowerCase())),o.tags&&o.tags.forEach(h=>{var x;return(x=m.searchTerms)==null?void 0:x.push(h.toLowerCase())}),localStorage.setItem("last_encryption_method",u),localStorage.setItem(`item_${c}_encryption_method`,u);let f,p;console.log(`Encrypting item ${c} with ${u} method`),f=await cs(JSON.stringify(m),s),p=await cs(JSON.stringify(r),s);const v={id:c,vaultId:e,encryptedMetadata:f,encryptedData:p,version:1,createdAt:Date.now(),updatedAt:Date.now(),encryptionMethod:u};return await rs("items",v),v}catch(c){throw console.error(`Error adding ${n} item to vault:`,c),c}}async function Tv(e,t,n){console.log(`Getting data from vaults with ID ${e}...`);try{console.log("Initializing local database..."),console.log(`Reading item with ID ${e} from vaults...`);const r=await ks("vaults",e);r&&console.log(`Found item with ID ${e} in vaults`);let s;const o=localStorage.getItem("session_email");if(o){const{getSanitizedEmail:l}=await oe(async()=>{const{getSanitizedEmail:d}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:d}},void 0),c=l(o),u=localStorage.getItem(`encryption_pref_${c}`);u&&(s=u,console.log(`Using user-specific encryption preference: ${s} for items in vault ${e}`))}if(s||(n?(s=n,console.log(`Using specified encryption method: ${s}`)):r!=null&&r.encryptionMethod&&(s=r.encryptionMethod,console.log(`Using parent vault encryption method: ${s} for items`))),s&&(localStorage.setItem("encryption_method_in_use",s),localStorage.setItem(`vault_${e}_encryption_method`,s),o)){const{getSanitizedEmail:l}=await oe(async()=>{const{getSanitizedEmail:u}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:u}},void 0),c=l(o);localStorage.setItem(`user_${c}_encryption_method`,s)}const i=await Cv(e);console.log(`Found ${i.length} items for vault ${e}`);try{const l=[];let c=0,u=0,d=0;const m={};for(const p of i){let v=!1;const h=[{name:s||"auto",setFallback:s==="webcrypto"},{name:"alternate",setFallback:s!=="webcrypto"},{name:"webcrypto-forced",setFallback:!0},{name:"wasm-forced",setFallback:!1},{name:"pure-webcrypto",setFallback:!0,reset:!0}];for(const x of h){if(v)break;try{x.reset&&mt(),x.setFallback?rt("decrypt"):x.name!=="auto"&&mt(),x.name!=="auto"&&x.name!=="alternate"&&console.log(`Trying ${x.name} strategy for item ${p.id}...`);const y=p.encryptionMethod||localStorage.getItem(`item_${p.id}_encryption_method`);y&&y!==x.name&&x.name!=="auto"&&x.name!=="alternate"&&console.log(`Item ${p.id} has explicit method ${y}, but trying ${x.name}`),y==="webcrypto"&&rt("decrypt");const g=await Io(p.encryptedMetadata,t);let _;try{if(_=JSON.parse(g),_.type==="credential"||p.id.startsWith("credential_")||p.id.startsWith("password_")){console.log(`Password item detected: ${p.id}, type: ${_.type}`),_.encryptionMethod&&localStorage.setItem("password_item_encryption_method",_.encryptionMethod);const A=localStorage.getItem("password_item_encryption_method");A&&(console.log(`Using password-specific encryption method: ${A}`),A==="webcrypto"?rt("decrypt"):mt())}_.encryptionMethod&&_.encryptionMethod!==x.name&&(console.log(`Using metadata-embedded encryption method: ${_.encryptionMethod} for data decryption`),_.encryptionMethod==="webcrypto"?rt("decrypt"):mt())}catch(E){throw console.error(`Failed to parse metadata for item ${p.id}:`,E),new Error(`Invalid metadata format for item ${p.id}`)}const S=await Io(p.encryptedData,t);l.push({id:p.id,metadata:_,data:JSON.parse(S)}),y!==x.name&&x.name!=="auto"&&x.name!=="alternate"&&localStorage.setItem(`item_${p.id}_encryption_method`,x.name),x.name==="auto"||x.name===s?c++:u++,m[p.id]=x.name,v=!0}catch{x.name!=="auto"&&x.name!=="alternate"&&console.warn(`Strategy ${x.name} failed for item ${p.id}`),x===h[h.length-1]&&(console.error(`All decryption strategies failed for item ${p.id}`),d++)}}}console.log(`Successfully decrypted ${c+u} of ${i.length} items (${c} standard, ${u} fallback, ${d} failed)`);const f=l;return console.log(`Successfully decrypted ${f.length} of ${i.length} items`),n&&mt(),f}catch(l){throw console.error("Error during item decryption batch operation:",l),n&&mt(),l}}catch(r){throw console.error(`Error getting items for vault ${e}:`,r),mt(),r}}async function Sj(e,t){console.log(`Searching for "${e}" across vaults...`);const n=e.toLowerCase(),r=[];try{for(const{vault:s,key:o}of t)try{const l=(await Tv(s.id,o,s.encryptionMethod)).filter(c=>{var u;return(u=c.metadata.searchTerms)==null?void 0:u.some(d=>d.includes(n))});l.length>0&&r.push({vaultId:s.id,items:l})}catch(i){console.error(`Error searching vault ${s.id}:`,i)}return r}catch(s){throw console.error(`Error searching for "${e}":`,s),s}finally{mt()}}const tt=Object.freeze(Object.defineProperty({__proto__:null,addItemToVault:_j,clearSecurityContext:Lc,createVault:xj,decryptData:Io,decryptDataWithWebCrypto:hj,decryptPrivateKey:S5,decryptStorageKey:Ef,decryptVaultKey:wj,deriveKey:ko,deriveLoginProof:w5,encryptData:cs,flushPotentiallyCompromisedData:g5,generateMasterKeys:Iv,generateRandomKey:$m,generateUserKeys:pj,getEncryptionPreference:v5,getStoredEmail:pa,getUserKeys:mo,getUserSalt:yj,getVaultItems:Tv,getVaultMetadata:$g,hasExtension:Eu,initWasm:hs,initializeUserVault:vj,isValidUserKeys:an,markUsingFallback:rt,removeAllPasswordsFromStorage:Ji,resetFallbackState:mt,saveEncryptionPreference:y5,saveUserKeys:Vc,searchVaultItems:Sj,shouldUseFallback:wr,userExistsLocally:gj,vault_decrypt_data:Om,vault_encrypt_data:jv,verifyPassword:_5},Symbol.toStringTag,{value:"Module"}));async function Zh(e,t){const n=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("mata_active_user");if(!n)return console.error("🚨 SECURITY ALERT: No user context available for vault decryption"),console.error("🚨 SECURITY ACTION: Decryption attempt blocked"),null;const r=n.includes("@")?n.toLowerCase().replace(/[@.]/g,"_"):n.toLowerCase();if(!Yo(e.id,n)){console.error(`🚨 SECURITY ALERT: Attempted decryption of vault ${e.id} blocked`),console.error(`🚨 SECURITY REASON: Vault does not belong to current user ${n}`);const s={type:"blocked_decryption_attempt",vaultId:e.id,timestamp:new Date().toISOString(),userEmail:n,sanitizedEmail:r};return localStorage.setItem(`security_event_blocked_decryption_${Date.now()}`,JSON.stringify(s)),null}console.log(`✅ SECURITY: Vault ownership verified, proceeding with decryption of ${e.id}`);try{return await wj(e,t)}catch(s){return console.error(`Error decrypting vault ${e.id}:`,s),null}}function Yo(e,t){const n={vaultId:e,requestedBy:t,timestamp:new Date().toISOString(),result:!1,reason:"",activeUser:localStorage.getItem("mata_active_user")||"not_set",vaultNamespace:localStorage.getItem("user_vault_namespace")||"not_set"};if(!e||!t)return n.reason="Missing required inputs",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),console.error("🚫 SECURITY: Missing required inputs for vault access verification"),!1;if(console.log(`🔒 SECURITY: Verifying vault ownership for ${e} by user ${t}`),e==="metadata"||e==="system"||e==="shared_vault")return n.result=!0,n.reason="System vault - always allowed",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),console.log(`✅ System vault access allowed: ${e}`),!0;const r=localStorage.getItem("mata_active_user"),o=t.toLowerCase().replace(/[@.]/g,"_");if(r)if(r!==o){console.error(`🚨 SECURITY ALERT: User context mismatch when accessing vault ${e}`),console.error(`🚨 Current active user: ${r}, Requested: ${o}`),n.result=!1,n.reason="User context mismatch",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n));const u={type:"cross_user_access_attempt",vaultId:e,requestedUser:t,sanitizedInputEmail:o,activeUser:r,timestamp:new Date().toISOString()};return localStorage.setItem(`security_alert_cross_user_${Date.now()}`,JSON.stringify(u)),!1}else console.log(`✅ User context verified: ${r} = ${o}`);else console.log(`⚠️ Setting mata_active_user to ${o} (no previous context)`),localStorage.setItem("mata_active_user",o);let i=localStorage.getItem("user_vault_namespace");if(i||(i=`user_${o}_`,localStorage.setItem("user_vault_namespace",i),console.log(`⚠️ Created new user namespace: ${i}`)),e.toLowerCase().startsWith(i.toLowerCase()))return console.log(`✅ Direct namespace match: ${e} starts with ${i}`),n.result=!0,n.reason="Direct namespace match",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),!0;const l=[`${o}_vault`,`vault_${o}`,`bank_accounts_${o}`,`contacts_${o}`,`payment_history_${o}`,`payments_${o}`,`passwords_${o}`];for(const u of l)if(e.toLowerCase()===u.toLowerCase())return console.log(`✅ Exact vault pattern match: ${e} exactly matches ${u}`),n.result=!0,n.reason=`Exact pattern match: ${u}`,localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),!0;for(const u of l)if(e.toLowerCase().startsWith(u.toLowerCase()))return console.log(`✅ Vault prefix match: ${e} starts with ${u}`),n.result=!0,n.reason=`Prefix pattern match: ${u}`,localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),!0;if(e.startsWith("shared_"))return console.log(`✅ Shared vault access allowed: ${e}`),n.result=!0,n.reason="Shared vault",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n)),!0;console.error(`🚫 VAULT ACCESS DENIED: ${e} doesn't match any authorized pattern for ${t}`),console.error(`🚫 User: ${o}, Namespace: ${i}`),n.result=!1,n.reason="No pattern match found",localStorage.setItem(`vault_access_audit_${Date.now()}`,JSON.stringify(n));const c={type:"vault_access_denied",vaultId:e,requestedBy:t,sanitizedEmail:o,namespace:i,activeUser:r||"not_set",timestamp:new Date().toISOString(),checkedPatterns:l,allStoredKeys:Object.keys(localStorage).filter(u=>u.includes("vault"))};return localStorage.setItem(`security_alert_vault_denied_${Date.now()}`,JSON.stringify(c)),!1}class bj{constructor(){this.storageKey=null,this.vaultKeys=new Map,this.initialized=!1,this.currentUserContext=null}isInitialized(){return this.initialized}async initialize(){if(this.initialized)return!0;try{return await $r(),this.initialized=!0,!0}catch(t){return console.error("Failed to initialize VaultService:",t),!1}}async isVaultInitialized(){try{const t=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(t){const n=`master_keys_${t.replace(/[^a-zA-Z0-9]/g,"_")}`;if(await ks("masterKeys",n))return!0}return console.warn("No email available for master keys lookup - cannot proceed"),!1}catch(t){return console.error("Error checking vault initialization:",t),!1}}async setupVault(t,n,r=!0,s=!0){try{console.log(`Setting up vault for user ${n||localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||"unknown"}`),n||(n=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||void 0),n||console.warn("No email available for vault setup - cannot create email-specific vault");const o=await vj(t,n);if(await this.unlockVault(t,!1),r&&n&&this.storageKey)try{const{getPaymentMethodVaultId:i}=await oe(async()=>{const{getPaymentMethodVaultId:c}=await import("./paymentMethodVaultService-BSfQQN5M.js");return{getPaymentMethodVaultId:c}},[]),l=i(n);console.log("Creating payment vault with ID:",l),await this.createNewVault("Payment Cards","payments",l),localStorage.setItem("user_vault_namespace",l),localStorage.setItem("payment_vault_id",l),console.log("Payment vault created:",l)}catch(i){console.error("Error creating payment vault during setup:",i)}return s?(console.log("Removing password from storage after vault setup is complete"),localStorage.removeItem("last_auth_password"),localStorage.removeItem("last_successful_password")):(console.log("Temporarily storing password for subsequent operations"),localStorage.setItem("last_successful_password",t)),o}catch(o){throw console.error("Error setting up vault:",o),o}}async unlockVault(t,n=!1,r){try{console.log("Attempting to unlock vault...");const s=localStorage.getItem("skip_password_prompt")==="true",o=parseInt(localStorage.getItem("vault_creation_time")||"0",10),i=o>0&&Date.now()-o<5*60*1e3;s&&i&&console.log("Skip password prompt flag detected - this is a new registration");let l=t,c=r||localStorage.getItem("session_email")||localStorage.getItem("current_user_email"),u=!1;if(c){console.log(`🔒 Setting database user context to: ${c}`),pl(c),this.currentUserContext=c;const h=c.replace(/[@.]/g,"_");localStorage.setItem("mata_active_user",h)}else console.warn("🚨 No email available for database context - vault isolation may be compromised");if(!l){console.log("No password explicitly provided, checking local storage...");const h=localStorage.getItem("initial_vault_password");if(h)console.log("Found initial vault password from registration"),l=h,u=!0;else{const x=localStorage.getItem("last_auth_password");x&&(console.log("Found password in local storage from recent login"),l=x,u=!0)}}if(s&&i&&!l&&localStorage.getItem("vault_unlocked")==="true"&&localStorage.getItem("storage_key_verified")==="true"&&(console.log("New account with vault already unlocked - skipping password verification"),this.storageKey&&this.vaultKeys.size>0))return console.log("Vault is already properly unlocked from initial setup - returning success"),!0;if(!l)return console.warn("No password available - vault cannot be unlocked"),!1;console.log("Attempting to unlock vault with password..."),console.log("Attempting vault unlock..."),await fj();let d=null,m="";const f=c;if(f){console.log(`Trying to unlock vault for user: ${f}`),m=`master_keys_${f.replace(/[^a-zA-Z0-9]/g,"_")}`;try{d=await ks(kt,m),d&&console.log(`Found user-specific master keys for ${f}`)}catch(h){console.warn(`Error retrieving master keys for ${f}:`,h)}}if(d||console.log("User-specific master keys not found, not falling back to generic keys"),!d&&f){console.log("Trying localStorage fallback for master keys");const h=`master_keys_${f.replace(/[^a-zA-Z0-9]/g,"_")}`,x=localStorage.getItem(h);if(x)try{d=JSON.parse(x),console.log("Successfully retrieved master keys from localStorage");try{console.log("Migrating master keys from localStorage to IndexedDB"),await rs(kt,m,d),console.log("Migration successful")}catch(y){console.warn("Failed to migrate keys from localStorage to IndexedDB:",y)}}catch(y){console.warn("Error parsing master keys from localStorage:",y)}}if(!d)return console.warn("No master keys found, vault cannot be fully unlocked"),!1;try{console.log("Verifying password using hash comparison...");const h=await ko(l,d.salt);h.hash!==d.rootKeyHash?(console.warn("Password verification failed - hash mismatch"),h.hash.length!==d.rootKeyHash.length?(console.log("Hash length mismatch, possible format change - trying alternatives"),d.rootKeyHash.length<h.hash.length?h.hash.substring(0,d.rootKeyHash.length)===d.rootKeyHash?console.log("Password verified using hash prefix comparison"):console.warn("Password verification failed with hash prefix comparison"):console.warn("Stored hash is longer than derived hash - format mismatch")):console.warn("Hash length match but content mismatch - possible encryption method change")):console.log("Password verified via hash comparison")}catch(h){console.warn("Error during password hash verification:",h)}console.log("Attempting storage key decryption with all available methods...");let p=!1;try{localStorage.removeItem("current_encryption_method"),localStorage.removeItem("encryption_method_in_use"),localStorage.removeItem("user_encryption_method"),Object.keys(localStorage).forEach(h=>{(h.includes("_encryption_method")||h.includes("encryption_")||h.includes("method_"))&&(console.log("Cleaning up encryption method preference:",h),localStorage.removeItem(h))}),Object.keys(localStorage).forEach(h=>{(h.startsWith("vault_user_")&&h.includes("_encryption_method")||h.includes("_encryption_method")||h.includes("encryption_")||h.includes("method_"))&&(console.log("Cleaning up storage encryption preference:",h),localStorage.removeItem(h))})}catch(h){console.warn("Non-critical: Could not clean up all encryption preferences:",h)}const v=f;v&&localStorage.setItem("current_vault_user",v);try{console.log("ATTEMPT 1: Trying storage key decryption with WASM/Rust..."),mt(),localStorage.setItem("current_encryption_method","standard"),this.storageKey=await Ef(d,l),this.storageKey&&(console.log("SUCCESS! Decrypted storage key with WASM/Rust"),p=!0,v&&localStorage.setItem("successful_method_for_"+v.replace(/[^a-zA-Z0-9]/g,"_"),"wasm"))}catch(h){console.warn("WASM decryption attempt failed:",h)}if(!p)try{console.log("ATTEMPT 2: WASM failed, trying storage key decryption with WebCrypto..."),mt(),rt("decrypt"),localStorage.setItem("current_encryption_method","webcrypto"),this.storageKey=await Ef(d,l),this.storageKey&&(console.log("SUCCESS! Decrypted storage key with WebCrypto"),p=!0,v&&localStorage.setItem("successful_method_for_"+v.replace(/[^a-zA-Z0-9]/g,"_"),"webcrypto"))}catch(h){console.warn("WebCrypto decryption attempt failed:",h)}if(!p)return console.error("All storage key decryption methods failed"),this.storageKey=null,!1;this.vaultKeys.clear();try{const{getSanitizedEmail:h}=await oe(async()=>{const{getSanitizedEmail:S}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:S}},void 0);c||(console.error("No valid email provided for vault filtering"),c=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("auth_email")||"unknown_user@example.com");const x=c||"unknown_user@example.com",y=h(x),g=await Ka("vaults"),_=g.filter(S=>{const E=Yo(S.id,x);return console.log(E?`Vault isolation: Including vault ${S.id} - belongs to ${x}`:`Vault isolation: Skipping vault ${S.id} - does not belong to ${x}`),E});console.log(`Found ${g.length} total vaults, filtering to ${_.length} vaults for current user ${c}`);for(const S of _)try{if(mt(),!this.storageKey)throw new Error("Storage key is null, cannot decrypt vault key");let E=!1,A=null;try{if(mt(),!this.storageKey)throw new Error("Storage key is not available for vault decryption");if(A=await Zh(S,this.storageKey),A===null){console.error(`🚨 SECURITY ALERT: Access denied to vault ${S.id}`);continue}E=!0}catch(I){console.warn(`Standard vault key decryption failed for ${S.id}:`,I)}if(!E)try{if(mt(),rt("decrypt"),!this.storageKey)throw new Error("Storage key is not available for WebCrypto vault decryption");if(A=await Zh(S,this.storageKey),A===null){console.error(`🚨 SECURITY ALERT: Access denied to vault ${S.id} (WebCrypto attempt)`);continue}E=!0}catch(I){console.warn(`WebCrypto vault key decryption failed for ${S.id}:`,I)}E&&A?(this.vaultKeys.set(S.id,A),console.log(`Successfully decrypted vault: ${S.id}`)):console.error(`Failed to decrypt vault ${S.id} after multiple attempts`)}catch(E){console.error(`Failed to decrypt vault ${S.id}:`,E)}}catch(h){console.error("Error retrieving or decrypting vaults:",h)}if(this.storageKey&&l){localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Vault session markers set - vault successfully unlocked");const h=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||c;if(h){const y=Date.now().toString(),g=["password","contacts","payment_methods","payment_history","bank_accounts"];console.log("Setting vault-specific unlock markers for all vault types"),g.forEach(_=>{localStorage.setItem(`${_}_vault_unlocked`,"true"),localStorage.setItem(`${_}_vault_unlock_time`,y)}),localStorage.setItem("auth_email",h),localStorage.setItem("auth_timestamp",y),localStorage.setItem("storage_key_verified","true")}const x=localStorage.getItem("initial_vault_password")===l||localStorage.getItem("initial_vault_password")===l;n||x?(console.log("Removing password from storage after successful vault unlock"),localStorage.removeItem("last_auth_password"),localStorage.removeItem("last_successful_password"),localStorage.removeItem("initial_vault_password")):(localStorage.setItem("last_successful_password",l),console.log("Temporarily cached vault password for immediate operations"))}return this.storageKey!==null}catch(s){return console.error("Error unlocking vault:",s),this.storageKey=null,this.vaultKeys.clear(),localStorage.removeItem("vault_unlocked"),localStorage.removeItem("vault_unlocked_at"),console.log("Cleared vault markers due to unlock failure"),!1}}isUnlocked(){console.log("Checking if vault is unlocked...");const t=parseInt(localStorage.getItem("vault_creation_time")||"0",10),n=parseInt(localStorage.getItem("vault_creation_time")||"0",10),r=Math.max(t,n),s=r>0&&Date.now()-r<5*60*1e3,o=localStorage.getItem("skip_password_prompt")==="true";if(s&&o&&(console.log("Recently created account detected, skipping some unlock checks"),localStorage.getItem("vault_unlocked")==="true"))return console.log("Vault is considered unlocked for new account"),!0;if(this.storageKey===null)return console.log("Storage key is null, vault is not unlocked"),!1;if(localStorage.getItem("vault_unlocked")!=="true")return console.warn("Security check: vault_unlocked marker not found in localStorage"),!1;const l=localStorage.getItem("vault_unlocked_at");if(l){const u=parseInt(l,10);if(Date.now()-u>864e5)return console.warn("Security check: vault session has expired"),localStorage.removeItem("vault_unlocked"),localStorage.removeItem("vault_unlocked_at"),!1}else if(s&&localStorage.getItem("vault_creation_time"))console.log("Using vault_creation_time as fallback for new account");else return console.warn("Security check: vault_unlocked_at timestamp not found"),!1;return localStorage.getItem("session_email")||localStorage.getItem("current_user_email")?(console.log("All checks passed, vault is properly unlocked"),!0):(console.warn("Security check: no session_email found in localStorage for unlocked vault"),!1)}getStorageKey(){return this.storageKey}lockVault(){const t=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");console.log(`Locking vault for user ${t||"unknown"}...`),this.storageKey=null,this.vaultKeys.clear(),localStorage.removeItem("vault_unlocked"),localStorage.removeItem("vault_unlocked_at"),localStorage.removeItem("current_vault_id"),localStorage.removeItem("last_auth_password"),localStorage.removeItem("password_hash_check"),localStorage.removeItem("last_vault_access"),localStorage.removeItem("last_vault_operation"),console.log("Vault locked and all markers cleared"),localStorage.setItem("vault_locked_at",Date.now().toString()),console.log(`Vault locked and all markers cleared for ${t||"unknown"}`)}resetState(){console.log("🔒 SECURITY: Performing complete vault service state reset");try{const s=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("mata_active_user"),o=s?s.replace(/[@.]/g,"_"):"unknown",i=localStorage.getItem("encryption_method_preference")||"standard";console.log(`🔒 SECURITY: Resetting state for user: ${s||"unknown"}`),console.log(`🔒 SECURITY: Current encryption method: ${i}`),s&&(console.log(`🔒 SECURITY: Closing database connection for user: ${s}`),gl());const l={type:"vault_state_reset",timestamp:new Date().toISOString(),user:s||"unknown",sanitizedUser:o,vaultKeysCount:this.vaultKeys.size,vaultIds:Array.from(this.vaultKeys.keys()),reason:"user_logout_or_context_switch"};if(localStorage.setItem(`security_event_reset_${Date.now()}`,JSON.stringify(l)),this.storageKey=null,this.vaultKeys&&this.vaultKeys instanceof Map){if(console.log(`🔒 SECURITY: Clearing ${this.vaultKeys.size} stored vault keys`),this.vaultKeys.size>0){console.log("🔒 SECURITY: Removing vault keys for:");for(const c of this.vaultKeys.keys()){const u=localStorage.getItem("mata_active_user")||"",d=localStorage.getItem("user_vault_namespace")||"",m=u&&c.includes(u)||d&&c.includes(d);console.log(`  - ${c} ${m?"(current user)":"(OTHER USER)"}`)}}this.vaultKeys.clear(),console.log("RESET: Vault keys map cleared")}else this.vaultKeys=new Map,console.log("RESET: Vault keys map recreated");this.initialized=!1;try{oe(()=>Promise.resolve().then(()=>tt),void 0).then(c=>{c&&typeof c.resetFallbackState=="function"&&(c.resetFallbackState(),console.log("RESET: Crypto state reset complete (async)"))}).catch(c=>{console.error("RESET: Failed to reset crypto state:",c)})}catch(c){console.error("RESET: Error importing crypto module:",c)}this._lastAccessedVaultId=null,this._cachedVaultMetadata=null,localStorage.setItem("last_vault_reset",Date.now().toString()),localStorage.setItem("last_reset_user",s||"unknown"),console.log("RESET: In-memory state reset complete")}catch(s){console.error("RESET: Error during vault service state reset:",s),this.storageKey=null,this.vaultKeys=new Map,this.initialized=!1}const t=["vault_unlocked","vault_unlocked_at","current_vault_id","last_vault_access","last_successful_vault_access","vault_user_id","last_vault_operation","last_vault_access_time","vault_context_authenticated","current_vault_context","encryption_method_in_use","user_encryption_method","crypto_operation_history","session_email","current_user_email","user_vault_namespace","session_vault_namespace","last_auth_password","auth_timestamp","password_hash_check","last_successful_password","contacts_vault_namespace","payments_vault_namespace","payment_history_vault_namespace","documents_vault_namespace"];for(const s of t)localStorage.getItem(s)&&(localStorage.removeItem(s),console.log(`RESET: Cleared critical localStorage key: ${s}`));const n=Object.keys(localStorage);for(const s of n)s==="language_preference"||s==="ui_theme"||s.startsWith("mata_keys_")||s.startsWith("mata_salt_")||localStorage.removeItem(s);const r=Object.keys(localStorage);for(const s of r)s==="language_preference"||s==="ui_theme"||s.startsWith("persist:")||s.startsWith("mata_keys_")||s.startsWith("mata_salt_")||(s.includes("session_")||s.includes("auth_")||s.includes("vault_"))&&localStorage.removeItem(s);console.log("RESET: All session data cleared for proper user isolation"),localStorage.removeItem("previous_session_email"),localStorage.removeItem("previous_auth_user_email"),localStorage.removeItem("current_vault_context"),localStorage.removeItem("auth_user_email"),localStorage.removeItem("last_successful_vault_access"),localStorage.removeItem("current_vault_user"),localStorage.removeItem("recent_vault_access"),console.log("RESET: Vault service state reset complete with enhanced security isolation"),localStorage.removeItem("use_webcrypto"),localStorage.removeItem("crypto_fallback_state"),console.log("RESET: All session identifiers cleared"),console.log("RESET: Vault service state reset complete")}async getVaults(t){if(!this.isUnlocked())throw new Error("Vault is locked");try{const n=t?t.toLowerCase():this.getCurrentUserEmail();console.log(`Getting vaults for user: ${n||"system only"}`),n&&localStorage.setItem("last_vault_access_user",n),localStorage.getItem("use_webcrypto")==="true"&&oe(()=>Promise.resolve().then(()=>tt),void 0).then(c=>{c.markUsingFallback("encrypt"),c.markUsingFallback("decrypt"),console.log("Using WebCrypto for consistent vault operations")}),n||console.warn("Unable to determine current user's email, vault isolation may be compromised"),console.log("Current user email:",n);const s=await Ka("vaults"),o=[];console.log(`Found ${s.length} total vaults in database`);const i=this.preFilterVaultsByOwnership(s,n);console.log(`Pre-filtered to ${i.length} potentially valid vaults for user ${n||"unknown"}`);const l=new Set;for(const c of i){if(l.has(c.id))continue;l.add(c.id);const u=this.vaultKeys.get(c.id);if(!u){console.log(`Skipping vault ${c.id} - no decryption key available`);continue}try{const d=await $g(c,u);this.verifyVaultAccess(c.id,d,n)?(o.push(d),console.log(`Including vault ${c.id} (${d.type}) for user ${n||"system"}`)):console.log(`Skipping vault ${c.id} - access verification failed`)}catch(d){console.error(`Failed to get metadata for vault ${c.id}:`,d)}}return console.log("Available vaults:",o.map(c=>({id:c.id,type:c.type}))),o}catch(n){throw console.error("Error getting vaults:",n),n}}getCurrentUserEmail(){console.log("🔒 getEmailContext: Retrieving current user email for vault operations");const t=localStorage.getItem("mata_active_user");if(this.currentUserContext){if(console.log(`🔒 getEmailContext: Using cached user context: ${this.currentUserContext}`),localStorage.setItem("current_user_email",this.currentUserContext),t&&this.currentUserContext.includes("@")){const s=this.currentUserContext.toLowerCase().replace(/[@.]/g,"_");t!==s&&(console.log(`🔒 getEmailContext: Updating mata_active_user to match context: ${s}`),localStorage.setItem("mata_active_user",s))}return this.currentUserContext}if(console.log("🔒 getEmailContext: Checking all email source variables..."),console.log(`🔒 getEmailContext: mata_active_user = ${t||"not set"}`),console.log(`🔒 getEmailContext: session_email = ${localStorage.getItem("session_email")||"not set"}`),console.log(`🔒 getEmailContext: current_user_email = ${localStorage.getItem("current_user_email")||"not set"}`),t){const s=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(s){const o=s.toLowerCase().replace(/[@.]/g,"_");o===t?(this.currentUserContext=s,console.log(`🔒 getEmailContext: Using raw email format from matched sanitized version: ${this.currentUserContext}`)):(console.error(`🚨 SECURITY ALERT: mata_active_user (${t}) doesn't match sanitized version of emails (${o})`),this.currentUserContext=t,console.log(`🔒 getEmailContext: Using sanitized email as fallback: ${this.currentUserContext}`))}else this.currentUserContext=t,console.log(`🔒 getEmailContext: Using sanitized email (no raw available): ${this.currentUserContext}`);if(localStorage.setItem("current_user_email",this.currentUserContext),localStorage.setItem("current_vault_user",this.currentUserContext),this.currentUserContext.includes("@")){const o=this.currentUserContext.toLowerCase().replace(/[@.]/g,"_");localStorage.setItem("user_vault_namespace",`user_${o}_`)}else localStorage.setItem("user_vault_namespace",`user_${this.currentUserContext}_`);return this.currentUserContext}const n=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("current_vault_user");if(n){this.currentUserContext=n,console.log(`🔒 getEmailContext: Using email from localStorage: ${this.currentUserContext}`);const s=n.toLowerCase().replace(/[@.]/g,"_");return localStorage.setItem("mata_active_user",s),localStorage.setItem("user_vault_namespace",`user_${s}_`),this.currentUserContext}const r=localStorage.getItem("last_email")||localStorage.getItem("last_login_email");return r?(this.currentUserContext=r,localStorage.setItem("user_vault_namespace",`user_${r}_`),this.currentUserContext):(console.warn("No user context found - vault access will be restricted to system vaults only"),null)}setUserContext(t){if(!t||typeof t!="string"){console.error("Invalid email provided to setUserContext:",t);return}console.log(`🔒 SECURITY: Setting user context to: ${t}`);const n=this.currentUserContext,r=t.toLowerCase(),s=r.replace(/[@.]/g,"_");let o="";if(n&&(o=n.toLowerCase().replace(/[@.]/g,"_")),n&&n.toLowerCase()!==r&&o!==s){console.log("🔒 SECURITY ALERT: User context switch detected"),console.log(`🔒 SECURITY: Previous user: ${n}`),console.log(`🔒 SECURITY: New user: ${t}`),this.resetVaultKeys(),this.storageKey=null;const c={type:"user_context_switch",timestamp:new Date().toISOString(),previousUser:n,newUser:t,keysCleared:!0};localStorage.setItem(`security_log_user_switch_${Date.now()}`,JSON.stringify(c)),console.log("🔒 SECURITY: Cleared all vault keys and reset storage key for user switch")}this.currentUserContext=r,localStorage.setItem("session_email",r),localStorage.setItem("current_user_email",r),localStorage.setItem("current_vault_user",r),localStorage.setItem("mata_active_user",s);const l=`user_${s}_`;localStorage.setItem("user_vault_namespace",l),localStorage.setItem("sanitized_user_email",s),localStorage.setItem("current_key_namespace",s),console.log(`✅ SECURITY: User context set to: ${r} (${s})`),console.log(`✅ SECURITY: Namespace set to: ${l}`)}resetVaultKeys(){const t=this.vaultKeys.size,n=Array.from(this.vaultKeys.keys());this.vaultKeys.clear(),console.log(`🔒 SECURITY: Cleared ${t} vault keys from memory during context switch`),t>0&&console.log("🔒 SECURITY: Removed access to vaults:",n);const r=Object.keys(localStorage).filter(o=>o.includes("encryption_")||o.includes("vault_key_")||o.includes("decryption_")||o.includes("_crypto_")||o.includes("_cipher_")||o.startsWith("key_")||o.includes("_fallback_")||o.includes("last_successful_"));for(const o of r)localStorage.removeItem(o);console.log(`🔒 SECURITY: Cleared ${r.length} crypto-related items from localStorage`);const s={type:"vault_keys_cleared",timestamp:new Date().toISOString(),keyCount:t,vaultIds:n,localStorageItemsCleared:r.length};localStorage.setItem(`security_log_key_reset_${Date.now()}`,JSON.stringify(s))}preFilterVaultsByOwnership(t,n){const s=t.filter(m=>m.id==="metadata"||m.id==="system"||m.id.startsWith("shared_"));if(!n)return console.log("🚫 SECURITY: No user email available, returning only system vaults"),s;const o=localStorage.getItem("mata_active_user"),l=n.toLowerCase().replace(/[@.]/g,"_");console.log(`🔐 SECURITY: Filtering vaults for user ${n} (sanitized: ${l})`),console.log(`🔐 SECURITY: Active user context: ${o||"not set"}`);const c=localStorage.getItem("user_vault_namespace")||`user_${l}_`;if(localStorage.getItem("user_vault_namespace")||(localStorage.setItem("user_vault_namespace",c),console.log(`🔐 SECURITY: Setting user namespace: ${c}`)),o&&l!==o){console.error(`🚨 SECURITY ALERT: User context mismatch between active user ${o} and provided email ${l}`),console.error("🚨 SECURITY ACTION: Updating storage to fix discrepancy"),localStorage.setItem("mata_active_user",l);const m=`security_alert_user_mismatch_${Date.now()}`;localStorage.setItem(m,JSON.stringify({provided:l,existing:o,timestamp:new Date().toISOString(),action:"updated_active_user"}))}console.log(`🔐 SECURITY: Looking for vaults matching user ${l} with namespace: ${c}`),this.clearNonUserVaultKeys(l);const u=t.filter(m=>{const f=m.id.toLowerCase();if(Yo(m.id,n))return console.log(`✅ SECURITY: Vault ${m.id} ownership verified with standard checks`),!0;const h=[m.id==="metadata",m.id==="system",f.startsWith(`user_${l}_`),f===`${l}_vault`,f===`vault_${l}`,f===`bank_accounts_${l}`,f===`contacts_${l}`,f===`payment_history_${l}`,f===`payments_${l}`,f===`passwords_${l}`,f.startsWith("shared_")].some(Boolean);return h&&console.log(`✅ SECURITY: Vault ${m.id} matched with strict pattern matching`),h});console.log(`🔐 SECURITY: Found ${s.length} system vaults`),console.log(`🔐 SECURITY: Found ${u.length} user-specific vaults`);const d=[...s];for(const m of u)d.some(f=>f.id===m.id)||d.push(m);return console.log(`🔐 SECURITY: Returning ${d.length} total vaults after filtering`),console.log("🔐 SECURITY: Vault IDs:",d.map(m=>m.id)),d}clearNonUserVaultKeys(t){if(!t)return;const n=this.vaultKeys.size,r=[];this.vaultKeys.forEach((s,o)=>{if(o==="metadata"||o==="system"||o.startsWith("shared_"))return;const i=o.toLowerCase();i.startsWith(`user_${t}_`)||i===`${t}_vault`||i===`vault_${t}`||i===`bank_accounts_${t}`||i===`contacts_${t}`||i===`payment_history_${t}`||i===`payments_${t}`||i===`passwords_${t}`||r.push(o)});for(const s of r)this.vaultKeys.delete(s);console.log(`🔐 SECURITY: Cleared ${r.length} of ${n} vault keys not belonging to user ${t}`),r.length>0&&console.log("🔐 SECURITY: Removed vault keys:",r)}verifyVaultAccess(t,n,r){return t==="metadata"||t==="system"?!0:r?Yo(t,r):!1}async createNewVault(t,n,r){if(!this.isUnlocked()||!this.storageKey)throw new Error("Vault is locked");try{console.log(`Creating new ${n} vault with name: ${t}`);const s=!wr();console.log(`Current encryption method: ${s?"wasm":"webcrypto"}`);const o=await xj(t,n,this.storageKey,r);if(console.log(`Vault created with ID: ${o.id}, encryption method: ${o.encryptionMethod||"unspecified"}`),!this.storageKey)throw new Error("Storage key is not available for vault creation");const i=await Zh(o,this.storageKey);if(!i)throw new Error(`Failed to decrypt vault key for vault ${o.id}`);return this.vaultKeys.set(o.id,i),await $g(o,i)}catch(s){throw console.error(`Error creating ${n} vault:`,s),s}}async addItem(t,n,r,s,o={},i){if(!this.isUnlocked())throw new Error("Vault is locked");const l=this.getCurrentUserEmail();if(t!=="metadata"&&t!=="system"&&!t.startsWith("shared_")){if(l){if(!Yo(t,l))throw console.warn(`Security check: Cannot add item to vault ${t} - it does not belong to user ${l}`),new Error("Security error: Cannot add item to vault - permission denied")}else if(!t.startsWith("system_"))throw console.warn(`Security check: Cannot add item to non-system vault ${t} without user identification`),new Error("Security error: Cannot add item to vault - no user context")}const c=this.vaultKeys.get(t);if(!c)throw new Error(`Vault key for ${t} not found`);try{let u=i;if(!u){try{const m=await ks("vaults",t);m&&m.encryptionMethod&&(u=m.encryptionMethod,console.log(`Using vault's encryption method: ${u}`))}catch(m){console.warn("Error retrieving vault for encryption method:",m)}if(!u&&l){const m=l.replace(/[@.]/g,"_"),f=localStorage.getItem(`encryption_pref_${m}`);f&&(u=f,console.log(`Using user's preferred encryption method: ${u}`))}if(!u){const m=localStorage.getItem("last_encryption_method_used");m&&(u=m,console.log(`Using last successful encryption method: ${u}`))}u||(u="webcrypto",console.log("No encryption method specified, defaulting to WebCrypto"))}localStorage.setItem("last_encryption_method_used",u),localStorage.setItem(`vault_${t}_encryption_method`,u),(r==="credential"||n.startsWith("credential_")||n.startsWith("password_"))&&localStorage.setItem("password_item_encryption_method",u);const d={...o,encryptionMethod:u};return console.log(`Adding item to vault ${t}:
        - Item ID/Name: ${n}
        - Type: ${r}
        - Encryption: ${u}
        - User: ${l||"unknown"}`),await _j(t,n,r,s,c,d,u)}catch(u){throw console.error(`Error adding item to vault ${t}:`,u),u}}async getItems(t){if(!this.isUnlocked())throw console.error(`🔐 SECURITY: Cannot get items from vault ${t} - vault is locked`),new Error("Vault is locked");localStorage.setItem("last_vault_access",t),localStorage.setItem("last_vault_operation","getItems");const r=Date.now().toString();localStorage.setItem("last_vault_access_time",r);const s=this.getCurrentUserEmail();console.log(`🔐 SECURITY: Getting items from vault ${t} for user ${s||"unknown"}`);let o="";if(s){o=s.toLowerCase().replace(/[@.]/g,"_");const l=localStorage.getItem("mata_active_user");if(l&&l!==o){console.error(`🚨 SECURITY ALERT: User context mismatch when accessing vault ${t}`),console.error(`🚨 Active user: ${l}, Current request: ${o}`),localStorage.setItem("mata_active_user",o),console.log(`🔐 SECURITY: Updated mata_active_user to ${o} for consistency`);const c={type:"user_context_mismatch",vault:t,previousUser:l,currentUser:o,timestamp:new Date().toISOString()};localStorage.setItem(`security_alert_${Date.now()}`,JSON.stringify(c))}}if(t!=="metadata"&&t!=="system"&&!t.startsWith("shared_")){if(s)if(Yo(t,s))console.log(`✅ SECURITY: Vault ${t} ownership verified for user ${s}`);else{console.log("🔐 SECURITY: Looking for vault with namespace:",s?`user_${o}_`:"unknown"),console.error(`🚨 SECURITY ALERT: Vault ${t} does not belong to user ${s}`);const c={type:"vault_access_denied",vault:t,userEmail:s,sanitizedEmail:o,timestamp:new Date().toISOString()};return localStorage.setItem(`security_alert_access_denied_${Date.now()}`,JSON.stringify(c)),[]}else if(!t.startsWith("system_"))return console.error(`🚨 SECURITY ALERT: Cannot access non-system vault ${t} without user identification`),[]}const i=this.vaultKeys.get(t);if(!i)throw new Error(`Vault key for ${t} not found`);try{console.log(`Getting items for vault ${t}...`);let l,c=!1;try{const d=await ks("vaults",t);if(d){c=!0;const m=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(m){const f=localStorage.getItem(`encryption_pref_${m.replace(/[@.]/g,"_")}`);f&&(l=f,console.log(`Using user-specific encryption preference: ${l} for items in vault ${t}`))}if(!l&&d.encryptionMethod&&(l=d.encryptionMethod,console.log(`Using parent vault encryption method: ${l} for items`)),l){if(localStorage.setItem("encryption_method_in_use",l),localStorage.setItem("current_encryption_method",l),localStorage.setItem("user_encryption_method",l),localStorage.setItem(`vault_${t}_encryption_method`,l),m){const p=m.replace(/[@.]/g,"_");localStorage.setItem(`user_${p}_encryption_method`,l)}console.log(`Applied encryption method ${l} for user ${m||"unknown"}`);const f=await oe(()=>Promise.resolve().then(()=>tt),void 0);typeof f.resetFallbackState=="function"&&f.resetFallbackState(),l==="webcrypto"&&typeof f.markUsingFallback=="function"&&(f.markUsingFallback("encrypt"),f.markUsingFallback("decrypt"),console.log("Enforcing WebCrypto for both encryption and decryption based on vault metadata"))}else{console.log(`No encryption method specified for vault ${t}, using current default`);const f=localStorage.getItem("encryption_method_preference");f&&(l=f,console.log(`Using user preferred encryption method: ${f}`))}}else console.warn(`Vault ${t} not found in storage`)}catch(d){console.warn("Could not retrieve vault metadata for encryption method:",d)}if(!l){const d=localStorage.getItem("encryption_method_in_use");d&&(l=d,console.log(`Using localStorage-stored encryption method: ${d}`))}const u=await Tv(t,i,l);return u.length>0&&(localStorage.setItem("last_successful_vault_access",t),localStorage.setItem("last_successful_vault_items",u.length.toString()),localStorage.setItem("last_successful_vault_access_time",r),l&&localStorage.setItem("last_encryption_method_used",l)),u}catch(l){throw console.error(`Error getting items for vault ${t}:`,l),localStorage.setItem("last_vault_error",`${l}`),localStorage.setItem("last_vault_error_time",r),l}}async deleteItem(t,n){if(!this.isUnlocked())throw console.error(`🔐 SECURITY: Cannot delete item from vault ${t} - vault is locked`),new Error("Vault is locked");const r=this.getCurrentUserEmail();console.log(`🔐 SECURITY: Attempting to delete item ${n} from vault ${t}`),console.log(`🔐 SECURITY: Current user context: ${r||"unknown"}`);let s="";if(r)s=r.toLowerCase().replace(/[@.]/g,"_");else throw console.error(`🚨 SECURITY ALERT: No user context available for delete operation on vault ${t}`),new Error("Security error: Cannot delete item without user context");if(t!=="metadata"&&t!=="system"&&!t.startsWith("shared_")){if(r)if(Yo(t,r))console.log(`✅ SECURITY: Delete permission verified for user ${r} on vault ${t}`);else{console.error(`🚨 SECURITY ALERT: Unauthorized delete attempt on vault ${t} by user ${r}`);const i={type:"unauthorized_delete_attempt",vault:t,itemId:n,userEmail:r,sanitizedEmail:s,timestamp:new Date().toISOString()};throw localStorage.setItem(`security_alert_delete_${Date.now()}`,JSON.stringify(i)),new Error("Security error: Cannot delete item from vault - permission denied")}else if(!t.startsWith("system_"))throw console.error(`🚨 SECURITY ALERT: Delete attempt without user context on vault ${t}`),new Error("Security error: Cannot delete item from vault - no user context")}try{if(!this.vaultKeys.has(t))throw new Error(`Cannot delete from vault ${t} - no access to vault key`);await Wl("items",n),console.log(`Item ${n} deleted from vault ${t}`)}catch(o){throw console.error(`Error deleting item ${n} from vault ${t}:`,o),o}}async search(t){if(!this.isUnlocked()||!this.storageKey)throw new Error("Vault is locked");try{console.log(`Searching vaults for: "${t}"`);const n=await this.getVaults();console.log(`Searching across ${n.length} accessible vaults`);const r=[],s=await Ka("vaults"),o=new Set;for(const c of n){if(o.has(c.id))continue;const u=s.find(m=>m.id===c.id);if(!u){console.warn(`Could not find encrypted vault for ${c.id}`);continue}const d=this.vaultKeys.get(c.id);if(!d){console.warn(`No decryption key available for vault ${c.id}`);continue}r.push({vault:u,key:d}),o.add(c.id)}console.log(`Performing search across ${r.length} vaults with available keys`);const i=await Sj(t,r),l=i.reduce((c,u)=>c+u.items.length,0);return console.log(`Search complete: Found ${l} items across ${i.length} vaults`),i}catch(n){throw console.error(`Error searching for "${t}":`,n),n}}async changePassword(t,n){if(console.log("Starting complete password change process..."),!n||n.length<8)throw console.error("New password must be at least 8 characters long"),new Error("New password must be at least 8 characters long");if(!this.isUnlocked()&&(console.log("Vault not unlocked - attempting to unlock with old password"),!await this.unlockVault(t)))throw console.error("Could not unlock vault with old password - aborting password change"),new Error("Incorrect old password - could not unlock vault");if(!this.storageKey)throw console.error("Storage key not available - vault unlock failed"),new Error("Vault is not properly unlocked");try{mt(),console.log("Reset fallback state - ensuring consistent encryption method");const r=this.storageKey;console.log("Current vault is unlocked and storage key is available"),console.log("Caching vault keys and IDs before password change...");const s=Array.from(this.vaultKeys.entries()),o=new Set(this.vaultKeys.keys());console.log(`Found ${o.size} accessible vaults`);let i=null,l="database",c="masterKeys";const u=localStorage.getItem("session_email");if(u){const E=`master_keys_${u.replace(/[^a-zA-Z0-9]/g,"_")}`;try{i=await ks("masterKeys",E),i&&(console.log(`Found user-specific master keys for ${u}`),c=E)}catch(A){console.warn(`Error retrieving master keys for ${u}:`,A)}}if(i||console.log("User-specific master keys not found, not falling back to generic keys"),!i&&u){console.log("Trying localStorage fallback for master keys");const E=`master_keys_${u.replace(/[^a-zA-Z0-9]/g,"_")}`,A=localStorage.getItem(E);if(A)try{i=JSON.parse(A),console.log("Successfully retrieved master keys from localStorage"),l="localStorage",c=E}catch(I){console.warn("Error parsing master keys from localStorage:",I)}}if(!i)throw console.error("Could not locate master keys for password change"),new Error("Master keys not found - cannot change password");console.log("Verifying old password with stored salt...");const d=await ko(t,i.salt);if(d.hash!==i.rootKeyHash)throw console.error("Old password verification failed - hash mismatch"),new Error("Old password verification failed");console.log("Analyzing existing encryption method..."),mt();let m=!1;try{const E=await Io(i.encryptedStorageKey,d.key);m=wr(),console.log(`Detected encryption method: ${m?"WebCrypto":"WASM"}`),mt(),m&&(console.log("Setting WebCrypto for consistent encryption/decryption"),rt("encrypt"),rt("decrypt")),console.log("Successfully detected and set the appropriate encryption method")}catch(E){throw console.error("Failed to determine encryption method:",E),new Error("Could not analyze encryption method - password change aborted")}console.log("Will regenerate all storage and vault keys during password change"),console.log("Generating completely new encryption chain with consistent method...");const f=await Iv(n);if(f.rootKeyHash===i.rootKeyHash)throw console.error("New password produces the same root key hash - aborting"),new Error("New password cannot be the same as old password");console.log("Decrypting storage key with original method...");let p;try{p=await Io(i.encryptedStorageKey,d.key),console.log("Successfully decrypted storage key")}catch(E){throw console.error("Fatal error: Could not decrypt storage key:",E),new Error("Failed to decrypt storage key - password change aborted")}console.log("Re-encrypting all vault keys with consistent encryption method...");const v=await Ka("vaults");console.log(`Found ${v.length} encrypted vaults to update`);const h=new Set,x=u?`user_${u.replace(/[^a-zA-Z0-9]/g,"_")}_`:null;for(const E of v)try{if(x&&E.id.startsWith(x))h.add(E.id),console.log(`Found user vault: ${E.id}`);else if(E.id==="metadata")h.add(E.id),console.log("Found metadata vault that needs updating");else if(o.has(E.id))h.add(E.id),console.log(`Found accessible vault: ${E.id}`);else{console.log(`Skipping vault not owned by user: ${E.id}`);continue}const A=this.vaultKeys.get(E.id);if(!A){console.warn(`No decrypted key available for vault ${E.id}, skipping`);continue}console.log(`Re-encrypting key for vault: ${E.id}`);const I=await cs(A,p),N={...E,encryptedKey:I};await rs("vaults",N),console.log(`Updated vault ${E.id} with new encrypted key using consistent method`)}catch(A){console.error(`Error processing vault ${E.id}:`,A)}console.log(`Saving new master keys to ${l} using consistent method`);const y=await cs(p,await ko(n,f.salt).then(E=>E.key)),g={rootKeyHash:f.rootKeyHash,salt:f.salt,encryptedStorageKey:y};if(l==="database")if(u){const E=`master_keys_${u.replace(/[^a-zA-Z0-9]/g,"_")}`;await rs("masterKeys",E,{...g,lastUpdated:Date.now()}),console.log(`Updated master keys with user-specific ID: ${E}`)}else throw console.warn("Cannot update master keys - no email available"),new Error("Email is required for updating master keys");else{if(!u)throw console.warn("Cannot update master keys in localStorage - no email available"),new Error("Email is required for updating master keys in localStorage");const E=`master_keys_${u.replace(/[^a-zA-Z0-9]/g,"_")}`;localStorage.setItem(E,JSON.stringify({...g,lastUpdated:Date.now()})),console.log(`Updated master keys in localStorage with user-specific ID: ${E}`)}if(console.log("Clearing session authentication markers..."),localStorage.removeItem("last_auth_password"),localStorage.removeItem("auth_timestamp"),localStorage.removeItem("password_hash_check"),console.log("Verifying the new password..."),this.lockVault(),!await this.unlockVault(n))throw console.error("Failed to verify new password"),new Error("Password change verification failed - could not unlock with new password");console.log("Verifying vault access after password change...");let S=!0;for(const E of h)this.vaultKeys.has(E)||(console.error(`Verification failed: vault ${E} not accessible after password change`),S=!1);if(!S)throw console.error("Some user vaults are not accessible after password change"),new Error("Password change verification failed - some vaults not accessible");try{const E=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(n)),I=Array.from(new Uint8Array(E)).map(N=>N.toString(16).padStart(2,"0")).join("");localStorage.setItem("password_hash_check",I.substring(0,16)),console.log("Stored new password hash for verification")}catch(E){console.warn("Could not store password hash:",E)}return console.log("Password change complete - all keys re-encrypted successfully with consistent method"),!0}catch(r){throw console.error("Fatal error during password change:",r),r}}async clearAllData(t=!0){try{const n=localStorage.getItem("session_email");if(t&&n){console.log(`Clearing data only for user: ${n}`);const r=n.toLowerCase(),s=r.split("@")[0],o=r.replace(/[@.]/g,"_"),l=(await Ka("vaults")).filter(u=>u.id.includes(r)||u.id.startsWith("contacts-")&&u.id.includes(s)||u.id.startsWith("payments-")&&u.id.includes(s)||u.id.startsWith("user_")&&u.id.includes(o));console.log(`Found ${l.length} vaults belonging to ${n}`);for(const u of l){console.log(`Deleting vault: ${u.id}`),await Wl("vaults",u.id);const d=await Cv(u.id);for(const m of d)await Wl("items",m.id);console.log(`Deleted ${d.length} items from vault: ${u.id}`)}const c=`master_keys_${n.replace(/[^a-zA-Z0-9]/g,"_")}`;await Wl(kt,c),console.log(`Deleted master keys for: ${n}`),this.storageKey=null,this.vaultKeys.clear(),this.initialized=!1,console.log(`Successfully cleared all data for user: ${n}`)}else console.warn("CRITICAL: Clearing ALL vault data for ALL users"),await Pd("masterKeys"),await Pd("vaults"),await Pd("items"),this.storageKey=null,this.vaultKeys.clear(),this.initialized=!1,console.log("Successfully cleared all vault data")}catch(n){throw console.error("Error clearing vault data:",n),n}}}const pe=new bj,Ot=Object.freeze(Object.defineProperty({__proto__:null,VaultService:bj,vaultService:pe},Symbol.toStringTag,{value:"Module"}));function b5(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function E5(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n.buffer}async function k5(e,t,n){try{if(!e||!t)throw new Error("Data and key are required for encryption");const r=n?` for user ${n}`:"";console.log(`Performing standardized encryption${r}`);try{console.log("Attempting WASM encryption first...");const s=await jv(e,t);return console.log("WASM encryption successful"),s}catch(s){console.warn("WASM encryption failed, details:",s),console.log("Falling back to standardized WebCrypto encryption...");try{const o=new TextEncoder,i=E5(t),l=await window.crypto.subtle.importKey("raw",i,{name:"AES-GCM"},!1,["encrypt"]),c=window.crypto.getRandomValues(new Uint8Array(12)),u=o.encode(e),d=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},l,u),m=new Uint8Array(c.length+d.byteLength);m.set(c,0),m.set(new Uint8Array(d),c.length);const f=b5(m.buffer);return console.log("Standardized WebCrypto encryption successful"),f}catch(o){throw console.error("Standardized WebCrypto encryption failed:",o),new Error("All encryption methods failed")}}}catch(r){throw console.error("Error in standardizedEncrypt:",r),r}}async function C5(e,t,n){try{if(!e||!t)throw new Error("Encrypted data and key are required for decryption");if(n){const{isVaultContextUser:r,getVaultContextUser:s}=await oe(async()=>{const{isVaultContextUser:l,getVaultContextUser:c}=await Promise.resolve().then(()=>Ge);return{isVaultContextUser:l,getVaultContextUser:c}},void 0);if(localStorage.getItem("enforce_user_isolation")==="true"){if(!r(n))throw console.error(`SECURITY VIOLATION: Attempted decryption for user ${n} when context is for different user`),new Error("User context violation: Decryption blocked due to user mismatch");const l=`mata_decryption_audit_${n.toLowerCase().trim()}`,c=Date.now().toString(),d=(localStorage.getItem(l)||"").split(",").filter(Boolean);d.push(c),d.length>10&&d.shift(),localStorage.setItem(l,d.join(","))}else{const l=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("vault_user_email")||s();l&&l.toLowerCase().trim()!==n.toLowerCase().trim()&&console.warn(`User context mismatch during decryption: session=${l}, requested=${n}`)}}return Om(e,t)}catch(r){throw console.error("Error in standardizedDecrypt:",r),r}}function N5(e){return console.log("DEPRECATED: getStandardizedEncryptionMethod - Now using fixed WASM with WebCrypto fallback approach"),"wasm"}function Ej(e){console.log("DEPRECATED: applyStandardizedEncryption - Now using fixed WASM with WebCrypto fallback approach")}const kf=Object.freeze(Object.defineProperty({__proto__:null,applyStandardizedEncryption:Ej,getStandardizedEncryptionMethod:N5,standardizedDecrypt:C5,standardizedEncrypt:k5},Symbol.toStringTag,{value:"Module"}));async function kj(e){try{console.log(`Initializing all vaults for user: ${e}`),gl(),pl(e),console.log(`🔒 Database context initialized for user: ${e}`);const{vaultService:t}=await oe(async()=>{const{vaultService:m}=await Promise.resolve().then(()=>Ot);return{vaultService:m}},void 0);if(!t.isInitialized())throw console.error("ERROR: Vault service is not initialized before vault initialization."),new Error("Vault service is not initialized. Cannot initialize vaults.");if(!t.getStorageKey())throw console.error("ERROR: Vault storage key is null - vault is not unlocked."),new Error("Vault is not unlocked. Cannot initialize vaults without unlock.");const{initializePasswordVault:n}=await oe(async()=>{const{initializePasswordVault:m}=await Promise.resolve().then(()=>Ou);return{initializePasswordVault:m}},void 0),{initializeContactsVault:r}=await oe(async()=>{const{initializeContactsVault:m}=await import("./contactsVaultService-DTnxTawa.js");return{initializeContactsVault:m}},[]),{initializePaymentMethodVault:s}=await oe(async()=>{const{initializePaymentMethodVault:m}=await import("./paymentMethodVaultService-BSfQQN5M.js");return{initializePaymentMethodVault:m}},[]),{initializePaymentHistoryVault:o}=await oe(async()=>{const{initializePaymentHistoryVault:m}=await Promise.resolve().then(()=>Zg);return{initializePaymentHistoryVault:m}},void 0),{initializeBankAccountVault:i}=await oe(async()=>{const{initializeBankAccountVault:m}=await Promise.resolve().then(()=>iy);return{initializeBankAccountVault:m}},void 0),l=["passwords","contacts","payments","payment_history","bank_accounts"],c=[n,r,s,o,i],u=[];for(let m=0;m<c.length;m++){const f=l[m],p=c[m];try{console.log(`Initializing ${f} vault...`);const v=await p(e);localStorage.setItem(`vault_${f}_initialized`,v?"true":"false"),u.push({type:f,success:v,error:null}),console.log(`Vault initialization for ${f}: ${v?"SUCCESS":"FAILED"}`)}catch(v){const h=v instanceof Error?v.message:String(v);console.error(`Error initializing ${f} vault:`,v),u.push({type:f,success:!1,error:h}),localStorage.setItem(`vault_${f}_initialized`,"false"),localStorage.setItem(`vault_${f}_error`,h)}}localStorage.setItem("vault_initialization_details",JSON.stringify(u));const d=u.filter(m=>!m.success);if(d.length>0){console.warn(`Some vault initializations failed: ${d.length} failures`),console.warn("Vault initialization failures:",JSON.stringify(d,null,2)),d.forEach((f,p)=>{console.error(`VAULT INIT FAILURE ${p+1}: ${f.type} - ${f.error}`)});const m=u.some(f=>f.success);if(!m){const f=JSON.stringify(d.map(p=>`${p.type}: ${p.error}`));throw console.error(`ALL VAULT INITIALIZATIONS FAILED: ${f}`),new Error(`Failed to initialize any vaults. Details: ${f}`)}return m}return console.log("All vaults successfully initialized"),!0}catch(t){const n=t instanceof Error?t.message:String(t);throw console.error("ERROR in initializeUserVaults:",t),localStorage.setItem("vault_initialization_error",n),localStorage.setItem("vault_initialization_error_time",new Date().toISOString()),new Error(`Vault initialization failed: ${n}`)}}async function Av(e,t,n=!1){try{console.log(`Performing standardized vault unlock for: ${e}`);const{clearVaultContext:r,isVaultContextUser:s}=await oe(async()=>{const{clearVaultContext:f,isVaultContextUser:p}=await Promise.resolve().then(()=>Ge);return{clearVaultContext:f,isVaultContextUser:p}},void 0);if(r(),gl(),pl(e),cj(e),!s(e))return console.error(`User context verification failed for ${e} - preventing vault unlock`),!1;Ej(e);const{getStandardizedStorageKey:o}=await oe(async()=>{const{getStandardizedStorageKey:f}=await Promise.resolve().then(()=>Ge);return{getStandardizedStorageKey:f}},void 0),{getStandardizedEncryptionMethod:i}=await oe(async()=>{const{getStandardizedEncryptionMethod:f}=await Promise.resolve().then(()=>kf);return{getStandardizedEncryptionMethod:f}},void 0),l=i(e),c=o("encryption_method",e);localStorage.setItem(c,l),localStorage.setItem("encryption_method",l),localStorage.setItem("current_encryption_method",l);const u=o("auth_password",e);localStorage.setItem(u,t),localStorage.setItem("last_auth_password",t),localStorage.setItem("mata_auth_password",t);const d=Date.now().toString();if(localStorage.setItem("auth_timestamp",d),localStorage.setItem("last_vault_unlock_attempt",d),localStorage.getItem("vault_creation_time")||localStorage.setItem("vault_creation_time",d),await pe.unlockVault(t,n)){console.log("Standardized vault unlock successful");const f=o("vault_unlocked",e);localStorage.setItem(f,"true"),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",d);const p=e.replace(/[@.]/g,"_").toLowerCase();return localStorage.setItem(`vault_user_${p}_active`,"true"),localStorage.setItem("last_successful_unlock",d),localStorage.setItem("last_successful_user",e),!0}else return console.warn("Standardized vault unlock failed"),localStorage.setItem("last_failed_unlock",d),localStorage.setItem("last_failed_user",e),!1}catch(r){return console.error("Error in standardizedVaultUnlock:",r),localStorage.setItem("vault_unlock_error",r instanceof Error?r.message:String(r)),localStorage.setItem("vault_unlock_error_time",Date.now().toString()),!1}}async function Cf(e){try{if(!e){console.warn("Cannot set encryption state without email");return}console.log(`Ensuring consistent encryption state for: ${e}`);const t=await oe(()=>Promise.resolve().then(()=>Ge),void 0),n=await oe(()=>Promise.resolve().then(()=>kf),void 0),{setVaultUserContext:r,getStandardizedStorageKey:s,getSanitizedEmail:o,clearVaultContext:i}=t,{getStandardizedEncryptionMethod:l,applyStandardizedEncryption:c}=n;i(),gl(),pl(e),mt(),r(e),localStorage.setItem("active_user_email",e.toLowerCase()),localStorage.setItem("last_authenticated_user",e.toLowerCase()),localStorage.setItem("current_login_context",e.toLowerCase());const u=o(e);localStorage.setItem("sanitized_active_user",u),c(e),localStorage.setItem("enforce_user_isolation","true");const d=l(e),m=s("encryption_method",e);localStorage.setItem(m,d),localStorage.setItem("current_encryption_method",d),localStorage.getItem("last_encryption_format")&&localStorage.removeItem("last_encryption_format");const f=["encryption_format","encryption_method","last_format_used","wasm_enabled","webcrypto_fallback","preferred_crypto"];for(const x of f)localStorage.removeItem(x);const p=s("current_email",e);localStorage.setItem(p,e),localStorage.setItem("session_email",e),localStorage.setItem("current_user_email",e),localStorage.setItem("last_logged_in_email",e),localStorage.setItem("mata_active_user",e),localStorage.setItem("mata_active_user_sanitized",u);const v=s("auth_timestamp",e),h=Date.now().toString();localStorage.setItem(v,h),localStorage.setItem("auth_timestamp",h),console.log(`Encryption state standardized for ${e} using method: ${d}`)}catch(t){console.error("Error ensuring consistent encryption state:",t)}}async function Og(e,t,n=!1){const r={clearContext:!1,consistentEncryption:!1,userContextSet:!1,vaultUnlocked:!1,vaultsInitialized:!1,storageVariablesSet:!1,passwordsRemoved:!1};try{console.log(`Performing standardized login for: ${e}`);const{clearVaultContext:s,getStandardizedStorageKey:o,isVaultContextUser:i,verifyVaultAccess:l}=await oe(async()=>{const{clearVaultContext:u,getStandardizedStorageKey:d,isVaultContextUser:m,verifyVaultAccess:f}=await Promise.resolve().then(()=>Ge);return{clearVaultContext:u,getStandardizedStorageKey:d,isVaultContextUser:m,verifyVaultAccess:f}},void 0);try{s(),gl(),pl(e),console.log(`🔑 Database context set for user: ${e}`),r.clearContext=!0,console.log("Step 1: Context cleared and database isolation applied successfully")}catch(u){throw console.error("Step 1 FAILED: Error clearing context:",u),new Error(`Context clearing failed: ${u instanceof Error?u.message:String(u)}`)}try{await Cf(e),r.consistentEncryption=!0,console.log("Step 2: Encryption state ensured successfully")}catch(u){throw console.error("Step 2 FAILED: Error ensuring encryption state:",u),new Error(`Encryption state setup failed: ${u instanceof Error?u.message:String(u)}`)}try{localStorage.setItem("local_only_auth","true");const u=e.toLowerCase().replace(/[^a-z0-9]/g,"_");if(localStorage.setItem("current_user_email",e),localStorage.setItem("mata_active_user",u),localStorage.setItem("sanitized_active_user",u),localStorage.setItem("original_email_"+u,e),i(e))r.userContextSet=!0,console.log("Step 3: User context verified successfully");else{console.warn(`Step 3 WARNING: User context verification initially failed for ${e}`),console.log("Attempting to recover with fallback context initialization...");const{setVaultUserContext:d}=await oe(async()=>{const{setVaultUserContext:m}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:m}},void 0);d(e),i(e)?(r.userContextSet=!0,console.log("Step 3: User context verified successfully after recovery")):(console.error(`Step 3 FAILED: User context verification failed for ${e} even after recovery`),console.log("Local-only auth mode active - continuing despite context verification failure"),r.userContextSet=!0)}}catch(u){if(console.error("Step 3 FAILED: Error verifying user context:",u),localStorage.getItem("local_only_auth")==="true")console.log("Local-only auth mode active - continuing despite errors"),r.userContextSet=!0;else throw new Error(`User context verification failed: ${u instanceof Error?u.message:String(u)}`)}try{if(!await Av(e,t,!1))throw console.error("Step 4 FAILED: Vault unlock failed"),new Error("Vault unlock failed during login process");r.vaultUnlocked=!0,console.log("Step 4: Vault unlocked successfully")}catch(u){throw console.error("Step 4 FAILED: Error unlocking vault:",u),new Error(`Vault unlock error: ${u instanceof Error?u.message:String(u)}`)}try{const u=await kj(e);r.vaultsInitialized=u,console.log(`Step 5: Vaults initialization ${u?"successful":"failed"}`),u||console.warn("Failed to initialize vaults during standardized login")}catch(u){console.error("Step 5 FAILED: Error initializing vaults:",u),localStorage.setItem("vault_initialization_error",u instanceof Error?u.message:String(u))}try{const u=o("vault_unlocked",e);localStorage.setItem(u,"true");const d=o("vault_unlock_time",e),m=Date.now().toString();localStorage.setItem(d,m);const f=o("auth_email",e);localStorage.setItem(f,e),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlock_time",m),localStorage.setItem("auth_email",e),r.storageVariablesSet=!0,console.log("Step 6: Storage variables set successfully")}catch(u){console.error("Step 6 FAILED: Error setting storage variables:",u)}try{n?(Ji(),console.log("🔒 Security: All password variables removed after successful vault initialization")):console.log("Password cleanup skipped (deletePasswordAfterUse=false)"),r.passwordsRemoved=!0,console.log("Step 7: Password cleanup completed")}catch(u){console.error("Step 7 FAILED: Error removing passwords:",u)}const c=Date.now().toString();console.log(`Standardized login process completed successfully for ${e}`),console.log(`Vault access state: unlocked=${r.vaultUnlocked}, vaultsInitialized=${r.vaultsInitialized}`),console.log(`Login completed at: ${new Date(parseInt(c)).toISOString()}`),localStorage.setItem("login_steps_completed",JSON.stringify(r));try{console.log("Dispatching loginComplete event to refresh DID display...");const u=new CustomEvent("loginComplete",{detail:{email:e,timestamp:Date.now()}});window.dispatchEvent(u);const d=new CustomEvent("userKeysUpdated",{detail:{email:e,timestamp:Date.now()}});window.dispatchEvent(d),console.log("Login events dispatched to refresh DID display")}catch(u){console.error("Error dispatching login events:",u)}return!0}catch(s){const o=s instanceof Error?s.message:String(s);return console.error("ERROR in performStandardizedLogin:",s),localStorage.setItem("login_error",o),localStorage.setItem("login_error_time",new Date().toISOString()),localStorage.setItem("login_steps_completed",JSON.stringify(r)),r.vaultUnlocked&&!r.vaultsInitialized&&localStorage.setItem("vault_unlock_without_init","true"),!1}finally{if(n)try{Ji()}catch(s){console.error("Error in final password cleanup:",s)}}}const Cj=w.createContext(null);function j5({children:e}){const{toast:t}=dn();wu();const[n,r]=w.useState(!1),{data:s,error:o,isLoading:i,refetch:l}=oN({queryKey:["/api/user"],queryFn:async()=>{localStorage.setItem("local_only_auth","true");const f=["auth_user","user_data","current_user","user_profile","mata_user"];for(const p of f){const v=localStorage.getItem(p);if(v)try{const h=JSON.parse(v);return console.log(`Authenticated from local storage (${p}):`,h),h}catch(h){console.error(`Error parsing local user data from ${p}:`,h)}}try{const p=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("mata_active_user");if(p){let v=null;const h=localStorage.getItem(`mata_keys_${p.replace(/[@.]/g,"_")}`);if(h)try{v=JSON.parse(h).publicKey}catch(x){console.error("Error parsing user keys:",x)}if(v){const x={id:0,email:p,publicKey:v,firstName:p.split("@")[0],isVerified:!0,password:null,salt:null,authCode:null,createdAt:new Date};return localStorage.setItem("auth_user",JSON.stringify(x)),console.log("Reconstructed user from keys in localStorage:",x),x}}}catch(p){console.error("Error reconstructing user from localStorage pieces:",p)}return console.log("No user found in localStorage and server checks disabled"),null}});w.useEffect(()=>{r(!0),console.log("Auto-login functionality explicitly disabled - manual login required")},[]);const c=Kl({mutationFn:async f=>{try{console.log("🔐 Starting standardized secure login process...");try{const{clearSecurityContext:I,resetFallbackState:N}=await oe(async()=>{const{clearSecurityContext:T,resetFallbackState:$}=await Promise.resolve().then(()=>tt);return{clearSecurityContext:T,resetFallbackState:$}},void 0);N(),console.log("🔄 Reset crypto fallback state to ensure clean crypto operations"),I(!0),console.log("🧹 Enhanced security: Cleared security context to prevent cross-user contamination")}catch(I){console.error("⚠️ Error during enhanced security initialization:",I),console.log("⚠️ Falling back to standard login flow"),sessionStorage.clear()}const{getSanitizedEmail:p,setVaultUserContext:v,getStandardizedStorageKey:h}=await oe(async()=>{const{getSanitizedEmail:I,setVaultUserContext:N,getStandardizedStorageKey:T}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:I,setVaultUserContext:N,getStandardizedStorageKey:T}},void 0),x=p(f.email);if(v(f.email),localStorage.setItem(h("active_user",f.email),f.email),localStorage.setItem("last_email",f.email),console.log(`👤 User identity set with enhanced isolation: ${x}`),f.password&&(localStorage.setItem("last_auth_password",f.password),localStorage.setItem("auth_timestamp",Date.now().toString())),localStorage.setItem("local_only_auth","true"),console.log("Setting local-only authentication mode"),!gj(f.email))throw console.log(`No account found locally for email: ${f.email}`),new Error(`Account not found locally: ${f.email}. Please register first.`);let g=yj(f.email);if(!g)throw console.log("No local salt found for local-only authentication - this is an error condition"),new Error("Missing security information for this account. Please register again.");console.log("Initializing WebAssembly cryptography module...");const _=await hs();if(!_)throw new Error("Failed to initialize encryption module");console.log("Deriving cryptographic key from password and salt...");const{key:S}=await _.derive_key(f.password,g);console.log("Key derived successfully");const E=await mo(f.email);if(console.log(`Retrieved stored keys for ${f.email}:`,E?"found":"not found"),E&&an(E)&&E.hash===S){console.log("Local authentication successful - using standardized approach!"),await Cf(f.email),await Og(f.email,f.password)?console.log("Standardized login process completed successfully"):console.warn("Standardized login completed with partial success");const N={id:E.id||0,email:f.email,firstName:E.firstName||"User",isVerified:E.isVerified||!0,publicKey:E.publicKey,password:null,salt:null,authCode:null,createdAt:new Date};navigator.onLine&&(console.log("Online - syncing with server in background"),ad("POST","/api/login",{email:f.email,password:S}).then(async T=>{try{const $=await T.json(),M={publicKey:$.publicKey||E.publicKey,encryptedPrivateKey:E.encryptedPrivateKey,salt:E.salt,hash:E.hash,id:$.id,email:$.email,firstName:$.firstName,isVerified:$.isVerified};await Vc(M);const j=$.email.toLowerCase();localStorage.setItem("session_email",j),localStorage.setItem("current_user_email",$.email),localStorage.setItem("login_timestamp",Date.now().toString());const{getSanitizedEmail:P}=await oe(async()=>{const{getSanitizedEmail:Z}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:Z}},void 0),V=`user_${P($.email)}_payments`;localStorage.setItem("user_vault_namespace",V),console.log("Vault namespace configured with standardized email sanitization:",V);try{oe(()=>Promise.resolve().then(()=>Ot),void 0).then(Z=>{const D=Z.vaultService;D.isInitialized()&&(D.resetState(),console.log("VaultService state reset for new user session"))}).catch(Z=>{console.warn("Failed to reset vault service:",Z)})}catch(Z){console.warn("Error importing vault service:",Z)}Qo.setQueryData(["/api/user"],$),console.log("Successfully synced user data with server")}catch($){console.warn("Background server sync failed, continuing with local data",$)}}).catch(T=>{console.warn("Background server login failed, continuing with local authentication",T)}));try{console.log("Auto-initializing vault service after successful login..."),oe(()=>Promise.resolve().then(()=>Ot),void 0).then(async T=>{const $=T.vaultService;$.isInitialized()||await $.initialize(),await $.unlockVault(void 0,!0)?(console.log("Auto-unlock successful: Vault is now ready to use"),console.log("Password cleaned up from session storage for security")):console.warn("Auto-unlock failed: User may need to enter password again")}).catch(T=>{console.warn("Failed to auto-initialize vault service:",T)})}catch(T){console.warn("Error during vault auto-initialization:",T)}return N}if(localStorage.getItem("local_only_auth")==="true")throw console.log("Local-only authentication mode is enabled but local auth failed"),new Error("Authentication failed: Invalid password for local-only account");if(navigator.onLine){console.log("Local authentication failed or no stored keys - trying server authentication");const I={email:f.email,password:S};console.log("Sending authentication request to server...");try{const T=await(await ad("POST","/api/login",I)).json();if(console.log("Server authentication successful - using standardized login approach"),await Cf(f.email),await Og(f.email,f.password)?console.log("Standardized login process completed successfully"):console.warn("Standardized login completed with partial success"),!T.publicKey)throw new Error("Server response missing required cryptographic keys");const M={publicKey:T.publicKey,encryptedPrivateKey:(E==null?void 0:E.encryptedPrivateKey)||"",salt:g||"",hash:S,email:T.email,firstName:T.firstName,id:T.id,isVerified:T.isVerified};await Vc(M),console.log("User data saved locally for future offline login");const j=T.email.toLowerCase();localStorage.setItem("session_email",j),localStorage.setItem("current_user_email",T.email),localStorage.setItem("login_timestamp",Date.now().toString());const{getSanitizedEmail:P}=await oe(async()=>{const{getSanitizedEmail:Z}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:Z}},void 0),V=`user_${P(T.email)}_payments`;localStorage.setItem("user_vault_namespace",V),console.log("Vault namespace configured for server auth with standardized email sanitization:",V),localStorage.setItem("auth_timestamp",Date.now().toString()),localStorage.setItem("last_auth_password",f.password);try{oe(()=>Promise.resolve().then(()=>Ot),void 0).then(Z=>{const D=Z.vaultService;D.isInitialized()&&(D.resetState(),console.log("VaultService state reset for new user session"))}).catch(Z=>{console.warn("Failed to reset vault service:",Z)})}catch(Z){console.warn("Error importing vault service:",Z)}return T}catch(N){throw console.error("Server authentication failed:",N),new Error("Login failed: Invalid credentials")}}else throw new Error("Authentication failed: Invalid password and no server connection available")}catch(p){throw console.error("Secure login error:",p),p}},onSuccess:async f=>{var p,v,h,x,y,g,_;if(f&&typeof f=="object"&&"email"in f){Qo.setQueryData(["/api/user"],f);try{if(gr()){const{syncWithExtension:S}=await oe(async()=>{const{syncWithExtension:E}=await Promise.resolve().then(()=>gi);return{syncWithExtension:E}},void 0);console.log("Syncing with extension after login..."),await S()}}catch(S){console.warn("Extension sync after login failed:",S)}try{if(console.log("Automatically initializing vault service..."),(p=c.variables)!=null&&p.email){const A=c.variables.email.toLowerCase();if(localStorage.setItem("session_email",A),localStorage.setItem("current_user_email",c.variables.email),localStorage.setItem("last_session_email",A),localStorage.setItem("auth_user_email",A),console.log(`Session email set to ${c.variables.email} with all necessary session markers`),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Pre-emptively set vault unlocked marker for payment access flow with cross-session persistence"),(v=c.variables)!=null&&v.password){localStorage.setItem("last_auth_password",c.variables.password),console.log("Stored password in localStorage for persistent vault unlocking across sessions");const I=c.variables.email,{getSanitizedEmail:N}=await oe(async()=>{const{getSanitizedEmail:M}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:M}},void 0),$=`master_keys_${N(I)}`;try{const M=await ks("masterKeys",$);if(M!=null&&M.encryptionMethod)localStorage.setItem("user_encryption_method",M.encryptionMethod),console.log(`Using encryption method from master keys with cross-session persistence: ${M.encryptionMethod}`);else{const{getSanitizedEmail:j}=await oe(async()=>{const{getSanitizedEmail:V}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:V}},void 0),P=j(I),b=localStorage.getItem(`encryption_pref_${P}`);if(b){localStorage.setItem("user_encryption_method",b),console.log(`Using and persisting legacy encryption preference: ${b}`);try{const V={...M,encryptionMethod:b,lastUpdated:Date.now()},{getSanitizedEmail:Z}=await oe(async()=>{const{getSanitizedEmail:O}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:O}},void 0),L=`master_keys_${Z(I)}`;await rs(kt,L,V),console.log(`Updated master keys with encryption method from localStorage: ${b}`),localStorage.removeItem(`encryption_pref_${P}`)}catch(V){console.warn("Could not update master keys with encryption method:",V)}}else localStorage.setItem("user_encryption_method","webcrypto"),console.log("No encryption preference found, defaulting to WebCrypto with cross-session persistence")}}catch(M){console.error("Error retrieving master keys for encryption preference:",M),localStorage.setItem("user_encryption_method","webcrypto"),console.log("Defaulting to WebCrypto encryption method with cross-session persistence due to error")}}}await pe.initialize(),console.log("Vault service initialized successfully");let S=!1;try{S=await pe.isVaultInitialized(),console.log(`Vault initialization check: ${S?"initialized":"not initialized"}`)}catch(A){console.warn("Error checking vault initialization:",A)}const E=(h=c.variables)==null?void 0:h.email;if(E){const A=localStorage.getItem("last_vault_namespace"),I=localStorage.getItem("last_session_email");if(A&&I===E)localStorage.setItem("user_vault_namespace",A),console.log("Restored previous vault namespace:",A);else{const{getSanitizedEmail:N}=await oe(async()=>{const{getSanitizedEmail:M}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:M}},void 0),$=`user_${N(E)}_payments`;localStorage.setItem("user_vault_namespace",$),console.log("User-specific vault namespace configured with standardized email:",$)}}if(S){const A=await mo(E);if(A&&an(A)){if((x=c.variables)!=null&&x.password){console.log("Automatically unlocking vault with login credentials...");try{if(await pe.unlockVault(c.variables.password,!0)){console.log("Vault successfully unlocked for session"),console.log("Login password cleaned up after vault unlock for security"),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString());try{console.log("Initializing password vault during login...");const{initializePasswordVault:N,unlockPasswordVault:T}=await oe(async()=>{const{initializePasswordVault:$,unlockPasswordVault:M}=await Promise.resolve().then(()=>Ou);return{initializePasswordVault:$,unlockPasswordVault:M}},void 0);if(E)try{await N(E)?(console.log("Password vault successfully initialized during login"),(y=c.variables)!=null&&y.password&&(console.log("Unlocking password vault with login credentials..."),await T(c.variables.password)?(console.log("Password vault successfully unlocked during login"),localStorage.setItem("password_vault_initialized","true"),localStorage.setItem("password_vault_unlocked","true")):console.error("Failed to unlock password vault during login"))):console.error("Failed to initialize password vault during login")}catch($){console.error("Error initializing password vault during login:",$)}}catch(N){console.error("Error initializing password vault:",N)}t({title:"Vault unlocked",description:"Your secure vault has been unlocked for this session"})}else console.warn("Failed to unlock vault during login"),localStorage.setItem("vault_unlocked","true"),console.log("Setting vault unlocked marker with persistence to help with UI flows")}catch(I){console.error("Error unlocking vault:",I),localStorage.setItem("vault_unlocked","true"),console.log("Setting vault unlocked marker with persistence despite error")}}}else console.log("Valid user keys not found, vault remains locked"),localStorage.setItem("vault_unlocked","true"),console.log("Setting vault unlocked marker with persistence despite missing keys")}else{console.log("Vault not yet initialized - setting up new vault");try{if((g=c.variables)!=null&&g.password&&((_=c.variables)!=null&&_.email)){console.log("Setting up new vault with login credentials...");const A=c.variables.email,I=A.toLowerCase();localStorage.setItem("session_email",I),console.log("Setting persistent session email for cross-session access");const N=await pe.setupVault(c.variables.password,A);if(N){console.log("Vault successfully set up with root key hash:",N),localStorage.setItem("vault_unlocked","true"),console.log("Setting persistent vault unlocked marker for cross-session access");const{getSanitizedEmail:T}=await oe(async()=>{const{getSanitizedEmail:j}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:j}},void 0),$=T(A),M=`user_${$}_payments`;localStorage.setItem("user_vault_namespace",M),localStorage.setItem("last_vault_namespace",M),console.log("Setting persistent vault namespace for cross-session access"),localStorage.setItem("last_session_email",I),localStorage.setItem("user_encryption_method","webcrypto");try{const j=`master_keys_${$}`,P=await ks(kt,j);if(P&&!P.encryptionMethod){const b={...P,encryptionMethod:"webcrypto",lastUpdated:Date.now()};await rs(kt,j,b),console.log("Updated master keys with encryption method: webcrypto")}localStorage.removeItem(`encryption_pref_${$}`)}catch(j){console.warn("Could not update master keys with encryption method:",j),localStorage.getItem(`encryption_pref_${$}`)||localStorage.setItem(`encryption_pref_${$}`,"webcrypto")}console.log("User-specific vault namespace configured and persisted:",M),t({title:"Secure vault created",description:"Your encrypted vault has been set up and unlocked for cross-session access"})}}else console.warn("Cannot initialize vault - password or email not available")}catch(A){console.error("Error setting up new vault:",A)}}}catch(S){console.error("Error automatically unlocking vault:",S)}}},onError:f=>{t({title:"Login failed",description:f.message,variant:"destructive"})}}),u=Kl({mutationFn:async f=>await(await ad("POST","/api/register",f)).json(),onSuccess:async f=>{var p,v;if(f&&typeof f=="object"&&"email"in f){Qo.setQueryData(["/api/user"],f);try{if(gr()){const{syncWithExtension:h}=await oe(async()=>{const{syncWithExtension:x}=await Promise.resolve().then(()=>gi);return{syncWithExtension:x}},void 0);console.log("Syncing with extension after registration..."),await h()}}catch(h){console.warn("Extension sync after registration failed:",h)}try{if(console.log("Setting up vault for new user..."),await pe.initialize(),(p=u.variables)!=null&&p.password&&(f!=null&&f.email)){console.log("Setting up new vault with registration credentials...");const h=f.email,x=h.toLowerCase();localStorage.setItem("session_email",x),console.log("Setting persistent session email for new user registration");const y=await pe.setupVault(u.variables.password,h);if(y){console.log("Vault successfully set up with root key hash:",y),localStorage.setItem("vault_unlocked","true"),console.log("Setting persistent vault unlocked marker for new user");try{console.log("Creating initial payment vault for new user...");const g=(f==null?void 0:f.email)||((v=u.variables)==null?void 0:v.email);if(!g)console.error("Cannot create user-specific vault - email not available");else{const{getSanitizedEmail:_}=await oe(async()=>{const{getSanitizedEmail:A}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:A}},void 0),S=_(g),E=await pe.createNewVault("Payment Information","payments",`user_${S}_payments`);E&&console.log("User-specific payment vault created successfully:",E.id)}}catch(g){console.error("Error creating payment vault:",g)}t({title:"Secure vault created",description:"Your encrypted vault has been set up for persistent cross-session access"})}}}catch(h){console.error("Error setting up vault for new user:",h)}}},onError:f=>{t({title:"Registration failed",description:f.message,variant:"destructive"})}}),d=Kl({mutationFn:async f=>{console.log("In verifyCodeMutation mutationFn with data:",f);const p={code:f.code.trim(),email:f.email.trim()};console.log("Sending payload to /api/verify-code:",p);try{const v=await fetch("/api/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p),credentials:"include"});if(console.log("API response status:",v.status),!v.ok){const h=await v.text();throw console.error("API error response:",h),new Error(h||"Verification failed")}return console.log("Verification API call successful"),await v.json().catch(()=>({}))}catch(v){throw console.error("API request failed:",v),v}},onError:f=>{console.error("Verification mutation error:",f),t({title:"Verification failed",description:f.message,variant:"destructive"})},onSuccess:f=>{console.log("Verification successful! Response data:",f)}}),m=Kl({mutationFn:async()=>{try{console.log("🔒 Starting enhanced secure logout process...");try{const{vaultService:v}=await oe(async()=>{const{vaultService:h}=await Promise.resolve().then(()=>Ot);return{vaultService:h}},void 0);v.lockVault(),v.resetState(),console.log("🔒 Vault service state reset to prevent cross-account access")}catch(v){console.warn("Failed to reset vault service state:",v)}const f=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("last_email");console.log(`🔄 Logging out user: ${f||"unknown"}`),Qo.clear(),console.log("🧹 Query client cache cleared");try{pe&&pe.isInitialized()&&(await pe.lockVault(),console.log("🔒 Vault locked - encryption keys cleared from memory"),await pe.resetState(),console.log("🔄 Vault service state reset to prevent cross-account access"))}catch(v){console.error("⚠️ Error during vault reset:",v)}const p=localStorage.getItem("local_only_auth")==="true";if(!p&&navigator.onLine){console.log("🌐 Online - sending logout request to server");try{await ad("POST","/api/logout"),console.log("✅ Server logout successful")}catch(v){console.warn("⚠️ Server logout failed, but continuing with local logout",v)}}else console.log(p?"🔒 Local-only authentication detected - skipping server logout":"📴 Offline - skipping server logout");try{const{clearSecurityContext:v,resetFallbackState:h,removeAllPasswordsFromStorage:x}=await oe(async()=>{const{clearSecurityContext:y,resetFallbackState:g,removeAllPasswordsFromStorage:_}=await Promise.resolve().then(()=>tt);return{clearSecurityContext:y,resetFallbackState:g,removeAllPasswordsFromStorage:_}},void 0);v(!0),console.log("🧹 Enhanced security: Cleared security context to prevent cross-user contamination"),x(),console.log("🔑 Enhanced security: Removed all password-related data from storage"),h(),console.log("🔄 Enhanced security: Crypto state reset complete"),localStorage.removeItem("local_only_auth"),console.log("🔑 Removed local-only authentication flag")}catch(v){console.error("⚠️ Error during enhanced security cleanup:",v),console.log("⚠️ Falling back to manual localStorage cleanup"),sessionStorage.clear(),console.log("🧹 Session storage cleared manually");try{oe(()=>Promise.resolve().then(()=>tt),void 0).then(h=>{const{clearSecurityContext:x,removeAllPasswordsFromStorage:y}=h;x(!0),console.log("🧹 Successfully cleared security context to prevent cross-user contamination"),y(),console.log("🔑 Successfully removed all password-related data from storage"),localStorage.removeItem("local_only_auth"),console.log("🔑 Removed local-only authentication flag")}).catch(h=>{console.warn("Failed to import crypto module for security context cleanup:",h),localStorage.removeItem("mata_keys"),localStorage.removeItem("mata_salt"),localStorage.removeItem("encryption_pref"),localStorage.removeItem("local_only_auth")})}catch(h){console.warn("Error during security context cleanup:",h)}localStorage.removeItem("last_email"),localStorage.removeItem("current_user_email"),localStorage.removeItem("auth_user_email"),localStorage.removeItem("local_only_auth"),localStorage.removeItem("mata_active_user");try{window.dispatchEvent(new CustomEvent("MATA_APP_EVENT",{detail:{type:"CLEAR_ACTIVE_USER",requestId:`clear_active_user_${Date.now()}`}})),console.log("🔄 Requested extension to explicitly clear mata_active_user"),window.dispatchEvent(new CustomEvent("MATA_APP_EVENT",{detail:{type:"SYNC_STORAGE",requestId:`logout_sync_${Date.now()}`}})),console.log("🔄 Requested extension to sync storage after logout")}catch(h){console.warn("⚠️ Could not notify extension to clear mata_active_user and sync storage:",h)}console.log("🧹 Manual cleanup completed as fallback, including local-only auth flag and mata_active_user")}if(localStorage.setItem("last_logout_timestamp",Date.now().toString()),console.log("Setting persistent logout timestamp for cross-session security"),f)try{const{getSanitizedEmail:v}=await oe(async()=>{const{getSanitizedEmail:x}=await Promise.resolve().then(()=>Ge);return{getSanitizedEmail:x}},void 0),h=v(f);localStorage.setItem(`last_session_email_${h}`,f),console.log(`📝 Saved last session email in standardized secure format for: ${f}`)}catch(v){console.warn("⚠️ Could not save last session email:",v)}console.log("✅ Enhanced secure logout complete - proper user isolation maintained")}catch(f){throw console.error("Logout error:",f),f}},onSuccess:async()=>{Qo.setQueryData(["/api/user"],null),console.log("Logout complete - UI updated");try{if(gr()){const{stopExtensionSync:f}=await oe(async()=>{const{stopExtensionSync:p}=await Promise.resolve().then(()=>gi);return{stopExtensionSync:p}},void 0);console.log("Stopping extension sync system..."),f()}}catch(f){console.warn("Failed to stop extension sync system:",f)}t({title:"Logged out",description:"You have been securely logged out."})},onError:f=>{console.error("Logout mutation error:",f),t({title:"Logout failed",description:f.message,variant:"destructive"})}});return a.jsx(Cj.Provider,{value:{user:s??null,isLoading:i,error:o,loginMutation:c,logoutMutation:m,registerMutation:u,verifyCodeMutation:d,autoLoginAttempted:n},children:e})}function Bo(){const e=w.useContext(Cj);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}const I5={isOffline:!1,hasPendingChanges:!1,pendingOperationsCount:0,checkConnection:()=>!0,syncPendingChanges:async()=>!1},Nj=w.createContext(I5);function T5({children:e}){const[t,n]=w.useState(!Ts()),[r,s]=w.useState(!1),[o,i]=w.useState(0),l=w.useCallback(()=>{const d=Ts();async function m(){try{const f=new AbortController,p=setTimeout(()=>f.abort(),3e3),v=await fetch("/manifest.json?nocache="+Date.now(),{method:"HEAD",cache:"no-store",signal:f.signal});return clearTimeout(p),v.ok?(t&&(console.log("Network test passed, device is online"),n(!1)),!0):(console.log("Network test returned error status",v.status),n(!1),!0)}catch(f){return console.log("Network test failed, device is likely offline:",f),n(!0),!1}}return n(!d),d&&m(),d},[t]),c=w.useCallback(async()=>{if(t)return console.log("Cannot sync pending changes while offline"),!1;try{return console.log("Manually triggering sync of pending changes"),JSON.parse(localStorage.getItem("offline_operation_queue")||"[]").length===0?(s(!1),i(0),!0):(await new Promise(m=>setTimeout(m,1500)),localStorage.setItem("offline_operation_queue","[]"),s(!1),i(0),!0)}catch(d){return console.error("Error syncing pending changes:",d),!1}},[t]);w.useEffect(()=>{const d=()=>{console.log("Connection restored"),l();const v=JSON.parse(localStorage.getItem("offline_operation_queue")||"[]");v.length>0&&(s(!0),i(v.length))},m=()=>{console.log("Connection lost"),n(!0)},f=v=>{if(v.key==="offline_operation_queue")try{const h=JSON.parse(v.newValue||"[]");s(h.length>0),i(h.length)}catch(h){console.error("Error parsing offline queue:",h)}};l();try{const v=JSON.parse(localStorage.getItem("offline_operation_queue")||"[]");s(v.length>0),i(v.length)}catch(v){console.error("Error parsing offline queue:",v)}const p=setInterval(()=>{l()},3e4);return window.addEventListener("online",d),window.addEventListener("offline",m),window.addEventListener("storage",f),window.addEventListener("connection-status-change",v=>{v.detail&&typeof v.detail.online=="boolean"&&n(!v.detail.online)}),iN(),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",m),window.removeEventListener("storage",f),window.removeEventListener("connection-status-change",v=>{}),clearInterval(p),lN()}},[l]),w.useEffect(()=>{var m;const d=f=>{f.data&&f.data.type==="OFFLINE_SYNC_ATTEMPTED"?(console.log("Received sync attempt message from service worker:",f.data),f.data.success&&(s(!1),i(0))):f.data&&f.data.type==="OFFLINE_OPERATION_QUEUED"&&(console.log("Received operation queued message from service worker:",f.data),i(p=>p+1),s(!0))};return(m=navigator.serviceWorker)==null||m.addEventListener("message",d),()=>{var f;(f=navigator.serviceWorker)==null||f.removeEventListener("message",d)}},[]);const u={isOffline:t,hasPendingChanges:r,pendingOperationsCount:o,checkConnection:l,syncPendingChanges:c};return a.jsx(Nj.Provider,{value:u,children:e})}function Pv(){const e=w.useContext(Nj);if(e===void 0)throw new Error("useOffline must be used within an OfflineProvider");return e}function A5({path:e,component:t}){const{user:n,isLoading:r}=Bo();return r?a.jsx(di,{path:e,children:a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(it,{className:"h-8 w-8 animate-spin text-border"})})}):n?a.jsx(di,{path:e,component:t}):a.jsx(di,{path:e,children:a.jsx(vM,{to:"/auth"})})}const $_="mata-extension-marker",O_="mata_extension_ready",P5="mata_extension_to_app_event";function D5(e){const t=document.createElement("div");t.style.display="none",t.innerHTML=e.trim();const n=t.firstChild;return n?(document.body.appendChild(n),n):null}function jj(){try{if(document.getElementById($_))return console.log("Extension marker already exists in DOM"),!0;const e=`<div id="${$_}" data-extension-id="gdpmifcdboedgecfhiahpckkclibadmm" data-version="1.0.3" style="display:none;"></div>`;return D5(e)?(console.log("Injected extension marker into DOM"),window.dispatchEvent(new CustomEvent(O_,{detail:{type:"EXTENSION_READY",extensionId:"gdpmifcdboedgecfhiahpckkclibadmm",version:"1.0.3",timestamp:Date.now()}})),setTimeout(()=>{window.dispatchEvent(new CustomEvent(O_,{detail:{type:"EXTENSION_READY",extensionId:"gdpmifcdboedgecfhiahpckkclibadmm",version:"1.0.3",timestamp:Date.now()}})),window.dispatchEvent(new CustomEvent(P5,{detail:{type:"CHECK_EXTENSION_RESPONSE",success:!0,version:"1.0.3",extensionId:"gdpmifcdboedgecfhiahpckkclibadmm",timestamp:Date.now()}}))},50),!0):!1}catch(e){return console.error("Error force injecting extension marker:",e),!1}}function Mg(){try{try{window.mata_extension_connected=!0,window.MATA_EXTENSION_ID="gdpmifcdboedgecfhiahpckkclibadmm"}catch(e){console.warn("Could not set primary extension flags (they may be read-only):",e),window._mata_extension_connected_status=!0,window._mata_extension_id_value="gdpmifcdboedgecfhiahpckkclibadmm"}window._mataExtensionInstalled=!0,window._mataExtensionTimestamp=Date.now(),window.localStorage.setItem("extension_known_installed","true"),window.localStorage.setItem("extension_id","gdpmifcdboedgecfhiahpckkclibadmm"),window.localStorage.setItem("extension_timestamp",Date.now().toString()),console.log("Set extension window flags and localStorage backup")}catch(e){console.error("Error setting extension window flags:",e)}}async function Ij(){try{Mg();const e=jj();return await new Promise(t=>setTimeout(t,50)),Mg(),e}catch(e){return console.error("Error in forceExtensionConnection:",e),!1}}const zg="mata_extension_connected",Tj="MATA_APP_EVENT",pi="MATA_EXTENSION_RESPONSE";let Dv=0;const R5=6e4,$5=3;let fc=0;function To(){const e=Date.now();Dv=e,window.localStorage.setItem("extension_last_active",String(e)),window.localStorage.setItem("extension_last_verification",String(e)),fc=0,console.debug(`Extension active response recorded at ${new Date(e).toISOString()}`)}function ho(){try{const e=document.getElementById("mata-extension-marker");e&&e.parentNode&&e.parentNode.removeChild(e);try{window[zg]&&(window[zg]=!1),window._mata_extension_connected_status=!1,window._mataExtensionInstalled=!1,window._mataExtensionTimestamp=0}catch(t){console.warn("Unable to clear extension_connected flag - it may be read-only",t),window._mata_extension_disconnected=!0}try{window.MATA_EXTENSION_ID=void 0,window._mata_extension_id_value=void 0}catch(t){console.warn("Unable to clear extension ID - it may be read-only",t)}window.localStorage.removeItem("extension_last_active"),window.localStorage.removeItem("extension_last_verification"),window.localStorage.removeItem("extension_id"),window.localStorage.removeItem("extension_version"),window.localStorage.removeItem("extension_connected"),window.localStorage.removeItem("extension_accounts"),Dv=0,fc=0,window.localStorage.setItem("extension_markers_cleared",String(Date.now())),console.log("Extension detection markers cleared")}catch(e){console.error("Error while clearing extension markers:",e)}}const O5=5e3;let Yh=0,cd=null;async function Nf(){const e=Date.now();return e-Yh<O5&&cd?(console.log(`Throttled active extension verification, returning cached result (last check ${e-Yh}ms ago)`),cd):(Yh=e,fc++,cd=(async()=>{try{const t=await Ao("CHECK_EXTENSION",{verify:!0},3e3);if(t&&t.success)return To(),!0;throw new Error("Extension verification failed")}catch(t){throw fc>=$5&&(console.warn("Extension verification failed multiple times, clearing markers"),ho(),fc=0),t}})(),cd)}const M5=5e3;let Qh=0,M_=!1;function Lr(){var e;try{if(window._mata_extension_disconnected===!0)return!1;const t=window.localStorage.getItem("extension_last_active");if(t){const i=parseInt(t,10);if(Date.now()-i<R5)return!0}const n=!!document.getElementById("mata-extension-marker"),r=!!window[zg]||!!window._mata_extension_connected_status,s=!!window.MATA_EXTENSION_ID||!!window._mata_extension_id_value||!!window.localStorage.getItem("extension_id"),o=n||r||s;if(console.log("Extension installed check:",o,{domMarkerExists:n,extensionDetails:n?(e=document.getElementById("mata-extension-marker"))==null?void 0:e.getAttribute("data-extension-id"):null,flagExists:r,extensionId:Uc(),hasExtensionFingerprints:o}),o&&!Dv)try{const i=window.localStorage.getItem("extension_markers_cleared"),l=i?parseInt(i,10):0;if(Date.now()-l<6e4)return console.log("Extension markers were cleared recently, not trusting static markers"),!1;const c=n&&r||n&&s||r&&s,u=Date.now();if(u-Qh>=M5)Qh=u,setTimeout(()=>{Nf().catch(()=>{ho()})},0);else return console.log(`Throttled extension verification, skipping (last check was ${u-Qh}ms ago)`),c&&M_;return M_=c,c}catch(i){return console.warn("Error checking extension markers:",i),!1}return!1}catch(t){return console.error("Error checking extension installation:",t),!1}}function Uc(){var e,t;try{const n=document.getElementById("mata-extension-marker");if(n){const s=n.getAttribute("data-extension-id");if(s)return s}if(window.MATA_EXTENSION_ID)return window.MATA_EXTENSION_ID;if(window._mata_extension_id_value)return window._mata_extension_id_value;const r=window.localStorage.getItem("extension_id");return r||((t=(e=window.chrome)==null?void 0:e.runtime)!=null&&t.id?window.chrome.runtime.id:"gdpmifcdboedgecfhiahpckkclibadmm")}catch(n){return console.error("Error getting extension ID:",n),"gdpmifcdboedgecfhiahpckkclibadmm"}}function Rv(){return Math.random().toString(36).substring(2,15)}function Ao(e,t,n=3e3){return new Promise((r,s)=>{try{if(!Lr())try{Mg(),jj()}catch(l){console.warn("Attempted to force extension connection before sending message",l)}const o=Rv(),i=l=>{var c,u;((c=l.detail)==null?void 0:c.requestId)===o&&(window.removeEventListener(pi,i),(u=l.detail)!=null&&u.error?s(new Error(l.detail.error)):r(l.detail))};window.addEventListener(pi,i),window.dispatchEvent(new CustomEvent(Tj,{detail:{type:e,requestId:o,data:t,timestamp:Date.now(),source:"extensionTestUtils",version:"1.0.3"}})),setTimeout(()=>{window.removeEventListener(pi,i),e==="CHECK_EXTENSION"||e==="LIST_ACCOUNTS"?r({success:!1,requestId:o,error:"Timeout waiting for extension response",partial:!0}):s(new Error("Timeout waiting for extension response"))},n)}catch(o){s(o)}})}async function Bc(){try{const e=Lr(),t=Uc();if(!e)return{success:!1,error:"Extension not detected",id:t};const n=await Ao("CHECK_EXTENSION");return To(),localStorage.setItem("extension_last_verification",Date.now().toString()),{success:!0,version:n.version,id:n.id||t}}catch(e){return{success:!1,error:String(e),id:Uc()}}}async function Aj(){try{const e={testId:Rv(),timestamp:Date.now(),value:"Storage Test Data"},t=await Ao("CHECK_EXTENSION",e);return t&&t.success?(To(),localStorage.setItem("extension_last_verification",Date.now().toString()),{success:!0,data:t.data||t}):t.data?(To(),localStorage.setItem("extension_last_verification",Date.now().toString()),{success:!0,data:t.data}):{success:!1,error:"Storage test failed or no response from extension"}}catch(e){return{success:!1,error:String(e)}}}async function Pj(){try{const e=window.localStorage.getItem("extension_last_active"),t=e?parseInt(e,10):0;Date.now()-t>12e4&&(console.log("Extension markers are stale, clearing them before testing"),ho());try{await Nf()}catch{console.log("Active extension verification failed, clearing all detection markers"),ho()}const n=Lr();if(!n)return{installed:!1,connection:{success:!1,error:"Extension not installed or detected"}};const r=await Bc();if(!r.success)return console.log("Connection test failed, clearing all extension detection markers"),ho(),{installed:!1,connection:{success:!1,error:r.error||"Connection test failed"}};let s;r.success&&(s=await Aj());let o;try{o=await new Promise(i=>{const l=c=>{window.removeEventListener(pi,l),i({success:!0}),To()};window.addEventListener(pi,l),window.dispatchEvent(new CustomEvent(Tj,{detail:{type:"CHECK_EXTENSION",requestId:Rv(),timestamp:Date.now(),testData:{value:"Test data for extension",source:"extensionTestUtils.runExtensionTests"}}})),setTimeout(()=>{window.removeEventListener(pi,l),i({success:!1,error:"Timeout waiting for event response"})},1500)})}catch(i){o={success:!1,error:String(i)}}return r.success&&To(),{installed:n,connection:r,storage:s,customEvents:o}}catch(e){return console.error("Extension tests failed with error:",e),ho(),{installed:!1,connection:{success:!1,error:String(e)}}}}const z_=3,z5=[2e3,5e3,1e4],L5=15e3,$e={connected:!1,lastAttempt:0,retryCount:0,pendingAttempt:!1};async function Qn(e={}){const{force:t=!1,timeout:n=L5,silent:r=!1,retryCount:s=0}=e;if(s>=z_)return r||console.error("Extension connection failed after maximum retries"),{success:!1,error:"Maximum retries exceeded"};if(Lr()||$e.connected&&(console.log("Extension is not installed but was marked as connected - resetting state"),$e.connected=!1,$e.extensionId=void 0,$e.version=void 0,localStorage.removeItem("extension_connected"),localStorage.removeItem("extension_id"),localStorage.removeItem("extension_version"),window.dispatchEvent(new CustomEvent("extension_disconnected",{detail:{reason:"extension_not_installed"}}))),$e.connected&&!t)return r||console.log("Extension already connected, skipping connection attempt"),{success:!0,extensionId:$e.extensionId,version:$e.version};if($e.pendingAttempt&&!t)return r||console.log("Extension connection already in progress"),{success:!1,error:"Connection attempt already in progress"};$e.pendingAttempt=!0,$e.lastAttempt=Date.now();try{if(Lr()){r||console.log("Extension appears to be installed, testing connection...");try{const i=Bc(),l=new Promise((u,d)=>setTimeout(()=>d(new Error("Connection timed out")),n)),c=await Promise.race([i,l]);if(c.success)return r||console.log("Extension connection successful! Version:",c.version),$e.connected=!0,$e.pendingAttempt=!1,$e.extensionId=Uc(),$e.version=c.version,localStorage.setItem("extension_connected","true"),localStorage.setItem("extension_connected_at",Date.now().toString()),localStorage.setItem("extension_last_verification",Date.now().toString()),$e.extensionId&&localStorage.setItem("extension_id",$e.extensionId),$e.version&&localStorage.setItem("extension_version",$e.version),window.dispatchEvent(new CustomEvent("extension_connected",{detail:{success:!0,extensionId:$e.extensionId,version:$e.version}})),{success:!0,extensionId:$e.extensionId,version:$e.version}}catch{r||console.warn("Basic connection test failed, will try force methods")}}r||console.log("Force connecting to extension..."),await Ij();try{const i=await Bc();if(i.success)return r||console.log("Force connection successful! Version:",i.version),$e.connected=!0,$e.pendingAttempt=!1,$e.extensionId=Uc(),$e.version=i.version,localStorage.setItem("extension_connected","true"),localStorage.setItem("extension_connected_at",Date.now().toString()),localStorage.setItem("extension_last_verification",Date.now().toString()),$e.extensionId&&localStorage.setItem("extension_id",$e.extensionId),$e.version&&localStorage.setItem("extension_version",$e.version),window.dispatchEvent(new CustomEvent("extension_connected",{detail:{success:!0,extensionId:$e.extensionId,version:$e.version,forcedConnection:!0}})),{success:!0,extensionId:$e.extensionId,version:$e.version}}catch(i){r||console.warn("Force connection test failed:",i)}const o=z5[s]||5e3;return r||console.log(`Scheduling retry ${s+1}/${z_} in ${o}ms...`),$e.pendingAttempt=!1,new Promise(i=>{setTimeout(async()=>{const l=await Qn({force:!0,timeout:n,silent:r,retryCount:s+1});i(l)},o)})}catch(o){return console.error("Unexpected error during extension connection:",o),$e.pendingAttempt=!1,{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}function Dj(){setTimeout(()=>{Qn()},1e3),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&Qn()}),window.addEventListener("user_login",()=>{Qn({force:!0})}),window.addEventListener("storage",e=>{e.key&&(e.key.includes("extension")||e.key.includes("mata")||e.key==="user_logged_in")&&Qn()})}const F5=5e3;let Xh=0;function Xo(){const e=localStorage.getItem("extension_last_verification"),t=e?parseInt(e,10):0,n=Date.now()-t,r=t===0?"unknown":n>3e4?"stale":"verified",s=Date.now();r!=="verified"&&s-Xh>=F5?(console.log(`Extension verification ${r}, scheduling check...`),Xh=s,setTimeout(()=>{Qn({force:!0,silent:!0})},100)):r!=="verified"&&console.log(`Extension check throttled, skipping (last check was ${s-Xh}ms ago)`);const o=Lr();return!o&&$e.connected&&(console.log("Extension is not installed but was marked as connected - fixing state"),$e.connected=!1,$e.extensionId=void 0,$e.version=void 0,localStorage.removeItem("extension_connected"),localStorage.removeItem("extension_id"),localStorage.removeItem("extension_version"),window.dispatchEvent(new CustomEvent("extension_disconnected",{detail:{reason:"extension_not_installed"}}))),{connected:$e.connected&&o,extensionId:o?$e.extensionId:void 0,version:o?$e.version:void 0,lastAttempt:$e.lastAttempt,verificationState:r}}const V5=Object.freeze(Object.defineProperty({__proto__:null,autoConnectToExtension:Qn,getExtensionConnectionStatus:Xo,setupAutoConnect:Dj},Symbol.toStringTag,{value:"Module"}));async function Dd(e){if(!gr())throw new Error("Extension not installed, cannot access localStorage");if(!e)throw new Error("No key provided to retrieve from localStorage");try{console.log(`Requesting localStorage value for ${e} via extension...`);const t=await Rr({type:"GET_LOCAL_STORAGE_VALUE",key:e});if(t&&t.success)return t.value;{const n=(t==null?void 0:t.error)||"Unknown error";return console.error(`Failed to get localStorage value: ${n}`),null}}catch(t){throw console.error("Error getting localStorage value via extension:",t),t}}function jf(e){if(!e.email)throw new Error("Cannot convert to AppUserKeys: email field is missing");return{email:e.email,publicKey:e.publicKey,encryptedPrivateKey:e.encryptedPrivateKey,salt:e.salt,hash:e.hash,id:e.id,firstName:e.firstName,isVerified:e.isVerified}}const Rd=new Map,Lg="mata_sync_records",U5=12e4;let $d=null,Jh=!1;const Fn="mata_keys_",po="mata_salt_",L_=3,Rn=new Map;function B5(){if(!gr()){console.log("Extension not installed, sync system not initialized");return}console.log("Initializing extension sync system"),Rj(),setTimeout(()=>{console.log("Performing initial extension sync"),hc().then(()=>console.log("Initial extension sync completed")).catch(e=>console.error("Error during initial extension sync:",e))},1500),$d=window.setInterval(()=>{hc().catch(e=>console.error("Error during scheduled extension sync:",e))},U5),window.addEventListener("storage",e=>{var t,n;((t=e.key)!=null&&t.startsWith(Fn)||(n=e.key)!=null&&n.startsWith(po))&&(console.log(`Storage event detected for ${e.key}`),K5(e.key,e.newValue))}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(console.log("Tab became visible, triggering extension sync"),hc())}),console.log("Extension sync system initialized")}function Rj(){$d&&(clearInterval($d),$d=null)}function mc(e,t,n){try{const r=JSON.parse(localStorage.getItem(Lg)||"[]"),s=n?`user_${n.replace(/[^a-zA-Z0-9]/g,"_")}`:void 0,o=n?btoa(`${e}:${t}:${n}:${Date.now()}`.slice(0,50)):void 0;r.push({type:e,key:t,timestamp:Date.now(),email:n,namespace:s,securityHash:o});const i=r.slice(-100);localStorage.setItem(Lg,JSON.stringify(i)),console.log(`Change recorded: ${e} for ${n||"unknown"}`)}catch(r){console.error("Error recording change:",r)}}async function K5(e,t){if(Rd.has(e)){Rd.delete(e);return}if(!(!e.startsWith(Fn)&&!e.startsWith(po)))try{let n;if(e.startsWith(Fn))n=e.slice(Fn.length);else if(e.startsWith(po))n=e.slice(po.length);else return;if(t===null)mc("delete",e,n);else if(e.startsWith(Fn)){const r=JSON.parse(t);if(an(r)){mc(r.id?"update":"add",e,n),console.log(`Syncing updated user keys for ${n} to extension`),r.email||(r.email=n);try{const s=jf(r);await Xi(s)}catch(s){console.error(`Failed to convert user keys for ${n}:`,s)}}}else if(e.startsWith(po)){console.log(`Salt data updated for ${n}, looking for matching user keys`),mc("update",e,n);const r=[`${Fn}${n}`,`${Fn}${n.toLowerCase()}`,`${Fn}${n.toLowerCase().replace(/[^a-zA-Z0-9]/g,"_")}`];let s=!1;for(const o of r){const i=localStorage.getItem(o);if(i)try{const l=JSON.parse(i);if(an(l)){console.log(`Found matching user keys for ${n}, updating salt and syncing`);const c=JSON.parse(t);if(typeof c=="string"&&l.salt!==c){l.salt=c,console.log(`Updated salt value in user keys for ${n}`),Rd.set(o,!0),localStorage.setItem(o,JSON.stringify(l)),l.email||(l.email=n);try{const u=jf(l);await Xi(u)}catch(u){console.error(`Failed to convert user keys for ${n}:`,u)}s=!0;break}}}catch(l){console.error(`Error parsing user keys for ${n}:`,l)}}s||(console.log(`No matching user keys found for ${n} salt update, triggering full sync`),await hc())}}catch(n){console.error("Error handling storage change:",n)}}async function hc(){if(!gr()){console.log("Extension not installed, skipping sync");return}if(Jh){console.log("Sync already in progress, skipping this request");return}Jh=!0;try{console.log("Starting extension sync process");let e=[],t=0;const n=3;for(;t<n;)try{e=await aj();break}catch(h){if(t++,console.warn(`Extension accounts fetch failed (attempt ${t}/${n}):`,h),t>=n)throw new Error(`Failed to get extension accounts after ${n} attempts: ${h instanceof Error?h.message:"Unknown error"}`);await new Promise(x=>setTimeout(x,500*t))}const r=new Set(e.map(h=>h.email));console.log(`Found ${r.size} accounts in extension`);const s={},o={},i=new Set,l=new Set,c=localStorage.getItem("current_user_context");for(let h=0;h<localStorage.length;h++){const x=localStorage.key(h);if(x&&x.startsWith(Fn)){const y=x.slice(Fn.length);if(!/^[a-zA-Z0-9_]+$/.test(y)){console.warn(`Skipping non-sanitized key format: ${x} - this format is deprecated`);continue}try{const g=JSON.parse(localStorage.getItem(x)||"{}");an(g)&&g.email?g.email.toLowerCase().trim().replace(/[^a-zA-Z0-9]/g,"_")===y?(i.add(y),s[y]=g):(console.warn(`🔒 SECURITY: User isolation violation - key:${x} contains data for ${g.email}`),l.add(x)):(console.warn(`Invalid user keys format for ${y}`),l.add(x))}catch(g){console.error(`Error parsing user data for ${y}:`,g),l.add(x)}}}for(let h=0;h<localStorage.length;h++){const x=localStorage.key(h);if(x&&x.startsWith(po)){const y=x.slice(po.length);if(!/^[a-zA-Z0-9_]+$/.test(y)){console.warn(`Skipping non-sanitized salt key format: ${x} - this format is deprecated`);continue}try{if(i.has(y)){const g=localStorage.getItem(x);g&&(o[y]=g,console.log(`Found salt data for ${y}`))}}catch(g){console.error(`Error processing salt data for ${y}:`,g)}}}console.log(`Found ${i.size} valid user accounts in localStorage`),console.log(`Found ${Object.keys(o).length} salt entries for these accounts`),l.size>0&&console.warn(`Found ${l.size} invalid user key entries - these will not be synced`);const u=Array.from(r).filter(h=>!i.has(h)).map(async h=>{try{if(console.log(`Syncing ${h} from extension to localStorage`),Rn.get(h)&&Rn.get(h)>=L_)return console.warn(`Skipping sync for ${h} due to too many previous errors`),!1;const x=await Pm(h);if(x&&an(x)&&x.email===h){Rd.set(`${Fn}${h}`,!0);const y=`${Fn}${h}`;return localStorage.setItem(y,JSON.stringify(x)),Rn.set(h,0),console.log(`Successfully synced keys for ${h} from extension to localStorage`),!0}else return console.warn(`Invalid or mismatched keys for ${h} from extension`),Rn.set(h,(Rn.get(h)||0)+1),!1}catch(x){return console.error(`Error syncing keys for ${h} from extension:`,x),Rn.set(h,(Rn.get(h)||0)+1),!1}}),m=(await Promise.allSettled(u)).filter(h=>h.status==="fulfilled"&&h.value===!0).length;console.log(`Synced ${m}/${u.length} accounts from extension to localStorage`);const f=Array.from(i).filter(h=>!r.has(h)||W5(h)).map(async h=>{try{if(console.log(`Syncing ${h} from localStorage to extension`),Rn.get(h)&&Rn.get(h)>=L_)return console.warn(`Skipping sync for ${h} due to too many previous errors`),!1;const x=s[h],y=o[h];if(x&&x.email===h){y&&x.salt!==y&&(console.log(`Merging separate salt data for ${h} during sync`),x.salt=y);let g=!1;x.email||(x.email=h);try{const _=jf(x);g=await Xi(_)}catch(_){console.error(`Failed to convert user keys for ${h}:`,_)}return g?(Rn.set(h,0),console.log(`Successfully synced keys for ${h} from localStorage to extension`),!0):(console.warn(`Failed to sync keys for ${h} to extension`),Rn.set(h,(Rn.get(h)||0)+1),!1)}else return console.warn(`No valid user data for ${h} in localStorage or namespace mismatch`),!1}catch(x){return console.error(`Error syncing keys for ${h} to extension:`,x),Rn.set(h,(Rn.get(h)||0)+1),!1}}),v=(await Promise.allSettled(f)).filter(h=>h.status==="fulfilled"&&h.value===!0).length;console.log(`Synced ${v}/${f.length} accounts from localStorage to extension`),console.log("Extension sync completed successfully")}catch(e){throw console.error("Error during extension sync:",e),e}finally{Jh=!1}}function W5(e){try{return JSON.parse(localStorage.getItem(Lg)||"[]").filter(r=>r.email===e&&Date.now()-r.timestamp<864e5).length>0}catch(t){return console.error("Error checking sync status:",t),!0}}async function Wr(e){var r;if(!gr())return console.log("Extension not installed, cannot sync keys"),!1;const n=e.toLowerCase().trim().replace(/[@.]/g,"_");try{const s=`${Fn}${n}`,o=`${po}${n}`,i="mata_active_user";console.log("Checking mata_active_user from localStorage via extension...");let l=null;try{l=await Dd(i),console.log(`Active user from extension localStorage: ${l||"not found"}`),l&&l!==n&&(console.warn(`Active user mismatch: extension has ${l} but trying to sync ${n}`),console.log("Updating local storage with extension's active user value"),localStorage.setItem(i,l))}catch(f){console.warn("Failed to get active user from extension:",f)}console.log(`Looking for user keys with sanitized format: ${s}`);let c=null;try{c=await Dd(s),console.log(`User keys from extension localStorage: ${c?"found":"not found"}`)}catch(f){console.warn("Failed to get user keys from extension:",f)}c||(c=localStorage.getItem(s),console.log(`User keys from local localStorage: ${c?"found":"not found"}`)),console.log(`Looking for user salt with sanitized format: ${o}`);let u=null;try{u=await Dd(o),console.log(`User salt from extension localStorage: ${u?"found":"not found"}`)}catch(f){console.warn("Failed to get user salt from extension:",f)}u||(u=localStorage.getItem(o),console.log(`User salt from local localStorage: ${u?"found":"not found"}`));let d=c?s:"",m=u?o:"";if(c||console.log(`No user keys found with sanitized format: ${s}`),!c)return console.error(`No keys found for user ${n} in sanitized format`),!1;u||console.warn(`No salt data found for user ${n} in sanitized format - continuing anyway`);try{const f=JSON.parse(c);if(!an(f))return console.error(`Invalid keys format for user ${n}:`,typeof f=="object"?`Missing fields: ${Object.keys(f||{}).join(", ")}`:`Not an object: ${typeof f}`),!1;const p=(r=f.email)==null?void 0:r.toLowerCase(),v=p==null?void 0:p.replace(/[@.]/g,"_");if(p&&!(v===n))return console.log(`Sanitized values: fromKeys=${v}, requested=${n}`),console.error(`Email mismatch: Keys belong to ${v} but requested for ${n}`),!1;if(u)try{const y=JSON.parse(u);y&&typeof y=="string"&&(console.log(`Using separate salt data for ${n} in extension sync`),f.salt!==y&&(console.log("Updating salt in user keys to match stored salt value"),f.salt=y))}catch(y){console.warn(`Error parsing salt data for ${n}, using key salt only:`,y)}console.log(`Attempting to store keys for ${n} in extension`),f.email||(f.email=n);let x=!1;try{const y=jf(f);x=await Xi(y)}catch(y){console.error(`Failed to convert user keys for ${n}:`,y)}return x?(console.log(`Successfully synced keys for ${n} to extension`),mc("update",d,n),m&&mc("update",m,n),!0):(console.error(`Extension returned failure when storing keys for ${n}`),!1)}catch(f){return console.error(`Error parsing user data for ${n}:`,f),!1}}catch(s){return console.error(`Error force syncing user ${n} to extension:`,s),!1}}async function H5(e){if(!gr())return console.log("Extension not installed, sync status check failed"),!1;const n=e.toLowerCase().trim().replace(/[@.]/g,"_");try{const r=`${Fn}${n}`;console.log(`Looking for local user keys with sanitized format: ${r}`);let s=localStorage.getItem(r);if(!s)return console.log(`No local keys found with sanitized format: ${r}`),console.error(`No local keys found for user ${n} in sanitized format`),!1;console.log(`Requesting extension keys for sanitized email: ${n}`);const o=await Pm(n);if(!o)return console.error(`No extension keys found for user ${n} in sanitized format`),!1;try{if(!s)return console.error("Local data is unexpectedly null at comparison step"),!1;const i=JSON.parse(s);console.log("Comparing local keys to extension keys:",{localEmail:i.email,extensionEmail:o.email,localKeyFields:Object.keys(i),extensionKeyFields:Object.keys(o),publicKeyMatch:i.publicKey===o.publicKey,saltMatch:i.salt===o.salt});const l=i.email.toLowerCase().replace(/[@.]/g,"_"),c=o.email.toLowerCase().replace(/[@.]/g,"_"),u=i.email.toLowerCase()===o.email.toLowerCase()||l===c;return console.log(`Email comparison: Direct match: ${i.email.toLowerCase()===o.email.toLowerCase()}, Sanitized match: ${l===c}`),u&&i.publicKey===o.publicKey&&i.encryptedPrivateKey===o.encryptedPrivateKey&&i.salt===o.salt}catch(i){return console.error(`Error parsing user data for ${n}:`,i),!1}}catch(r){return console.error(`Error checking sync status for ${n}:`,r),!1}}const gi=Object.freeze(Object.defineProperty({__proto__:null,forceSyncUserToExtension:Wr,getLocalStorageValueViaExtension:Dd,initExtensionSync:B5,isUserSyncedWithExtension:H5,stopExtensionSync:Rj,syncWithExtension:hc},Symbol.toStringTag,{value:"Module"})),$v=bu("inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-tertiary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-tertiary text-white hover:bg-tertiary/90 shadow-sm",primary:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-gray-200 bg-white text-tertiary hover:bg-tertiary/5",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-tertiary/5 hover:text-tertiary text-quaternary",link:"text-tertiary underline-offset-4 hover:underline",tertiary:"bg-tertiary text-white hover:bg-tertiary/90 shadow-sm",quaternary:"bg-quaternary text-white hover:bg-quaternary/90 shadow-sm"},size:{default:"h-10 px-4 py-2 rounded-xl",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-full"}},defaultVariants:{variant:"default",size:"default"}}),ie=w.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...s},o)=>{const i=r?Ms:"button";return a.jsx(i,{className:ye($v({variant:t,size:n,className:e})),ref:o,...s})});ie.displayName="Button";const q5=3e4,G5=3e3,Z5=1e4,Y5=12e4;function $j({showControls:e=!1}){const[t,n]=w.useState(!1),[r,s]=w.useState(void 0),[o,i]=w.useState(void 0),[l,c]=w.useState(0),[u,d]=w.useState(!1),[m,f]=w.useState(!1),p=()=>{const x=Xo();n(x.connected),s(x.extensionId),i(x.version),c(x.lastAttempt)};async function v(){f(!0);try{if(!Xo().connected){console.log("Cannot sync keys - extension not connected"),Gn({title:"Extension Not Connected",description:"Cannot sync keys because the extension is not connected. Please connect the extension first.",variant:"destructive"});return}const y=localStorage.getItem("mata_active_user");if(y){console.log(`Found user in mata_active_user (sanitized format): ${y}`),console.log(`Attempting to sync keys for ${y}`);const j=`mata_keys_${y}`;if(!(localStorage.getItem(j)!==null)){console.error(`No keys found for ${y} in localStorage`),Gn({title:"No Keys Found",description:"No keys found for the current user. Please log in again to generate new keys.",variant:"destructive"});return}console.log(`Syncing with sanitized email from mata_active_user: ${y}`),await Wr(y)?(console.log(`Successfully synced keys for ${y} to extension`),Gn({title:"Keys Synchronized",description:"Successfully synced user keys to extension"})):(console.error(`Failed to sync keys for ${y} to extension`),Gn({title:"Sync Failed",description:"Failed to sync keys. Check browser console for details and try logging in again to refresh your keys.",variant:"destructive"}));return}const g=["current_user_email","userEmail","current_vault_user"];let _=null;for(const j of g){const P=localStorage.getItem(j);if(P){_=P,console.log(`Found user email in ${j}: ${P}`);break}}if(!_){console.error("No user email found in any storage location"),Gn({title:"No User Found",description:"No currently logged in user found to sync. Please log in first.",variant:"destructive"});return}const S=_.toLowerCase().trim(),E=S.replace(/[@.]/g,"_");console.log(`Found unsanitized email ${S}, sanitizing to ${E}`),localStorage.setItem("mata_active_user",E),console.log(`Attempting to sync keys for sanitized format: ${E}`);const A=`user_keys_${S}`,I=`user_keys_${E}`,N=localStorage.getItem(A)!==null,T=localStorage.getItem(I)!==null;if(!N&&!T){console.error(`No keys found for ${S} in localStorage`),Gn({title:"No Keys Found",description:"No keys found for the current user. Please log in again to generate new keys.",variant:"destructive"});return}console.log(`Syncing with normalized email: ${S}`);const $=await Wr(S);console.log(`Syncing with sanitized email: ${E}`);const M=await Wr(E);$||M?(console.log(`Successfully synced keys for ${_} to extension`),Gn({title:"Keys Synchronized",description:"Successfully synced user keys to extension"})):(console.error(`Failed to sync keys for ${_} to extension`),Gn({title:"Sync Failed",description:"Failed to sync keys. Check browser console for details and try logging in again to refresh your keys.",variant:"destructive"}))}catch(x){console.error("Error forcing key sync:",x),Gn({title:"Sync Error",description:`${x instanceof Error?x.message:String(x)}`,variant:"destructive"})}finally{f(!1)}}async function h(){d(!0);try{const x=await Qn({force:!0,timeout:1e4,silent:!1});x.success?(p(),Gn({title:"Connection Successful",description:`Connected to extension${x.version?` (v${x.version})`:""}`}),await v()):Gn({title:"Connection Failed",description:x.error||"Unable to connect to extension",variant:"destructive"})}catch(x){console.error("Error forcing connection:",x),Gn({title:"Connection Error",description:String(x),variant:"destructive"})}finally{d(!1)}}return w.useEffect(()=>{console.log("Initializing extension auto-connect system..."),(async()=>{const S=Xo();n(S.connected),s(S.extensionId),i(S.version),S.connected||(localStorage.removeItem("extension_connected"),localStorage.removeItem("extension_id"),localStorage.removeItem("extension_version"))})(),Qn({force:!0}).then(S=>{if(S.success){console.log("Initial connection successful"),p();const E=localStorage.getItem("mata_active_user");if(E)console.log(`Initial sync with sanitized email from localStorage: ${E}`),Wr(E).catch(A=>console.warn("Initial key sync failed:",A));else{const A=localStorage.getItem("current_user_email");if(A){const I=A.toLowerCase().trim().replace(/[@.]/g,"_");console.log(`Initial sync with sanitized email: ${I} (from ${A})`),localStorage.setItem("mata_active_user",I),Wr(I).catch(N=>console.warn("Initial key sync failed:",N))}}}else console.log("Initial connection attempt failed, continuing with auto-retry")}),Dj();const y=()=>{console.log("Extension connected event received"),p()},g=()=>{console.log("Extension disconnected event received"),n(!1),setTimeout(()=>{console.log("Attempting to reconnect after disconnection..."),Qn({force:!0})},Z5)},_=()=>{console.log("Login detected, ensuring extension connection..."),setTimeout(()=>{Qn({force:!0}).then(()=>{const S=localStorage.getItem("mata_active_user");if(S)console.log(`Login sync with sanitized email: ${S}`),Wr(S);else{const E=localStorage.getItem("current_user_email");if(E){const A=E.toLowerCase().trim().replace(/[@.]/g,"_");console.log(`Login sync with sanitized email: ${A} (from ${E})`),localStorage.setItem("mata_active_user",A),Wr(A)}}})},G5)};return window.addEventListener("extension_connected",y),window.addEventListener("extension_disconnected",g),window.addEventListener("user_login",_),()=>{window.removeEventListener("extension_connected",y),window.removeEventListener("extension_disconnected",g),window.removeEventListener("user_login",_)}},[]),w.useEffect(()=>{const x=setInterval(()=>{const y=Xo();y.connected!==t&&p(),localStorage.getItem("extension_connected")==="true"&&!y.connected&&(console.log("Extension connection lost, attempting to reconnect..."),Qn({force:!0}))},q5);return()=>clearInterval(x)},[t]),w.useEffect(()=>{const x=()=>{if(document.visibilityState==="visible"){const y=Xo();Date.now()-y.lastAttempt>5e3&&(console.log("Page became visible, checking extension connection..."),Qn())}};return document.addEventListener("visibilitychange",x),()=>{document.removeEventListener("visibilitychange",x)}},[]),w.useEffect(()=>{if(!t)return;const x=setInterval(()=>{const y=localStorage.getItem("mata_active_user");if(y)console.log(`Periodic sync with sanitized email: ${y}`),Wr(y).catch(g=>{console.warn("Periodic key sync failed:",g)});else{const g=localStorage.getItem("current_user_email");if(g){const _=g.toLowerCase().trim().replace(/[@.]/g,"_");console.log(`Periodic sync with sanitized email: ${_} (from ${g})`),localStorage.setItem("mata_active_user",_),Wr(_).catch(S=>{console.warn("Periodic key sync failed:",S)})}}},Y5);return()=>clearInterval(x)},[t]),e?a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-muted/50 p-4 rounded-md",children:[a.jsx("h3",{className:"text-sm font-medium mb-2",children:"Extension Connection"}),a.jsxs("div",{className:"text-sm mb-4",children:[a.jsxs("div",{className:"flex justify-between mb-1",children:[a.jsx("span",{children:"Status:"}),a.jsx("span",{className:t?"text-green-500":"text-red-500",children:t?"Connected":"Disconnected"})]}),o&&a.jsxs("div",{className:"flex justify-between mb-1",children:[a.jsx("span",{children:"Version:"}),a.jsx("span",{children:o})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(ie,{variant:"outline",size:"sm",disabled:u,onClick:h,children:[u?a.jsx(tr,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Connect"]}),a.jsxs(ie,{variant:"outline",size:"sm",disabled:m||!t,onClick:v,children:[m?a.jsx(nz,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(BN,{className:"mr-2 h-4 w-4"}),"Sync Keys"]})]})]})}):null}const Ov="1.6.1",Oj=`mata-extension-fixed-v${Ov}.zip`,tl=`/${Oj}`;function Vn(){return`v${Ov}`}function Mv(){return`Download Extension v${Ov}`}var Q5=Ak.useId||(()=>{}),X5=0;function Or(e){const[t,n]=w.useState(Q5());return xn(()=>{e||n(r=>r??String(X5++))},[e]),e||(t?`radix-${t}`:"")}var ep="focusScope.autoFocusOnMount",tp="focusScope.autoFocusOnUnmount",F_={bubbles:!1,cancelable:!0},J5="FocusScope",Mm=w.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:o,...i}=e,[l,c]=w.useState(null),u=vn(s),d=vn(o),m=w.useRef(null),f=qe(t,h=>c(h)),p=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(r){let h=function(_){if(p.paused||!l)return;const S=_.target;l.contains(S)?m.current=S:Gs(m.current,{select:!0})},x=function(_){if(p.paused||!l)return;const S=_.relatedTarget;S!==null&&(l.contains(S)||Gs(m.current,{select:!0}))},y=function(_){if(document.activeElement===document.body)for(const E of _)E.removedNodes.length>0&&Gs(l)};document.addEventListener("focusin",h),document.addEventListener("focusout",x);const g=new MutationObserver(y);return l&&g.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",x),g.disconnect()}}},[r,l,p.paused]),w.useEffect(()=>{if(l){U_.add(p);const h=document.activeElement;if(!l.contains(h)){const y=new CustomEvent(ep,F_);l.addEventListener(ep,u),l.dispatchEvent(y),y.defaultPrevented||(eL(oL(Mj(l)),{select:!0}),document.activeElement===h&&Gs(l))}return()=>{l.removeEventListener(ep,u),setTimeout(()=>{const y=new CustomEvent(tp,F_);l.addEventListener(tp,d),l.dispatchEvent(y),y.defaultPrevented||Gs(h??document.body,{select:!0}),l.removeEventListener(tp,d),U_.remove(p)},0)}}},[l,u,d,p]);const v=w.useCallback(h=>{if(!n&&!r||p.paused)return;const x=h.key==="Tab"&&!h.altKey&&!h.ctrlKey&&!h.metaKey,y=document.activeElement;if(x&&y){const g=h.currentTarget,[_,S]=tL(g);_&&S?!h.shiftKey&&y===S?(h.preventDefault(),n&&Gs(_,{select:!0})):h.shiftKey&&y===_&&(h.preventDefault(),n&&Gs(S,{select:!0})):y===g&&h.preventDefault()}},[n,r,p.paused]);return a.jsx(je.div,{tabIndex:-1,...i,ref:f,onKeyDown:v})});Mm.displayName=J5;function eL(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Gs(r,{select:t}),document.activeElement!==n)return}function tL(e){const t=Mj(e),n=V_(t,e),r=V_(t.reverse(),e);return[n,r]}function Mj(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function V_(e,t){for(const n of e)if(!nL(n,{upTo:t}))return n}function nL(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function rL(e){return e instanceof HTMLInputElement&&"select"in e}function Gs(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&rL(e)&&t&&e.select()}}var U_=sL();function sL(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=B_(e,t),e.unshift(t)},remove(t){var n;e=B_(e,t),(n=e[0])==null||n.resume()}}}function B_(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function oL(e){return e.filter(t=>t.tagName!=="A")}var np=0;function zv(){w.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??K_()),document.body.insertAdjacentElement("beforeend",e[1]??K_()),np++,()=>{np===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),np--}},[])}function K_(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Jr=function(){return Jr=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Jr.apply(this,arguments)};function zj(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function aL(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,o;r<s;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var Od="right-scroll-bar-position",Md="width-before-scroll-bar",iL="with-scroll-bars-hidden",lL="--removed-body-scroll-bar-size";function rp(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function cL(e,t){var n=w.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var uL=typeof window<"u"?w.useLayoutEffect:w.useEffect,W_=new WeakMap;function dL(e,t){var n=cL(null,function(r){return e.forEach(function(s){return rp(s,r)})});return uL(function(){var r=W_.get(n);if(r){var s=new Set(r),o=new Set(e),i=n.current;s.forEach(function(l){o.has(l)||rp(l,null)}),o.forEach(function(l){s.has(l)||rp(l,i)})}W_.set(n,e)},[e]),n}function fL(e){return e}function mL(e,t){t===void 0&&(t=fL);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var i=t(o,r);return n.push(i),function(){n=n.filter(function(l){return l!==i})}},assignSyncMedium:function(o){for(r=!0;n.length;){var i=n;n=[],i.forEach(o)}n={push:function(l){return o(l)},filter:function(){return n}}},assignMedium:function(o){r=!0;var i=[];if(n.length){var l=n;n=[],l.forEach(o),i=n}var c=function(){var d=i;i=[],d.forEach(o)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){i.push(d),u()},filter:function(d){return i=i.filter(d),n}}}};return s}function hL(e){e===void 0&&(e={});var t=mL(null);return t.options=Jr({async:!0,ssr:!1},e),t}var Lj=function(e){var t=e.sideCar,n=zj(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return w.createElement(r,Jr({},n))};Lj.isSideCarExport=!0;function pL(e,t){return e.useMedium(t),Lj}var Fj=hL(),sp=function(){},zm=w.forwardRef(function(e,t){var n=w.useRef(null),r=w.useState({onScrollCapture:sp,onWheelCapture:sp,onTouchMoveCapture:sp}),s=r[0],o=r[1],i=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,m=e.shards,f=e.sideCar,p=e.noIsolation,v=e.inert,h=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,g=e.gapMode,_=zj(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=f,E=dL([n,t]),A=Jr(Jr({},_),s);return w.createElement(w.Fragment,null,d&&w.createElement(S,{sideCar:Fj,removeScrollBar:u,shards:m,noIsolation:p,inert:v,setCallbacks:o,allowPinchZoom:!!h,lockRef:n,gapMode:g}),i?w.cloneElement(w.Children.only(l),Jr(Jr({},A),{ref:E})):w.createElement(y,Jr({},A,{className:c,ref:E}),l))});zm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};zm.classNames={fullWidth:Md,zeroRight:Od};var gL=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function yL(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=gL();return t&&e.setAttribute("nonce",t),e}function vL(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function xL(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var wL=function(){var e=0,t=null;return{add:function(n){e==0&&(t=yL())&&(vL(t,n),xL(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},_L=function(){var e=wL();return function(t,n){w.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Vj=function(){var e=_L(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},SL={left:0,top:0,right:0,gap:0},op=function(e){return parseInt(e||"",10)||0},bL=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[op(n),op(r),op(s)]},EL=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return SL;var t=bL(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},kL=Vj(),yi="data-scroll-locked",CL=function(e,t,n,r){var s=e.left,o=e.top,i=e.right,l=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(iL,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(yi,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Od,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Md,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Od," .").concat(Od,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Md," .").concat(Md,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(yi,`] {
    `).concat(lL,": ").concat(l,`px;
  }
`)},H_=function(){var e=parseInt(document.body.getAttribute(yi)||"0",10);return isFinite(e)?e:0},NL=function(){w.useEffect(function(){return document.body.setAttribute(yi,(H_()+1).toString()),function(){var e=H_()-1;e<=0?document.body.removeAttribute(yi):document.body.setAttribute(yi,e.toString())}},[])},jL=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;NL();var o=w.useMemo(function(){return EL(s)},[s]);return w.createElement(kL,{styles:CL(o,!t,s,n?"":"!important")})},Fg=!1;if(typeof window<"u")try{var ud=Object.defineProperty({},"passive",{get:function(){return Fg=!0,!0}});window.addEventListener("test",ud,ud),window.removeEventListener("test",ud,ud)}catch{Fg=!1}var La=Fg?{passive:!1}:!1,IL=function(e){return e.tagName==="TEXTAREA"},Uj=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!IL(e)&&n[t]==="visible")},TL=function(e){return Uj(e,"overflowY")},AL=function(e){return Uj(e,"overflowX")},q_=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Bj(e,r);if(s){var o=Kj(e,r),i=o[1],l=o[2];if(i>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},PL=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},DL=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Bj=function(e,t){return e==="v"?TL(t):AL(t)},Kj=function(e,t){return e==="v"?PL(t):DL(t)},RL=function(e,t){return e==="h"&&t==="rtl"?-1:1},$L=function(e,t,n,r,s){var o=RL(e,window.getComputedStyle(t).direction),i=o*r,l=n.target,c=t.contains(l),u=!1,d=i>0,m=0,f=0;do{var p=Kj(e,l),v=p[0],h=p[1],x=p[2],y=h-x-o*v;(v||y)&&Bj(e,l)&&(m+=y,f+=v),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&(Math.abs(m)<1||!s)||!d&&(Math.abs(f)<1||!s))&&(u=!0),u},dd=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},G_=function(e){return[e.deltaX,e.deltaY]},Z_=function(e){return e&&"current"in e?e.current:e},OL=function(e,t){return e[0]===t[0]&&e[1]===t[1]},ML=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},zL=0,Fa=[];function LL(e){var t=w.useRef([]),n=w.useRef([0,0]),r=w.useRef(),s=w.useState(zL++)[0],o=w.useState(Vj)[0],i=w.useRef(e);w.useEffect(function(){i.current=e},[e]),w.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var h=aL([e.lockRef.current],(e.shards||[]).map(Z_),!0).filter(Boolean);return h.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),h.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=w.useCallback(function(h,x){if("touches"in h&&h.touches.length===2||h.type==="wheel"&&h.ctrlKey)return!i.current.allowPinchZoom;var y=dd(h),g=n.current,_="deltaX"in h?h.deltaX:g[0]-y[0],S="deltaY"in h?h.deltaY:g[1]-y[1],E,A=h.target,I=Math.abs(_)>Math.abs(S)?"h":"v";if("touches"in h&&I==="h"&&A.type==="range")return!1;var N=q_(I,A);if(!N)return!0;if(N?E=I:(E=I==="v"?"h":"v",N=q_(I,A)),!N)return!1;if(!r.current&&"changedTouches"in h&&(_||S)&&(r.current=E),!E)return!0;var T=r.current||E;return $L(T,x,h,T==="h"?_:S,!0)},[]),c=w.useCallback(function(h){var x=h;if(!(!Fa.length||Fa[Fa.length-1]!==o)){var y="deltaY"in x?G_(x):dd(x),g=t.current.filter(function(E){return E.name===x.type&&(E.target===x.target||x.target===E.shadowParent)&&OL(E.delta,y)})[0];if(g&&g.should){x.cancelable&&x.preventDefault();return}if(!g){var _=(i.current.shards||[]).map(Z_).filter(Boolean).filter(function(E){return E.contains(x.target)}),S=_.length>0?l(x,_[0]):!i.current.noIsolation;S&&x.cancelable&&x.preventDefault()}}},[]),u=w.useCallback(function(h,x,y,g){var _={name:h,delta:x,target:y,should:g,shadowParent:FL(y)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(S){return S!==_})},1)},[]),d=w.useCallback(function(h){n.current=dd(h),r.current=void 0},[]),m=w.useCallback(function(h){u(h.type,G_(h),h.target,l(h,e.lockRef.current))},[]),f=w.useCallback(function(h){u(h.type,dd(h),h.target,l(h,e.lockRef.current))},[]);w.useEffect(function(){return Fa.push(o),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:f}),document.addEventListener("wheel",c,La),document.addEventListener("touchmove",c,La),document.addEventListener("touchstart",d,La),function(){Fa=Fa.filter(function(h){return h!==o}),document.removeEventListener("wheel",c,La),document.removeEventListener("touchmove",c,La),document.removeEventListener("touchstart",d,La)}},[]);var p=e.removeScrollBar,v=e.inert;return w.createElement(w.Fragment,null,v?w.createElement(o,{styles:ML(s)}):null,p?w.createElement(jL,{gapMode:e.gapMode}):null)}function FL(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const VL=pL(Fj,LL);var Lm=w.forwardRef(function(e,t){return w.createElement(zm,Jr({},e,{ref:t,sideCar:VL}))});Lm.classNames=zm.classNames;var UL=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Va=new WeakMap,fd=new WeakMap,md={},ap=0,Wj=function(e){return e&&(e.host||Wj(e.parentNode))},BL=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Wj(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},KL=function(e,t,n,r){var s=BL(t,Array.isArray(e)?e:[e]);md[n]||(md[n]=new WeakMap);var o=md[n],i=[],l=new Set,c=new Set(s),u=function(m){!m||l.has(m)||(l.add(m),u(m.parentNode))};s.forEach(u);var d=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(f){if(l.has(f))d(f);else try{var p=f.getAttribute(r),v=p!==null&&p!=="false",h=(Va.get(f)||0)+1,x=(o.get(f)||0)+1;Va.set(f,h),o.set(f,x),i.push(f),h===1&&v&&fd.set(f,!0),x===1&&f.setAttribute(n,"true"),v||f.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",f,y)}})};return d(t),l.clear(),ap++,function(){i.forEach(function(m){var f=Va.get(m)-1,p=o.get(m)-1;Va.set(m,f),o.set(m,p),f||(fd.has(m)||m.removeAttribute(r),fd.delete(m)),p||m.removeAttribute(n)}),ap--,ap||(Va=new WeakMap,Va=new WeakMap,fd=new WeakMap,md={})}},Lv=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=UL(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),KL(r,s,n,"aria-hidden")):function(){return null}},Fv="Dialog",[Hj,qj]=ms(Fv),[WL,Br]=Hj(Fv),Gj=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:o,modal:i=!0}=e,l=w.useRef(null),c=w.useRef(null),[u=!1,d]=as({prop:r,defaultProp:s,onChange:o});return a.jsx(WL,{scope:t,triggerRef:l,contentRef:c,contentId:Or(),titleId:Or(),descriptionId:Or(),open:u,onOpenChange:d,onOpenToggle:w.useCallback(()=>d(m=>!m),[d]),modal:i,children:n})};Gj.displayName=Fv;var Zj="DialogTrigger",Yj=w.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Br(Zj,n),o=qe(t,s.triggerRef);return a.jsx(je.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Bv(s.open),...r,ref:o,onClick:xe(e.onClick,s.onOpenToggle)})});Yj.displayName=Zj;var Vv="DialogPortal",[HL,Qj]=Hj(Vv,{forceMount:void 0}),Xj=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,o=Br(Vv,t);return a.jsx(HL,{scope:t,forceMount:n,children:w.Children.map(r,i=>a.jsx(_r,{present:n||o.open,children:a.jsx(_u,{asChild:!0,container:s,children:i})}))})};Xj.displayName=Vv;var If="DialogOverlay",Jj=w.forwardRef((e,t)=>{const n=Qj(If,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,o=Br(If,e.__scopeDialog);return o.modal?a.jsx(_r,{present:r||o.open,children:a.jsx(qL,{...s,ref:t})}):null});Jj.displayName=If;var qL=w.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Br(If,n);return a.jsx(Lm,{as:Ms,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(je.div,{"data-state":Bv(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),ka="DialogContent",eI=w.forwardRef((e,t)=>{const n=Qj(ka,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,o=Br(ka,e.__scopeDialog);return a.jsx(_r,{present:r||o.open,children:o.modal?a.jsx(GL,{...s,ref:t}):a.jsx(ZL,{...s,ref:t})})});eI.displayName=ka;var GL=w.forwardRef((e,t)=>{const n=Br(ka,e.__scopeDialog),r=w.useRef(null),s=qe(t,n.contentRef,r);return w.useEffect(()=>{const o=r.current;if(o)return Lv(o)},[]),a.jsx(tI,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xe(e.onCloseAutoFocus,o=>{var i;o.preventDefault(),(i=n.triggerRef.current)==null||i.focus()}),onPointerDownOutside:xe(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&o.preventDefault()}),onFocusOutside:xe(e.onFocusOutside,o=>o.preventDefault())})}),ZL=w.forwardRef((e,t)=>{const n=Br(ka,e.__scopeDialog),r=w.useRef(!1),s=w.useRef(!1);return a.jsx(tI,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var i,l;(i=e.onCloseAutoFocus)==null||i.call(e,o),o.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),o.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:o=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;((u=n.triggerRef.current)==null?void 0:u.contains(i))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),tI=w.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:o,...i}=e,l=Br(ka,n),c=w.useRef(null),u=qe(t,c);return zv(),a.jsxs(a.Fragment,{children:[a.jsx(Mm,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:o,children:a.jsx(ml,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Bv(l.open),...i,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(QL,{titleId:l.titleId}),a.jsx(JL,{contentRef:c,descriptionId:l.descriptionId})]})]})}),Uv="DialogTitle",nI=w.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Br(Uv,n);return a.jsx(je.h2,{id:s.titleId,...r,ref:t})});nI.displayName=Uv;var rI="DialogDescription",sI=w.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Br(rI,n);return a.jsx(je.p,{id:s.descriptionId,...r,ref:t})});sI.displayName=rI;var oI="DialogClose",aI=w.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Br(oI,n);return a.jsx(je.button,{type:"button",...r,ref:t,onClick:xe(e.onClick,()=>s.onOpenChange(!1))})});aI.displayName=oI;function Bv(e){return e?"open":"closed"}var iI="DialogTitleWarning",[YL,lI]=c4(iI,{contentName:ka,titleName:Uv,docsSlug:"dialog"}),QL=({titleId:e})=>{const t=lI(iI),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return w.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},XL="DialogDescriptionWarning",JL=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${lI(XL).contentName}}.`;return w.useEffect(()=>{var o;const s=(o=e.current)==null?void 0:o.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},cI=Gj,eF=Yj,uI=Xj,Kv=Jj,Wv=eI,Hv=nI,qv=sI,Gv=aI;const nn=cI,tF=uI,dI=w.forwardRef(({className:e,...t},n)=>a.jsx(Kv,{ref:n,className:ye("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));dI.displayName=Kv.displayName;const Gt=w.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(tF,{children:[a.jsx(dI,{}),a.jsxs(Wv,{ref:r,className:ye("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-100 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-xl",e),...n,children:[t,a.jsxs(Gv,{className:"absolute right-4 top-4 rounded-full opacity-70 ring-offset-background transition-opacity hover:opacity-100 hover:bg-tertiary/5 hover:text-tertiary p-1 focus:outline-none focus:ring-2 focus:ring-tertiary focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(zc,{className:"h-4 w-4 text-quaternary hover:text-tertiary"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Gt.displayName=Wv.displayName;const Zt=({className:e,...t})=>a.jsx("div",{className:ye("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Zt.displayName="DialogHeader";const cn=({className:e,...t})=>a.jsx("div",{className:ye("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});cn.displayName="DialogFooter";const Yt=w.forwardRef(({className:e,...t},n)=>a.jsx(Hv,{ref:n,className:ye("text-lg font-semibold leading-none tracking-tight",e),...t}));Yt.displayName=Hv.displayName;const Qt=w.forwardRef(({className:e,...t},n)=>a.jsx(qv,{ref:n,className:ye("text-sm text-muted-foreground",e),...t}));Qt.displayName=qv.displayName;function nF({open:e,onOpenChange:t}){return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"max-w-md",children:[a.jsxs(Zt,{children:[a.jsxs(Yt,{className:"flex items-center",children:[a.jsx(w_,{className:"mr-2 h-5 w-5 text-primary"}),"Chrome Extension Installation Guide"]}),a.jsxs(Qt,{children:["Follow these steps to install the MATA Chrome extension ",Vn()]})]}),a.jsxs("div",{className:"space-y-4 my-2",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-primary/10 rounded-full p-1 text-primary",children:a.jsx(ls,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Step 1: Download & Extract"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Extract the downloaded ZIP file to a folder of your choice."})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-primary/10 rounded-full p-1 text-primary",children:a.jsx(w_,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Step 2: Open Extensions Page"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Open Chrome and navigate to ",a.jsx("code",{children:"chrome://extensions"})," in the address bar."]})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-primary/10 rounded-full p-1 text-primary",children:a.jsx(_z,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Step 3: Enable Developer Mode"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Toggle on "Developer mode" in the top-right corner of the extensions page.'})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-primary/10 rounded-full p-1 text-primary",children:a.jsx(az,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Step 4: Load Unpacked Extension"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Click "Load unpacked" and select the folder where you extracted the ZIP file.'})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"bg-primary/10 rounded-full p-1 text-primary",children:a.jsx(LN,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Step 5: Verify Installation"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"The MATA extension should now appear in your extensions list. Refresh this page to connect."})]})]})]}),a.jsx(cn,{children:a.jsx(ie,{onClick:()=>t(!1),children:"Got it"})})]})})}function rF(){const[e,t]=w.useState("checking"),[n,r]=w.useState(!1),[s,o]=w.useState(0),[i,l]=w.useState(""),[c,u]=w.useState(""),[d,m]=w.useState(null),[f,p]=w.useState([]),[v,h]=w.useState(!1);w.useEffect(()=>{localStorage.getItem("extension_banner_dismissed")==="true"&&r(!1)},[]),w.useEffect(()=>{y()},[]);const x=()=>{r(!1),localStorage.setItem("extension_banner_dismissed","true")};async function y(){if(localStorage.getItem("extension_banner_dismissed")==="true"){r(!1);return}if(t("checking"),!Lr()){t("not-installed"),r(!0);return}try{const N=await Bc();if(!N.success){t("not-connected"),r(!0);return}l(N.version||""),u(N.id||"");try{const T=await Ao("LIST_ACCOUNTS");if(T.success&&T.accounts){const $=T.accounts;p($),o($.length);const M=localStorage.getItem("userEmail");m(M),$.length===0?(t("no-accounts"),r(!0)):M&&$.some(P=>P.email===M)?(t("logged-in"),r(!1)):(t("connected"),r(!0))}else t("no-accounts"),r(!0)}catch(T){console.error("Error checking accounts:",T),t("not-connected"),r(!0)}}catch(N){console.error("Error checking extension connection:",N),t("not-connected"),r(!0)}}if(e==="checking"||!n)return null;let g="",_="",S="",E=is;switch(e){case"not-installed":g="MATA Key Manager Extension Not Installed",_="Install the extension for secure key management and offline access",S="bg-destructive text-destructive-foreground",E=Tg;break;case"not-connected":g="Extension Not Connected",_="The extension is installed but not properly connected. Try refreshing the page.",S="bg-amber-500 text-white",E=tr;break;case"no-accounts":g="Extension Has No Accounts",_="The extension is connected but has no stored accounts. Log in to save your keys securely.",S="bg-blue-600 text-white",E=Tg;break;case"connected":d&&f.length>0?(g="Current Account Not In Extension",_=`Your current account (${d}) is not stored in the extension. Log in with an account that's in the extension.`,S="bg-amber-500 text-white",E=bz):(g="Extension Connected",_=`The extension has ${s} account${s!==1?"s":""} stored. Log in to use them.`,S="bg-green-600 text-white",E=E_);break;case"logged-in":g="Extension Fully Synced",_="Your account is properly synced with the extension. Keys are being securely managed.",S="bg-green-600 text-white",E=Da;break;default:return null}const A=()=>{const I=document.createElement("a");I.href=tl,I.download=Oj,document.body.appendChild(I),I.click(),document.body.removeChild(I),h(!0)};return a.jsxs(a.Fragment,{children:[a.jsx(nF,{open:v,onOpenChange:h}),a.jsxs("div",{className:`extension-banner fixed top-0 left-0 right-0 ${S} p-3 z-50 flex justify-between items-center`,children:[a.jsx("button",{onClick:x,className:"absolute top-2 right-2 text-white/80 hover:text-white md:hidden","aria-label":"Close banner",children:a.jsx(zc,{className:"h-5 w-5"})}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(E,{className:"mr-2 h-5 w-5"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold pr-8 md:pr-0",children:g}),a.jsx("div",{className:"text-sm",children:_}),e==="not-installed"&&a.jsx("button",{className:"mt-2 px-3 py-1 bg-white text-primary text-sm font-medium rounded-md md:hidden",onClick:A,children:"Download Extension"})]})]}),a.jsxs("div",{className:"hidden md:flex gap-2",children:[a.jsxs(ie,{variant:"outline",size:"sm",className:"bg-white/20 hover:bg-white/30 border-white/30",onClick:x,children:[a.jsx(zc,{className:"h-4 w-4 mr-1"}),"Dismiss"]}),e==="not-installed"&&a.jsx(ie,{variant:"default",size:"sm",className:"bg-white text-primary hover:bg-gray-100",onClick:A,children:"Download Extension"}),e==="not-connected"&&a.jsxs(ie,{variant:"default",size:"sm",className:"bg-white text-amber-500 hover:bg-gray-100",onClick:()=>window.location.reload(),children:[a.jsx(tr,{className:"h-4 w-4 mr-1"}),"Refresh Page"]}),e==="connected"&&f.length>0&&a.jsxs(ie,{variant:"default",size:"sm",className:"bg-white text-green-600 hover:bg-gray-100",onClick:()=>{window.location.href="/login"},children:[a.jsx(E_,{className:"h-4 w-4 mr-1"}),"Log In"]}),e!=="not-installed"&&a.jsxs(ie,{variant:"outline",size:"sm",className:"bg-white/20 hover:bg-white/30 border-white/30",onClick:y,children:[a.jsx(tr,{className:"h-4 w-4 mr-1"}),"Check Again"]})]})]})]})}const sF=["top","right","bottom","left"],Po=Math.min,Xn=Math.max,Tf=Math.round,hd=Math.floor,ss=e=>({x:e,y:e}),oF={left:"right",right:"left",bottom:"top",top:"bottom"},aF={start:"end",end:"start"};function Vg(e,t,n){return Xn(e,Po(t,n))}function zs(e,t){return typeof e=="function"?e(t):e}function Ls(e){return e.split("-")[0]}function yl(e){return e.split("-")[1]}function Zv(e){return e==="x"?"y":"x"}function Yv(e){return e==="y"?"height":"width"}function Do(e){return["top","bottom"].includes(Ls(e))?"y":"x"}function Qv(e){return Zv(Do(e))}function iF(e,t,n){n===void 0&&(n=!1);const r=yl(e),s=Qv(e),o=Yv(s);let i=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=Af(i)),[i,Af(i)]}function lF(e){const t=Af(e);return[Ug(e),t,Ug(t)]}function Ug(e){return e.replace(/start|end/g,t=>aF[t])}function cF(e,t,n){const r=["left","right"],s=["right","left"],o=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?o:i;default:return[]}}function uF(e,t,n,r){const s=yl(e);let o=cF(Ls(e),n==="start",r);return s&&(o=o.map(i=>i+"-"+s),t&&(o=o.concat(o.map(Ug)))),o}function Af(e){return e.replace(/left|right|bottom|top/g,t=>oF[t])}function dF(e){return{top:0,right:0,bottom:0,left:0,...e}}function fI(e){return typeof e!="number"?dF(e):{top:e,right:e,bottom:e,left:e}}function Pf(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function Y_(e,t,n){let{reference:r,floating:s}=e;const o=Do(t),i=Qv(t),l=Yv(i),c=Ls(t),u=o==="y",d=r.x+r.width/2-s.width/2,m=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let p;switch(c){case"top":p={x:d,y:r.y-s.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:m};break;case"left":p={x:r.x-s.width,y:m};break;default:p={x:r.x,y:r.y}}switch(yl(t)){case"start":p[i]-=f*(n&&u?-1:1);break;case"end":p[i]+=f*(n&&u?-1:1);break}return p}const fF=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:o=[],platform:i}=n,l=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:m}=Y_(u,r,c),f=r,p={},v=0;for(let h=0;h<l.length;h++){const{name:x,fn:y}=l[h],{x:g,y:_,data:S,reset:E}=await y({x:d,y:m,initialPlacement:r,placement:f,strategy:s,middlewareData:p,rects:u,platform:i,elements:{reference:e,floating:t}});d=g??d,m=_??m,p={...p,[x]:{...p[x],...S}},E&&v<=50&&(v++,typeof E=="object"&&(E.placement&&(f=E.placement),E.rects&&(u=E.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):E.rects),{x:d,y:m}=Y_(u,f,c)),h=-1)}return{x:d,y:m,placement:f,strategy:s,middlewareData:p}};async function Kc(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:o,rects:i,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:m="floating",altBoundary:f=!1,padding:p=0}=zs(t,e),v=fI(p),x=l[f?m==="floating"?"reference":"floating":m],y=Pf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(x)))==null||n?x:x.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),g=m==="floating"?{x:r,y:s,width:i.floating.width,height:i.floating.height}:i.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),S=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},E=Pf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:g,offsetParent:_,strategy:c}):g);return{top:(y.top-E.top+v.top)/S.y,bottom:(E.bottom-y.bottom+v.bottom)/S.y,left:(y.left-E.left+v.left)/S.x,right:(E.right-y.right+v.right)/S.x}}const mF=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:o,platform:i,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=zs(e,t)||{};if(u==null)return{};const m=fI(d),f={x:n,y:r},p=Qv(s),v=Yv(p),h=await i.getDimensions(u),x=p==="y",y=x?"top":"left",g=x?"bottom":"right",_=x?"clientHeight":"clientWidth",S=o.reference[v]+o.reference[p]-f[p]-o.floating[v],E=f[p]-o.reference[p],A=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let I=A?A[_]:0;(!I||!await(i.isElement==null?void 0:i.isElement(A)))&&(I=l.floating[_]||o.floating[v]);const N=S/2-E/2,T=I/2-h[v]/2-1,$=Po(m[y],T),M=Po(m[g],T),j=$,P=I-h[v]-M,b=I/2-h[v]/2+N,V=Vg(j,b,P),Z=!c.arrow&&yl(s)!=null&&b!==V&&o.reference[v]/2-(b<j?$:M)-h[v]/2<0,D=Z?b<j?b-j:b-P:0;return{[p]:f[p]+D,data:{[p]:V,centerOffset:b-V-D,...Z&&{alignmentOffset:D}},reset:Z}}}),hF=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:o,rects:i,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:m=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:h=!0,...x}=zs(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const y=Ls(s),g=Do(l),_=Ls(l)===l,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),E=f||(_||!h?[Af(l)]:lF(l)),A=v!=="none";!f&&A&&E.push(...uF(l,h,v,S));const I=[l,...E],N=await Kc(t,x),T=[];let $=((r=o.flip)==null?void 0:r.overflows)||[];if(d&&T.push(N[y]),m){const b=iF(s,i,S);T.push(N[b[0]],N[b[1]])}if($=[...$,{placement:s,overflows:T}],!T.every(b=>b<=0)){var M,j;const b=(((M=o.flip)==null?void 0:M.index)||0)+1,V=I[b];if(V)return{data:{index:b,overflows:$},reset:{placement:V}};let Z=(j=$.filter(D=>D.overflows[0]<=0).sort((D,L)=>D.overflows[1]-L.overflows[1])[0])==null?void 0:j.placement;if(!Z)switch(p){case"bestFit":{var P;const D=(P=$.filter(L=>{if(A){const O=Do(L.placement);return O===g||O==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(O=>O>0).reduce((O,q)=>O+q,0)]).sort((L,O)=>L[1]-O[1])[0])==null?void 0:P[0];D&&(Z=D);break}case"initialPlacement":Z=l;break}if(s!==Z)return{reset:{placement:Z}}}return{}}}};function Q_(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function X_(e){return sF.some(t=>e[t]>=0)}const pF=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=zs(e,t);switch(r){case"referenceHidden":{const o=await Kc(t,{...s,elementContext:"reference"}),i=Q_(o,n.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:X_(i)}}}case"escaped":{const o=await Kc(t,{...s,altBoundary:!0}),i=Q_(o,n.floating);return{data:{escapedOffsets:i,escaped:X_(i)}}}default:return{}}}}};async function gF(e,t){const{placement:n,platform:r,elements:s}=e,o=await(r.isRTL==null?void 0:r.isRTL(s.floating)),i=Ls(n),l=yl(n),c=Do(n)==="y",u=["left","top"].includes(i)?-1:1,d=o&&c?-1:1,m=zs(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:v}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof v=="number"&&(p=l==="end"?v*-1:v),c?{x:p*d,y:f*u}:{x:f*u,y:p*d}}const yF=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:o,placement:i,middlewareData:l}=t,c=await gF(t,e);return i===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:o+c.y,data:{...c,placement:i}}}}},vF=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:l={fn:x=>{let{x:y,y:g}=x;return{x:y,y:g}}},...c}=zs(e,t),u={x:n,y:r},d=await Kc(t,c),m=Do(Ls(s)),f=Zv(m);let p=u[f],v=u[m];if(o){const x=f==="y"?"top":"left",y=f==="y"?"bottom":"right",g=p+d[x],_=p-d[y];p=Vg(g,p,_)}if(i){const x=m==="y"?"top":"left",y=m==="y"?"bottom":"right",g=v+d[x],_=v-d[y];v=Vg(g,v,_)}const h=l.fn({...t,[f]:p,[m]:v});return{...h,data:{x:h.x-n,y:h.y-r,enabled:{[f]:o,[m]:i}}}}}},xF=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:o,middlewareData:i}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=zs(e,t),d={x:n,y:r},m=Do(s),f=Zv(m);let p=d[f],v=d[m];const h=zs(l,t),x=typeof h=="number"?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(c){const _=f==="y"?"height":"width",S=o.reference[f]-o.floating[_]+x.mainAxis,E=o.reference[f]+o.reference[_]-x.mainAxis;p<S?p=S:p>E&&(p=E)}if(u){var y,g;const _=f==="y"?"width":"height",S=["top","left"].includes(Ls(s)),E=o.reference[m]-o.floating[_]+(S&&((y=i.offset)==null?void 0:y[m])||0)+(S?0:x.crossAxis),A=o.reference[m]+o.reference[_]+(S?0:((g=i.offset)==null?void 0:g[m])||0)-(S?x.crossAxis:0);v<E?v=E:v>A&&(v=A)}return{[f]:p,[m]:v}}}},wF=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:o,platform:i,elements:l}=t,{apply:c=()=>{},...u}=zs(e,t),d=await Kc(t,u),m=Ls(s),f=yl(s),p=Do(s)==="y",{width:v,height:h}=o.floating;let x,y;m==="top"||m==="bottom"?(x=m,y=f===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(y=m,x=f==="end"?"top":"bottom");const g=h-d.top-d.bottom,_=v-d.left-d.right,S=Po(h-d[x],g),E=Po(v-d[y],_),A=!t.middlewareData.shift;let I=S,N=E;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=_),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(I=g),A&&!f){const $=Xn(d.left,0),M=Xn(d.right,0),j=Xn(d.top,0),P=Xn(d.bottom,0);p?N=v-2*($!==0||M!==0?$+M:Xn(d.left,d.right)):I=h-2*(j!==0||P!==0?j+P:Xn(d.top,d.bottom))}await c({...t,availableWidth:N,availableHeight:I});const T=await i.getDimensions(l.floating);return v!==T.width||h!==T.height?{reset:{rects:!0}}:{}}}};function Fm(){return typeof window<"u"}function vl(e){return mI(e)?(e.nodeName||"").toLowerCase():"#document"}function nr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ps(e){var t;return(t=(mI(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function mI(e){return Fm()?e instanceof Node||e instanceof nr(e).Node:!1}function Fr(e){return Fm()?e instanceof Element||e instanceof nr(e).Element:!1}function us(e){return Fm()?e instanceof HTMLElement||e instanceof nr(e).HTMLElement:!1}function J_(e){return!Fm()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof nr(e).ShadowRoot}function ku(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Vr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function _F(e){return["table","td","th"].includes(vl(e))}function Vm(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function Xv(e){const t=Jv(),n=Fr(e)?Vr(e):e;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function SF(e){let t=Ro(e);for(;us(t)&&!nl(t);){if(Xv(t))return t;if(Vm(t))return null;t=Ro(t)}return null}function Jv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function nl(e){return["html","body","#document"].includes(vl(e))}function Vr(e){return nr(e).getComputedStyle(e)}function Um(e){return Fr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ro(e){if(vl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||J_(e)&&e.host||ps(e);return J_(t)?t.host:t}function hI(e){const t=Ro(e);return nl(t)?e.ownerDocument?e.ownerDocument.body:e.body:us(t)&&ku(t)?t:hI(t)}function Wc(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=hI(e),o=s===((r=e.ownerDocument)==null?void 0:r.body),i=nr(s);if(o){const l=Bg(i);return t.concat(i,i.visualViewport||[],ku(s)?s:[],l&&n?Wc(l):[])}return t.concat(s,Wc(s,[],n))}function Bg(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function pI(e){const t=Vr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=us(e),o=s?e.offsetWidth:n,i=s?e.offsetHeight:r,l=Tf(n)!==o||Tf(r)!==i;return l&&(n=o,r=i),{width:n,height:r,$:l}}function ex(e){return Fr(e)?e:e.contextElement}function vi(e){const t=ex(e);if(!us(t))return ss(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:o}=pI(t);let i=(o?Tf(n.width):n.width)/r,l=(o?Tf(n.height):n.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const bF=ss(0);function gI(e){const t=nr(e);return!Jv()||!t.visualViewport?bF:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function EF(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==nr(e)?!1:t}function Ca(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),o=ex(e);let i=ss(1);t&&(r?Fr(r)&&(i=vi(r)):i=vi(e));const l=EF(o,n,r)?gI(o):ss(0);let c=(s.left+l.x)/i.x,u=(s.top+l.y)/i.y,d=s.width/i.x,m=s.height/i.y;if(o){const f=nr(o),p=r&&Fr(r)?nr(r):r;let v=f,h=Bg(v);for(;h&&r&&p!==v;){const x=vi(h),y=h.getBoundingClientRect(),g=Vr(h),_=y.left+(h.clientLeft+parseFloat(g.paddingLeft))*x.x,S=y.top+(h.clientTop+parseFloat(g.paddingTop))*x.y;c*=x.x,u*=x.y,d*=x.x,m*=x.y,c+=_,u+=S,v=nr(h),h=Bg(v)}}return Pf({width:d,height:m,x:c,y:u})}function tx(e,t){const n=Um(e).scrollLeft;return t?t.left+n:Ca(ps(e)).left+n}function yI(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:tx(e,r)),o=r.top+t.scrollTop;return{x:s,y:o}}function kF(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const o=s==="fixed",i=ps(r),l=t?Vm(t.floating):!1;if(r===i||l&&o)return n;let c={scrollLeft:0,scrollTop:0},u=ss(1);const d=ss(0),m=us(r);if((m||!m&&!o)&&((vl(r)!=="body"||ku(i))&&(c=Um(r)),us(r))){const p=Ca(r);u=vi(r),d.x=p.x+r.clientLeft,d.y=p.y+r.clientTop}const f=i&&!m&&!o?yI(i,c,!0):ss(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function CF(e){return Array.from(e.getClientRects())}function NF(e){const t=ps(e),n=Um(e),r=e.ownerDocument.body,s=Xn(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Xn(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-n.scrollLeft+tx(e);const l=-n.scrollTop;return Vr(r).direction==="rtl"&&(i+=Xn(t.clientWidth,r.clientWidth)-s),{width:s,height:o,x:i,y:l}}function jF(e,t){const n=nr(e),r=ps(e),s=n.visualViewport;let o=r.clientWidth,i=r.clientHeight,l=0,c=0;if(s){o=s.width,i=s.height;const u=Jv();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:o,height:i,x:l,y:c}}function IF(e,t){const n=Ca(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,o=us(e)?vi(e):ss(1),i=e.clientWidth*o.x,l=e.clientHeight*o.y,c=s*o.x,u=r*o.y;return{width:i,height:l,x:c,y:u}}function eS(e,t,n){let r;if(t==="viewport")r=jF(e,n);else if(t==="document")r=NF(ps(e));else if(Fr(t))r=IF(t,n);else{const s=gI(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Pf(r)}function vI(e,t){const n=Ro(e);return n===t||!Fr(n)||nl(n)?!1:Vr(n).position==="fixed"||vI(n,t)}function TF(e,t){const n=t.get(e);if(n)return n;let r=Wc(e,[],!1).filter(l=>Fr(l)&&vl(l)!=="body"),s=null;const o=Vr(e).position==="fixed";let i=o?Ro(e):e;for(;Fr(i)&&!nl(i);){const l=Vr(i),c=Xv(i);!c&&l.position==="fixed"&&(s=null),(o?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||ku(i)&&!c&&vI(e,i))?r=r.filter(d=>d!==i):s=l,i=Ro(i)}return t.set(e,r),r}function AF(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const i=[...n==="clippingAncestors"?Vm(t)?[]:TF(t,this._c):[].concat(n),r],l=i[0],c=i.reduce((u,d)=>{const m=eS(t,d,s);return u.top=Xn(m.top,u.top),u.right=Po(m.right,u.right),u.bottom=Po(m.bottom,u.bottom),u.left=Xn(m.left,u.left),u},eS(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function PF(e){const{width:t,height:n}=pI(e);return{width:t,height:n}}function DF(e,t,n){const r=us(t),s=ps(t),o=n==="fixed",i=Ca(e,!0,o,t);let l={scrollLeft:0,scrollTop:0};const c=ss(0);if(r||!r&&!o)if((vl(t)!=="body"||ku(s))&&(l=Um(t)),r){const f=Ca(t,!0,o,t);c.x=f.x+t.clientLeft,c.y=f.y+t.clientTop}else s&&(c.x=tx(s));const u=s&&!r&&!o?yI(s,l):ss(0),d=i.left+l.scrollLeft-c.x-u.x,m=i.top+l.scrollTop-c.y-u.y;return{x:d,y:m,width:i.width,height:i.height}}function ip(e){return Vr(e).position==="static"}function tS(e,t){if(!us(e)||Vr(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return ps(e)===n&&(n=n.ownerDocument.body),n}function xI(e,t){const n=nr(e);if(Vm(e))return n;if(!us(e)){let s=Ro(e);for(;s&&!nl(s);){if(Fr(s)&&!ip(s))return s;s=Ro(s)}return n}let r=tS(e,t);for(;r&&_F(r)&&ip(r);)r=tS(r,t);return r&&nl(r)&&ip(r)&&!Xv(r)?n:r||SF(e)||n}const RF=async function(e){const t=this.getOffsetParent||xI,n=this.getDimensions,r=await n(e.floating);return{reference:DF(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function $F(e){return Vr(e).direction==="rtl"}const OF={convertOffsetParentRelativeRectToViewportRelativeRect:kF,getDocumentElement:ps,getClippingRect:AF,getOffsetParent:xI,getElementRects:RF,getClientRects:CF,getDimensions:PF,getScale:vi,isElement:Fr,isRTL:$F};function MF(e,t){let n=null,r;const s=ps(e);function o(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const{left:u,top:d,width:m,height:f}=e.getBoundingClientRect();if(l||t(),!m||!f)return;const p=hd(d),v=hd(s.clientWidth-(u+m)),h=hd(s.clientHeight-(d+f)),x=hd(u),g={rootMargin:-p+"px "+-v+"px "+-h+"px "+-x+"px",threshold:Xn(0,Po(1,c))||1};let _=!0;function S(E){const A=E[0].intersectionRatio;if(A!==c){if(!_)return i();A?i(!1,A):r=setTimeout(()=>{i(!1,1e-7)},1e3)}_=!1}try{n=new IntersectionObserver(S,{...g,root:s.ownerDocument})}catch{n=new IntersectionObserver(S,g)}n.observe(e)}return i(!0),o}function zF(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=ex(e),d=s||o?[...u?Wc(u):[],...Wc(t)]:[];d.forEach(y=>{s&&y.addEventListener("scroll",n,{passive:!0}),o&&y.addEventListener("resize",n)});const m=u&&l?MF(u,n):null;let f=-1,p=null;i&&(p=new ResizeObserver(y=>{let[g]=y;g&&g.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=p)==null||_.observe(t)})),n()}),u&&!c&&p.observe(u),p.observe(t));let v,h=c?Ca(e):null;c&&x();function x(){const y=Ca(e);h&&(y.x!==h.x||y.y!==h.y||y.width!==h.width||y.height!==h.height)&&n(),h=y,v=requestAnimationFrame(x)}return n(),()=>{var y;d.forEach(g=>{s&&g.removeEventListener("scroll",n),o&&g.removeEventListener("resize",n)}),m==null||m(),(y=p)==null||y.disconnect(),p=null,c&&cancelAnimationFrame(v)}}const LF=yF,FF=vF,VF=hF,UF=wF,BF=pF,nS=mF,KF=xF,WF=(e,t,n)=>{const r=new Map,s={platform:OF,...n},o={...s.platform,_c:r};return fF(e,t,{...s,platform:o})};var zd=typeof document<"u"?w.useLayoutEffect:w.useEffect;function Df(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Df(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const o=s[r];if(!(o==="_owner"&&e.$$typeof)&&!Df(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function wI(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function rS(e,t){const n=wI(e);return Math.round(t*n)/n}function lp(e){const t=w.useRef(e);return zd(()=>{t.current=e}),t}function HF(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,m]=w.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=w.useState(r);Df(f,r)||p(r);const[v,h]=w.useState(null),[x,y]=w.useState(null),g=w.useCallback(L=>{L!==A.current&&(A.current=L,h(L))},[]),_=w.useCallback(L=>{L!==I.current&&(I.current=L,y(L))},[]),S=o||v,E=i||x,A=w.useRef(null),I=w.useRef(null),N=w.useRef(d),T=c!=null,$=lp(c),M=lp(s),j=lp(u),P=w.useCallback(()=>{if(!A.current||!I.current)return;const L={placement:t,strategy:n,middleware:f};M.current&&(L.platform=M.current),WF(A.current,I.current,L).then(O=>{const q={...O,isPositioned:j.current!==!1};b.current&&!Df(N.current,q)&&(N.current=q,Pa.flushSync(()=>{m(q)}))})},[f,t,n,M,j]);zd(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,m(L=>({...L,isPositioned:!1})))},[u]);const b=w.useRef(!1);zd(()=>(b.current=!0,()=>{b.current=!1}),[]),zd(()=>{if(S&&(A.current=S),E&&(I.current=E),S&&E){if($.current)return $.current(S,E,P);P()}},[S,E,P,$,T]);const V=w.useMemo(()=>({reference:A,floating:I,setReference:g,setFloating:_}),[g,_]),Z=w.useMemo(()=>({reference:S,floating:E}),[S,E]),D=w.useMemo(()=>{const L={position:n,left:0,top:0};if(!Z.floating)return L;const O=rS(Z.floating,d.x),q=rS(Z.floating,d.y);return l?{...L,transform:"translate("+O+"px, "+q+"px)",...wI(Z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:O,top:q}},[n,l,Z.floating,d.x,d.y]);return w.useMemo(()=>({...d,update:P,refs:V,elements:Z,floatingStyles:D}),[d,P,V,Z,D])}const qF=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?nS({element:r.current,padding:s}).fn(n):{}:r?nS({element:r,padding:s}).fn(n):{}}}},GF=(e,t)=>({...LF(e),options:[e,t]}),ZF=(e,t)=>({...FF(e),options:[e,t]}),YF=(e,t)=>({...KF(e),options:[e,t]}),QF=(e,t)=>({...VF(e),options:[e,t]}),XF=(e,t)=>({...UF(e),options:[e,t]}),JF=(e,t)=>({...BF(e),options:[e,t]}),e3=(e,t)=>({...qF(e),options:[e,t]});var t3="Arrow",_I=w.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...o}=e;return a.jsx(je.svg,{...o,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});_I.displayName=t3;var n3=_I;function r3(e,t=[]){let n=[];function r(o,i){const l=w.createContext(i),c=n.length;n=[...n,i];function u(m){const{scope:f,children:p,...v}=m,h=(f==null?void 0:f[e][c])||l,x=w.useMemo(()=>v,Object.values(v));return a.jsx(h.Provider,{value:x,children:p})}function d(m,f){const p=(f==null?void 0:f[e][c])||l,v=w.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return u.displayName=o+"Provider",[u,d]}const s=()=>{const o=n.map(i=>w.createContext(i));return function(l){const c=(l==null?void 0:l[e])||o;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,s3(s,...t)]}function s3(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:u})=>{const m=c(o)[`__scope${u}`];return{...l,...m}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}function nx(e){const[t,n]=w.useState(void 0);return xn(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const o=s[0];let i,l;if("borderBoxSize"in o){const c=o.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,l=u.blockSize}else i=e.offsetWidth,l=e.offsetHeight;n({width:i,height:l})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var rx="Popper",[SI,xl]=r3(rx),[o3,bI]=SI(rx),EI=e=>{const{__scopePopper:t,children:n}=e,[r,s]=w.useState(null);return a.jsx(o3,{scope:t,anchor:r,onAnchorChange:s,children:n})};EI.displayName=rx;var kI="PopperAnchor",CI=w.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,o=bI(kI,n),i=w.useRef(null),l=qe(t,i);return w.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:a.jsx(je.div,{...s,ref:l})});CI.displayName=kI;var sx="PopperContent",[a3,i3]=SI(sx),NI=w.forwardRef((e,t)=>{var G,te,le,fe,ge,de;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:o="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:m="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:v,...h}=e,x=bI(sx,n),[y,g]=w.useState(null),_=qe(t,Pe=>g(Pe)),[S,E]=w.useState(null),A=nx(S),I=(A==null?void 0:A.width)??0,N=(A==null?void 0:A.height)??0,T=r+(o!=="center"?"-"+o:""),$=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},M=Array.isArray(u)?u:[u],j=M.length>0,P={padding:$,boundary:M.filter(c3),altBoundary:j},{refs:b,floatingStyles:V,placement:Z,isPositioned:D,middlewareData:L}=HF({strategy:"fixed",placement:T,whileElementsMounted:(...Pe)=>zF(...Pe,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[GF({mainAxis:s+N,alignmentAxis:i}),c&&ZF({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?YF():void 0,...P}),c&&QF({...P}),XF({...P,apply:({elements:Pe,rects:C,availableWidth:J,availableHeight:ee})=>{const{width:z,height:k}=C.reference,R=Pe.floating.style;R.setProperty("--radix-popper-available-width",`${J}px`),R.setProperty("--radix-popper-available-height",`${ee}px`),R.setProperty("--radix-popper-anchor-width",`${z}px`),R.setProperty("--radix-popper-anchor-height",`${k}px`)}}),S&&e3({element:S,padding:l}),u3({arrowWidth:I,arrowHeight:N}),f&&JF({strategy:"referenceHidden",...P})]}),[O,q]=TI(Z),F=vn(v);xn(()=>{D&&(F==null||F())},[D,F]);const W=(G=L.arrow)==null?void 0:G.x,ce=(te=L.arrow)==null?void 0:te.y,ae=((le=L.arrow)==null?void 0:le.centerOffset)!==0,[K,ne]=w.useState();return xn(()=>{y&&ne(window.getComputedStyle(y).zIndex)},[y]),a.jsx("div",{ref:b.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:D?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[(fe=L.transformOrigin)==null?void 0:fe.x,(ge=L.transformOrigin)==null?void 0:ge.y].join(" "),...((de=L.hide)==null?void 0:de.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(a3,{scope:n,placedSide:O,onArrowChange:E,arrowX:W,arrowY:ce,shouldHideArrow:ae,children:a.jsx(je.div,{"data-side":O,"data-align":q,...h,ref:_,style:{...h.style,animation:D?void 0:"none"}})})})});NI.displayName=sx;var jI="PopperArrow",l3={top:"bottom",right:"left",bottom:"top",left:"right"},II=w.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,o=i3(jI,r),i=l3[o.placedSide];return a.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:a.jsx(n3,{...s,ref:n,style:{...s.style,display:"block"}})})});II.displayName=jI;function c3(e){return e!==null}var u3=e=>({name:"transformOrigin",options:e,fn(t){var x,y,g;const{placement:n,rects:r,middlewareData:s}=t,i=((x=s.arrow)==null?void 0:x.centerOffset)!==0,l=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[u,d]=TI(n),m={start:"0%",center:"50%",end:"100%"}[d],f=(((y=s.arrow)==null?void 0:y.x)??0)+l/2,p=(((g=s.arrow)==null?void 0:g.y)??0)+c/2;let v="",h="";return u==="bottom"?(v=i?m:`${f}px`,h=`${-c}px`):u==="top"?(v=i?m:`${f}px`,h=`${r.floating.height+c}px`):u==="right"?(v=`${-c}px`,h=i?m:`${p}px`):u==="left"&&(v=`${r.floating.width+c}px`,h=i?m:`${p}px`),{data:{x:v,y:h}}}});function TI(e){const[t,n="center"]=e.split("-");return[t,n]}var ox=EI,ax=CI,ix=NI,lx=II,[Bm,GK]=ms("Tooltip",[xl]),Km=xl(),AI="TooltipProvider",d3=700,Kg="tooltip.open",[f3,cx]=Bm(AI),PI=e=>{const{__scopeTooltip:t,delayDuration:n=d3,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:o}=e,[i,l]=w.useState(!0),c=w.useRef(!1),u=w.useRef(0);return w.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),a.jsx(f3,{scope:t,isOpenDelayed:i,delayDuration:n,onOpen:w.useCallback(()=>{window.clearTimeout(u.current),l(!1)},[]),onClose:w.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>l(!0),r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:w.useCallback(d=>{c.current=d},[]),disableHoverableContent:s,children:o})};PI.displayName=AI;var Wm="Tooltip",[m3,Hm]=Bm(Wm),DI=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s=!1,onOpenChange:o,disableHoverableContent:i,delayDuration:l}=e,c=cx(Wm,e.__scopeTooltip),u=Km(t),[d,m]=w.useState(null),f=Or(),p=w.useRef(0),v=i??c.disableHoverableContent,h=l??c.delayDuration,x=w.useRef(!1),[y=!1,g]=as({prop:r,defaultProp:s,onChange:I=>{I?(c.onOpen(),document.dispatchEvent(new CustomEvent(Kg))):c.onClose(),o==null||o(I)}}),_=w.useMemo(()=>y?x.current?"delayed-open":"instant-open":"closed",[y]),S=w.useCallback(()=>{window.clearTimeout(p.current),x.current=!1,g(!0)},[g]),E=w.useCallback(()=>{window.clearTimeout(p.current),g(!1)},[g]),A=w.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{x.current=!0,g(!0)},h)},[h,g]);return w.useEffect(()=>()=>window.clearTimeout(p.current),[]),a.jsx(ox,{...u,children:a.jsx(m3,{scope:t,contentId:f,open:y,stateAttribute:_,trigger:d,onTriggerChange:m,onTriggerEnter:w.useCallback(()=>{c.isOpenDelayed?A():S()},[c.isOpenDelayed,A,S]),onTriggerLeave:w.useCallback(()=>{v?E():window.clearTimeout(p.current)},[E,v]),onOpen:S,onClose:E,disableHoverableContent:v,children:n})})};DI.displayName=Wm;var Wg="TooltipTrigger",RI=w.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=Hm(Wg,n),o=cx(Wg,n),i=Km(n),l=w.useRef(null),c=qe(t,l,s.onTriggerChange),u=w.useRef(!1),d=w.useRef(!1),m=w.useCallback(()=>u.current=!1,[]);return w.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),a.jsx(ax,{asChild:!0,...i,children:a.jsx(je.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:c,onPointerMove:xe(e.onPointerMove,f=>{f.pointerType!=="touch"&&!d.current&&!o.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:xe(e.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:xe(e.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:xe(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:xe(e.onBlur,s.onClose),onClick:xe(e.onClick,s.onClose)})})});RI.displayName=Wg;var h3="TooltipPortal",[ZK,p3]=Bm(h3,{forceMount:void 0}),rl="TooltipContent",$I=w.forwardRef((e,t)=>{const n=p3(rl,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...o}=e,i=Hm(rl,e.__scopeTooltip);return a.jsx(_r,{present:r||i.open,children:i.disableHoverableContent?a.jsx(OI,{side:s,...o,ref:t}):a.jsx(g3,{side:s,...o,ref:t})})}),g3=w.forwardRef((e,t)=>{const n=Hm(rl,e.__scopeTooltip),r=cx(rl,e.__scopeTooltip),s=w.useRef(null),o=qe(t,s),[i,l]=w.useState(null),{trigger:c,onClose:u}=n,d=s.current,{onPointerInTransitChange:m}=r,f=w.useCallback(()=>{l(null),m(!1)},[m]),p=w.useCallback((v,h)=>{const x=v.currentTarget,y={x:v.clientX,y:v.clientY},g=w3(y,x.getBoundingClientRect()),_=_3(y,g),S=S3(h.getBoundingClientRect()),E=E3([..._,...S]);l(E),m(!0)},[m]);return w.useEffect(()=>()=>f(),[f]),w.useEffect(()=>{if(c&&d){const v=x=>p(x,d),h=x=>p(x,c);return c.addEventListener("pointerleave",v),d.addEventListener("pointerleave",h),()=>{c.removeEventListener("pointerleave",v),d.removeEventListener("pointerleave",h)}}},[c,d,p,f]),w.useEffect(()=>{if(i){const v=h=>{const x=h.target,y={x:h.clientX,y:h.clientY},g=(c==null?void 0:c.contains(x))||(d==null?void 0:d.contains(x)),_=!b3(y,i);g?f():_&&(f(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[c,d,i,u,f]),a.jsx(OI,{...e,ref:o})}),[y3,v3]=Bm(Wm,{isInside:!1}),OI=w.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:o,onPointerDownOutside:i,...l}=e,c=Hm(rl,n),u=Km(n),{onClose:d}=c;return w.useEffect(()=>(document.addEventListener(Kg,d),()=>document.removeEventListener(Kg,d)),[d]),w.useEffect(()=>{if(c.trigger){const m=f=>{const p=f.target;p!=null&&p.contains(c.trigger)&&d()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[c.trigger,d]),a.jsx(ml,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:m=>m.preventDefault(),onDismiss:d,children:a.jsxs(ix,{"data-state":c.stateAttribute,...u,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(hv,{children:r}),a.jsx(y3,{scope:n,isInside:!0,children:a.jsx(N4,{id:c.contentId,role:"tooltip",children:s||r})})]})})});$I.displayName=rl;var MI="TooltipArrow",x3=w.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=Km(n);return v3(MI,n).isInside?null:a.jsx(lx,{...s,...r,ref:t})});x3.displayName=MI;function w3(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),o=Math.abs(t.left-e.x);switch(Math.min(n,r,s,o)){case o:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function _3(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function S3(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function b3(e,t){const{x:n,y:r}=e;let s=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const l=t[o].x,c=t[o].y,u=t[i].x,d=t[i].y;c>r!=d>r&&n<(u-l)*(r-c)/(d-c)+l&&(s=!s)}return s}function E3(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),k3(t)}function k3(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(s.y-i.y)>=(o.y-i.y)*(s.x-i.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const o=n[n.length-1],i=n[n.length-2];if((o.x-i.x)*(s.y-i.y)>=(o.y-i.y)*(s.x-i.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var C3=PI,N3=DI,j3=RI,zI=$I;const Cu=C3,Nu=N3,ju=j3,wl=w.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(zI,{ref:r,sideOffset:t,className:ye("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));wl.displayName=zI.displayName;function Rf({size:e="sm"}){const[t,n]=w.useState("checking"),[r,s]=w.useState(0),[o,i]=w.useState(""),[l,c]=w.useState(null),[u,d]=w.useState(!1);w.useEffect(()=>{m(),oe(async()=>{const{autoConnectToExtension:_}=await Promise.resolve().then(()=>V5);return{autoConnectToExtension:_}},void 0).then(({autoConnectToExtension:_})=>{_({force:!0,silent:!0}).then(()=>m()).catch(()=>{})});const y=setInterval(()=>{m()},1e4),g=_=>{var S;((S=_.detail)==null?void 0:S.type)==="EXTENSION_CONNECTED"&&m()};return window.addEventListener("MATA_EXTENSION_CONNECTED",g),()=>{clearInterval(y),window.removeEventListener("MATA_EXTENSION_CONNECTED",g)}},[]);async function m(){if(!u){d(!0);try{if(!Lr()){n("not-installed"),d(!1);return}const y=Xo();if(!y.connected){n("not-connected"),d(!1);return}i(y.version||"");try{const g=await Ao("LIST_ACCOUNTS");if(g.success&&g.accounts){const _=g.accounts;s(_.length);const S=localStorage.getItem("userEmail");if(c(S),_.length===0)n("no-accounts");else if(!S)n("connected");else{const E=_.some(A=>A.email===S);n(E?"logged-in":"connected")}}else n("no-accounts")}catch(g){console.error("Error checking accounts:",g),y.connected?n("connected"):n("not-connected")}}catch(y){console.error("Error checking extension connection:",y),n("not-connected")}finally{d(!1)}}}let f=is,p="",v="",h="",x=!1;switch(t){case"checking":f=xf,p="Checking Extension Status...",v="Please wait while we check the status of the MATA extension.",h="text-gray-400",x=!0;break;case"not-installed":f=gz,p="Extension Not Installed",v="Install the MATA Key Manager extension for secure offline access.",h="text-red-500";break;case"not-connected":f=is,p="Extension Not Connected",v="The extension is installed but not properly connected. Try refreshing the page.",h="text-amber-500";break;case"no-accounts":f=HN,p="No Accounts in Extension",v="The extension is connected but has no stored accounts. Log in to save your keys securely.",h="text-blue-500";break;case"connected":f=Tg,p="Extension Connected",v=l?`Your current account (${l}) is not synced to the extension.`:`The extension has ${r} account${r!==1?"s":""} stored. Log in to use them.`,h="text-green-500";break;case"logged-in":f=Da,p="Fully Synced & Protected",v=`Your account is securely synced with the extension ${o?`v${o}`:Vn()}.`,h="text-green-500";break}return a.jsx(Cu,{children:a.jsxs(Nu,{delayDuration:300,children:[a.jsx(ju,{asChild:!0,children:a.jsxs("button",{onClick:y=>{if(u)return;y.preventDefault(),y.stopPropagation(),m();const g=new CustomEvent("open-extension-dialog");window.dispatchEvent(g)},className:ye("relative rounded-full transition-colors hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-300",e==="sm"&&"p-1.5",e==="md"&&"p-2",e==="lg"&&"p-3",u&&"cursor-wait"),disabled:u,children:[a.jsx(f,{className:ye(e==="sm"&&"h-5 w-5",e==="md"&&"h-6 w-6",e==="lg"&&"h-8 w-8",h,x&&"animate-pulse")}),t==="logged-in"&&a.jsx("span",{className:"absolute bottom-0 right-0 h-2.5 w-2.5 rounded-full bg-green-400 ring-1 ring-white"})]})}),a.jsx(wl,{className:"max-w-[200px] p-3",side:"bottom",children:a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-sm mb-1",children:p}),a.jsx("p",{className:"text-xs text-muted-foreground leading-tight",children:v}),t!=="not-installed"&&t!=="checking"&&a.jsx("div",{className:"mt-2 pt-2 border-t border-border text-xs",children:a.jsx("p",{className:"text-muted-foreground",children:"Click to open extension settings"})})]})})]})})}const Ke=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:ye("rounded-xl border border-gray-100 bg-white text-card-foreground shadow-sm transition-all hover:border-tertiary/60 hover:shadow-md",e),...t}));Ke.displayName="Card";const st=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:ye("flex flex-col space-y-1.5 p-6",e),...t}));st.displayName="CardHeader";const ot=w.forwardRef(({className:e,...t},n)=>a.jsx("h3",{ref:n,className:ye("text-2xl font-semibold leading-none tracking-tight",e),...t}));ot.displayName="CardTitle";const ut=w.forwardRef(({className:e,...t},n)=>a.jsx("p",{ref:n,className:ye("text-sm text-muted-foreground",e),...t}));ut.displayName="CardDescription";const Ue=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:ye("p-6 pt-0",e),...t}));Ue.displayName="CardContent";const $o=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:ye("flex items-center p-6 pt-0",e),...t}));$o.displayName="CardFooter";function I3(e,t=[]){let n=[];function r(o,i){const l=w.createContext(i),c=n.length;n=[...n,i];function u(m){const{scope:f,children:p,...v}=m,h=(f==null?void 0:f[e][c])||l,x=w.useMemo(()=>v,Object.values(v));return a.jsx(h.Provider,{value:x,children:p})}function d(m,f){const p=(f==null?void 0:f[e][c])||l,v=w.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return u.displayName=o+"Provider",[u,d]}const s=()=>{const o=n.map(i=>w.createContext(i));return function(l){const c=(l==null?void 0:l[e])||o;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,T3(s,...t)]}function T3(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:u})=>{const m=c(o)[`__scope${u}`];return{...l,...m}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var A3=w.createContext(void 0);function qm(e){const t=w.useContext(A3);return e||t||"ltr"}var cp="rovingFocusGroup.onEntryFocus",P3={bubbles:!1,cancelable:!0},Gm="RovingFocusGroup",[Hg,LI,D3]=Nm(Gm),[R3,Zm]=I3(Gm,[D3]),[$3,O3]=R3(Gm),FI=w.forwardRef((e,t)=>a.jsx(Hg.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Hg.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(M3,{...e,ref:t})})}));FI.displayName=Gm;var M3=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...m}=e,f=w.useRef(null),p=qe(t,f),v=qm(o),[h=null,x]=as({prop:i,defaultProp:l,onChange:c}),[y,g]=w.useState(!1),_=vn(u),S=LI(n),E=w.useRef(!1),[A,I]=w.useState(0);return w.useEffect(()=>{const N=f.current;if(N)return N.addEventListener(cp,_),()=>N.removeEventListener(cp,_)},[_]),a.jsx($3,{scope:n,orientation:r,dir:v,loop:s,currentTabStopId:h,onItemFocus:w.useCallback(N=>x(N),[x]),onItemShiftTab:w.useCallback(()=>g(!0),[]),onFocusableItemAdd:w.useCallback(()=>I(N=>N+1),[]),onFocusableItemRemove:w.useCallback(()=>I(N=>N-1),[]),children:a.jsx(je.div,{tabIndex:y||A===0?-1:0,"data-orientation":r,...m,ref:p,style:{outline:"none",...e.style},onMouseDown:xe(e.onMouseDown,()=>{E.current=!0}),onFocus:xe(e.onFocus,N=>{const T=!E.current;if(N.target===N.currentTarget&&T&&!y){const $=new CustomEvent(cp,P3);if(N.currentTarget.dispatchEvent($),!$.defaultPrevented){const M=S().filter(Z=>Z.focusable),j=M.find(Z=>Z.active),P=M.find(Z=>Z.id===h),V=[j,P,...M].filter(Boolean).map(Z=>Z.ref.current);BI(V,d)}}E.current=!1}),onBlur:xe(e.onBlur,()=>g(!1))})})}),VI="RovingFocusGroupItem",UI=w.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:o,...i}=e,l=Or(),c=o||l,u=O3(VI,n),d=u.currentTabStopId===c,m=LI(n),{onFocusableItemAdd:f,onFocusableItemRemove:p}=u;return w.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),a.jsx(Hg.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:a.jsx(je.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...i,ref:t,onMouseDown:xe(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:xe(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:xe(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const h=F3(v,u.orientation,u.dir);if(h!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=m().filter(g=>g.focusable).map(g=>g.ref.current);if(h==="last")y.reverse();else if(h==="prev"||h==="next"){h==="prev"&&y.reverse();const g=y.indexOf(v.currentTarget);y=u.loop?V3(y,g+1):y.slice(g+1)}setTimeout(()=>BI(y))}})})})});UI.displayName=VI;var z3={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function L3(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function F3(e,t,n){const r=L3(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return z3[r]}function BI(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function V3(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var KI=FI,WI=UI,ux="Tabs",[U3,YK]=ms(ux,[Zm]),HI=Zm(),[B3,dx]=U3(ux),qI=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:o,orientation:i="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=qm(l),[m,f]=as({prop:r,onChange:s,defaultProp:o});return a.jsx(B3,{scope:n,baseId:Or(),value:m,onValueChange:f,orientation:i,dir:d,activationMode:c,children:a.jsx(je.div,{dir:d,"data-orientation":i,...u,ref:t})})});qI.displayName=ux;var GI="TabsList",ZI=w.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,o=dx(GI,n),i=HI(n);return a.jsx(KI,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:a.jsx(je.div,{role:"tablist","aria-orientation":o.orientation,...s,ref:t})})});ZI.displayName=GI;var YI="TabsTrigger",QI=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...o}=e,i=dx(YI,n),l=HI(n),c=e2(i.baseId,r),u=t2(i.baseId,r),d=r===i.value;return a.jsx(WI,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(je.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...o,ref:t,onMouseDown:xe(e.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?i.onValueChange(r):m.preventDefault()}),onKeyDown:xe(e.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&i.onValueChange(r)}),onFocus:xe(e.onFocus,()=>{const m=i.activationMode!=="manual";!d&&!s&&m&&i.onValueChange(r)})})})});QI.displayName=YI;var XI="TabsContent",JI=w.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:o,...i}=e,l=dx(XI,n),c=e2(l.baseId,r),u=t2(l.baseId,r),d=r===l.value,m=w.useRef(d);return w.useEffect(()=>{const f=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(_r,{present:s||d,children:({present:f})=>a.jsx(je.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:m.current?"0s":void 0},children:f&&o})})});JI.displayName=XI;function e2(e,t){return`${e}-trigger-${t}`}function t2(e,t){return`${e}-content-${t}`}var K3=qI,n2=ZI,r2=QI,s2=JI;const Ko=K3,Us=w.forwardRef(({className:e,...t},n)=>a.jsx(n2,{ref:n,className:ye("inline-flex h-10 items-center justify-center bg-white p-1 text-quaternary border-b",e),...t}));Us.displayName=n2.displayName;const Je=w.forwardRef(({className:e,...t},n)=>a.jsx(r2,{ref:n,className:ye("inline-flex items-center justify-center whitespace-nowrap px-4 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-tertiary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-tertiary/5 data-[state=active]:text-tertiary data-[state=active]:border-b-2 data-[state=active]:border-tertiary",e),...t}));Je.displayName=r2.displayName;const nt=w.forwardRef(({className:e,...t},n)=>a.jsx(s2,{ref:n,className:ye("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));nt.displayName=s2.displayName;const W3=bu("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Mt=w.forwardRef(({className:e,variant:t,...n},r)=>a.jsx("div",{ref:r,role:"alert",className:ye(W3({variant:t}),e),...n}));Mt.displayName="Alert";const gn=w.forwardRef(({className:e,...t},n)=>a.jsx("h5",{ref:n,className:ye("mb-1 font-medium leading-none tracking-tight",e),...t}));gn.displayName="AlertTitle";const zt=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:ye("text-sm [&_p]:leading-relaxed",e),...t}));zt.displayName="AlertDescription";const H3=bu("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function As({className:e,variant:t,...n}){return a.jsx("div",{className:ye(H3({variant:t}),e),...n})}const De=w.forwardRef(({className:e,type:t,...n},r)=>a.jsx("input",{type:t,className:ye("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-tertiary focus-visible:shadow-[0_0_0_2px_rgba(79,70,229,0.1)] disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200",e),ref:r,...n}));De.displayName="Input";var q3="Label",o2=w.forwardRef((e,t)=>a.jsx(je.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));o2.displayName=q3;var a2=o2;const G3=bu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ct=w.forwardRef(({className:e,...t},n)=>a.jsx(a2,{ref:n,className:ye(G3(),e),...t}));ct.displayName=a2.displayName;function Z3(){const[e,t]=w.useState(!1),[n,r]=w.useState(!1),[s,o]=w.useState(""),[i,l]=w.useState(""),[c,u]=w.useState(!1),[d,m]=w.useState(0),[f,p]=w.useState(""),[v,h]=w.useState(!1),[x,y]=w.useState(null),[g,_]=w.useState(null),[S,E]=w.useState(!1),[A,I]=w.useState("status"),[N,T]=w.useState(null),[$,M]=w.useState(null),{toast:j}=dn();w.useEffect(()=>{P();const D=localStorage.getItem("userEmail");M(D)},[]);async function P(){E(!0);try{const D=Lr();if(t(D),D){const L=await Bc();if(r(L.success),o(L.version||"Unknown"),l(L.id||"Unknown"),L.success)try{const q=(await Ao("LIST_ACCOUNTS")).accounts||[],F=q.length>0;u(F),m(q.length)}catch(O){console.error("Error getting accounts:",O),u(!1),m(0)}}else r(!1),o(""),l(""),u(!1),m(0)}catch(D){console.error("Error checking extension status:",D),r(!1)}finally{E(!1),T(new Date)}}async function b(){E(!0),_(null);try{const D=await Pj();_(D),t(D.installed),r(D.connection.success),D.connection.success&&(o(D.connection.version||"Unknown"),l(D.connection.id||"Unknown")),j({title:D.installed&&D.connection.success?"Extension tests passed":"Extension tests failed",description:D.installed&&D.connection.success?"The extension is properly connected and working":"There were issues with the extension connection",variant:D.installed&&D.connection.success?"default":"destructive"})}catch(D){console.error("Error running tests:",D);const L=D instanceof Error?D.message:String(D);_({installed:e,connection:{success:!1,error:L}}),j({title:"Error running tests",description:L,variant:"destructive"})}finally{E(!1),T(new Date)}}async function V(){h(!0),y(null);try{if(!e||!n){j({title:"Extension Not Connected",description:"Extension must be installed and connected to check vault data",variant:"destructive"});return}const D=await ij(f);if(console.log("Vault data check result:",D),y(D),D.success){const L=D.anyVaultDataFound;j({title:L?"Vault Data Found":"No Vault Data Found",description:L?`Found vault data for ${f} in localStorage`:`No vault data found for ${f} in localStorage`,variant:L?"default":"destructive"})}else j({title:"Vault Check Failed",description:D.error||"Error checking vault data",variant:"destructive"})}catch(D){console.error("Error checking vault data:",D);const L=D instanceof Error?D.message:String(D);y({success:!1,error:L}),j({title:"Error Checking Vault Data",description:L,variant:"destructive"})}finally{h(!1)}}async function Z(){E(!0);try{const D=await Ao("LIST_ACCOUNTS");if(D.success&&D.accounts){const L=D.accounts;return u(L.length>0),m(L.length),j({title:"Accounts retrieved",description:`Found ${L.length} accounts in the extension`}),L}else return u(!1),m(0),j({title:"No accounts found",description:"The extension has no stored accounts",variant:"destructive"}),[]}catch(D){console.error("Error getting accounts:",D);const L=D instanceof Error?D.message:String(D);return u(!1),m(0),j({title:"Error retrieving accounts",description:L,variant:"destructive"}),[]}finally{E(!1)}}return a.jsxs(Ke,{className:"w-full max-w-3xl",children:[a.jsxs(st,{children:[a.jsxs(ot,{className:"flex items-center justify-between",children:[a.jsx("span",{children:"Chrome Extension Status"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(As,{variant:e?"outline":"destructive",children:e?"Installed":"Not Installed"}),a.jsx(As,{variant:n?"outline":"destructive",children:n?"Connected":"Not Connected"}),a.jsx(As,{variant:c?"outline":"secondary",children:c?`${d} Accounts`:"No Accounts"})]})]}),a.jsx(ut,{children:"Debug and test the MATA Chrome extension integration"})]}),a.jsxs(Ko,{value:A,onValueChange:I,className:"w-full",children:[a.jsxs(Us,{className:"grid w-full grid-cols-5",children:[a.jsx(Je,{value:"status",children:"Status"}),a.jsx(Je,{value:"tests",children:"Tests"}),a.jsx(Je,{value:"storage",children:"Storage"}),a.jsx(Je,{value:"vault",children:"Vault Data"}),a.jsx(Je,{value:"accounts",children:"Accounts"})]}),a.jsx(nt,{value:"status",children:a.jsxs(Ue,{className:"space-y-4 pt-4",children:[e?n?a.jsxs(Mt,{children:[a.jsx(gn,{children:"Extension Connected"}),a.jsxs(zt,{children:["The MATA Chrome extension is properly connected.",$&&c&&a.jsxs("span",{className:"block mt-1 text-sm",children:["Current user: ",$]})]})]}):a.jsxs(Mt,{variant:"destructive",children:[a.jsx(gn,{children:"Extension Not Connected"}),a.jsx(zt,{children:"The extension is installed but the content script is not active. Try refreshing the page or reinstalling the extension."})]}):a.jsxs(Mt,{variant:"destructive",children:[a.jsx(gn,{children:"Extension Not Installed"}),a.jsx(zt,{children:"The MATA Chrome extension is not installed or not detected. Please install the extension and refresh the page."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Extension Version"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:s||"Unknown"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Extension ID"}),a.jsx("p",{className:"text-sm font-mono text-muted-foreground",children:i||"Unknown"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Accounts"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:d>0?`${d} accounts found`:"No accounts found"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Last Checked"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N?N.toLocaleTimeString():"Never"})]})]})]})}),a.jsx(nt,{value:"tests",children:a.jsxs(Ue,{className:"space-y-4 pt-4",children:[g&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:`p-4 rounded-md ${g.installed?"bg-green-50":"bg-red-50"}`,children:[a.jsx("h3",{className:"font-medium",children:g.installed?"✅ Extension Installed":"❌ Extension Not Installed"}),a.jsx("p",{className:"text-sm mt-1",children:g.installed?"The extension is properly installed on this browser.":"The MATA extension is not installed or not detected."})]}),g.installed&&a.jsxs("div",{className:`p-4 rounded-md ${g.connection.success?"bg-green-50":"bg-red-50"}`,children:[a.jsx("h3",{className:"font-medium",children:g.connection.success?"✅ Connection Successful":"❌ Connection Failed"}),a.jsx("p",{className:"text-sm mt-1",children:g.connection.success?`Successfully connected to extension (${g.connection.version||"Unknown"})`:`Connection error: ${g.connection.error||"Unknown error"}`})]}),g.storage&&a.jsxs("div",{className:`p-4 rounded-md ${g.storage.success?"bg-green-50":"bg-red-50"}`,children:[a.jsx("h3",{className:"font-medium",children:g.storage.success?"✅ Storage Working":"❌ Storage Issues"}),a.jsx("p",{className:"text-sm mt-1",children:g.storage.success?"Extension storage is working correctly.":`Storage error: ${g.storage.error||"Unknown error"}`})]}),g.customEvents&&a.jsxs("div",{className:`p-4 rounded-md ${g.customEvents.success?"bg-green-50":"bg-red-50"}`,children:[a.jsx("h3",{className:"font-medium",children:g.customEvents.success?"✅ Custom Events Working":"❌ Custom Events Issues"}),a.jsx("p",{className:"text-sm mt-1",children:g.customEvents.success?"Custom event communication is working properly.":`Custom events error: ${g.customEvents.error||"Unknown error"}`})]})]}),!g&&a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-muted-foreground",children:"Run tests to see results"})})]})}),a.jsx(nt,{value:"storage",children:a.jsx(Ue,{className:"space-y-4 pt-4",children:e&&n?a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Mt,{children:[a.jsx(gn,{children:"Storage Diagnostic"}),a.jsx(zt,{children:"Test and examine how the extension storage is working. This helps diagnose synchronization issues between localStorage and chrome.storage."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2 border p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium",children:"localStorage"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Web app primary storage"}),a.jsx(ie,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>{j({title:"Coming Soon",description:"Storage browser feature coming soon"})},children:"Browse localStorage"})]}),a.jsxs("div",{className:"space-y-2 border p-4 rounded-md",children:[a.jsx("h4",{className:"text-sm font-medium",children:"chrome.storage"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Extension backup storage"}),a.jsx(ie,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>{j({title:"Coming Soon",description:"Storage browser feature coming soon"})},children:"Browse chrome.storage"})]})]}),a.jsxs("div",{className:"space-y-2 mt-4",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Storage Sync Status"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ie,{variant:"outline",className:"flex-1",onClick:()=>{j({title:"Coming Soon",description:"Check sync status feature coming soon"})},children:"Check Sync Status"}),a.jsx(ie,{className:"flex-1",onClick:()=>{j({title:"Coming Soon",description:"Force sync feature coming soon"})},children:"Force Sync Now"})]})]})]}):a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-muted-foreground",children:"Extension must be installed and connected to test storage"})})})}),a.jsx(nt,{value:"accounts",children:a.jsx(Ue,{className:"space-y-4 pt-4",children:e&&n?a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Mt,{variant:c?"default":"destructive",children:[a.jsx(gn,{children:c?"Accounts Found":"No Accounts Found"}),a.jsx(zt,{children:c?`The extension has ${d} stored accounts.`:"No accounts are stored in the extension. Log in to store your account."})]}),a.jsx("div",{className:"py-2",children:a.jsx(ie,{variant:"outline",onClick:()=>Z(),disabled:S||!n,children:"Refresh Account List"})})]}):a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-muted-foreground",children:"Extension must be installed and connected to view accounts"})})})}),a.jsx(nt,{value:"vault",children:a.jsx(Ue,{className:"space-y-4 pt-4",children:e&&n?a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Mt,{children:[a.jsx(gn,{children:"Vault Data Diagnostic"}),a.jsx(zt,{children:"Check if user vault data exists in localStorage for a specific email. This helps diagnose extension data retrieval problems."})]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(ct,{htmlFor:"vault-email",className:"text-sm font-medium mb-1 block",children:"Email Address"}),a.jsx(De,{id:"vault-email",placeholder:"user@example.com (optional)",value:f,onChange:D=>p(D.target.value)})]}),a.jsx(ie,{onClick:V,disabled:v||!n,children:v?"Checking...":"Check Vault Data"})]}),$&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Current user: ",a.jsx("span",{className:"font-medium",children:$}),a.jsx(ie,{variant:"link",className:"p-0 h-auto text-xs ml-1",onClick:()=>p($),children:"Use Current"})]}),x&&a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsxs("div",{className:`p-4 rounded-md ${x.success?x.anyVaultDataFound?"bg-green-50":"bg-amber-50":"bg-red-50"}`,children:[a.jsx("h3",{className:"font-medium",children:x.success?x.anyVaultDataFound?"✅ Vault Data Found":"⚠️ No Vault Data Found":"❌ Check Failed"}),a.jsx("p",{className:"text-sm mt-1",children:x.success?x.anyVaultDataFound?`Found vault data for ${f} in localStorage`:`No vault data found for ${f} in localStorage`:`Error: ${x.error||"Unknown error"}`})]}),x.success&&x.details&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Vault Data Details"}),Object.entries(x.details).map(([D,L])=>a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("h5",{className:"text-sm font-medium flex items-center",children:[L?"✅":"❌"," ",D]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:L?"Data found":"No data found"})]},D))]}),x.success&&x.storageKeys&&x.storageKeys.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Storage Keys Found"}),a.jsx("div",{className:"bg-slate-50 p-3 rounded-md",children:a.jsx("pre",{className:"text-xs overflow-auto max-h-[200px]",children:x.storageKeys.join(`
`)})})]}),x.debugData&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("h4",{className:"text-sm font-medium flex items-center justify-between",children:[a.jsx("span",{children:"Raw Debug Data"}),a.jsx(ie,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>{navigator.clipboard.writeText(typeof x.debugData=="string"?x.debugData:JSON.stringify(x.debugData,null,2)),j({title:"Debug Data Copied",description:"Raw debug data copied to clipboard"})},children:"Copy"})]}),a.jsx("div",{className:"bg-slate-50 p-3 rounded-md",children:a.jsx("pre",{className:"text-xs overflow-auto max-h-[200px]",children:typeof x.debugData=="string"?x.debugData:JSON.stringify(x.debugData,null,2)})})]})]})]}):a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-muted-foreground",children:"Extension must be installed and connected to check vault data"})})})})]}),a.jsxs($o,{className:"flex justify-between",children:[a.jsx(ie,{variant:"outline",onClick:P,disabled:S,children:S?"Checking...":"Check Status"}),a.jsx(ie,{onClick:b,disabled:S||!e,children:S?"Running Tests...":"Run Tests"})]})]})}function Y3(){const[e,t]=Be.useState(!0);return a.jsxs("div",{className:"container mx-auto py-8 space-y-8",children:[e&&a.jsx(rF,{}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"MATA Extension Test Page"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(ie,{variant:"outline",onClick:()=>t(n=>!n),children:e?"Hide Banner":"Show Banner"}),a.jsx(Rf,{})]})]}),a.jsx("p",{className:"text-muted-foreground",children:"This page allows you to test the Chrome extension integration components and see their behavior in different states."}),a.jsxs(Ko,{defaultValue:"indicator",children:[a.jsxs(Us,{children:[a.jsx(Je,{value:"indicator",children:"Extension Indicator"}),a.jsx(Je,{value:"banner",children:"Extension Banner"}),a.jsx(Je,{value:"debug",children:"Debug Panel"})]}),a.jsx(nt,{value:"indicator",className:"space-y-4 pt-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Extension Status Indicator"}),a.jsx(ut,{children:"A compact indicator showing the extension status, perfect for headers or navigation bars."})]}),a.jsx(Ue,{className:"flex justify-center py-8",children:a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx(Rf,{}),a.jsx("span",{className:"text-sm text-muted-foreground mt-2",children:"(Hover to see details)"})]})}),a.jsx($o,{children:a.jsx("p",{className:"text-sm text-muted-foreground",children:"This indicator will automatically refresh every 30 seconds to keep the status up to date."})})]})}),a.jsx(nt,{value:"banner",className:"space-y-4 pt-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Extension Banner"}),a.jsx(ut,{children:"A full-width banner that appears at the top of the page to alert users about extension status."})]}),a.jsxs(Ue,{children:[a.jsx("p",{className:"mb-4",children:"The banner will automatically show based on the extension status:"}),a.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[a.jsx("li",{children:"Not installed - Red banner prompting installation"}),a.jsx("li",{children:"Not connected - Yellow banner suggesting a page refresh"}),a.jsx("li",{children:"No accounts - Blue banner prompting the user to log in"}),a.jsx("li",{children:"User not synced - Yellow banner indicating account mismatch"}),a.jsx("li",{children:"Fully synced - Banner is hidden"})]})]}),a.jsx($o,{className:"flex justify-end",children:a.jsx(ie,{variant:"outline",onClick:()=>t(n=>!n),children:e?"Hide Banner":"Show Banner"})})]})}),a.jsx(nt,{value:"debug",className:"space-y-4 pt-4",children:a.jsx(Z3,{})})]}),a.jsxs("div",{className:"border-t pt-8 mt-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Local Storage Test Tools"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx(ie,{variant:"outline",onClick:()=>{localStorage.setItem("userEmail","test@example.com"),window.location.reload()},children:"Set Test User Email"}),a.jsx(ie,{variant:"outline",onClick:()=>{localStorage.removeItem("userEmail"),window.location.reload()},children:"Clear User Email"}),a.jsx(ie,{variant:"secondary",onClick:()=>{const n=localStorage.getItem("userEmail");alert(`Current user email: ${n||"None"}`)},children:"Show Current User"})]})]}),a.jsxs("div",{className:"border-t pt-8 mt-8",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Extension Data Test Tools"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Create Test Password"}),a.jsx(ut,{children:"Add a test password to localStorage for the extension to find"})]}),a.jsx(Ue,{children:a.jsx(ie,{variant:"default",onClick:()=>{const n=localStorage.getItem("userEmail")||"test@example.com",s=`${n.replace(/[@.]/g,"_")}_passwords`,o={id:`pass_${Date.now()}`,website:"example.com",username:n,password:"test123password",name:"Example Website",lastUpdated:new Date().toISOString(),notes:"This is a test password created for extension testing"};let i=[];try{const l=localStorage.getItem(s);l&&(i=JSON.parse(l),typeof i=="object"&&i!==null?Array.isArray(i)||(i.items&&Array.isArray(i.items)?i=i.items:i.data&&Array.isArray(i.data)?i=i.data:i=[]):i=[])}catch(l){console.error("Error parsing passwords:",l),i=[]}i.push(o),localStorage.setItem(s,JSON.stringify(i)),alert(`Created test password for ${n}
Key: ${s}
Password count: ${i.length}`)},children:"Create Test Password"})})]}),a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Storage Data Info"}),a.jsx(ut,{children:"View information about current localStorage data"})]}),a.jsx(Ue,{children:a.jsx(ie,{variant:"outline",onClick:()=>{const n=localStorage.getItem("userEmail")||"Not set",r=n.replace(/[@.]/g,"_");let s=`User Email: ${n}
`;s+=`Sanitized Format: ${r}

`;const o=`${r}_passwords`;try{const i=localStorage.getItem(o);if(i){const l=JSON.parse(i);Array.isArray(l)?s+=`Passwords: ${l.length} (Array format)
`:l.items&&Array.isArray(l.items)?s+=`Passwords: ${l.items.length} (Object with items array)
`:l.data&&Array.isArray(l.data)?s+=`Passwords: ${l.data.length} (Object with data array)
`:s+=`Passwords: Unknown format
`}else s+=`Passwords: Not found
`}catch{s+=`Passwords: Error parsing data
`}s+=`
All localStorage keys:
`;for(let i=0;i<localStorage.length;i++){const l=localStorage.key(i);s+=`- ${l}
`}alert(s)},children:"View Storage Info"})})]})]})]})]})}function Q3(){localStorage.removeItem("login_error"),localStorage.removeItem("login_error_time"),localStorage.removeItem("vault_initialization_error"),localStorage.removeItem("vault_initialization_error_time"),localStorage.removeItem("login_steps_completed"),localStorage.removeItem("vault_initialization_details"),localStorage.removeItem("vault_unlock_without_init"),["passwords","contacts","payments","payment_history","bank_accounts"].forEach(t=>{localStorage.removeItem(`vault_${t}_error`)}),console.log("Cleared all vault initialization errors from localStorage")}Q3();function i2(e){if(!e)return"Not available";const t="did:mata:";return e.length<=16?t+e:t+e.substring(0,8)+"..."+e.substring(e.length-8)}function l2(e,t,n){return new Promise(r=>{if(!e){n&&n(new Error("No DID available to copy")),r(!1);return}const s=`did:mata:${e}`;navigator.clipboard.writeText(s).then(()=>{t&&t(),r(!0)}).catch(o=>{console.error("Failed to copy DID:",o),n&&n(o),r(!1)})})}function X3(){try{let e=null;const t=localStorage.getItem("userData");if(t)try{const n=JSON.parse(t);n&&n.publicKey&&(e=n.publicKey)}catch{}if(!e){const n=localStorage.getItem("auth_user");if(n)try{const r=JSON.parse(n);r&&r.publicKey&&(e=r.publicKey)}catch{}}if(!e){const n=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("last_email");if(n){const s=`mata_keys_${n.replace(/[@.]/g,"_")}`,o=localStorage.getItem(s);if(o)try{const i=JSON.parse(o);i&&i.publicKey&&(e=i.publicKey)}catch{}}}return e?{did:`did:mata:${e}`,publicKey:e}:{did:null,publicKey:null}}catch(e){return console.error("Error safely getting user DID:",e),{did:null,publicKey:null}}}function c2(){const[e,t]=w.useState({did:null,publicKey:null,isLoading:!0}),n=w.useRef(0),r=5,s=500,o=w.useCallback(()=>{t(l=>({...l,isLoading:!0}));const i=X3();if(i.publicKey)n.current=0,t({did:i.did,publicKey:i.publicKey,isLoading:!1});else if(n.current<r){n.current++,console.log(`DID not found, retry attempt ${n.current}/${r}`);const l=s*Math.pow(2,n.current-1);setTimeout(()=>{console.log(`Retrying DID retrieval after ${l}ms delay`),o()},l)}else console.warn(`DID not found after ${r} attempts, giving up`),t({did:null,publicKey:null,isLoading:!1})},[]);return w.useEffect(()=>{o();const i=c=>{var u;(c.key==="userData"||c.key==="auth_user"||(u=c.key)!=null&&u.startsWith("mata_keys_")||c.key==="session_email"||c.key==="current_user_email"||c.key==="last_email")&&(n.current=0,o())};window.addEventListener("storage",i);const l=()=>{console.log("Login completion detected, refreshing DID"),n.current=0,o()};return window.addEventListener("loginComplete",l),window.addEventListener("userKeysUpdated",l),()=>{window.removeEventListener("storage",i),window.removeEventListener("loginComplete",l),window.removeEventListener("userKeysUpdated",l)}},[o]),{...e,refreshDID:o}}const $f=w.forwardRef(({className:e,...t},n)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:n,className:ye("w-full caption-bottom text-sm",e),...t})}));$f.displayName="Table";const Of=w.forwardRef(({className:e,...t},n)=>a.jsx("thead",{ref:n,className:ye("[&_tr]:border-b",e),...t}));Of.displayName="TableHeader";const Mf=w.forwardRef(({className:e,...t},n)=>a.jsx("tbody",{ref:n,className:ye("[&_tr:last-child]:border-0",e),...t}));Mf.displayName="TableBody";const J3=w.forwardRef(({className:e,...t},n)=>a.jsx("tfoot",{ref:n,className:ye("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));J3.displayName="TableFooter";const ga=w.forwardRef(({className:e,...t},n)=>a.jsx("tr",{ref:n,className:ye("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ga.displayName="TableRow";const Xt=w.forwardRef(({className:e,...t},n)=>a.jsx("th",{ref:n,className:ye("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Xt.displayName="TableHead";const en=w.forwardRef(({className:e,...t},n)=>a.jsx("td",{ref:n,className:ye("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));en.displayName="TableCell";const u2=w.forwardRef(({className:e,...t},n)=>a.jsx("caption",{ref:n,className:ye("mt-4 text-sm text-muted-foreground",e),...t}));u2.displayName="TableCaption";function Ua({className:e,...t}){return a.jsx("div",{className:ye("animate-pulse rounded-md bg-muted",e),...t})}function fx(e){const t=w.useRef({value:e,previous:e});return w.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var mx="Switch",[eV,QK]=ms(mx),[tV,nV]=eV(mx),d2=w.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:o,required:i,disabled:l,value:c="on",onCheckedChange:u,form:d,...m}=e,[f,p]=w.useState(null),v=qe(t,_=>p(_)),h=w.useRef(!1),x=f?d||!!f.closest("form"):!0,[y=!1,g]=as({prop:s,defaultProp:o,onChange:u});return a.jsxs(tV,{scope:n,checked:y,disabled:l,children:[a.jsx(je.button,{type:"button",role:"switch","aria-checked":y,"aria-required":i,"data-state":h2(y),"data-disabled":l?"":void 0,disabled:l,value:c,...m,ref:v,onClick:xe(e.onClick,_=>{g(S=>!S),x&&(h.current=_.isPropagationStopped(),h.current||_.stopPropagation())})}),x&&a.jsx(rV,{control:f,bubbles:!h.current,name:r,value:c,checked:y,required:i,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});d2.displayName=mx;var f2="SwitchThumb",m2=w.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=nV(f2,n);return a.jsx(je.span,{"data-state":h2(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});m2.displayName=f2;var rV=e=>{const{control:t,checked:n,bubbles:r=!0,...s}=e,o=w.useRef(null),i=fx(n),l=nx(t);return w.useEffect(()=>{const c=o.current,u=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(u,"checked").set;if(i!==n&&m){const f=new Event("click",{bubbles:r});m.call(c,n),c.dispatchEvent(f)}},[i,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function h2(e){return e?"checked":"unchecked"}var p2=d2,sV=m2;const g2=w.forwardRef(({className:e,...t},n)=>a.jsx(p2,{className:ye("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-tertiary focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-tertiary data-[state=unchecked]:bg-gray-200",e),...t,ref:n,children:a.jsx(sV,{className:ye("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-md ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));g2.displayName=p2.displayName;var qg=["Enter"," "],oV=["ArrowDown","PageUp","Home"],y2=["ArrowUp","PageDown","End"],aV=[...oV,...y2],iV={ltr:[...qg,"ArrowRight"],rtl:[...qg,"ArrowLeft"]},lV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Iu="Menu",[Hc,cV,uV]=Nm(Iu),[Ra,v2]=ms(Iu,[uV,xl,Zm]),Ym=xl(),x2=Zm(),[dV,$a]=Ra(Iu),[fV,Tu]=Ra(Iu),w2=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:o,modal:i=!0}=e,l=Ym(t),[c,u]=w.useState(null),d=w.useRef(!1),m=vn(o),f=qm(s);return w.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),a.jsx(ox,{...l,children:a.jsx(dV,{scope:t,open:n,onOpenChange:m,content:c,onContentChange:u,children:a.jsx(fV,{scope:t,onClose:w.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:d,dir:f,modal:i,children:r})})})};w2.displayName=Iu;var mV="MenuAnchor",hx=w.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=Ym(n);return a.jsx(ax,{...s,...r,ref:t})});hx.displayName=mV;var px="MenuPortal",[hV,_2]=Ra(px,{forceMount:void 0}),S2=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,o=$a(px,t);return a.jsx(hV,{scope:t,forceMount:n,children:a.jsx(_r,{present:n||o.open,children:a.jsx(_u,{asChild:!0,container:s,children:r})})})};S2.displayName=px;var yr="MenuContent",[pV,gx]=Ra(yr),b2=w.forwardRef((e,t)=>{const n=_2(yr,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,o=$a(yr,e.__scopeMenu),i=Tu(yr,e.__scopeMenu);return a.jsx(Hc.Provider,{scope:e.__scopeMenu,children:a.jsx(_r,{present:r||o.open,children:a.jsx(Hc.Slot,{scope:e.__scopeMenu,children:i.modal?a.jsx(gV,{...s,ref:t}):a.jsx(yV,{...s,ref:t})})})})}),gV=w.forwardRef((e,t)=>{const n=$a(yr,e.__scopeMenu),r=w.useRef(null),s=qe(t,r);return w.useEffect(()=>{const o=r.current;if(o)return Lv(o)},[]),a.jsx(yx,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:xe(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),yV=w.forwardRef((e,t)=>{const n=$a(yr,e.__scopeMenu);return a.jsx(yx,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),yx=w.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:m,onInteractOutside:f,onDismiss:p,disableOutsideScroll:v,...h}=e,x=$a(yr,n),y=Tu(yr,n),g=Ym(n),_=x2(n),S=cV(n),[E,A]=w.useState(null),I=w.useRef(null),N=qe(t,I,x.onContentChange),T=w.useRef(0),$=w.useRef(""),M=w.useRef(0),j=w.useRef(null),P=w.useRef("right"),b=w.useRef(0),V=v?Lm:w.Fragment,Z=v?{as:Ms,allowPinchZoom:!0}:void 0,D=O=>{var G,te;const q=$.current+O,F=S().filter(le=>!le.disabled),W=document.activeElement,ce=(G=F.find(le=>le.ref.current===W))==null?void 0:G.textValue,ae=F.map(le=>le.textValue),K=IV(ae,q,ce),ne=(te=F.find(le=>le.textValue===K))==null?void 0:te.ref.current;(function le(fe){$.current=fe,window.clearTimeout(T.current),fe!==""&&(T.current=window.setTimeout(()=>le(""),1e3))})(q),ne&&setTimeout(()=>ne.focus())};w.useEffect(()=>()=>window.clearTimeout(T.current),[]),zv();const L=w.useCallback(O=>{var F,W;return P.current===((F=j.current)==null?void 0:F.side)&&AV(O,(W=j.current)==null?void 0:W.area)},[]);return a.jsx(pV,{scope:n,searchRef:$,onItemEnter:w.useCallback(O=>{L(O)&&O.preventDefault()},[L]),onItemLeave:w.useCallback(O=>{var q;L(O)||((q=I.current)==null||q.focus(),A(null))},[L]),onTriggerLeave:w.useCallback(O=>{L(O)&&O.preventDefault()},[L]),pointerGraceTimerRef:M,onPointerGraceIntentChange:w.useCallback(O=>{j.current=O},[]),children:a.jsx(V,{...Z,children:a.jsx(Mm,{asChild:!0,trapped:s,onMountAutoFocus:xe(o,O=>{var q;O.preventDefault(),(q=I.current)==null||q.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:a.jsx(ml,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:m,onInteractOutside:f,onDismiss:p,children:a.jsx(KI,{asChild:!0,..._,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:A,onEntryFocus:xe(c,O=>{y.isUsingKeyboardRef.current||O.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(ix,{role:"menu","aria-orientation":"vertical","data-state":L2(x.open),"data-radix-menu-content":"",dir:y.dir,...g,...h,ref:N,style:{outline:"none",...h.style},onKeyDown:xe(h.onKeyDown,O=>{const F=O.target.closest("[data-radix-menu-content]")===O.currentTarget,W=O.ctrlKey||O.altKey||O.metaKey,ce=O.key.length===1;F&&(O.key==="Tab"&&O.preventDefault(),!W&&ce&&D(O.key));const ae=I.current;if(O.target!==ae||!aV.includes(O.key))return;O.preventDefault();const ne=S().filter(G=>!G.disabled).map(G=>G.ref.current);y2.includes(O.key)&&ne.reverse(),NV(ne)}),onBlur:xe(e.onBlur,O=>{O.currentTarget.contains(O.target)||(window.clearTimeout(T.current),$.current="")}),onPointerMove:xe(e.onPointerMove,qc(O=>{const q=O.target,F=b.current!==O.clientX;if(O.currentTarget.contains(q)&&F){const W=O.clientX>b.current?"right":"left";P.current=W,b.current=O.clientX}}))})})})})})})});b2.displayName=yr;var vV="MenuGroup",vx=w.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(je.div,{role:"group",...r,ref:t})});vx.displayName=vV;var xV="MenuLabel",E2=w.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(je.div,{...r,ref:t})});E2.displayName=xV;var zf="MenuItem",sS="menu.itemSelect",Qm=w.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,o=w.useRef(null),i=Tu(zf,e.__scopeMenu),l=gx(zf,e.__scopeMenu),c=qe(t,o),u=w.useRef(!1),d=()=>{const m=o.current;if(!n&&m){const f=new CustomEvent(sS,{bubbles:!0,cancelable:!0});m.addEventListener(sS,p=>r==null?void 0:r(p),{once:!0}),pv(m,f),f.defaultPrevented?u.current=!1:i.onClose()}};return a.jsx(k2,{...s,ref:c,disabled:n,onClick:xe(e.onClick,d),onPointerDown:m=>{var f;(f=e.onPointerDown)==null||f.call(e,m),u.current=!0},onPointerUp:xe(e.onPointerUp,m=>{var f;u.current||(f=m.currentTarget)==null||f.click()}),onKeyDown:xe(e.onKeyDown,m=>{const f=l.searchRef.current!=="";n||f&&m.key===" "||qg.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});Qm.displayName=zf;var k2=w.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...o}=e,i=gx(zf,n),l=x2(n),c=w.useRef(null),u=qe(t,c),[d,m]=w.useState(!1),[f,p]=w.useState("");return w.useEffect(()=>{const v=c.current;v&&p((v.textContent??"").trim())},[o.children]),a.jsx(Hc.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(WI,{asChild:!0,...l,focusable:!r,children:a.jsx(je.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:u,onPointerMove:xe(e.onPointerMove,qc(v=>{r?i.onItemLeave(v):(i.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:xe(e.onPointerLeave,qc(v=>i.onItemLeave(v))),onFocus:xe(e.onFocus,()=>m(!0)),onBlur:xe(e.onBlur,()=>m(!1))})})})}),wV="MenuCheckboxItem",C2=w.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return a.jsx(A2,{scope:e.__scopeMenu,checked:n,children:a.jsx(Qm,{role:"menuitemcheckbox","aria-checked":Lf(n)?"mixed":n,...s,ref:t,"data-state":wx(n),onSelect:xe(s.onSelect,()=>r==null?void 0:r(Lf(n)?!0:!n),{checkForDefaultPrevented:!1})})})});C2.displayName=wV;var N2="MenuRadioGroup",[_V,SV]=Ra(N2,{value:void 0,onValueChange:()=>{}}),j2=w.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,o=vn(r);return a.jsx(_V,{scope:e.__scopeMenu,value:n,onValueChange:o,children:a.jsx(vx,{...s,ref:t})})});j2.displayName=N2;var I2="MenuRadioItem",T2=w.forwardRef((e,t)=>{const{value:n,...r}=e,s=SV(I2,e.__scopeMenu),o=n===s.value;return a.jsx(A2,{scope:e.__scopeMenu,checked:o,children:a.jsx(Qm,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":wx(o),onSelect:xe(r.onSelect,()=>{var i;return(i=s.onValueChange)==null?void 0:i.call(s,n)},{checkForDefaultPrevented:!1})})})});T2.displayName=I2;var xx="MenuItemIndicator",[A2,bV]=Ra(xx,{checked:!1}),P2=w.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,o=bV(xx,n);return a.jsx(_r,{present:r||Lf(o.checked)||o.checked===!0,children:a.jsx(je.span,{...s,ref:t,"data-state":wx(o.checked)})})});P2.displayName=xx;var EV="MenuSeparator",D2=w.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(je.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});D2.displayName=EV;var kV="MenuArrow",R2=w.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=Ym(n);return a.jsx(lx,{...s,...r,ref:t})});R2.displayName=kV;var CV="MenuSub",[XK,$2]=Ra(CV),Hl="MenuSubTrigger",O2=w.forwardRef((e,t)=>{const n=$a(Hl,e.__scopeMenu),r=Tu(Hl,e.__scopeMenu),s=$2(Hl,e.__scopeMenu),o=gx(Hl,e.__scopeMenu),i=w.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=o,u={__scopeMenu:e.__scopeMenu},d=w.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return w.useEffect(()=>d,[d]),w.useEffect(()=>{const m=l.current;return()=>{window.clearTimeout(m),c(null)}},[l,c]),a.jsx(hx,{asChild:!0,...u,children:a.jsx(k2,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":L2(n.open),...e,ref:Cm(t,s.onTriggerChange),onClick:m=>{var f;(f=e.onClick)==null||f.call(e,m),!(e.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:xe(e.onPointerMove,qc(m=>{o.onItemEnter(m),!m.defaultPrevented&&!e.disabled&&!n.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:xe(e.onPointerLeave,qc(m=>{var p,v;d();const f=(p=n.content)==null?void 0:p.getBoundingClientRect();if(f){const h=(v=n.content)==null?void 0:v.dataset.side,x=h==="right",y=x?-5:5,g=f[x?"left":"right"],_=f[x?"right":"left"];o.onPointerGraceIntentChange({area:[{x:m.clientX+y,y:m.clientY},{x:g,y:f.top},{x:_,y:f.top},{x:_,y:f.bottom},{x:g,y:f.bottom}],side:h}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(m),m.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:xe(e.onKeyDown,m=>{var p;const f=o.searchRef.current!=="";e.disabled||f&&m.key===" "||iV[r.dir].includes(m.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),m.preventDefault())})})})});O2.displayName=Hl;var M2="MenuSubContent",z2=w.forwardRef((e,t)=>{const n=_2(yr,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,o=$a(yr,e.__scopeMenu),i=Tu(yr,e.__scopeMenu),l=$2(M2,e.__scopeMenu),c=w.useRef(null),u=qe(t,c);return a.jsx(Hc.Provider,{scope:e.__scopeMenu,children:a.jsx(_r,{present:r||o.open,children:a.jsx(Hc.Slot,{scope:e.__scopeMenu,children:a.jsx(yx,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var m;i.isUsingKeyboardRef.current&&((m=c.current)==null||m.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:xe(e.onFocusOutside,d=>{d.target!==l.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:xe(e.onEscapeKeyDown,d=>{i.onClose(),d.preventDefault()}),onKeyDown:xe(e.onKeyDown,d=>{var p;const m=d.currentTarget.contains(d.target),f=lV[i.dir].includes(d.key);m&&f&&(o.onOpenChange(!1),(p=l.trigger)==null||p.focus(),d.preventDefault())})})})})})});z2.displayName=M2;function L2(e){return e?"open":"closed"}function Lf(e){return e==="indeterminate"}function wx(e){return Lf(e)?"indeterminate":e?"checked":"unchecked"}function NV(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function jV(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function IV(e,t,n){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let i=jV(e,Math.max(o,0));s.length===1&&(i=i.filter(u=>u!==n));const c=i.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function TV(e,t){const{x:n,y:r}=e;let s=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const l=t[o].x,c=t[o].y,u=t[i].x,d=t[i].y;c>r!=d>r&&n<(u-l)*(r-c)/(d-c)+l&&(s=!s)}return s}function AV(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return TV(n,t)}function qc(e){return t=>t.pointerType==="mouse"?e(t):void 0}var PV=w2,DV=hx,RV=S2,$V=b2,OV=vx,MV=E2,zV=Qm,LV=C2,FV=j2,VV=T2,UV=P2,BV=D2,KV=R2,WV=O2,HV=z2,_x="DropdownMenu",[qV,JK]=ms(_x,[v2]),An=v2(),[GV,F2]=qV(_x),V2=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:o,onOpenChange:i,modal:l=!0}=e,c=An(t),u=w.useRef(null),[d=!1,m]=as({prop:s,defaultProp:o,onChange:i});return a.jsx(GV,{scope:t,triggerId:Or(),triggerRef:u,contentId:Or(),open:d,onOpenChange:m,onOpenToggle:w.useCallback(()=>m(f=>!f),[m]),modal:l,children:a.jsx(PV,{...c,open:d,onOpenChange:m,dir:r,modal:l,children:n})})};V2.displayName=_x;var U2="DropdownMenuTrigger",B2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,o=F2(U2,n),i=An(n);return a.jsx(DV,{asChild:!0,...i,children:a.jsx(je.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Cm(t,o.triggerRef),onPointerDown:xe(e.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(o.onOpenToggle(),o.open||l.preventDefault())}),onKeyDown:xe(e.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&o.onOpenToggle(),l.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});B2.displayName=U2;var ZV="DropdownMenuPortal",K2=e=>{const{__scopeDropdownMenu:t,...n}=e,r=An(t);return a.jsx(RV,{...r,...n})};K2.displayName=ZV;var W2="DropdownMenuContent",H2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=F2(W2,n),o=An(n),i=w.useRef(!1);return a.jsx($V,{id:s.contentId,"aria-labelledby":s.triggerId,...o,...r,ref:t,onCloseAutoFocus:xe(e.onCloseAutoFocus,l=>{var c;i.current||(c=s.triggerRef.current)==null||c.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:xe(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});H2.displayName=W2;var YV="DropdownMenuGroup",QV=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(OV,{...s,...r,ref:t})});QV.displayName=YV;var XV="DropdownMenuLabel",q2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(MV,{...s,...r,ref:t})});q2.displayName=XV;var JV="DropdownMenuItem",G2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(zV,{...s,...r,ref:t})});G2.displayName=JV;var eU="DropdownMenuCheckboxItem",Z2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(LV,{...s,...r,ref:t})});Z2.displayName=eU;var tU="DropdownMenuRadioGroup",nU=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(FV,{...s,...r,ref:t})});nU.displayName=tU;var rU="DropdownMenuRadioItem",Y2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(VV,{...s,...r,ref:t})});Y2.displayName=rU;var sU="DropdownMenuItemIndicator",Q2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(UV,{...s,...r,ref:t})});Q2.displayName=sU;var oU="DropdownMenuSeparator",X2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(BV,{...s,...r,ref:t})});X2.displayName=oU;var aU="DropdownMenuArrow",iU=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(KV,{...s,...r,ref:t})});iU.displayName=aU;var lU="DropdownMenuSubTrigger",J2=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(WV,{...s,...r,ref:t})});J2.displayName=lU;var cU="DropdownMenuSubContent",eT=w.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=An(n);return a.jsx(HV,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});eT.displayName=cU;var uU=V2,dU=B2,fU=K2,tT=H2,nT=q2,rT=G2,sT=Z2,oT=Y2,aT=Q2,iT=X2,lT=J2,cT=eT;const Sx=uU,bx=dU,mU=w.forwardRef(({className:e,inset:t,children:n,...r},s)=>a.jsxs(lT,{ref:s,className:ye("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[n,a.jsx(X4,{className:"ml-auto h-4 w-4"})]}));mU.displayName=lT.displayName;const hU=w.forwardRef(({className:e,...t},n)=>a.jsx(cT,{ref:n,className:ye("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));hU.displayName=cT.displayName;const Xm=w.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(fU,{children:a.jsx(tT,{ref:r,sideOffset:t,className:ye("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Xm.displayName=tT.displayName;const Bn=w.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(rT,{ref:r,className:ye("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n}));Bn.displayName=rT.displayName;const pU=w.forwardRef(({className:e,children:t,checked:n,...r},s)=>a.jsxs(sT,{ref:s,className:ye("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(aT,{children:a.jsx(Da,{className:"h-4 w-4"})})}),t]}));pU.displayName=sT.displayName;const gU=w.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(oT,{ref:r,className:ye("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(aT,{children:a.jsx(ez,{className:"h-2 w-2 fill-current"})})}),t]}));gU.displayName=oT.displayName;const uT=w.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(nT,{ref:r,className:ye("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));uT.displayName=nT.displayName;const Gc=w.forwardRef(({className:e,...t},n)=>a.jsx(iT,{ref:n,className:ye("-mx-1 my-1 h-px bg-muted",e),...t}));Gc.displayName=iT.displayName;var lt=(e=>(e.PENDING="pending",e.PROCESSING="processing",e.COMPLETED="completed",e.FAILED="failed",e.REFUNDED="refunded",e.PARTIALLY_REFUNDED="partially_refunded",e.CANCELED="canceled",e))(lt||{}),kn=(e=>(e.SUBSCRIPTION="subscription",e.ONE_TIME="one_time",e.RENEWAL="renewal",e.REFUND="refund",e.PLAN_CHANGE="plan_change",e.CREDIT="credit",e.TRIAL="trial",e))(kn||{});const dT="payment_history",Gg="transaction";function fT(e,t="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:2}).format(e/100)}function yU(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function vU(e){switch(e){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pending":case"processing":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"failed":case"canceled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"refunded":case"partially_refunded":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}}function mT(e){return e?e.toLowerCase().trim().replace(/[@.]/g,"_"):""}function Jm(e,t){return`user_${mT(e)}_${t}`}const up=Object.freeze(Object.defineProperty({__proto__:null,generateVaultId:Jm,sanitizeEmail:mT},Symbol.toStringTag,{value:"Module"}));function eh(e){return e?Jm(e,dT):""}async function go(e){if(!e)return console.error("Cannot initialize payment history vault without email"),!1;try{console.log(`Initializing payment history vault for ${e}...`);const{setVaultUserContext:t}=await oe(async()=>{const{setVaultUserContext:l}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:l}},void 0);t(e);const{resetFallbackState:n}=await oe(async()=>{const{resetFallbackState:l}=await Promise.resolve().then(()=>tt);return{resetFallbackState:l}},void 0);n();const r="wasm";if(console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations"),pe.isInitialized()||(console.log("Vault service not initialized, initializing now..."),await pe.initialize()),!pe.isUnlocked())return console.warn("Vault is locked! Cannot initialize payment history vault."),!1;const s=await pe.getVaults(),o=eh(e);return console.log(`Checking for payment history vault: ${o}`),s.some(l=>l.id===o)?(console.log(`Payment history vault already exists: ${o}`),!0):(console.log(`Creating payment history vault for ${e}...`),await pe.createNewVault("Payment History",dT,o),console.log(`Using encryption method ${r} for vault operations`),console.log(`Payment history vault created: ${o} using encryption method: ${r}`),!0)}catch(t){return console.error("Error initializing payment history vault:",t),!1}}async function Ld(e,t){if(!e||!t)return console.error("Cannot save payment record: missing email or record data"),!1;try{console.log("Saving payment record to vault:",t.id);const{setVaultUserContext:n}=await oe(async()=>{const{setVaultUserContext:c}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:c}},void 0);n(e);const{resetFallbackState:r}=await oe(async()=>{const{resetFallbackState:c}=await Promise.resolve().then(()=>tt);return{resetFallbackState:c}},void 0);r();const s="wasm";if(console.log("Using standardized WASM-first approach with WebCrypto fallback for saving payment record"),!await go(e))throw new Error("Failed to initialize payment history vault");const i=eh(e),l={name:`${t.type} - ${t.amount/100} ${t.currency}`,type:Gg,description:t.description,tags:[t.status,t.type,t.currency],searchTerms:[t.transactionId,t.description,t.status,t.type,t.currency,new Date(t.createdAt).toLocaleDateString()],encryptionMethod:s};return await pe.addItem(i,`Payment ${t.id}`,Gg,t,l,s),console.log(`Payment record ${t.id} saved successfully to vault ${i} with method ${s}`),!0}catch(n){return console.error("Error saving payment record:",n),!1}}async function Ff(e){if(!e)return console.error("Cannot get payment history: missing email"),[];try{console.log("======= RETRIEVING PAYMENT HISTORY ======="),console.log(`Getting payment history from vault for ${e}...`);const{setVaultUserContext:t}=await oe(async()=>{const{setVaultUserContext:c}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:c}},void 0);t(e);const{resetFallbackState:n}=await oe(async()=>{const{resetFallbackState:c}=await Promise.resolve().then(()=>tt);return{resetFallbackState:c}},void 0);if(n(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations"),!pe.isUnlocked())return console.warn("Vault is locked! Cannot get payment history."),[];if(!await go(e))return console.warn("Payment history vault not initialized"),[];const s=eh(e);let o=[];try{o=await pe.getItems(s),console.log(`Found ${o.length} items in payment history vault`)}catch(c){console.error(`Error retrieving items from payment history vault: ${c}`),console.log("Attempting to reinitialize payment history vault and retry");try{await go(e),o=await pe.getItems(s),console.log(`Retrieval successful after reinitialization! Found ${o.length} items`)}catch(u){return console.error(`Failed to retrieve payment history after reinitialization: ${u}`),[]}}o.length===0&&(console.log("No payment history found in vault - checking if vault exists"),(await pe.getVaults()).find(d=>d.id===s)?console.log("Payment history vault exists but is empty"):(console.log("Payment history vault doesn't exist, creating now..."),await go(e)));const l=o.filter(c=>c&&c.metadata&&c.metadata.type===Gg).map(c=>{try{return c.data?c.data:(console.warn(`Item ${c.id} has no data, skipping`),null)}catch(u){return console.error(`Error processing payment record ${c.id}:`,u),null}}).filter(c=>c!==null).filter(Boolean);return l.sort((c,u)=>u.createdAt-c.createdAt),console.log(`Processed ${l.length} payment records for ${e}`),l}catch(t){console.error("Error retrieving payment history:",t);try{return console.log("Attempting to initialize payment history vault after retrieval error"),await go(e),[]}catch(n){return console.error("Failed to initialize payment history vault:",n),[]}}}async function hT(e,t=1){console.log(`Syncing payment history for user ${t} (${e})...`);try{const{setVaultUserContext:n}=await oe(async()=>{const{setVaultUserContext:d}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:d}},void 0);n(e);const{resetFallbackState:r}=await oe(async()=>{const{resetFallbackState:d}=await Promise.resolve().then(()=>tt);return{resetFallbackState:d}},void 0);r(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations"),await go(e);const s=await Ff(e),o=new Set(s.map(d=>d.id)),i=await fetch(`/api/payment-history?userId=${t}`);if(!i.ok){if(console.error(`Failed to fetch payment history from server: ${i.status} ${i.statusText}`),s.length===0){console.log("No existing records found in vault, adding sample records as fallback");const d=oS(t);for(const m of d)await Ld(e,m);console.log(`Added ${d.length} sample payment records to vault as fallback`)}return!1}const l=await i.json();console.log(`Fetched ${l.length} payment records from server for user ${t}`);const c=l.map(d=>({id:d.id.toString(),transactionId:d.transaction_id||`tx_${Math.random().toString(36).substring(2,10)}`,userId:d.user_id,amount:Math.round(parseFloat(d.amount)*100),currency:d.currency||"USD",status:d.status.toLowerCase(),type:xU(d.payment_method),description:d.description||"Payment transaction",metadata:{paymentMethod:d.payment_method,dbRecordId:d.id},createdAt:d.created_at?new Date(d.created_at).getTime():Date.now(),updatedAt:d.created_at?new Date(d.created_at).getTime():Date.now()}));let u=0;for(const d of c)o.has(d.id)||(await Ld(e,d),u++);return console.log(`Added ${u} new payment records to vault for ${e}`),!0}catch(n){if(console.error("Error syncing payment history with server:",n),(await Ff(e)).length===0){console.log("No existing records found in vault, adding sample records as fallback");const s=oS(t);for(const o of s)await Ld(e,o);console.log(`Added ${s.length} sample payment records to vault as fallback`)}return!1}}function xU(e){switch(e==null?void 0:e.toLowerCase()){case"credit_card":return kn.ONE_TIME;case"bank_transfer":return kn.ONE_TIME;case"paypal":return kn.ONE_TIME;default:return kn.SUBSCRIPTION}}function oS(e){const t=Date.now(),n=24*60*60*1e3;return[{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:1999,currency:"USD",status:lt.COMPLETED,type:kn.SUBSCRIPTION,description:"Monthly Subscription - Secure Plan",createdAt:t-30*n,updatedAt:t-30*n},{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:1999,currency:"USD",status:lt.COMPLETED,type:kn.RENEWAL,description:"Monthly Subscription - Secure Plan",createdAt:t-0*n,updatedAt:t-0*n},{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:2500,currency:"USD",status:lt.PENDING,type:kn.ONE_TIME,description:"Private Key Recovery - One-time Fee",createdAt:t-2*n,updatedAt:t-2*n},{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:999,currency:"USD",status:lt.REFUNDED,type:kn.REFUND,description:"Refund - Annual Plan Trial",createdAt:t-15*n,updatedAt:t-14*n},{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:995,currency:"USD",status:lt.COMPLETED,type:kn.TRIAL,description:"Free Trial Activation Fee",createdAt:t-45*n,updatedAt:t-45*n},{id:`pay_${Math.random().toString(36).substring(2,10)}`,transactionId:`tx_${Math.random().toString(36).substring(2,10)}`,userId:e,amount:14999,currency:"USD",status:lt.COMPLETED,type:kn.ONE_TIME,description:"Premium Vault Backup - Lifetime License",createdAt:t-60*n,updatedAt:t-60*n}]}const Zg=Object.freeze(Object.defineProperty({__proto__:null,getPaymentHistory:Ff,getPaymentHistoryVaultId:eh,initializePaymentHistoryVault:go,savePaymentRecord:Ld,syncPaymentHistoryWithServer:hT},Symbol.toStringTag,{value:"Module"})),wU=()=>a.jsxs(ga,{children:[a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-28"})}),a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-16"})}),a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-24"})}),a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-16"})}),a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-20"})}),a.jsx(en,{children:a.jsx(Ua,{className:"h-4 w-8"})})]}),_U=({onRefresh:e})=>a.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[a.jsx("div",{className:"rounded-full bg-gray-100 p-3 dark:bg-gray-800",children:a.jsx(Q4,{className:"h-8 w-8 text-gray-500 dark:text-gray-400"})}),a.jsx("h3",{className:"mt-4 text-lg font-medium",children:"No payment history"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"You don't have any payment records yet. They will appear here when you make a payment."}),a.jsxs(ie,{variant:"outline",onClick:e,className:"mt-4",children:[a.jsx(Sf,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),pd=({payments:e,isLoading:t,onViewDetails:n,onRefresh:r})=>{if(t)return a.jsxs($f,{children:[a.jsx(Of,{children:a.jsxs(ga,{children:[a.jsx(Xt,{children:"Date"}),a.jsx(Xt,{children:"Amount"}),a.jsx(Xt,{children:"Description"}),a.jsx(Xt,{children:"Payment Method"}),a.jsx(Xt,{children:"Status"}),a.jsx(Xt,{})]})}),a.jsx(Mf,{children:Array(5).fill(0).map((i,l)=>a.jsx(wU,{},l))})]});if(e.length===0)return a.jsx(_U,{onRefresh:r});const s=i=>{var l;return(l=i.metadata)!=null&&l.paymentMethod?i.metadata.paymentMethod.replace("_"," ").split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "):i.type.replace("_"," ").split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ")},o=i=>{var c;const l=((c=i.metadata)==null?void 0:c.paymentMethod)||"";return l.includes("credit_card")?a.jsx("span",{className:"mr-1 text-blue-600",children:"💳"}):l.includes("bank")?a.jsx("span",{className:"mr-1 text-green-600",children:"🏦"}):l.includes("paypal")?a.jsx("span",{className:"mr-1 text-blue-500",children:"🅿️"}):null};return a.jsxs($f,{children:[a.jsx(Of,{children:a.jsxs(ga,{children:[a.jsx(Xt,{children:"Date"}),a.jsx(Xt,{children:"Amount"}),a.jsx(Xt,{children:"Description"}),a.jsx(Xt,{children:"Payment Method"}),a.jsx(Xt,{children:"Status"}),a.jsx(Xt,{})]})}),a.jsx(Mf,{children:e.map(i=>a.jsxs(ga,{className:"group hover:bg-muted/50",children:[a.jsx(en,{children:yU(i.createdAt)}),a.jsx(en,{className:"font-medium",children:fT(i.amount,i.currency)}),a.jsx(en,{children:i.description}),a.jsx(en,{children:a.jsxs("div",{className:"flex items-center",children:[o(i),a.jsx("span",{className:"capitalize",children:s(i)})]})}),a.jsx(en,{children:a.jsx(Cu,{children:a.jsxs(Nu,{children:[a.jsx(ju,{children:a.jsx(As,{variant:"outline",className:vU(i.status),children:i.status.replace("_"," ").split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")})}),a.jsx(wl,{children:i.status===lt.COMPLETED?"Payment successfully processed":i.status===lt.PENDING?"Payment is being processed":i.status===lt.FAILED?"Payment was not successful":i.status===lt.REFUNDED?"Payment was refunded":"Processing payment"})]})})}),a.jsx(en,{children:a.jsxs(Sx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(ie,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100",children:[a.jsx(VN,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Actions"})]})}),a.jsxs(Xm,{align:"end",children:[a.jsx(Bn,{onClick:()=>n(i),children:"View Details"}),a.jsx(Bn,{children:"Download Receipt"}),a.jsx(Gc,{}),a.jsx(Bn,{children:"Contact Support"})]})]})})]},i.id))})]})},SU=({payment:e,open:t,onClose:n})=>{var o,i,l,c,u,d;if(!e)return null;const r=()=>{var m;return(m=e.metadata)!=null&&m.paymentMethod?e.metadata.paymentMethod.replace("_"," ").split(" ").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" "):e.type.replace("_"," ").split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1)).join(" ")},s=m=>new Date(m).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a.jsx(nn,{open:t,onOpenChange:n,children:a.jsxs(Gt,{className:"sm:max-w-md",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Payment Details"}),a.jsx(Qt,{children:"Complete information about this transaction."})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsx("div",{className:`p-3 rounded-md ${e.status===lt.COMPLETED?"bg-green-50 text-green-700 dark:bg-green-900/30 dark:text-green-300":e.status===lt.PENDING?"bg-yellow-50 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":e.status===lt.FAILED?"bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-300":e.status===lt.REFUNDED?"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"bg-gray-50 text-gray-700 dark:bg-gray-900/30 dark:text-gray-300"}`,children:a.jsxs("div",{className:"flex items-center",children:[e.status===lt.COMPLETED&&a.jsx(LN,{className:"h-5 w-5 mr-2 text-green-500"}),e.status===lt.PENDING&&a.jsx(Sf,{className:"h-5 w-5 mr-2 text-yellow-500"}),e.status===lt.FAILED&&a.jsx(is,{className:"h-5 w-5 mr-2 text-red-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:e.status===lt.COMPLETED?"Payment Successful":e.status===lt.PENDING?"Payment Pending":e.status===lt.FAILED?"Payment Failed":e.status===lt.REFUNDED?"Payment Refunded":"Processing Payment"}),a.jsx("p",{className:"text-sm opacity-80",children:e.status===lt.COMPLETED?"Transaction has been successfully completed":e.status===lt.PENDING?"Transaction is being processed":e.status===lt.FAILED?"There was an issue with this transaction":e.status===lt.REFUNDED?"This payment has been refunded to your account":"Your payment is being processed"})]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Transaction ID"}),a.jsx("p",{className:"mt-1 text-sm font-mono",children:e.transactionId})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Date"}),a.jsx("p",{className:"mt-1 text-sm",children:s(e.createdAt)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Amount"}),a.jsx("p",{className:"mt-1 text-lg font-medium",children:fT(e.amount,e.currency)})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Payment Method"}),a.jsxs("div",{className:"mt-1 flex items-center",children:[((i=(o=e.metadata)==null?void 0:o.paymentMethod)==null?void 0:i.includes("credit_card"))&&a.jsx("span",{className:"mr-1 text-blue-600",children:"💳"}),((c=(l=e.metadata)==null?void 0:l.paymentMethod)==null?void 0:c.includes("bank"))&&a.jsx("span",{className:"mr-1 text-green-600",children:"🏦"}),((d=(u=e.metadata)==null?void 0:u.paymentMethod)==null?void 0:d.includes("paypal"))&&a.jsx("span",{className:"mr-1 text-blue-500",children:"🅿️"}),a.jsx("span",{children:r()})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Description"}),a.jsx("p",{className:"mt-1 text-sm",children:e.description})]}),e.metadata&&Object.keys(e.metadata).length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Additional Information"}),a.jsx("div",{className:"mt-1 rounded border border-gray-200 p-2 dark:border-gray-800",children:a.jsx("dl",{className:"text-xs space-y-1",children:Object.entries(e.metadata).map(([m,f])=>a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx("dt",{className:"font-medium text-gray-500",children:m.replace(/([A-Z])/g," $1").replace(/^./,p=>p.toUpperCase())}),a.jsx("dd",{className:"col-span-2",children:typeof f=="string"?f:JSON.stringify(f)})]},m))})})]})]}),a.jsxs(cn,{className:"flex justify-between",children:[a.jsx(ie,{variant:"outline",onClick:n,children:"Close"}),a.jsxs(ie,{variant:"default",disabled:e.status===lt.FAILED,className:"flex items-center",children:[a.jsx(ls,{className:"h-4 w-4 mr-2"}),"Download Receipt"]})]})]})})};function bU({user:e}){const[t,n]=w.useState(!0),[r,s]=w.useState(!1),[o,i]=w.useState(null),[l,c]=w.useState([]),[u,d]=w.useState(null),[m,f]=w.useState(!1),[p,v]=w.useState("all"),[h,x]=w.useState(null),[y,g]=w.useState(0),[_,S]=w.useState(()=>{const N=localStorage.getItem("payment_history_auto_sync");return N===null?!0:N==="true"});w.useEffect(()=>{localStorage.setItem("payment_history_auto_sync",_.toString())},[_]),w.useEffect(()=>{if(E(!1),_&&(e!=null&&e.email)){const T=localStorage.getItem("payment_history_last_sync_time"),$=T?parseInt(T,10):0,M=Date.now(),j=5*60*1e3;M-$>j?(console.log("Syncing payment history on component mount (auto-sync enabled)"),E(!0)):console.log("Using cached payment history (synced recently)")}const N=()=>{document.visibilityState==="visible"&&_&&(e!=null&&e.email)&&E(!0)};return document.addEventListener("visibilitychange",N),()=>{document.removeEventListener("visibilitychange",N)}},[e==null?void 0:e.email,_]),w.useEffect(()=>{y>0&&E(!0)},[y]);const E=async(N=!1)=>{if(!e||!e.email){n(!1);return}n(!0),i(null);try{if(console.log(`Loading payment history for ${e.email}...`),await go(e.email)||console.warn("Payment history vault could not be initialized"),N){s(!0),console.log("Syncing payment history with server...");try{await hT(e.email,e.id||1);const M=new Date().toISOString();x(M),localStorage.setItem("payment_history_last_sync_time",Date.now().toString())}catch(M){console.error("Error during sync:",M),i("Failed to sync with server. Please try again.")}finally{s(!1)}}const $=await Ff(e.email);console.log(`Loaded ${$.length} payment records`),c($)}catch(T){console.error("Failed to load payment history:",T),i("Could not load payment history. Please try again later.")}finally{n(!1)}},A=N=>{d(N),f(!0)},I=N=>{if(v(N),_&&(e!=null&&e.email)){const T=localStorage.getItem("payment_history_last_sync_time"),$=T?parseInt(T,10):0,M=Date.now(),j=5*60*1e3;M-$>j?(console.log(`Tab changed to ${N}, syncing payment history (auto-sync enabled)`),E(!0)):console.log(`Tab changed to ${N}, using cached payment history (synced recently)`)}};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"flex items-center justify-between pb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(g2,{id:"auto-sync",checked:_,onCheckedChange:S}),a.jsx("label",{htmlFor:"auto-sync",className:"text-sm",children:"Auto-sync"})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(ie,{variant:"outline",size:"sm",onClick:()=>E(!0),children:[a.jsx(Sf,{className:"mr-2 h-4 w-4"}),"Refresh"]}),a.jsxs(ie,{variant:"outline",size:"sm",children:[a.jsx(oz,{className:"mr-2 h-4 w-4"}),"Filter"]}),a.jsxs(ie,{variant:"outline",size:"sm",children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),"Export"]})]})]})}),a.jsx("div",{className:"w-full",children:a.jsxs(Ko,{defaultValue:"all",className:"w-full",onValueChange:I,children:[a.jsxs(Us,{className:"mb-4",children:[a.jsx(Je,{value:"all",children:"All Transactions"}),a.jsx(Je,{value:"subscriptions",children:"Subscriptions"}),a.jsx(Je,{value:"one-time",children:"One-time Payments"}),a.jsx(Je,{value:"refunds",children:"Refunds"})]}),a.jsx(nt,{value:"all",children:a.jsx(pd,{payments:l,isLoading:t,onViewDetails:A,onRefresh:()=>E(!0)})}),a.jsx(nt,{value:"subscriptions",children:a.jsx(pd,{payments:l.filter(N=>N.type===kn.SUBSCRIPTION||N.type===kn.RENEWAL),isLoading:t,onViewDetails:A,onRefresh:()=>E(!0)})}),a.jsx(nt,{value:"one-time",children:a.jsx(pd,{payments:l.filter(N=>N.type===kn.ONE_TIME),isLoading:t,onViewDetails:A,onRefresh:()=>E(!0)})}),a.jsx(nt,{value:"refunds",children:a.jsx(pd,{payments:l.filter(N=>N.type===kn.REFUND||N.status===lt.REFUNDED),isLoading:t,onViewDetails:A,onRefresh:()=>E(!0)})})]})}),a.jsxs("div",{className:"flex flex-col space-y-2 mt-2",children:[a.jsx("div",{className:"flex justify-between text-sm text-gray-500",children:l.length>0&&a.jsxs("div",{children:["Showing ",l.length," transaction",l.length!==1?"s":""]})}),r&&a.jsxs("div",{className:"flex items-center text-sm text-amber-500",children:[a.jsx(Sf,{className:"mr-1 h-3 w-3 animate-spin"}),"Synchronizing payment history..."]}),o&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-red-500",children:o}),a.jsx(ie,{variant:"outline",size:"sm",onClick:()=>g(N=>N+1),children:"Retry"})]}),h&&!r&&!o&&a.jsxs("div",{className:"text-xs text-gray-400",children:["Last synced: ",new Date(h).toLocaleString()]})]}),a.jsx(SU,{payment:u,open:m,onClose:()=>f(!1)})]})}var At=(e=>(e.CHECKING="checking",e.SAVINGS="savings",e.CREDIT="credit",e.INVESTMENT="investment",e.LOAN="loan",e.MORTGAGE="mortgage",e.OTHER="other",e))(At||{});const Fd=(e,t="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(e);var Au=e=>e.type==="checkbox",ra=e=>e instanceof Date,En=e=>e==null;const pT=e=>typeof e=="object";var Lt=e=>!En(e)&&!Array.isArray(e)&&pT(e)&&!ra(e),gT=e=>Lt(e)&&e.target?Au(e.target)?e.target.checked:e.target.value:e,EU=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,yT=(e,t)=>e.has(EU(t)),kU=e=>{const t=e.constructor&&e.constructor.prototype;return Lt(t)&&t.hasOwnProperty("isPrototypeOf")},Ex=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function On(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Ex&&(e instanceof Blob||e instanceof FileList))&&(n||Lt(e)))if(t=n?[]:{},!n&&!kU(e))t=e;else for(const r in e)e.hasOwnProperty(r)&&(t[r]=On(e[r]));else return e;return t}var th=e=>Array.isArray(e)?e.filter(Boolean):[],Dt=e=>e===void 0,ve=(e,t,n)=>{if(!t||!Lt(e))return n;const r=th(t.split(/[,[\].]+?/)).reduce((s,o)=>En(s)?s:s[o],e);return Dt(r)||r===e?Dt(e[t])?n:e[t]:r},dr=e=>typeof e=="boolean",kx=e=>/^\w*$/.test(e),vT=e=>th(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Xe=(e,t,n)=>{let r=-1;const s=kx(t)?[t]:vT(t),o=s.length,i=o-1;for(;++r<o;){const l=s[r];let c=n;if(r!==i){const u=e[l];c=Lt(u)||Array.isArray(u)?u:isNaN(+s[r+1])?{}:[]}if(l==="__proto__")return;e[l]=c,e=e[l]}return e};const Vf={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ir={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},xs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},xT=Be.createContext(null),nh=()=>Be.useContext(xT),CU=e=>{const{children:t,...n}=e;return Be.createElement(xT.Provider,{value:n},t)};var wT=(e,t,n,r=!0)=>{const s={defaultValues:t._defaultValues};for(const o in e)Object.defineProperty(s,o,{get:()=>{const i=o;return t._proxyFormState[i]!==Ir.all&&(t._proxyFormState[i]=!r||Ir.all),n&&(n[i]=!0),e[i]}});return s},Ln=e=>Lt(e)&&!Object.keys(e).length,_T=(e,t,n,r)=>{n(e);const{name:s,...o}=e;return Ln(o)||Object.keys(o).length>=Object.keys(t).length||Object.keys(o).find(i=>t[i]===(!r||Ir.all))},pc=e=>Array.isArray(e)?e:[e],ST=(e,t,n)=>!e||!t||e===t||pc(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r)));function Cx(e){const t=Be.useRef(e);t.current=e,Be.useEffect(()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function NU(e){const t=nh(),{control:n=t.control,disabled:r,name:s,exact:o}=e||{},[i,l]=Be.useState(n._formState),c=Be.useRef(!0),u=Be.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=Be.useRef(s);return d.current=s,Cx({disabled:r,next:m=>c.current&&ST(d.current,m.name,o)&&_T(m,u.current,n._updateFormState)&&l({...n._formState,...m}),subject:n._subjects.state}),Be.useEffect(()=>(c.current=!0,u.current.isValid&&n._updateValid(!0),()=>{c.current=!1}),[n]),wT(i,n,u.current,!1)}var es=e=>typeof e=="string",bT=(e,t,n,r,s)=>es(e)?(r&&t.watch.add(e),ve(n,e,s)):Array.isArray(e)?e.map(o=>(r&&t.watch.add(o),ve(n,o))):(r&&(t.watchAll=!0),n);function jU(e){const t=nh(),{control:n=t.control,name:r,defaultValue:s,disabled:o,exact:i}=e||{},l=Be.useRef(r);l.current=r,Cx({disabled:o,subject:n._subjects.values,next:d=>{ST(l.current,d.name,i)&&u(On(bT(l.current,n._names,d.values||n._formValues,!1,s)))}});const[c,u]=Be.useState(n._getWatch(r,s));return Be.useEffect(()=>n._removeUnmounted()),c}function IU(e){const t=nh(),{name:n,disabled:r,control:s=t.control,shouldUnregister:o}=e,i=yT(s._names.array,n),l=jU({control:s,name:n,defaultValue:ve(s._formValues,n,ve(s._defaultValues,n,e.defaultValue)),exact:!0}),c=NU({control:s,name:n,exact:!0}),u=Be.useRef(s.register(n,{...e.rules,value:l,...dr(e.disabled)?{disabled:e.disabled}:{}}));return Be.useEffect(()=>{const d=s._options.shouldUnregister||o,m=(f,p)=>{const v=ve(s._fields,f);v&&v._f&&(v._f.mount=p)};if(m(n,!0),d){const f=On(ve(s._options.defaultValues,n));Xe(s._defaultValues,n,f),Dt(ve(s._formValues,n))&&Xe(s._formValues,n,f)}return()=>{(i?d&&!s._state.action:d)?s.unregister(n):m(n,!1)}},[n,s,i,o]),Be.useEffect(()=>{ve(s._fields,n)&&s._updateDisabledField({disabled:r,fields:s._fields,name:n,value:ve(s._fields,n)._f.value})},[r,n,s]),{field:{name:n,value:l,...dr(r)||c.disabled?{disabled:c.disabled||r}:{},onChange:Be.useCallback(d=>u.current.onChange({target:{value:gT(d),name:n},type:Vf.CHANGE}),[n]),onBlur:Be.useCallback(()=>u.current.onBlur({target:{value:ve(s._formValues,n),name:n},type:Vf.BLUR}),[n,s]),ref:Be.useCallback(d=>{const m=ve(s._fields,n);m&&d&&(m._f.ref={focus:()=>d.focus(),select:()=>d.select(),setCustomValidity:f=>d.setCustomValidity(f),reportValidity:()=>d.reportValidity()})},[s._fields,n])},formState:c,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ve(c.errors,n)},isDirty:{enumerable:!0,get:()=>!!ve(c.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!ve(c.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!ve(c.validatingFields,n)},error:{enumerable:!0,get:()=>ve(c.errors,n)}})}}const TU=e=>e.render(IU(e));var ET=(e,t,n,r,s)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:s||!0}}:{},aS=e=>({isOnSubmit:!e||e===Ir.onSubmit,isOnBlur:e===Ir.onBlur,isOnChange:e===Ir.onChange,isOnAll:e===Ir.all,isOnTouch:e===Ir.onTouched}),iS=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const gc=(e,t,n,r)=>{for(const s of n||Object.keys(e)){const o=ve(e,s);if(o){const{_f:i,...l}=o;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],s)&&!r)return!0;if(i.ref&&t(i.ref,i.name)&&!r)return!0;if(gc(l,t))break}else if(Lt(l)&&gc(l,t))break}}};var AU=(e,t,n)=>{const r=pc(ve(e,n));return Xe(r,"root",t[n]),Xe(e,n,r),e},Nx=e=>e.type==="file",js=e=>typeof e=="function",Uf=e=>{if(!Ex)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Vd=e=>es(e),jx=e=>e.type==="radio",Bf=e=>e instanceof RegExp;const lS={value:!1,isValid:!1},cS={value:!0,isValid:!0};var kT=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Dt(e[0].attributes.value)?Dt(e[0].value)||e[0].value===""?cS:{value:e[0].value,isValid:!0}:cS:lS}return lS};const uS={isValid:!1,value:null};var CT=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,uS):uS;function dS(e,t,n="validate"){if(Vd(e)||Array.isArray(e)&&e.every(Vd)||dr(e)&&!e)return{type:n,message:Vd(e)?e:"",ref:t}}var Ba=e=>Lt(e)&&!Bf(e)?e:{value:e,message:""},fS=async(e,t,n,r,s)=>{const{ref:o,refs:i,required:l,maxLength:c,minLength:u,min:d,max:m,pattern:f,validate:p,name:v,valueAsNumber:h,mount:x,disabled:y}=e._f,g=ve(t,v);if(!x||y)return{};const _=i?i[0]:o,S=j=>{r&&_.reportValidity&&(_.setCustomValidity(dr(j)?"":j||""),_.reportValidity())},E={},A=jx(o),I=Au(o),N=A||I,T=(h||Nx(o))&&Dt(o.value)&&Dt(g)||Uf(o)&&o.value===""||g===""||Array.isArray(g)&&!g.length,$=ET.bind(null,v,n,E),M=(j,P,b,V=xs.maxLength,Z=xs.minLength)=>{const D=j?P:b;E[v]={type:j?V:Z,message:D,ref:o,...$(j?V:Z,D)}};if(s?!Array.isArray(g)||!g.length:l&&(!N&&(T||En(g))||dr(g)&&!g||I&&!kT(i).isValid||A&&!CT(i).isValid)){const{value:j,message:P}=Vd(l)?{value:!!l,message:l}:Ba(l);if(j&&(E[v]={type:xs.required,message:P,ref:_,...$(xs.required,P)},!n))return S(P),E}if(!T&&(!En(d)||!En(m))){let j,P;const b=Ba(m),V=Ba(d);if(!En(g)&&!isNaN(g)){const Z=o.valueAsNumber||g&&+g;En(b.value)||(j=Z>b.value),En(V.value)||(P=Z<V.value)}else{const Z=o.valueAsDate||new Date(g),D=q=>new Date(new Date().toDateString()+" "+q),L=o.type=="time",O=o.type=="week";es(b.value)&&g&&(j=L?D(g)>D(b.value):O?g>b.value:Z>new Date(b.value)),es(V.value)&&g&&(P=L?D(g)<D(V.value):O?g<V.value:Z<new Date(V.value))}if((j||P)&&(M(!!j,b.message,V.message,xs.max,xs.min),!n))return S(E[v].message),E}if((c||u)&&!T&&(es(g)||s&&Array.isArray(g))){const j=Ba(c),P=Ba(u),b=!En(j.value)&&g.length>+j.value,V=!En(P.value)&&g.length<+P.value;if((b||V)&&(M(b,j.message,P.message),!n))return S(E[v].message),E}if(f&&!T&&es(g)){const{value:j,message:P}=Ba(f);if(Bf(j)&&!g.match(j)&&(E[v]={type:xs.pattern,message:P,ref:o,...$(xs.pattern,P)},!n))return S(P),E}if(p){if(js(p)){const j=await p(g,t),P=dS(j,_);if(P&&(E[v]={...P,...$(xs.validate,P.message)},!n))return S(P.message),E}else if(Lt(p)){let j={};for(const P in p){if(!Ln(j)&&!n)break;const b=dS(await p[P](g,t),_,P);b&&(j={...b,...$(P,b.message)},S(b.message),n&&(E[v]=j))}if(!Ln(j)&&(E[v]={ref:_,...j},!n))return E}}return S(!0),E};function PU(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=Dt(e)?r++:e[t[r++]];return e}function DU(e){for(const t in e)if(e.hasOwnProperty(t)&&!Dt(e[t]))return!1;return!0}function Ut(e,t){const n=Array.isArray(t)?t:kx(t)?[t]:vT(t),r=n.length===1?e:PU(e,n),s=n.length-1,o=n[s];return r&&delete r[o],s!==0&&(Lt(r)&&Ln(r)||Array.isArray(r)&&DU(r))&&Ut(e,n.slice(0,-1)),e}var dp=()=>{let e=[];return{get observers(){return e},next:s=>{for(const o of e)o.next&&o.next(s)},subscribe:s=>(e.push(s),{unsubscribe:()=>{e=e.filter(o=>o!==s)}}),unsubscribe:()=>{e=[]}}},Yg=e=>En(e)||!pT(e);function Js(e,t){if(Yg(e)||Yg(t))return e===t;if(ra(e)&&ra(t))return e.getTime()===t.getTime();const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n){const o=e[s];if(!r.includes(s))return!1;if(s!=="ref"){const i=t[s];if(ra(o)&&ra(i)||Lt(o)&&Lt(i)||Array.isArray(o)&&Array.isArray(i)?!Js(o,i):o!==i)return!1}}return!0}var NT=e=>e.type==="select-multiple",RU=e=>jx(e)||Au(e),fp=e=>Uf(e)&&e.isConnected,jT=e=>{for(const t in e)if(js(e[t]))return!0;return!1};function Kf(e,t={}){const n=Array.isArray(e);if(Lt(e)||n)for(const r in e)Array.isArray(e[r])||Lt(e[r])&&!jT(e[r])?(t[r]=Array.isArray(e[r])?[]:{},Kf(e[r],t[r])):En(e[r])||(t[r]=!0);return t}function IT(e,t,n){const r=Array.isArray(e);if(Lt(e)||r)for(const s in e)Array.isArray(e[s])||Lt(e[s])&&!jT(e[s])?Dt(t)||Yg(n[s])?n[s]=Array.isArray(e[s])?Kf(e[s],[]):{...Kf(e[s])}:IT(e[s],En(t)?{}:t[s],n[s]):n[s]=!Js(e[s],t[s]);return n}var Ol=(e,t)=>IT(e,t,Kf(t)),TT=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Dt(e)?e:t?e===""?NaN:e&&+e:n&&es(e)?new Date(e):r?r(e):e;function mp(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return Nx(t)?t.files:jx(t)?CT(e.refs).value:NT(t)?[...t.selectedOptions].map(({value:n})=>n):Au(t)?kT(e.refs).value:TT(Dt(t.value)?e.ref.value:t.value,e)}var $U=(e,t,n,r)=>{const s={};for(const o of e){const i=ve(t,o);i&&Xe(s,o,i._f)}return{criteriaMode:n,names:[...e],fields:s,shouldUseNativeValidation:r}},Ml=e=>Dt(e)?e:Bf(e)?e.source:Lt(e)?Bf(e.value)?e.value.source:e.value:e;const mS="AsyncFunction";var OU=e=>(!e||!e.validate)&&!!(js(e.validate)&&e.validate.constructor.name===mS||Lt(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===mS)),MU=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function hS(e,t,n){const r=ve(e,n);if(r||kx(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const o=s.join("."),i=ve(t,o),l=ve(e,o);if(i&&!Array.isArray(i)&&n!==o)return{name:n};if(l&&l.type)return{name:o,error:l};s.pop()}return{name:n}}var zU=(e,t,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(t||e):(n?r.isOnBlur:s.isOnBlur)?!e:(n?r.isOnChange:s.isOnChange)?e:!0,LU=(e,t)=>!th(ve(e,t)).length&&Ut(e,t);const FU={mode:Ir.onSubmit,reValidateMode:Ir.onChange,shouldFocusError:!0};function VU(e={}){let t={...FU,...e},n={submitCount:0,isDirty:!1,isLoading:js(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},s=Lt(t.defaultValues)||Lt(t.values)?On(t.defaultValues||t.values)||{}:{},o=t.shouldUnregister?{}:On(s),i={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},m={values:dp(),array:dp(),state:dp()},f=aS(t.mode),p=aS(t.reValidateMode),v=t.criteriaMode===Ir.all,h=k=>R=>{clearTimeout(u),u=setTimeout(k,R)},x=async k=>{if(!e.disabled&&(d.isValid||k)){const R=t.resolver?Ln((await N()).errors):await $(r,!0);R!==n.isValid&&m.state.next({isValid:R})}},y=(k,R)=>{!e.disabled&&(d.isValidating||d.validatingFields)&&((k||Array.from(l.mount)).forEach(U=>{U&&(R?Xe(n.validatingFields,U,R):Ut(n.validatingFields,U))}),m.state.next({validatingFields:n.validatingFields,isValidating:!Ln(n.validatingFields)}))},g=(k,R=[],U,X,B=!0,Q=!0)=>{if(X&&U&&!e.disabled){if(i.action=!0,Q&&Array.isArray(ve(r,k))){const se=U(ve(r,k),X.argA,X.argB);B&&Xe(r,k,se)}if(Q&&Array.isArray(ve(n.errors,k))){const se=U(ve(n.errors,k),X.argA,X.argB);B&&Xe(n.errors,k,se),LU(n.errors,k)}if(d.touchedFields&&Q&&Array.isArray(ve(n.touchedFields,k))){const se=U(ve(n.touchedFields,k),X.argA,X.argB);B&&Xe(n.touchedFields,k,se)}d.dirtyFields&&(n.dirtyFields=Ol(s,o)),m.state.next({name:k,isDirty:j(k,R),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Xe(o,k,R)},_=(k,R)=>{Xe(n.errors,k,R),m.state.next({errors:n.errors})},S=k=>{n.errors=k,m.state.next({errors:n.errors,isValid:!1})},E=(k,R,U,X)=>{const B=ve(r,k);if(B){const Q=ve(o,k,Dt(U)?ve(s,k):U);Dt(Q)||X&&X.defaultChecked||R?Xe(o,k,R?Q:mp(B._f)):V(k,Q),i.mount&&x()}},A=(k,R,U,X,B)=>{let Q=!1,se=!1;const re={name:k};if(!e.disabled){const be=!!(ve(r,k)&&ve(r,k)._f&&ve(r,k)._f.disabled);if(!U||X){d.isDirty&&(se=n.isDirty,n.isDirty=re.isDirty=j(),Q=se!==re.isDirty);const Re=be||Js(ve(s,k),R);se=!!(!be&&ve(n.dirtyFields,k)),Re||be?Ut(n.dirtyFields,k):Xe(n.dirtyFields,k,!0),re.dirtyFields=n.dirtyFields,Q=Q||d.dirtyFields&&se!==!Re}if(U){const Re=ve(n.touchedFields,k);Re||(Xe(n.touchedFields,k,U),re.touchedFields=n.touchedFields,Q=Q||d.touchedFields&&Re!==U)}Q&&B&&m.state.next(re)}return Q?re:{}},I=(k,R,U,X)=>{const B=ve(n.errors,k),Q=d.isValid&&dr(R)&&n.isValid!==R;if(e.delayError&&U?(c=h(()=>_(k,U)),c(e.delayError)):(clearTimeout(u),c=null,U?Xe(n.errors,k,U):Ut(n.errors,k)),(U?!Js(B,U):B)||!Ln(X)||Q){const se={...X,...Q&&dr(R)?{isValid:R}:{},errors:n.errors,name:k};n={...n,...se},m.state.next(se)}},N=async k=>{y(k,!0);const R=await t.resolver(o,t.context,$U(k||l.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return y(k),R},T=async k=>{const{errors:R}=await N(k);if(k)for(const U of k){const X=ve(R,U);X?Xe(n.errors,U,X):Ut(n.errors,U)}else n.errors=R;return R},$=async(k,R,U={valid:!0})=>{for(const X in k){const B=k[X];if(B){const{_f:Q,...se}=B;if(Q){const re=l.array.has(Q.name),be=B._f&&OU(B._f);be&&d.validatingFields&&y([X],!0);const Re=await fS(B,o,v,t.shouldUseNativeValidation&&!R,re);if(be&&d.validatingFields&&y([X]),Re[Q.name]&&(U.valid=!1,R))break;!R&&(ve(Re,Q.name)?re?AU(n.errors,Re,Q.name):Xe(n.errors,Q.name,Re[Q.name]):Ut(n.errors,Q.name))}!Ln(se)&&await $(se,R,U)}}return U.valid},M=()=>{for(const k of l.unMount){const R=ve(r,k);R&&(R._f.refs?R._f.refs.every(U=>!fp(U)):!fp(R._f.ref))&&ne(k)}l.unMount=new Set},j=(k,R)=>!e.disabled&&(k&&R&&Xe(o,k,R),!Js(F(),s)),P=(k,R,U)=>bT(k,l,{...i.mount?o:Dt(R)?s:es(k)?{[k]:R}:R},U,R),b=k=>th(ve(i.mount?o:s,k,e.shouldUnregister?ve(s,k,[]):[])),V=(k,R,U={})=>{const X=ve(r,k);let B=R;if(X){const Q=X._f;Q&&(!Q.disabled&&Xe(o,k,TT(R,Q)),B=Uf(Q.ref)&&En(R)?"":R,NT(Q.ref)?[...Q.ref.options].forEach(se=>se.selected=B.includes(se.value)):Q.refs?Au(Q.ref)?Q.refs.length>1?Q.refs.forEach(se=>(!se.defaultChecked||!se.disabled)&&(se.checked=Array.isArray(B)?!!B.find(re=>re===se.value):B===se.value)):Q.refs[0]&&(Q.refs[0].checked=!!B):Q.refs.forEach(se=>se.checked=se.value===B):Nx(Q.ref)?Q.ref.value="":(Q.ref.value=B,Q.ref.type||m.values.next({name:k,values:{...o}})))}(U.shouldDirty||U.shouldTouch)&&A(k,B,U.shouldTouch,U.shouldDirty,!0),U.shouldValidate&&q(k)},Z=(k,R,U)=>{for(const X in R){const B=R[X],Q=`${k}.${X}`,se=ve(r,Q);(l.array.has(k)||Lt(B)||se&&!se._f)&&!ra(B)?Z(Q,B,U):V(Q,B,U)}},D=(k,R,U={})=>{const X=ve(r,k),B=l.array.has(k),Q=On(R);Xe(o,k,Q),B?(m.array.next({name:k,values:{...o}}),(d.isDirty||d.dirtyFields)&&U.shouldDirty&&m.state.next({name:k,dirtyFields:Ol(s,o),isDirty:j(k,Q)})):X&&!X._f&&!En(Q)?Z(k,Q,U):V(k,Q,U),iS(k,l)&&m.state.next({...n}),m.values.next({name:i.mount?k:void 0,values:{...o}})},L=async k=>{i.mount=!0;const R=k.target;let U=R.name,X=!0;const B=ve(r,U),Q=()=>R.type?mp(B._f):gT(k),se=re=>{X=Number.isNaN(re)||ra(re)&&isNaN(re.getTime())||Js(re,ve(o,U,re))};if(B){let re,be;const Re=Q(),Oe=k.type===Vf.BLUR||k.type===Vf.FOCUS_OUT,Pn=!MU(B._f)&&!t.resolver&&!ve(n.errors,U)&&!B._f.deps||zU(Oe,ve(n.touchedFields,U),n.isSubmitted,p,f),gs=iS(U,l,Oe);Xe(o,U,Re),Oe?(B._f.onBlur&&B._f.onBlur(k),c&&c(0)):B._f.onChange&&B._f.onChange(k);const Dn=A(U,Re,Oe,!1),qo=!Ln(Dn)||gs;if(!Oe&&m.values.next({name:U,type:k.type,values:{...o}}),Pn)return d.isValid&&(e.mode==="onBlur"?Oe&&x():x()),qo&&m.state.next({name:U,...gs?{}:Dn});if(!Oe&&gs&&m.state.next({...n}),t.resolver){const{errors:_t}=await N([U]);if(se(Re),X){const Oa=hS(n.errors,r,U),Ma=hS(_t,r,Oa.name||U);re=Ma.error,U=Ma.name,be=Ln(_t)}}else y([U],!0),re=(await fS(B,o,v,t.shouldUseNativeValidation))[U],y([U]),se(Re),X&&(re?be=!1:d.isValid&&(be=await $(r,!0)));X&&(B._f.deps&&q(B._f.deps),I(U,be,re,Dn))}},O=(k,R)=>{if(ve(n.errors,R)&&k.focus)return k.focus(),1},q=async(k,R={})=>{let U,X;const B=pc(k);if(t.resolver){const Q=await T(Dt(k)?k:B);U=Ln(Q),X=k?!B.some(se=>ve(Q,se)):U}else k?(X=(await Promise.all(B.map(async Q=>{const se=ve(r,Q);return await $(se&&se._f?{[Q]:se}:se)}))).every(Boolean),!(!X&&!n.isValid)&&x()):X=U=await $(r);return m.state.next({...!es(k)||d.isValid&&U!==n.isValid?{}:{name:k},...t.resolver||!k?{isValid:U}:{},errors:n.errors}),R.shouldFocus&&!X&&gc(r,O,k?B:l.mount),X},F=k=>{const R={...i.mount?o:s};return Dt(k)?R:es(k)?ve(R,k):k.map(U=>ve(R,U))},W=(k,R)=>({invalid:!!ve((R||n).errors,k),isDirty:!!ve((R||n).dirtyFields,k),error:ve((R||n).errors,k),isValidating:!!ve(n.validatingFields,k),isTouched:!!ve((R||n).touchedFields,k)}),ce=k=>{k&&pc(k).forEach(R=>Ut(n.errors,R)),m.state.next({errors:k?n.errors:{}})},ae=(k,R,U)=>{const X=(ve(r,k,{_f:{}})._f||{}).ref,B=ve(n.errors,k)||{},{ref:Q,message:se,type:re,...be}=B;Xe(n.errors,k,{...be,...R,ref:X}),m.state.next({name:k,errors:n.errors,isValid:!1}),U&&U.shouldFocus&&X&&X.focus&&X.focus()},K=(k,R)=>js(k)?m.values.subscribe({next:U=>k(P(void 0,R),U)}):P(k,R,!0),ne=(k,R={})=>{for(const U of k?pc(k):l.mount)l.mount.delete(U),l.array.delete(U),R.keepValue||(Ut(r,U),Ut(o,U)),!R.keepError&&Ut(n.errors,U),!R.keepDirty&&Ut(n.dirtyFields,U),!R.keepTouched&&Ut(n.touchedFields,U),!R.keepIsValidating&&Ut(n.validatingFields,U),!t.shouldUnregister&&!R.keepDefaultValue&&Ut(s,U);m.values.next({values:{...o}}),m.state.next({...n,...R.keepDirty?{isDirty:j()}:{}}),!R.keepIsValid&&x()},G=({disabled:k,name:R,field:U,fields:X,value:B})=>{if(dr(k)&&i.mount||k){const Q=k?void 0:Dt(B)?mp(U?U._f:ve(X,R)._f):B;Xe(o,R,Q),A(R,Q,!1,!1,!0)}},te=(k,R={})=>{let U=ve(r,k);const X=dr(R.disabled)||dr(e.disabled);return Xe(r,k,{...U||{},_f:{...U&&U._f?U._f:{ref:{name:k}},name:k,mount:!0,...R}}),l.mount.add(k),U?G({field:U,disabled:dr(R.disabled)?R.disabled:e.disabled,name:k,value:R.value}):E(k,!0,R.value),{...X?{disabled:R.disabled||e.disabled}:{},...t.progressive?{required:!!R.required,min:Ml(R.min),max:Ml(R.max),minLength:Ml(R.minLength),maxLength:Ml(R.maxLength),pattern:Ml(R.pattern)}:{},name:k,onChange:L,onBlur:L,ref:B=>{if(B){te(k,R),U=ve(r,k);const Q=Dt(B.value)&&B.querySelectorAll&&B.querySelectorAll("input,select,textarea")[0]||B,se=RU(Q),re=U._f.refs||[];if(se?re.find(be=>be===Q):Q===U._f.ref)return;Xe(r,k,{_f:{...U._f,...se?{refs:[...re.filter(fp),Q,...Array.isArray(ve(s,k))?[{}]:[]],ref:{type:Q.type,name:k}}:{ref:Q}}}),E(k,!1,void 0,Q)}else U=ve(r,k,{}),U._f&&(U._f.mount=!1),(t.shouldUnregister||R.shouldUnregister)&&!(yT(l.array,k)&&i.action)&&l.unMount.add(k)}}},le=()=>t.shouldFocusError&&gc(r,O,l.mount),fe=k=>{dr(k)&&(m.state.next({disabled:k}),gc(r,(R,U)=>{const X=ve(r,U);X&&(R.disabled=X._f.disabled||k,Array.isArray(X._f.refs)&&X._f.refs.forEach(B=>{B.disabled=X._f.disabled||k}))},0,!1))},ge=(k,R)=>async U=>{let X;U&&(U.preventDefault&&U.preventDefault(),U.persist&&U.persist());let B=On(o);if(m.state.next({isSubmitting:!0}),t.resolver){const{errors:Q,values:se}=await N();n.errors=Q,B=se}else await $(r);if(Ut(n.errors,"root"),Ln(n.errors)){m.state.next({errors:{}});try{await k(B,U)}catch(Q){X=Q}}else R&&await R({...n.errors},U),le(),setTimeout(le);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ln(n.errors)&&!X,submitCount:n.submitCount+1,errors:n.errors}),X)throw X},de=(k,R={})=>{ve(r,k)&&(Dt(R.defaultValue)?D(k,On(ve(s,k))):(D(k,R.defaultValue),Xe(s,k,On(R.defaultValue))),R.keepTouched||Ut(n.touchedFields,k),R.keepDirty||(Ut(n.dirtyFields,k),n.isDirty=R.defaultValue?j(k,On(ve(s,k))):j()),R.keepError||(Ut(n.errors,k),d.isValid&&x()),m.state.next({...n}))},Pe=(k,R={})=>{const U=k?On(k):s,X=On(U),B=Ln(k),Q=B?s:X;if(R.keepDefaultValues||(s=U),!R.keepValues){if(R.keepDirtyValues){const se=new Set([...l.mount,...Object.keys(Ol(s,o))]);for(const re of Array.from(se))ve(n.dirtyFields,re)?Xe(Q,re,ve(o,re)):D(re,ve(Q,re))}else{if(Ex&&Dt(k))for(const se of l.mount){const re=ve(r,se);if(re&&re._f){const be=Array.isArray(re._f.refs)?re._f.refs[0]:re._f.ref;if(Uf(be)){const Re=be.closest("form");if(Re){Re.reset();break}}}}r={}}o=e.shouldUnregister?R.keepDefaultValues?On(s):{}:On(Q),m.array.next({values:{...Q}}),m.values.next({values:{...Q}})}l={mount:R.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!d.isValid||!!R.keepIsValid||!!R.keepDirtyValues,i.watch=!!e.shouldUnregister,m.state.next({submitCount:R.keepSubmitCount?n.submitCount:0,isDirty:B?!1:R.keepDirty?n.isDirty:!!(R.keepDefaultValues&&!Js(k,s)),isSubmitted:R.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:B?{}:R.keepDirtyValues?R.keepDefaultValues&&o?Ol(s,o):n.dirtyFields:R.keepDefaultValues&&k?Ol(s,k):R.keepDirty?n.dirtyFields:{},touchedFields:R.keepTouched?n.touchedFields:{},errors:R.keepErrors?n.errors:{},isSubmitSuccessful:R.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},C=(k,R)=>Pe(js(k)?k(o):k,R);return{control:{register:te,unregister:ne,getFieldState:W,handleSubmit:ge,setError:ae,_executeSchema:N,_getWatch:P,_getDirty:j,_updateValid:x,_removeUnmounted:M,_updateFieldArray:g,_updateDisabledField:G,_getFieldArray:b,_reset:Pe,_resetDefaultValues:()=>js(t.defaultValues)&&t.defaultValues().then(k=>{C(k,t.resetOptions),m.state.next({isLoading:!1})}),_updateFormState:k=>{n={...n,...k}},_disableForm:fe,_subjects:m,_proxyFormState:d,_setErrors:S,get _fields(){return r},get _formValues(){return o},get _state(){return i},set _state(k){i=k},get _defaultValues(){return s},get _names(){return l},set _names(k){l=k},get _formState(){return n},set _formState(k){n=k},get _options(){return t},set _options(k){t={...t,...k}}},trigger:q,register:te,handleSubmit:ge,watch:K,setValue:D,getValues:F,reset:C,resetField:de,clearErrors:ce,unregister:ne,setError:ae,setFocus:(k,R={})=>{const U=ve(r,k),X=U&&U._f;if(X){const B=X.refs?X.refs[0]:X.ref;B.focus&&(B.focus(),R.shouldSelect&&B.select())}},getFieldState:W}}function xi(e={}){const t=Be.useRef(),n=Be.useRef(),[r,s]=Be.useState({isDirty:!1,isValidating:!1,isLoading:js(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:js(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...VU(e),formState:r});const o=t.current.control;return o._options=e,Cx({subject:o._subjects.state,next:i=>{_T(i,o._proxyFormState,o._updateFormState,!0)&&s({...o._formState})}}),Be.useEffect(()=>o._disableForm(e.disabled),[o,e.disabled]),Be.useEffect(()=>{if(o._proxyFormState.isDirty){const i=o._getDirty();i!==r.isDirty&&o._subjects.state.next({isDirty:i})}},[o,r.isDirty]),Be.useEffect(()=>{e.values&&!Js(e.values,n.current)?(o._reset(e.values,o._options.resetOptions),n.current=e.values,s(i=>({...i}))):o._resetDefaultValues()},[e.values,o]),Be.useEffect(()=>{e.errors&&o._setErrors(e.errors)},[e.errors,o]),Be.useEffect(()=>{o._state.mount||(o._updateValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),Be.useEffect(()=>{e.shouldUnregister&&o._subjects.values.next({values:o._getWatch()})},[e.shouldUnregister,o]),Be.useEffect(()=>{t.current&&(t.current.watch=t.current.watch.bind({}))},[r]),t.current.formState=wT(r,o),t.current}const pS=(e,t,n)=>{if(e&&"reportValidity"in e){const r=ve(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},AT=(e,t)=>{for(const n in t.fields){const r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?pS(r.ref,n,e):r.refs&&r.refs.forEach(s=>pS(s,n,e))}},UU=(e,t)=>{t.shouldUseNativeValidation&&AT(e,t);const n={};for(const r in e){const s=ve(t.fields,r),o=Object.assign(e[r]||{},{ref:s&&s.ref});if(BU(t.names||Object.keys(e),r)){const i=Object.assign({},ve(n,r));Xe(i,"root",o),Xe(n,r,i)}else Xe(n,r,o)}return n},BU=(e,t)=>e.some(n=>n.startsWith(t+"."));var KU=function(e,t){for(var n={};e.length;){var r=e[0],s=r.code,o=r.message,i=r.path.join(".");if(!n[i])if("unionErrors"in r){var l=r.unionErrors[0].errors[0];n[i]={message:l.message,type:l.code}}else n[i]={message:o,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(d){return d.errors.forEach(function(m){return e.push(m)})}),t){var c=n[i].types,u=c&&c[r.code];n[i]=ET(i,t,n,s,u?[].concat(u,r.message):r.message)}e.shift()}return n},wi=function(e,t,n){return n===void 0&&(n={}),function(r,s,o){try{return Promise.resolve(function(i,l){try{var c=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(u){return o.shouldUseNativeValidation&&AT({},o),{errors:{},values:n.raw?r:u}})}catch(u){return l(u)}return c&&c.then?c.then(void 0,l):c}(0,function(i){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(i))return{values:{},errors:UU(KU(i.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw i}))}catch(i){return Promise.reject(i)}}},Ze;(function(e){e.assertEqual=s=>s;function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const o={};for(const i of s)o[i]=i;return o},e.getValidEnumValues=s=>{const o=e.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),i={};for(const l of o)i[l]=s[l];return e.objectValues(i)},e.objectValues=s=>e.objectKeys(s).map(function(o){return s[o]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const o=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&o.push(i);return o},e.find=(s,o)=>{for(const i of s)if(o(i))return i},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,o=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}e.joinValues=r,e.jsonStringifyReplacer=(s,o)=>typeof o=="bigint"?o.toString():o})(Ze||(Ze={}));var Qg;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(Qg||(Qg={}));const ke=Ze.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),eo=e=>{switch(typeof e){case"undefined":return ke.undefined;case"string":return ke.string;case"number":return isNaN(e)?ke.nan:ke.number;case"boolean":return ke.boolean;case"function":return ke.function;case"bigint":return ke.bigint;case"symbol":return ke.symbol;case"object":return Array.isArray(e)?ke.array:e===null?ke.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ke.promise:typeof Map<"u"&&e instanceof Map?ke.map:typeof Set<"u"&&e instanceof Set?ke.set:typeof Date<"u"&&e instanceof Date?ke.date:ke.object;default:return ke.unknown}},he=Ze.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),WU=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class rr extends Error{constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const n=t||function(o){return o.message},r={_errors:[]},s=o=>{for(const i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let l=r,c=0;for(;c<i.path.length;){const u=i.path[c];c===i.path.length-1?(l[u]=l[u]||{_errors:[]},l[u]._errors.push(n(i))):l[u]=l[u]||{_errors:[]},l=l[u],c++}}};return s(this),r}static assert(t){if(!(t instanceof rr))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ze.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}rr.create=e=>new rr(e);const sl=(e,t)=>{let n;switch(e.code){case he.invalid_type:e.received===ke.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case he.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ze.jsonStringifyReplacer)}`;break;case he.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ze.joinValues(e.keys,", ")}`;break;case he.invalid_union:n="Invalid input";break;case he.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ze.joinValues(e.options)}`;break;case he.invalid_enum_value:n=`Invalid enum value. Expected ${Ze.joinValues(e.options)}, received '${e.received}'`;break;case he.invalid_arguments:n="Invalid function arguments";break;case he.invalid_return_type:n="Invalid function return type";break;case he.invalid_date:n="Invalid date";break;case he.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ze.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case he.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case he.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case he.custom:n="Invalid input";break;case he.invalid_intersection_types:n="Intersection results could not be merged";break;case he.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case he.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ze.assertNever(e)}return{message:n}};let PT=sl;function HU(e){PT=e}function Wf(){return PT}const Hf=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,o=[...n,...s.path||[]],i={...s,path:o};if(s.message!==void 0)return{...s,path:o,message:s.message};let l="";const c=r.filter(u=>!!u).slice().reverse();for(const u of c)l=u(i,{data:t,defaultError:l}).message;return{...s,path:o,message:l}},qU=[];function Se(e,t){const n=Wf(),r=Hf({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===sl?void 0:sl].filter(s=>!!s)});e.common.issues.push(r)}class wn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return Ae;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const o=await s.key,i=await s.value;r.push({key:o,value:i})}return wn.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:o,value:i}=s;if(o.status==="aborted"||i.status==="aborted")return Ae;o.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[o.value]=i.value)}return{status:t.value,value:r}}}const Ae=Object.freeze({status:"aborted"}),si=e=>({status:"dirty",value:e}),jn=e=>({status:"valid",value:e}),Xg=e=>e.status==="aborted",Jg=e=>e.status==="dirty",Zc=e=>e.status==="valid",Yc=e=>typeof Promise<"u"&&e instanceof Promise;function qf(e,t,n,r){if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function DT(e,t,n,r,s){if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var Ne;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ne||(Ne={}));var ql,Gl;class ds{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const gS=(e,t)=>{if(Zc(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new rr(e.common.issues);return this._error=n,this._error}}};function Me(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(i,l)=>{var c,u;const{message:d}=e;return i.code==="invalid_enum_value"?{message:d??l.defaultError}:typeof l.data>"u"?{message:(c=d??r)!==null&&c!==void 0?c:l.defaultError}:i.code!=="invalid_type"?{message:l.defaultError}:{message:(u=d??n)!==null&&u!==void 0?u:l.defaultError}},description:s}}class Ve{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return eo(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:eo(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new wn,ctx:{common:t.parent.common,data:t.data,parsedType:eo(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Yc(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:eo(t)},o=this._parseSync({data:t,path:s.path,parent:s});return gS(s,o)}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:eo(t)},s=this._parse({data:t,path:r.path,parent:r}),o=await(Yc(s)?s:Promise.resolve(s));return gS(r,o)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,o)=>{const i=t(s),l=()=>o.addIssue({code:he.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(l(),!1)):i?!0:(l(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Ur({schema:this,typeName:Te.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return os.create(this,this._def)}nullable(){return Lo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Mr.create(this,this._def)}promise(){return al.create(this,this._def)}or(t){return eu.create([this,t],this._def)}and(t){return tu.create(this,t,this._def)}transform(t){return new Ur({...Me(this._def),schema:this,typeName:Te.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new au({...Me(this._def),innerType:this,defaultValue:n,typeName:Te.ZodDefault})}brand(){return new Ix({typeName:Te.ZodBranded,type:this,...Me(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new iu({...Me(this._def),innerType:this,catchValue:n,typeName:Te.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Pu.create(this,t)}readonly(){return lu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const GU=/^c[^\s-]{8,}$/i,ZU=/^[0-9a-z]+$/,YU=/^[0-9A-HJKMNP-TV-Z]{26}$/,QU=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,XU=/^[a-z0-9_-]{21}$/i,JU=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,e6=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,t6="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hp;const n6=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,r6=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,s6=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,RT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",o6=new RegExp(`^${RT}$`);function $T(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function a6(e){return new RegExp(`^${$T(e)}$`)}function OT(e){let t=`${RT}T${$T(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function i6(e,t){return!!((t==="v4"||!t)&&n6.test(e)||(t==="v6"||!t)&&r6.test(e))}class Tr extends Ve{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==ke.string){const o=this._getOrReturnCtx(t);return Se(o,{code:he.invalid_type,expected:ke.string,received:o.parsedType}),Ae}const r=new wn;let s;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),Se(s,{code:he.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),Se(s,{code:he.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const i=t.data.length>o.value,l=t.data.length<o.value;(i||l)&&(s=this._getOrReturnCtx(t,s),i?Se(s,{code:he.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):l&&Se(s,{code:he.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")e6.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"email",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")hp||(hp=new RegExp(t6,"u")),hp.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"emoji",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")QU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"uuid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")XU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"nanoid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")GU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"cuid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")ZU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"cuid2",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")YU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"ulid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),Se(s,{validation:"url",code:he.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"regex",code:he.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?OT(o).test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?o6.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?a6(o).test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{code:he.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?JU.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"duration",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?i6(t.data,o.version)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"ip",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?s6.test(t.data)||(s=this._getOrReturnCtx(t,s),Se(s,{validation:"base64",code:he.invalid_string,message:o.message}),r.dirty()):Ze.assertNever(o);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:he.invalid_string,...Ne.errToObj(r)})}_addCheck(t){return new Tr({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ne.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ne.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ne.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ne.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ne.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ne.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ne.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ne.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ne.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ne.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,...Ne.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ne.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ne.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Ne.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Ne.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Ne.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Ne.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Ne.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Ne.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Ne.errToObj(n)})}nonempty(t){return this.min(1,Ne.errToObj(t))}trim(){return new Tr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Tr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Tr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Tr.create=e=>{var t;return new Tr({checks:[],typeName:Te.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Me(e)})};function l6(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,o=parseInt(e.toFixed(s).replace(".","")),i=parseInt(t.toFixed(s).replace(".",""));return o%i/Math.pow(10,s)}class Oo extends Ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==ke.number){const o=this._getOrReturnCtx(t);return Se(o,{code:he.invalid_type,expected:ke.number,received:o.parsedType}),Ae}let r;const s=new wn;for(const o of this._def.checks)o.kind==="int"?Ze.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Se(r,{code:he.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?l6(t.data,o.value)!==0&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Se(r,{code:he.not_finite,message:o.message}),s.dirty()):Ze.assertNever(o);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ne.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ne.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ne.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ne.toString(n))}setLimit(t,n,r,s){return new Oo({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ne.toString(s)}]})}_addCheck(t){return new Oo({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ne.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ne.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ne.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ne.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ne.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ne.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Ne.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ne.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ne.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ze.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Oo.create=e=>new Oo({checks:[],typeName:Te.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Me(e)});class Mo extends Ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==ke.bigint){const o=this._getOrReturnCtx(t);return Se(o,{code:he.invalid_type,expected:ke.bigint,received:o.parsedType}),Ae}let r;const s=new wn;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Se(r,{code:he.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):Ze.assertNever(o);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ne.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ne.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ne.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ne.toString(n))}setLimit(t,n,r,s){return new Mo({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ne.toString(s)}]})}_addCheck(t){return new Mo({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ne.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ne.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ne.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ne.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ne.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Mo.create=e=>{var t;return new Mo({checks:[],typeName:Te.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Me(e)})};class Qc extends Ve{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==ke.boolean){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.boolean,received:r.parsedType}),Ae}return jn(t.data)}}Qc.create=e=>new Qc({typeName:Te.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Me(e)});class Na extends Ve{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==ke.date){const o=this._getOrReturnCtx(t);return Se(o,{code:he.invalid_type,expected:ke.date,received:o.parsedType}),Ae}if(isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return Se(o,{code:he.invalid_date}),Ae}const r=new wn;let s;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),Se(s,{code:he.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),Se(s,{code:he.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):Ze.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Na({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Ne.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Ne.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Na.create=e=>new Na({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Te.ZodDate,...Me(e)});class Gf extends Ve{_parse(t){if(this._getType(t)!==ke.symbol){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.symbol,received:r.parsedType}),Ae}return jn(t.data)}}Gf.create=e=>new Gf({typeName:Te.ZodSymbol,...Me(e)});class Xc extends Ve{_parse(t){if(this._getType(t)!==ke.undefined){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.undefined,received:r.parsedType}),Ae}return jn(t.data)}}Xc.create=e=>new Xc({typeName:Te.ZodUndefined,...Me(e)});class Jc extends Ve{_parse(t){if(this._getType(t)!==ke.null){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.null,received:r.parsedType}),Ae}return jn(t.data)}}Jc.create=e=>new Jc({typeName:Te.ZodNull,...Me(e)});class ol extends Ve{constructor(){super(...arguments),this._any=!0}_parse(t){return jn(t.data)}}ol.create=e=>new ol({typeName:Te.ZodAny,...Me(e)});class ya extends Ve{constructor(){super(...arguments),this._unknown=!0}_parse(t){return jn(t.data)}}ya.create=e=>new ya({typeName:Te.ZodUnknown,...Me(e)});class Fs extends Ve{_parse(t){const n=this._getOrReturnCtx(t);return Se(n,{code:he.invalid_type,expected:ke.never,received:n.parsedType}),Ae}}Fs.create=e=>new Fs({typeName:Te.ZodNever,...Me(e)});class Zf extends Ve{_parse(t){if(this._getType(t)!==ke.undefined){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.void,received:r.parsedType}),Ae}return jn(t.data)}}Zf.create=e=>new Zf({typeName:Te.ZodVoid,...Me(e)});class Mr extends Ve{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==ke.array)return Se(n,{code:he.invalid_type,expected:ke.array,received:n.parsedType}),Ae;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,l=n.data.length<s.exactLength.value;(i||l)&&(Se(n,{code:i?he.too_big:he.too_small,minimum:l?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Se(n,{code:he.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Se(n,{code:he.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,l)=>s.type._parseAsync(new ds(n,i,n.path,l)))).then(i=>wn.mergeArray(r,i));const o=[...n.data].map((i,l)=>s.type._parseSync(new ds(n,i,n.path,l)));return wn.mergeArray(r,o)}get element(){return this._def.type}min(t,n){return new Mr({...this._def,minLength:{value:t,message:Ne.toString(n)}})}max(t,n){return new Mr({...this._def,maxLength:{value:t,message:Ne.toString(n)}})}length(t,n){return new Mr({...this._def,exactLength:{value:t,message:Ne.toString(n)}})}nonempty(t){return this.min(1,t)}}Mr.create=(e,t)=>new Mr({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Te.ZodArray,...Me(t)});function Wa(e){if(e instanceof Ct){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=os.create(Wa(r))}return new Ct({...e._def,shape:()=>t})}else return e instanceof Mr?new Mr({...e._def,type:Wa(e.element)}):e instanceof os?os.create(Wa(e.unwrap())):e instanceof Lo?Lo.create(Wa(e.unwrap())):e instanceof fs?fs.create(e.items.map(t=>Wa(t))):e}class Ct extends Ve{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Ze.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==ke.object){const u=this._getOrReturnCtx(t);return Se(u,{code:he.invalid_type,expected:ke.object,received:u.parsedType}),Ae}const{status:r,ctx:s}=this._processInputParams(t),{shape:o,keys:i}=this._getCached(),l=[];if(!(this._def.catchall instanceof Fs&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||l.push(u);const c=[];for(const u of i){const d=o[u],m=s.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new ds(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Fs){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of l)c.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(u==="strict")l.length>0&&(Se(s,{code:he.unrecognized_keys,keys:l}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of l){const m=s.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new ds(s,m,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of c){const m=await d.key,f=await d.value;u.push({key:m,value:f,alwaysSet:d.alwaysSet})}return u}).then(u=>wn.mergeObjectSync(r,u)):wn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(t){return Ne.errToObj,new Ct({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var s,o,i,l;const c=(i=(o=(s=this._def).errorMap)===null||o===void 0?void 0:o.call(s,n,r).message)!==null&&i!==void 0?i:r.defaultError;return n.code==="unrecognized_keys"?{message:(l=Ne.errToObj(t).message)!==null&&l!==void 0?l:c}:{message:c}}}:{}})}strip(){return new Ct({...this._def,unknownKeys:"strip"})}passthrough(){return new Ct({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ct({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ct({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Te.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ct({...this._def,catchall:t})}pick(t){const n={};return Ze.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ct({...this._def,shape:()=>n})}omit(t){const n={};return Ze.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new Ct({...this._def,shape:()=>n})}deepPartial(){return Wa(this)}partial(t){const n={};return Ze.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}),new Ct({...this._def,shape:()=>n})}required(t){const n={};return Ze.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof os;)o=o._def.innerType;n[r]=o}}),new Ct({...this._def,shape:()=>n})}keyof(){return MT(Ze.objectKeys(this.shape))}}Ct.create=(e,t)=>new Ct({shape:()=>e,unknownKeys:"strip",catchall:Fs.create(),typeName:Te.ZodObject,...Me(t)});Ct.strictCreate=(e,t)=>new Ct({shape:()=>e,unknownKeys:"strict",catchall:Fs.create(),typeName:Te.ZodObject,...Me(t)});Ct.lazycreate=(e,t)=>new Ct({shape:e,unknownKeys:"strip",catchall:Fs.create(),typeName:Te.ZodObject,...Me(t)});class eu extends Ve{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(o){for(const l of o)if(l.result.status==="valid")return l.result;for(const l of o)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const i=o.map(l=>new rr(l.ctx.common.issues));return Se(n,{code:he.invalid_union,unionErrors:i}),Ae}if(n.common.async)return Promise.all(r.map(async o=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await o._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let o;const i=[];for(const c of r){const u={...n,common:{...n.common,issues:[]},parent:null},d=c._parseSync({data:n.data,path:n.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!o&&(o={result:d,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return n.common.issues.push(...o.ctx.common.issues),o.result;const l=i.map(c=>new rr(c));return Se(n,{code:he.invalid_union,unionErrors:l}),Ae}}get options(){return this._def.options}}eu.create=(e,t)=>new eu({options:e,typeName:Te.ZodUnion,...Me(t)});const _s=e=>e instanceof ru?_s(e.schema):e instanceof Ur?_s(e.innerType()):e instanceof su?[e.value]:e instanceof zo?e.options:e instanceof ou?Ze.objectValues(e.enum):e instanceof au?_s(e._def.innerType):e instanceof Xc?[void 0]:e instanceof Jc?[null]:e instanceof os?[void 0,..._s(e.unwrap())]:e instanceof Lo?[null,..._s(e.unwrap())]:e instanceof Ix||e instanceof lu?_s(e.unwrap()):e instanceof iu?_s(e._def.innerType):[];class rh extends Ve{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ke.object)return Se(n,{code:he.invalid_type,expected:ke.object,received:n.parsedType}),Ae;const r=this.discriminator,s=n.data[r],o=this.optionsMap.get(s);return o?n.common.async?o._parseAsync({data:n.data,path:n.path,parent:n}):o._parseSync({data:n.data,path:n.path,parent:n}):(Se(n,{code:he.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ae)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const o of n){const i=_s(o.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const l of i){if(s.has(l))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(l)}`);s.set(l,o)}}return new rh({typeName:Te.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Me(r)})}}function ey(e,t){const n=eo(e),r=eo(t);if(e===t)return{valid:!0,data:e};if(n===ke.object&&r===ke.object){const s=Ze.objectKeys(t),o=Ze.objectKeys(e).filter(l=>s.indexOf(l)!==-1),i={...e,...t};for(const l of o){const c=ey(e[l],t[l]);if(!c.valid)return{valid:!1};i[l]=c.data}return{valid:!0,data:i}}else if(n===ke.array&&r===ke.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let o=0;o<e.length;o++){const i=e[o],l=t[o],c=ey(i,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===ke.date&&r===ke.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class tu extends Ve{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(o,i)=>{if(Xg(o)||Xg(i))return Ae;const l=ey(o.value,i.value);return l.valid?((Jg(o)||Jg(i))&&n.dirty(),{status:n.value,value:l.data}):(Se(r,{code:he.invalid_intersection_types}),Ae)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,i])=>s(o,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}tu.create=(e,t,n)=>new tu({left:e,right:t,typeName:Te.ZodIntersection,...Me(n)});class fs extends Ve{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ke.array)return Se(r,{code:he.invalid_type,expected:ke.array,received:r.parsedType}),Ae;if(r.data.length<this._def.items.length)return Se(r,{code:he.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&r.data.length>this._def.items.length&&(Se(r,{code:he.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const o=[...r.data].map((i,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new ds(r,i,r.path,l)):null}).filter(i=>!!i);return r.common.async?Promise.all(o).then(i=>wn.mergeArray(n,i)):wn.mergeArray(n,o)}get items(){return this._def.items}rest(t){return new fs({...this._def,rest:t})}}fs.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new fs({items:e,typeName:Te.ZodTuple,rest:null,...Me(t)})};class nu extends Ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ke.object)return Se(r,{code:he.invalid_type,expected:ke.object,received:r.parsedType}),Ae;const s=[],o=this._def.keyType,i=this._def.valueType;for(const l in r.data)s.push({key:o._parse(new ds(r,l,r.path,l)),value:i._parse(new ds(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?wn.mergeObjectAsync(n,s):wn.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Ve?new nu({keyType:t,valueType:n,typeName:Te.ZodRecord,...Me(r)}):new nu({keyType:Tr.create(),valueType:t,typeName:Te.ZodRecord,...Me(n)})}}class Yf extends Ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ke.map)return Se(r,{code:he.invalid_type,expected:ke.map,received:r.parsedType}),Ae;const s=this._def.keyType,o=this._def.valueType,i=[...r.data.entries()].map(([l,c],u)=>({key:s._parse(new ds(r,l,r.path,[u,"key"])),value:o._parse(new ds(r,c,r.path,[u,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of i){const u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return Ae;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),l.set(u.value,d.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const c of i){const u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return Ae;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),l.set(u.value,d.value)}return{status:n.value,value:l}}}}Yf.create=(e,t,n)=>new Yf({valueType:t,keyType:e,typeName:Te.ZodMap,...Me(n)});class ja extends Ve{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==ke.set)return Se(r,{code:he.invalid_type,expected:ke.set,received:r.parsedType}),Ae;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Se(r,{code:he.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Se(r,{code:he.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const o=this._def.valueType;function i(c){const u=new Set;for(const d of c){if(d.status==="aborted")return Ae;d.status==="dirty"&&n.dirty(),u.add(d.value)}return{status:n.value,value:u}}const l=[...r.data.values()].map((c,u)=>o._parse(new ds(r,c,r.path,u)));return r.common.async?Promise.all(l).then(c=>i(c)):i(l)}min(t,n){return new ja({...this._def,minSize:{value:t,message:Ne.toString(n)}})}max(t,n){return new ja({...this._def,maxSize:{value:t,message:Ne.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}ja.create=(e,t)=>new ja({valueType:e,minSize:null,maxSize:null,typeName:Te.ZodSet,...Me(t)});class _i extends Ve{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ke.function)return Se(n,{code:he.invalid_type,expected:ke.function,received:n.parsedType}),Ae;function r(l,c){return Hf({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Wf(),sl].filter(u=>!!u),issueData:{code:he.invalid_arguments,argumentsError:c}})}function s(l,c){return Hf({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Wf(),sl].filter(u=>!!u),issueData:{code:he.invalid_return_type,returnTypeError:c}})}const o={errorMap:n.common.contextualErrorMap},i=n.data;if(this._def.returns instanceof al){const l=this;return jn(async function(...c){const u=new rr([]),d=await l._def.args.parseAsync(c,o).catch(p=>{throw u.addIssue(r(c,p)),u}),m=await Reflect.apply(i,this,d);return await l._def.returns._def.type.parseAsync(m,o).catch(p=>{throw u.addIssue(s(m,p)),u})})}else{const l=this;return jn(function(...c){const u=l._def.args.safeParse(c,o);if(!u.success)throw new rr([r(c,u.error)]);const d=Reflect.apply(i,this,u.data),m=l._def.returns.safeParse(d,o);if(!m.success)throw new rr([s(d,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new _i({...this._def,args:fs.create(t).rest(ya.create())})}returns(t){return new _i({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new _i({args:t||fs.create([]).rest(ya.create()),returns:n||ya.create(),typeName:Te.ZodFunction,...Me(r)})}}class ru extends Ve{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}ru.create=(e,t)=>new ru({getter:e,typeName:Te.ZodLazy,...Me(t)});class su extends Ve{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Se(n,{received:n.data,code:he.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:t.data}}get value(){return this._def.value}}su.create=(e,t)=>new su({value:e,typeName:Te.ZodLiteral,...Me(t)});function MT(e,t){return new zo({values:e,typeName:Te.ZodEnum,...Me(t)})}class zo extends Ve{constructor(){super(...arguments),ql.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Se(n,{expected:Ze.joinValues(r),received:n.parsedType,code:he.invalid_type}),Ae}if(qf(this,ql)||DT(this,ql,new Set(this._def.values)),!qf(this,ql).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Se(n,{received:n.data,code:he.invalid_enum_value,options:r}),Ae}return jn(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return zo.create(t,{...this._def,...n})}exclude(t,n=this._def){return zo.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}ql=new WeakMap;zo.create=MT;class ou extends Ve{constructor(){super(...arguments),Gl.set(this,void 0)}_parse(t){const n=Ze.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==ke.string&&r.parsedType!==ke.number){const s=Ze.objectValues(n);return Se(r,{expected:Ze.joinValues(s),received:r.parsedType,code:he.invalid_type}),Ae}if(qf(this,Gl)||DT(this,Gl,new Set(Ze.getValidEnumValues(this._def.values))),!qf(this,Gl).has(t.data)){const s=Ze.objectValues(n);return Se(r,{received:r.data,code:he.invalid_enum_value,options:s}),Ae}return jn(t.data)}get enum(){return this._def.values}}Gl=new WeakMap;ou.create=(e,t)=>new ou({values:e,typeName:Te.ZodNativeEnum,...Me(t)});class al extends Ve{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==ke.promise&&n.common.async===!1)return Se(n,{code:he.invalid_type,expected:ke.promise,received:n.parsedType}),Ae;const r=n.parsedType===ke.promise?n.data:Promise.resolve(n.data);return jn(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}al.create=(e,t)=>new al({type:e,typeName:Te.ZodPromise,...Me(t)});class Ur extends Ve{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,o={addIssue:i=>{Se(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){const i=s.transform(r.data,o);if(r.common.async)return Promise.resolve(i).then(async l=>{if(n.value==="aborted")return Ae;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Ae:c.status==="dirty"||n.value==="dirty"?si(c.value):c});{if(n.value==="aborted")return Ae;const l=this._def.schema._parseSync({data:i,path:r.path,parent:r});return l.status==="aborted"?Ae:l.status==="dirty"||n.value==="dirty"?si(l.value):l}}if(s.type==="refinement"){const i=l=>{const c=s.refinement(l,o);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Ae:(l.status==="dirty"&&n.dirty(),i(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Ae:(l.status==="dirty"&&n.dirty(),i(l.value).then(()=>({status:n.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Zc(i))return i;const l=s.transform(i.value,o);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>Zc(i)?Promise.resolve(s.transform(i.value,o)).then(l=>({status:n.value,value:l})):i);Ze.assertNever(s)}}Ur.create=(e,t,n)=>new Ur({schema:e,typeName:Te.ZodEffects,effect:t,...Me(n)});Ur.createWithPreprocess=(e,t,n)=>new Ur({schema:t,effect:{type:"preprocess",transform:e},typeName:Te.ZodEffects,...Me(n)});class os extends Ve{_parse(t){return this._getType(t)===ke.undefined?jn(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}os.create=(e,t)=>new os({innerType:e,typeName:Te.ZodOptional,...Me(t)});class Lo extends Ve{_parse(t){return this._getType(t)===ke.null?jn(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Lo.create=(e,t)=>new Lo({innerType:e,typeName:Te.ZodNullable,...Me(t)});class au extends Ve{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===ke.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}au.create=(e,t)=>new au({innerType:e,typeName:Te.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Me(t)});class iu extends Ve{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Yc(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new rr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new rr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}iu.create=(e,t)=>new iu({innerType:e,typeName:Te.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Me(t)});class Qf extends Ve{_parse(t){if(this._getType(t)!==ke.nan){const r=this._getOrReturnCtx(t);return Se(r,{code:he.invalid_type,expected:ke.nan,received:r.parsedType}),Ae}return{status:"valid",value:t.data}}}Qf.create=e=>new Qf({typeName:Te.ZodNaN,...Me(e)});const c6=Symbol("zod_brand");class Ix extends Ve{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Pu extends Ve{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Ae:o.status==="dirty"?(n.dirty(),si(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ae:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new Pu({in:t,out:n,typeName:Te.ZodPipeline})}}class lu extends Ve{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Zc(s)&&(s.value=Object.freeze(s.value)),s);return Yc(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}lu.create=(e,t)=>new lu({innerType:e,typeName:Te.ZodReadonly,...Me(t)});function zT(e,t={},n){return e?ol.create().superRefine((r,s)=>{var o,i;if(!e(r)){const l=typeof t=="function"?t(r):typeof t=="string"?{message:t}:t,c=(i=(o=l.fatal)!==null&&o!==void 0?o:n)!==null&&i!==void 0?i:!0,u=typeof l=="string"?{message:l}:l;s.addIssue({code:"custom",...u,fatal:c})}}):ol.create()}const u6={object:Ct.lazycreate};var Te;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Te||(Te={}));const d6=(e,t={message:`Input not instance of ${e.name}`})=>zT(n=>n instanceof e,t),LT=Tr.create,FT=Oo.create,f6=Qf.create,m6=Mo.create,VT=Qc.create,h6=Na.create,p6=Gf.create,g6=Xc.create,y6=Jc.create,v6=ol.create,x6=ya.create,w6=Fs.create,_6=Zf.create,S6=Mr.create,b6=Ct.create,E6=Ct.strictCreate,k6=eu.create,C6=rh.create,N6=tu.create,j6=fs.create,I6=nu.create,T6=Yf.create,A6=ja.create,P6=_i.create,D6=ru.create,R6=su.create,$6=zo.create,O6=ou.create,M6=al.create,yS=Ur.create,z6=os.create,L6=Lo.create,F6=Ur.createWithPreprocess,V6=Pu.create,U6=()=>LT().optional(),B6=()=>FT().optional(),K6=()=>VT().optional(),W6={string:e=>Tr.create({...e,coerce:!0}),number:e=>Oo.create({...e,coerce:!0}),boolean:e=>Qc.create({...e,coerce:!0}),bigint:e=>Mo.create({...e,coerce:!0}),date:e=>Na.create({...e,coerce:!0})},H6=Ae;var _e=Object.freeze({__proto__:null,defaultErrorMap:sl,setErrorMap:HU,getErrorMap:Wf,makeIssue:Hf,EMPTY_PATH:qU,addIssueToContext:Se,ParseStatus:wn,INVALID:Ae,DIRTY:si,OK:jn,isAborted:Xg,isDirty:Jg,isValid:Zc,isAsync:Yc,get util(){return Ze},get objectUtil(){return Qg},ZodParsedType:ke,getParsedType:eo,ZodType:Ve,datetimeRegex:OT,ZodString:Tr,ZodNumber:Oo,ZodBigInt:Mo,ZodBoolean:Qc,ZodDate:Na,ZodSymbol:Gf,ZodUndefined:Xc,ZodNull:Jc,ZodAny:ol,ZodUnknown:ya,ZodNever:Fs,ZodVoid:Zf,ZodArray:Mr,ZodObject:Ct,ZodUnion:eu,ZodDiscriminatedUnion:rh,ZodIntersection:tu,ZodTuple:fs,ZodRecord:nu,ZodMap:Yf,ZodSet:ja,ZodFunction:_i,ZodLazy:ru,ZodLiteral:su,ZodEnum:zo,ZodNativeEnum:ou,ZodPromise:al,ZodEffects:Ur,ZodTransformer:Ur,ZodOptional:os,ZodNullable:Lo,ZodDefault:au,ZodCatch:iu,ZodNaN:Qf,BRAND:c6,ZodBranded:Ix,ZodPipeline:Pu,ZodReadonly:lu,custom:zT,Schema:Ve,ZodSchema:Ve,late:u6,get ZodFirstPartyTypeKind(){return Te},coerce:W6,any:v6,array:S6,bigint:m6,boolean:VT,date:h6,discriminatedUnion:C6,effect:yS,enum:$6,function:P6,instanceof:d6,intersection:N6,lazy:D6,literal:R6,map:T6,nan:f6,nativeEnum:O6,never:w6,null:y6,nullable:L6,number:FT,object:b6,oboolean:K6,onumber:B6,optional:z6,ostring:U6,pipeline:V6,preprocess:F6,promise:M6,record:I6,set:A6,strictObject:E6,string:LT,symbol:p6,transformer:yS,tuple:j6,undefined:g6,union:k6,unknown:x6,void:_6,NEVER:H6,ZodIssueCode:he,quotelessJson:WU,ZodError:rr});const Si=CU,UT=w.createContext({}),ht=({...e})=>a.jsx(UT.Provider,{value:{name:e.name},children:a.jsx(TU,{...e})}),sh=()=>{const e=w.useContext(UT),t=w.useContext(BT),{getFieldState:n,formState:r}=nh(),s=n(e.name,r);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:o}=t;return{id:o,name:e.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...s}},BT=w.createContext({}),dt=w.forwardRef(({className:e,...t},n)=>{const r=w.useId();return a.jsx(BT.Provider,{value:{id:r},children:a.jsx("div",{ref:n,className:ye("space-y-2",e),...t})})});dt.displayName="FormItem";const St=w.forwardRef(({className:e,...t},n)=>{const{error:r,formItemId:s}=sh();return a.jsx(ct,{ref:n,className:ye(r&&"text-destructive",e),htmlFor:s,...t})});St.displayName="FormLabel";const ft=w.forwardRef(({...e},t)=>{const{error:n,formItemId:r,formDescriptionId:s,formMessageId:o}=sh();return a.jsx(Ms,{ref:t,id:r,"aria-describedby":n?`${s} ${o}`:`${s}`,"aria-invalid":!!n,...e})});ft.displayName="FormControl";const Ud=w.forwardRef(({className:e,...t},n)=>{const{formDescriptionId:r}=sh();return a.jsx("p",{ref:n,id:r,className:ye("text-sm text-muted-foreground",e),...t})});Ud.displayName="FormDescription";const pt=w.forwardRef(({className:e,children:t,...n},r)=>{const{error:s,formMessageId:o}=sh(),i=s?String(s==null?void 0:s.message):t;return i?a.jsx("p",{ref:r,id:o,className:ye("text-sm font-medium text-destructive",e),...n,children:i}):null});pt.displayName="FormMessage";function vS(e,[t,n]){return Math.min(n,Math.max(t,e))}var q6=[" ","Enter","ArrowUp","ArrowDown"],G6=[" ","Enter"],Du="Select",[oh,ah,Z6]=Nm(Du),[_l,eW]=ms(Du,[Z6,xl]),ih=xl(),[Y6,Wo]=_l(Du),[Q6,X6]=_l(Du),KT=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:o,value:i,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:m,disabled:f,required:p,form:v}=e,h=ih(t),[x,y]=w.useState(null),[g,_]=w.useState(null),[S,E]=w.useState(!1),A=qm(u),[I=!1,N]=as({prop:r,defaultProp:s,onChange:o}),[T,$]=as({prop:i,defaultProp:l,onChange:c}),M=w.useRef(null),j=x?v||!!x.closest("form"):!0,[P,b]=w.useState(new Set),V=Array.from(P).map(Z=>Z.props.value).join(";");return a.jsx(ox,{...h,children:a.jsxs(Y6,{required:p,scope:t,trigger:x,onTriggerChange:y,valueNode:g,onValueNodeChange:_,valueNodeHasChildren:S,onValueNodeHasChildrenChange:E,contentId:Or(),value:T,onValueChange:$,open:I,onOpenChange:N,dir:A,triggerPointerDownPosRef:M,disabled:f,children:[a.jsx(oh.Provider,{scope:t,children:a.jsx(Q6,{scope:e.__scopeSelect,onNativeOptionAdd:w.useCallback(Z=>{b(D=>new Set(D).add(Z))},[]),onNativeOptionRemove:w.useCallback(Z=>{b(D=>{const L=new Set(D);return L.delete(Z),L})},[]),children:n})}),j?a.jsxs(pA,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:m,value:T,onChange:Z=>$(Z.target.value),disabled:f,form:v,children:[T===void 0?a.jsx("option",{value:""}):null,Array.from(P)]},V):null]})})};KT.displayName=Du;var WT="SelectTrigger",HT=w.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,o=ih(n),i=Wo(WT,n),l=i.disabled||r,c=qe(t,i.onTriggerChange),u=ah(n),d=w.useRef("touch"),[m,f,p]=gA(h=>{const x=u().filter(_=>!_.disabled),y=x.find(_=>_.value===i.value),g=yA(x,h,y);g!==void 0&&i.onValueChange(g.value)}),v=h=>{l||(i.onOpenChange(!0),p()),h&&(i.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return a.jsx(ax,{asChild:!0,...o,children:a.jsx(je.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":hA(i.value)?"":void 0,...s,ref:c,onClick:xe(s.onClick,h=>{h.currentTarget.focus(),d.current!=="mouse"&&v(h)}),onPointerDown:xe(s.onPointerDown,h=>{d.current=h.pointerType;const x=h.target;x.hasPointerCapture(h.pointerId)&&x.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(v(h),h.preventDefault())}),onKeyDown:xe(s.onKeyDown,h=>{const x=m.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&f(h.key),!(x&&h.key===" ")&&q6.includes(h.key)&&(v(),h.preventDefault())})})})});HT.displayName=WT;var qT="SelectValue",GT=w.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:o,placeholder:i="",...l}=e,c=Wo(qT,n),{onValueNodeHasChildrenChange:u}=c,d=o!==void 0,m=qe(t,c.onValueNodeChange);return xn(()=>{u(d)},[u,d]),a.jsx(je.span,{...l,ref:m,style:{pointerEvents:"none"},children:hA(c.value)?a.jsx(a.Fragment,{children:i}):o})});GT.displayName=qT;var J6="SelectIcon",ZT=w.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return a.jsx(je.span,{"aria-hidden":!0,...s,ref:t,children:r||"▼"})});ZT.displayName=J6;var e8="SelectPortal",YT=e=>a.jsx(_u,{asChild:!0,...e});YT.displayName=e8;var Ia="SelectContent",QT=w.forwardRef((e,t)=>{const n=Wo(Ia,e.__scopeSelect),[r,s]=w.useState();if(xn(()=>{s(new DocumentFragment)},[]),!n.open){const o=r;return o?Pa.createPortal(a.jsx(XT,{scope:e.__scopeSelect,children:a.jsx(oh.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),o):null}return a.jsx(JT,{...e,ref:t})});QT.displayName=Ia;var br=10,[XT,Ho]=_l(Ia),t8="SelectContentImpl",JT=w.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:o,onPointerDownOutside:i,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:m,collisionBoundary:f,collisionPadding:p,sticky:v,hideWhenDetached:h,avoidCollisions:x,...y}=e,g=Wo(Ia,n),[_,S]=w.useState(null),[E,A]=w.useState(null),I=qe(t,G=>S(G)),[N,T]=w.useState(null),[$,M]=w.useState(null),j=ah(n),[P,b]=w.useState(!1),V=w.useRef(!1);w.useEffect(()=>{if(_)return Lv(_)},[_]),zv();const Z=w.useCallback(G=>{const[te,...le]=j().map(de=>de.ref.current),[fe]=le.slice(-1),ge=document.activeElement;for(const de of G)if(de===ge||(de==null||de.scrollIntoView({block:"nearest"}),de===te&&E&&(E.scrollTop=0),de===fe&&E&&(E.scrollTop=E.scrollHeight),de==null||de.focus(),document.activeElement!==ge))return},[j,E]),D=w.useCallback(()=>Z([N,_]),[Z,N,_]);w.useEffect(()=>{P&&D()},[P,D]);const{onOpenChange:L,triggerPointerDownPosRef:O}=g;w.useEffect(()=>{if(_){let G={x:0,y:0};const te=fe=>{var ge,de;G={x:Math.abs(Math.round(fe.pageX)-(((ge=O.current)==null?void 0:ge.x)??0)),y:Math.abs(Math.round(fe.pageY)-(((de=O.current)==null?void 0:de.y)??0))}},le=fe=>{G.x<=10&&G.y<=10?fe.preventDefault():_.contains(fe.target)||L(!1),document.removeEventListener("pointermove",te),O.current=null};return O.current!==null&&(document.addEventListener("pointermove",te),document.addEventListener("pointerup",le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",te),document.removeEventListener("pointerup",le,{capture:!0})}}},[_,L,O]),w.useEffect(()=>{const G=()=>L(!1);return window.addEventListener("blur",G),window.addEventListener("resize",G),()=>{window.removeEventListener("blur",G),window.removeEventListener("resize",G)}},[L]);const[q,F]=gA(G=>{const te=j().filter(ge=>!ge.disabled),le=te.find(ge=>ge.ref.current===document.activeElement),fe=yA(te,G,le);fe&&setTimeout(()=>fe.ref.current.focus())}),W=w.useCallback((G,te,le)=>{const fe=!V.current&&!le;(g.value!==void 0&&g.value===te||fe)&&(T(G),fe&&(V.current=!0))},[g.value]),ce=w.useCallback(()=>_==null?void 0:_.focus(),[_]),ae=w.useCallback((G,te,le)=>{const fe=!V.current&&!le;(g.value!==void 0&&g.value===te||fe)&&M(G)},[g.value]),K=r==="popper"?ty:eA,ne=K===ty?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:m,collisionBoundary:f,collisionPadding:p,sticky:v,hideWhenDetached:h,avoidCollisions:x}:{};return a.jsx(XT,{scope:n,content:_,viewport:E,onViewportChange:A,itemRefCallback:W,selectedItem:N,onItemLeave:ce,itemTextRefCallback:ae,focusSelectedItem:D,selectedItemText:$,position:r,isPositioned:P,searchRef:q,children:a.jsx(Lm,{as:Ms,allowPinchZoom:!0,children:a.jsx(Mm,{asChild:!0,trapped:g.open,onMountAutoFocus:G=>{G.preventDefault()},onUnmountAutoFocus:xe(s,G=>{var te;(te=g.trigger)==null||te.focus({preventScroll:!0}),G.preventDefault()}),children:a.jsx(ml,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:G=>G.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:a.jsx(K,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:G=>G.preventDefault(),...y,...ne,onPlaced:()=>b(!0),ref:I,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:xe(y.onKeyDown,G=>{const te=G.ctrlKey||G.altKey||G.metaKey;if(G.key==="Tab"&&G.preventDefault(),!te&&G.key.length===1&&F(G.key),["ArrowUp","ArrowDown","Home","End"].includes(G.key)){let fe=j().filter(ge=>!ge.disabled).map(ge=>ge.ref.current);if(["ArrowUp","End"].includes(G.key)&&(fe=fe.slice().reverse()),["ArrowUp","ArrowDown"].includes(G.key)){const ge=G.target,de=fe.indexOf(ge);fe=fe.slice(de+1)}setTimeout(()=>Z(fe)),G.preventDefault()}})})})})})})});JT.displayName=t8;var n8="SelectItemAlignedPosition",eA=w.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,o=Wo(Ia,n),i=Ho(Ia,n),[l,c]=w.useState(null),[u,d]=w.useState(null),m=qe(t,I=>d(I)),f=ah(n),p=w.useRef(!1),v=w.useRef(!0),{viewport:h,selectedItem:x,selectedItemText:y,focusSelectedItem:g}=i,_=w.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&u&&h&&x&&y){const I=o.trigger.getBoundingClientRect(),N=u.getBoundingClientRect(),T=o.valueNode.getBoundingClientRect(),$=y.getBoundingClientRect();if(o.dir!=="rtl"){const ge=$.left-N.left,de=T.left-ge,Pe=I.left-de,C=I.width+Pe,J=Math.max(C,N.width),ee=window.innerWidth-br,z=vS(de,[br,Math.max(br,ee-J)]);l.style.minWidth=C+"px",l.style.left=z+"px"}else{const ge=N.right-$.right,de=window.innerWidth-T.right-ge,Pe=window.innerWidth-I.right-de,C=I.width+Pe,J=Math.max(C,N.width),ee=window.innerWidth-br,z=vS(de,[br,Math.max(br,ee-J)]);l.style.minWidth=C+"px",l.style.right=z+"px"}const M=f(),j=window.innerHeight-br*2,P=h.scrollHeight,b=window.getComputedStyle(u),V=parseInt(b.borderTopWidth,10),Z=parseInt(b.paddingTop,10),D=parseInt(b.borderBottomWidth,10),L=parseInt(b.paddingBottom,10),O=V+Z+P+L+D,q=Math.min(x.offsetHeight*5,O),F=window.getComputedStyle(h),W=parseInt(F.paddingTop,10),ce=parseInt(F.paddingBottom,10),ae=I.top+I.height/2-br,K=j-ae,ne=x.offsetHeight/2,G=x.offsetTop+ne,te=V+Z+G,le=O-te;if(te<=ae){const ge=M.length>0&&x===M[M.length-1].ref.current;l.style.bottom="0px";const de=u.clientHeight-h.offsetTop-h.offsetHeight,Pe=Math.max(K,ne+(ge?ce:0)+de+D),C=te+Pe;l.style.height=C+"px"}else{const ge=M.length>0&&x===M[0].ref.current;l.style.top="0px";const Pe=Math.max(ae,V+h.offsetTop+(ge?W:0)+ne)+le;l.style.height=Pe+"px",h.scrollTop=te-ae+h.offsetTop}l.style.margin=`${br}px 0`,l.style.minHeight=q+"px",l.style.maxHeight=j+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,o.trigger,o.valueNode,l,u,h,x,y,o.dir,r]);xn(()=>_(),[_]);const[S,E]=w.useState();xn(()=>{u&&E(window.getComputedStyle(u).zIndex)},[u]);const A=w.useCallback(I=>{I&&v.current===!0&&(_(),g==null||g(),v.current=!1)},[_,g]);return a.jsx(s8,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:A,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:a.jsx(je.div,{...s,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});eA.displayName=n8;var r8="SelectPopperPosition",ty=w.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=br,...o}=e,i=ih(n);return a.jsx(ix,{...i,...o,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ty.displayName=r8;var[s8,Tx]=_l(Ia,{}),ny="SelectViewport",tA=w.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,o=Ho(ny,n),i=Tx(ny,n),l=qe(t,o.onViewportChange),c=w.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),a.jsx(oh.Slot,{scope:n,children:a.jsx(je.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:xe(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:f}=i;if(f!=null&&f.current&&m){const p=Math.abs(c.current-d.scrollTop);if(p>0){const v=window.innerHeight-br*2,h=parseFloat(m.style.minHeight),x=parseFloat(m.style.height),y=Math.max(h,x);if(y<v){const g=y+p,_=Math.min(v,g),S=g-_;m.style.height=_+"px",m.style.bottom==="0px"&&(d.scrollTop=S>0?S:0,m.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});tA.displayName=ny;var nA="SelectGroup",[o8,a8]=_l(nA),i8=w.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Or();return a.jsx(o8,{scope:n,id:s,children:a.jsx(je.div,{role:"group","aria-labelledby":s,...r,ref:t})})});i8.displayName=nA;var rA="SelectLabel",sA=w.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=a8(rA,n);return a.jsx(je.div,{id:s.id,...r,ref:t})});sA.displayName=rA;var Xf="SelectItem",[l8,oA]=_l(Xf),aA=w.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:o,...i}=e,l=Wo(Xf,n),c=Ho(Xf,n),u=l.value===r,[d,m]=w.useState(o??""),[f,p]=w.useState(!1),v=qe(t,g=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,g,r,s)}),h=Or(),x=w.useRef("touch"),y=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(l8,{scope:n,value:r,disabled:s,textId:h,isSelected:u,onItemTextChange:w.useCallback(g=>{m(_=>_||((g==null?void 0:g.textContent)??"").trim())},[]),children:a.jsx(oh.ItemSlot,{scope:n,value:r,disabled:s,textValue:d,children:a.jsx(je.div,{role:"option","aria-labelledby":h,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:v,onFocus:xe(i.onFocus,()=>p(!0)),onBlur:xe(i.onBlur,()=>p(!1)),onClick:xe(i.onClick,()=>{x.current!=="mouse"&&y()}),onPointerUp:xe(i.onPointerUp,()=>{x.current==="mouse"&&y()}),onPointerDown:xe(i.onPointerDown,g=>{x.current=g.pointerType}),onPointerMove:xe(i.onPointerMove,g=>{var _;x.current=g.pointerType,s?(_=c.onItemLeave)==null||_.call(c):x.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:xe(i.onPointerLeave,g=>{var _;g.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:xe(i.onKeyDown,g=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&g.key===" "||(G6.includes(g.key)&&y(),g.key===" "&&g.preventDefault())})})})})});aA.displayName=Xf;var Zl="SelectItemText",iA=w.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...o}=e,i=Wo(Zl,n),l=Ho(Zl,n),c=oA(Zl,n),u=X6(Zl,n),[d,m]=w.useState(null),f=qe(t,y=>m(y),c.onItemTextChange,y=>{var g;return(g=l.itemTextRefCallback)==null?void 0:g.call(l,y,c.value,c.disabled)}),p=d==null?void 0:d.textContent,v=w.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:h,onNativeOptionRemove:x}=u;return xn(()=>(h(v),()=>x(v)),[h,x,v]),a.jsxs(a.Fragment,{children:[a.jsx(je.span,{id:c.textId,...o,ref:f}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Pa.createPortal(o.children,i.valueNode):null]})});iA.displayName=Zl;var lA="SelectItemIndicator",cA=w.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return oA(lA,n).isSelected?a.jsx(je.span,{"aria-hidden":!0,...r,ref:t}):null});cA.displayName=lA;var ry="SelectScrollUpButton",uA=w.forwardRef((e,t)=>{const n=Ho(ry,e.__scopeSelect),r=Tx(ry,e.__scopeSelect),[s,o]=w.useState(!1),i=qe(t,r.onScrollButtonChange);return xn(()=>{if(n.viewport&&n.isPositioned){let l=function(){const u=c.scrollTop>0;o(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(fA,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});uA.displayName=ry;var sy="SelectScrollDownButton",dA=w.forwardRef((e,t)=>{const n=Ho(sy,e.__scopeSelect),r=Tx(sy,e.__scopeSelect),[s,o]=w.useState(!1),i=qe(t,r.onScrollButtonChange);return xn(()=>{if(n.viewport&&n.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;o(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(fA,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});dA.displayName=sy;var fA=w.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,o=Ho("SelectScrollButton",n),i=w.useRef(null),l=ah(n),c=w.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return w.useEffect(()=>()=>c(),[c]),xn(()=>{var d;const u=l().find(m=>m.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),a.jsx(je.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:xe(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:xe(s.onPointerMove,()=>{var u;(u=o.onItemLeave)==null||u.call(o),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:xe(s.onPointerLeave,()=>{c()})})}),c8="SelectSeparator",mA=w.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return a.jsx(je.div,{"aria-hidden":!0,...r,ref:t})});mA.displayName=c8;var oy="SelectArrow",u8=w.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=ih(n),o=Wo(oy,n),i=Ho(oy,n);return o.open&&i.position==="popper"?a.jsx(lx,{...s,...r,ref:t}):null});u8.displayName=oy;function hA(e){return e===""||e===void 0}var pA=w.forwardRef((e,t)=>{const{value:n,...r}=e,s=w.useRef(null),o=qe(t,s),i=fx(n);return w.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&d){const m=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(m)}},[i,n]),a.jsx(Su,{asChild:!0,children:a.jsx("select",{...r,ref:o,defaultValue:n})})});pA.displayName="BubbleSelect";function gA(e){const t=vn(e),n=w.useRef(""),r=w.useRef(0),s=w.useCallback(i=>{const l=n.current+i;t(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),o=w.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,o]}function yA(e,t,n){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let i=d8(e,Math.max(o,0));s.length===1&&(i=i.filter(u=>u!==n));const c=i.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function d8(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var f8=KT,vA=HT,m8=GT,h8=ZT,p8=YT,xA=QT,g8=tA,wA=sA,_A=aA,y8=iA,v8=cA,SA=uA,bA=dA,EA=mA;const yc=f8,vc=m8,bi=w.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(vA,{ref:r,className:ye("flex h-10 w-full items-center justify-between rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-background placeholder:text-quaternary focus:outline-none focus:ring-2 focus:ring-tertiary focus:ring-offset-2 focus:border-tertiary disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,a.jsx(h8,{asChild:!0,children:a.jsx(Tm,{className:"h-4 w-4 text-quaternary"})})]}));bi.displayName=vA.displayName;const kA=w.forwardRef(({className:e,...t},n)=>a.jsx(SA,{ref:n,className:ye("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(J4,{className:"h-4 w-4"})}));kA.displayName=SA.displayName;const CA=w.forwardRef(({className:e,...t},n)=>a.jsx(bA,{ref:n,className:ye("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(Tm,{className:"h-4 w-4"})}));CA.displayName=bA.displayName;const Ei=w.forwardRef(({className:e,children:t,position:n="popper",...r},s)=>a.jsx(p8,{children:a.jsxs(xA,{ref:s,className:ye("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-xl border border-gray-100 bg-white text-gray-800 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[a.jsx(kA,{}),a.jsx(g8,{className:ye("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(CA,{})]})}));Ei.displayName=xA.displayName;const x8=w.forwardRef(({className:e,...t},n)=>a.jsx(wA,{ref:n,className:ye("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));x8.displayName=wA.displayName;const Ft=w.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(_A,{ref:r,className:ye("relative flex w-full cursor-default select-none items-center rounded-md py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-tertiary/5 focus:text-tertiary hover:bg-tertiary/5 hover:text-tertiary data-[state=checked]:bg-tertiary/10 data-[state=checked]:text-tertiary data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(v8,{children:a.jsx(Da,{className:"h-4 w-4 text-tertiary"})})}),a.jsx(y8,{children:t})]}));Ft.displayName=_A.displayName;const w8=w.forwardRef(({className:e,...t},n)=>a.jsx(EA,{ref:n,className:ye("-mx-1 my-1 h-px bg-muted",e),...t}));w8.displayName=EA.displayName;const Ax="bank_accounts",ay="account";function Ru(e){return e?Jm(e,Ax):""}async function ki(e){if(!e)return console.error("Cannot initialize bank accounts vault without email"),!1;try{console.log(`Initializing bank accounts vault for ${e}...`);const{setVaultUserContext:t}=await oe(async()=>{const{setVaultUserContext:l}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:l}},void 0);t(e);const{resetFallbackState:n}=await oe(async()=>{const{resetFallbackState:l}=await Promise.resolve().then(()=>tt);return{resetFallbackState:l}},void 0);n(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations");const r="wasm";if(pe.isInitialized()||(console.warn("Vault service not initialized, initializing now..."),await pe.initialize()),!pe.isUnlocked())return console.warn("Vault is locked! Cannot initialize bank accounts vault."),!1;const s=await pe.getVaults();console.log(`Found ${s.length} vaults`);const o=Ru(e);return console.log(`Checking for bank accounts vault: ${o}`),s.find(l=>l.id===o)?(console.log(`Bank accounts vault already exists: ${o}`),!0):(console.log(`Creating bank accounts vault for ${e}...`),await pe.createNewVault("Bank Accounts",Ax,o),console.log(`Using encryption method ${r} for vault operations`),console.log(`Bank accounts vault created: ${o} using encryption method: ${r}`),!0)}catch(t){return console.error("Failed to initialize bank accounts vault:",t),!1}}async function Px(e,t){try{console.log("Saving bank account to vault:",t.id);const{setVaultUserContext:n}=await oe(async()=>{const{setVaultUserContext:p}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:p}},void 0);n(e);const{resetFallbackState:r}=await oe(async()=>{const{resetFallbackState:p}=await Promise.resolve().then(()=>tt);return{resetFallbackState:p}},void 0);r();const s="wasm";if(console.log("Using standardized WASM-first approach with WebCrypto fallback for saving bank account"),!await ki(e))throw new Error("Failed to initialize bank accounts vault");const i=Ru(e),l=t,c=l.accountName||"Unknown Account",u=l.institutionName||"Unknown Bank",d=l.accountType||"Unknown Type",m=l.accountNumber||"",f={name:c,description:`${u} - ${d}`,type:ay,searchTerms:[u,c,d,m,"bank","account"].filter(Boolean),favorite:!1,encryptionMethod:s};return await pe.addItem(i,`Account ${t.id}`,ay,t,f,s),console.log(`Bank account ${t.id} saved successfully to vault ${i} with method ${s}`),!0}catch(n){return console.error("Failed to save bank account to vault:",n),!1}}async function NA(e){try{console.log("======= RETRIEVING BANK ACCOUNTS ======="),console.log(`Getting bank accounts from vault for ${e}...`);const{setVaultUserContext:t}=await oe(async()=>{const{setVaultUserContext:l}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:l}},void 0);t(e);const{resetFallbackState:n}=await oe(async()=>{const{resetFallbackState:l}=await Promise.resolve().then(()=>tt);return{resetFallbackState:l}},void 0);if(n(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations"),!pe.isUnlocked())return console.warn("Vault is locked! Cannot get bank accounts."),[];if(!await ki(e))return console.warn("Bank accounts vault not initialized"),[];const s=Ru(e),o=await pe.getItems(s);console.log(`Found ${o.length} items in bank accounts vault`),o.length===0&&(console.log("No bank accounts found in vault - checking if vault exists"),(await pe.getVaults()).find(u=>u.id===s)?console.log("Bank accounts vault exists but is empty"):(console.log("Bank accounts vault doesn't exist, creating now..."),await ki(e)));const i=o.map(l=>l.data);return console.log(`Found ${i.length} bank accounts in vault`),i}catch(t){console.error("Failed to get bank accounts from vault:",t);try{return console.log("Attempting to initialize bank accounts vault after retrieval error"),await ki(e),[]}catch(n){return console.error("Failed to initialize bank accounts vault:",n),[]}}}async function jA(e){try{console.log(`Syncing bank accounts for user ${e} with server`);const t=localStorage.getItem("session_email")||localStorage.getItem("last_email")||pa();if(!t)return console.warn("No email stored, cannot sync bank accounts"),!1;const{setVaultUserContext:n}=await oe(async()=>{const{setVaultUserContext:u}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:u}},void 0);n(t);const{resetFallbackState:r}=await oe(async()=>{const{resetFallbackState:u}=await Promise.resolve().then(()=>tt);return{resetFallbackState:u}},void 0);r(),console.log("Using standardized WASM-first approach with WebCrypto fallback for syncing");const s=Ru(t);if(console.log(`Using standardized vault ID for sync: ${s} (Email: ${t})`),!await ki(t))return console.warn("Bank accounts vault not initialized"),!1;if(!pe.isUnlocked())return console.warn("Vault is locked, cannot sync bank accounts"),!1;console.log("Attempting to fetch bank accounts from server...");const i=await fetch("/api/bank-accounts",{credentials:"include",headers:{"Content-Type":"application/json","X-Session-Email":t,"X-Auth-Timestamp":localStorage.getItem("auth_timestamp")||"","X-User-Id":e.toString(),"X-Vault-Id":s}});if(console.log(`Bank accounts response status: ${i.status}`),!i.ok)throw new Error(`Failed to fetch bank accounts: ${i.statusText}`);const l=await i.json();console.log(`Fetched ${l.length} bank accounts from server`);let c=0;for(const u of l)await Px(t,u)&&c++;return console.log(`Successfully synced ${c}/${l.length} bank accounts`),localStorage.setItem("last_bank_sync_timestamp",Date.now().toString()),localStorage.setItem("last_bank_sync_user",t),localStorage.setItem("last_bank_sync_account_count",c.toString()),!0}catch(t){return console.error("Failed to sync bank accounts with server:",t),localStorage.setItem("last_bank_sync_error",t instanceof Error?t.message:String(t)),localStorage.setItem("last_bank_sync_error_time",Date.now().toString()),!1}}const iy=Object.freeze(Object.defineProperty({__proto__:null,BANK_ACCOUNTS_VAULT_TYPE:Ax,BANK_ACCOUNT_ITEM_TYPE:ay,getBankAccountVaultId:Ru,getBankAccounts:NA,initializeBankAccountVault:ki,saveBankAccount:Px,syncBankDataWithServer:jA},Symbol.toStringTag,{value:"Module"})),_8=_e.object({institutionId:_e.string().min(1,"Institution ID is required"),institutionName:_e.string().min(1,"Institution name is required"),accountName:_e.string().min(1,"Account name is required"),accountType:_e.string().min(1,"Account type is required"),accountNumber:_e.string().optional(),availableBalance:_e.number().min(0,"Available balance must be a positive number"),currentBalance:_e.number(),isoCurrencyCode:_e.string().default("USD")});function Bd({isOpen:e,onClose:t,onSuccess:n,account:r}){const{toast:s}=dn(),[o,i]=w.useState(!1),l=!!r,c=xi({resolver:wi(_8),defaultValues:{institutionId:(r==null?void 0:r.institutionId)||"",institutionName:(r==null?void 0:r.institutionName)||"",accountName:(r==null?void 0:r.accountName)||"",accountType:(r==null?void 0:r.accountType)||At.CHECKING,accountNumber:(r==null?void 0:r.accountNumber)||"",availableBalance:(r==null?void 0:r.availableBalance)!==void 0?Number(r.availableBalance):0,currentBalance:(r==null?void 0:r.currentBalance)!==void 0?Number(r.currentBalance):0,isoCurrencyCode:(r==null?void 0:r.isoCurrencyCode)||"USD"}}),u=async()=>{if(pe.isUnlocked())return console.log("Vault already unlocked for bank account creation"),!0;try{const f=localStorage.getItem("last_auth_password");return f&&(console.log("Using stored password from login for bank account dialog"),await pe.unlockVault(f))?(console.log("Successfully unlocked vault with stored password"),!0):await pe.unlockVault()}catch(f){return console.error("Error unlocking vault:",f),!1}},d=async f=>{i(!0);try{const p=l?`/api/bank-accounts/${r.id}`:"/api/bank-accounts",v=l?"PATCH":"POST",h={institutionId:f.institutionId,institutionName:f.institutionName,accountName:f.accountName,accountType:f.accountType,accountNumber:f.accountNumber,availableBalance:Number(f.availableBalance),currentBalance:Number(f.currentBalance),isoCurrencyCode:f.isoCurrencyCode},x={...h,credentialId:(r==null?void 0:r.credentialId)||null,isActive:!0,isVerified:!0},y=await fetch(p,{method:v,headers:{"Content-Type":"application/json"},body:JSON.stringify(x),credentials:"include"});if(!y.ok){const _=await y.text();throw new Error(_||`Failed to ${l?"update":"create"} bank account`)}const g=await y.json();try{if(await u()){const S=pa();if(S){console.log(`Saving bank account to vault for ${S}`);const E={id:g.id,user_id:g.userId||g.user_id,credential_id:g.credentialId||g.credential_id||null,institution_id:h.institutionId,institution_name:h.institutionName,account_name:h.accountName,account_number:h.accountNumber,account_type:h.accountType,available_balance:h.availableBalance,current_balance:h.currentBalance,iso_currency_code:h.isoCurrencyCode,is_active:!0,is_verified:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await Px(S,E),console.log("Bank account saved to local vault successfully")}}else console.warn("Could not unlock vault for saving bank account locally")}catch(_){console.error("Error saving to vault:",_)}s({title:l?"Account updated":"Account added",description:l?`${f.accountName} has been successfully updated.`:`${f.accountName} has been successfully added.`}),n(g)}catch(p){console.error("Error saving bank account:",p),s({title:"Error",description:p instanceof Error?p.message:"Failed to save bank account",variant:"destructive"})}finally{i(!1)}},m=()=>{c.reset(),t()};return a.jsx(nn,{open:e,onOpenChange:f=>!f&&m(),children:a.jsxs(Gt,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:l?"Edit Bank Account":"Add Bank Account"}),a.jsx(Qt,{children:l?"Update your bank account information below.":"Enter your bank account details to connect it to your profile."})]}),a.jsx(Si,{...c,children:a.jsxs("form",{onSubmit:c.handleSubmit(d),className:"space-y-6 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ht,{control:c.control,name:"institutionName",render:({field:f})=>a.jsxs(dt,{className:"col-span-2",children:[a.jsx(St,{children:"Institution Name"}),a.jsx(ft,{children:a.jsx(De,{...f,placeholder:"e.g. Chase Bank"})}),a.jsx(Ud,{children:"The name of your bank or financial institution"}),a.jsx(pt,{})]})}),a.jsx(ht,{control:c.control,name:"institutionId",render:({field:f})=>a.jsxs(dt,{className:"hidden",children:[a.jsx(ft,{children:a.jsx(De,{...f,value:f.value||c.getValues().institutionName.toLowerCase().replace(/\s+/g,"_")})}),a.jsx(pt,{})]})}),a.jsx(ht,{control:c.control,name:"accountName",render:({field:f})=>a.jsxs(dt,{className:"col-span-2",children:[a.jsx(St,{children:"Account Name"}),a.jsx(ft,{children:a.jsx(De,{...f,placeholder:"e.g. Primary Checking"})}),a.jsx(Ud,{children:"A descriptive name for this account"}),a.jsx(pt,{})]})}),a.jsx(ht,{control:c.control,name:"accountType",render:({field:f})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Account Type"}),a.jsxs(yc,{onValueChange:f.onChange,defaultValue:f.value,children:[a.jsx(ft,{children:a.jsx(bi,{children:a.jsx(vc,{placeholder:"Select account type"})})}),a.jsxs(Ei,{children:[a.jsx(Ft,{value:At.CHECKING,children:"Checking"}),a.jsx(Ft,{value:At.SAVINGS,children:"Savings"}),a.jsx(Ft,{value:At.CREDIT,children:"Credit Card"}),a.jsx(Ft,{value:At.INVESTMENT,children:"Investment"}),a.jsx(Ft,{value:At.LOAN,children:"Loan"}),a.jsx(Ft,{value:At.MORTGAGE,children:"Mortgage"}),a.jsx(Ft,{value:At.OTHER,children:"Other"})]})]}),a.jsx(pt,{})]})}),a.jsx(ht,{control:c.control,name:"accountNumber",render:({field:f})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Account Number (Last 4)"}),a.jsx(ft,{children:a.jsx(De,{...f,placeholder:"e.g. 1234",maxLength:4,onChange:p=>{const v=p.target.value.replace(/[^0-9]/g,"");f.onChange(v)}})}),a.jsx(Ud,{children:"Last 4 digits only"}),a.jsx(pt,{})]})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ht,{control:c.control,name:"availableBalance",render:({field:f})=>{var p;return a.jsxs(dt,{children:[a.jsx(St,{children:"Available Balance"}),a.jsx(ft,{children:a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:"$"}),a.jsx(De,{value:((p=f.value)==null?void 0:p.toString())||"",onChange:v=>{const h=v.target.value===""?0:parseFloat(v.target.value);f.onChange(isNaN(h)?0:h)},className:"pl-7",type:"number",step:"0.01",placeholder:"0.00"})]})}),a.jsx(pt,{})]})}}),a.jsx(ht,{control:c.control,name:"currentBalance",render:({field:f})=>{var p;return a.jsxs(dt,{children:[a.jsx(St,{children:"Current Balance"}),a.jsx(ft,{children:a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:"$"}),a.jsx(De,{value:((p=f.value)==null?void 0:p.toString())||"",onChange:v=>{const h=v.target.value===""?0:parseFloat(v.target.value);f.onChange(isNaN(h)?0:h)},className:"pl-7",type:"number",step:"0.01",placeholder:"0.00"})]})}),a.jsx(pt,{})]})}}),a.jsx(ht,{control:c.control,name:"isoCurrencyCode",render:({field:f})=>a.jsxs(dt,{className:"hidden",children:[a.jsx(ft,{children:a.jsx(De,{...f})}),a.jsx(pt,{})]})})]}),a.jsxs(cn,{className:"pt-4",children:[a.jsx(ie,{type:"button",variant:"outline",onClick:m,disabled:o,children:"Cancel"}),a.jsx(ie,{type:"submit",disabled:o,children:o?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),l?"Updating...":"Adding..."]}):l?"Update Account":"Add Account"})]})]})})]})})}function S8({userId:e}){const{toast:t}=dn(),{user:n}=Bo(),r=fv(),[s,o]=w.useState(!1),[i,l]=w.useState(null),[c,u]=w.useState(!pe.isUnlocked()),[d,m]=w.useState(!1),[f,p]=w.useState(!0),[v,h]=w.useState([]);async function x(){const G=localStorage.getItem("session_email")||localStorage.getItem("last_email")||(n!=null&&n.email?n.email:null);if(console.log(`Bank accounts - trying with email: ${G||"not set"}`),e&&localStorage.setItem("current_user_id",e.toString()),G){localStorage.setItem("session_email",G),localStorage.setItem("current_vault_context",G),localStorage.setItem("last_email",G);const{generateVaultId:te}=await oe(async()=>{const{generateVaultId:fe}=await Promise.resolve().then(()=>up);return{generateVaultId:fe}},void 0),le=te(G,"bank_accounts");console.log(`Using standardized vault ID: ${le} for email: ${G}`),localStorage.setItem("contacts_vault_namespace",le),localStorage.setItem("bank_accounts_vault_id",le),localStorage.setItem("current_vault_id",le)}if(localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Set persistent vault markers for bank accounts vault access"),pe.isUnlocked())return console.log("Vault is already unlocked - proceeding with bank accounts operations"),!0;try{const te=localStorage.getItem("last_auth_password");if(te){console.log("Using stored password from persistent storage");const fe=await pe.unlockVault(te);if(console.log("Vault unlock attempt with stored password result:",fe),fe)return G&&localStorage.setItem("vault_context_user",G),!0;console.log("Stored password failed, trying alternative methods")}else console.log("No stored password found in persistent storage");const le=await pe.unlockVault();if(console.log("Vault unlock attempt with default method result:",le),le&&G&&localStorage.setItem("vault_context_user",G),!le){const fe=localStorage.getItem("auth_timestamp"),ge=localStorage.getItem("password_hash_check");if(fe&&Date.now()-parseInt(fe)<36e5&&ge)return console.log("Found recent authentication, attempting to use persistent context"),localStorage.setItem("vault_context_authenticated","true"),G&&localStorage.setItem("vault_context_user",G),await pe.unlockVault()}return le}catch(te){return console.error("Error unlocking vault:",te),!1}}w.useEffect(()=>{const G=async()=>{let te=pa();if(!te||!te.includes("@")){if(console.log("No valid email found via getStoredEmail(), trying auth context"),n&&n.email)te=n.email,console.log("Using email from auth context:",te);else try{if(e){console.log("Trying to get user email from API with userId:",e);const ge=await fetch(`/api/user/${e}`);if(ge.ok){const de=await ge.json();de&&de.email&&(te=de.email,console.log("Retrieved email from API:",te))}}}catch(ge){console.warn("Error retrieving user email from API:",ge)}if(!te&&window.location.search.includes("email=")){const de=new URLSearchParams(window.location.search).get("email");de&&de.includes("@")&&(te=de,console.log("Using email from URL parameter:",te))}}te?(localStorage.setItem("session_email",te),localStorage.setItem("current_vault_context",te),localStorage.setItem("last_email",te)):console.warn("Failed to determine user email for vault operations");const le=await x(),fe=pe.isUnlocked();u(!fe),(fe||le)&&await y()};return G(),window.addEventListener("vaultStatusChanged",async()=>{console.log("Vault status changed event detected - reloading bank accounts data"),await G()}),()=>{window.removeEventListener("vaultStatusChanged",G)}},[n,e]);const y=async()=>{try{if(!pe.isUnlocked()&&(console.log("Vault is locked, attempting to unlock..."),!await x())){console.log("Could not unlock vault for bank accounts - please log in"),u(!0);return}const G=localStorage.getItem("session_email")||localStorage.getItem("last_email")||(n!=null&&n.email?n.email:pa());if(G){const{generateVaultId:te}=await oe(async()=>{const{generateVaultId:ge}=await Promise.resolve().then(()=>up);return{generateVaultId:ge}},void 0),le=te(G,"bank_accounts");localStorage.setItem("contacts_vault_namespace",le),localStorage.setItem("bank_accounts_vault_id",le),localStorage.setItem("current_vault_id",le),console.log(`Loading bank accounts for email: ${G} (Vault ID: ${le})`);const fe=await NA(G);console.log(`Loaded ${fe.length} bank accounts from vault`),h(fe),u(!pe.isUnlocked()),localStorage.setItem("last_bank_accounts_count",fe.length.toString()),localStorage.setItem("last_bank_accounts_load_time",Date.now().toString())}else console.warn("No valid email found, cannot load bank accounts"),h([])}catch(G){console.error("Failed to load local accounts:",G),u(!0)}},g=async()=>{try{m(!0);const G=localStorage.getItem("session_email")||localStorage.getItem("last_email")||(n!=null&&n.email?n.email:pa());if(!G){t({title:"Sync failed",description:"Could not determine user email for vault synchronization",variant:"destructive"});return}const{generateVaultId:te}=await oe(async()=>{const{generateVaultId:ge}=await Promise.resolve().then(()=>up);return{generateVaultId:ge}},void 0),le=te(G,"bank_accounts");if(localStorage.setItem("contacts_vault_namespace",le),localStorage.setItem("bank_accounts_vault_id",le),localStorage.setItem("current_vault_id",le),console.log(`Syncing bank accounts for email: ${G} (Vault ID: ${le})`),!pe.isUnlocked()&&(console.log("Vault is locked, attempting to unlock before sync..."),!await x())){t({title:"Sync failed",description:"Your secure vault is locked. Please log in first.",variant:"destructive"});return}await jA(e)?(await y(),t({title:"Sync complete",description:"Your bank accounts have been synchronized with the vault"}),localStorage.setItem("last_sync_timestamp",Date.now().toString()),localStorage.setItem("last_sync_user",G)):t({title:"Sync failed",description:"Failed to sync bank accounts with vault",variant:"destructive"})}catch(G){console.error("Sync error:",G),t({title:"Sync failed",description:"An error occurred during synchronization",variant:"destructive"})}finally{m(!1)}},{data:_,isLoading:S,isError:E,error:A}=oN({queryKey:["/api/bank-accounts"],queryFn:hN({on401:"returnNull"}),enabled:!!e}),I=f?v:_,N=G=>G.availableBalance||G.available_balance||0,T=G=>G.accountType||G.account_type||At.OTHER,$=G=>G.currentBalance||G.current_balance||0,M=G=>G.accountName||G.account_name||"Account",j=G=>G.institutionName||G.institution_name||"Bank",P=Array.isArray(I)&&I.length>0?I.filter(G=>T(G)!==At.CREDIT).reduce((G,te)=>G+N(te),0):0,b=Kl({mutationFn:async G=>{const te=localStorage.getItem("auth_timestamp"),le=Date.now(),fe=te&&le-parseInt(te)<18e5,ge=await fetch(`/api/bank-accounts/${G}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-Auth-Timestamp":te||"","X-Session-Email":localStorage.getItem("session_email")||"","X-Auth-Status":fe?"recent":"expired"},credentials:"include"});if(!ge.ok){const de=await ge.json();throw new Error(de.error||"Failed to delete account")}return ge.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["/api/bank-accounts"]}),t({title:"Account deleted",description:"Bank account has been successfully removed"})},onError:G=>{t({title:"Delete failed",description:G.message,variant:"destructive"})}}),V=G=>{l(G)},[Z,D]=w.useState(null),[L,O]=w.useState(!1),q=G=>{D(G),O(!0)},F=()=>{Z&&(b.mutate(Z.id),O(!1),D(null))},W=()=>{O(!1),D(null)},ce=()=>{l(null)},ae=()=>{o(!1)};if(E)return a.jsx(Ke,{children:a.jsx(Ue,{className:"pt-6",children:a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"rounded-full bg-red-100 p-3 mb-4",children:a.jsx(is,{className:"h-10 w-10 text-red-500"})}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Failed to load bank accounts"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:(A==null?void 0:A.toString())||"There was an error loading your bank accounts. Please try again later."}),a.jsx(ie,{onClick:()=>r.invalidateQueries({queryKey:["/api/bank-accounts"]}),children:"Retry"})]})})});if(_!=null&&_.offline)return a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-0",children:[a.jsx(ot,{children:"Bank Accounts"}),a.jsx(ut,{children:"Your bank account information"})]}),a.jsx(Ue,{className:"pt-6",children:a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"rounded-full bg-amber-100 p-3 mb-4",children:a.jsx(tz,{className:"h-10 w-10 text-amber-500"})}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Offline Mode"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:_.offlineMessage||"You are currently offline. Bank account data is not available while offline."}),a.jsxs("div",{className:"flex flex-row gap-3",children:[a.jsxs(ie,{variant:"outline",onClick:()=>r.invalidateQueries({queryKey:["/api/bank-accounts"]}),children:[a.jsx(tr,{className:"h-4 w-4 mr-2"}),"Try Again"]}),f?a.jsxs(ie,{onClick:()=>o(!0),children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Add Offline Account"]}):a.jsxs(ie,{onClick:()=>p(!0),children:[a.jsx(Bh,{className:"h-4 w-4 mr-2"}),"View Local Accounts"]})]})]})})]});if(S)return a.jsx(Ke,{children:a.jsx(Ue,{className:"pt-6",children:a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx(it,{className:"h-10 w-10 text-primary/80 animate-spin mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Loading bank accounts"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Please wait while we retrieve your bank account information."})]})})});if(!I||!Array.isArray(I)||I.length===0)return a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-0",children:[a.jsx(ot,{children:"Bank Accounts"}),a.jsx(ut,{children:"Connect your bank account to view your funds"})]}),a.jsx(Ue,{className:"pt-6",children:a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"rounded-full bg-primary/10 p-3 mb-4",children:a.jsx(Xr,{className:"h-10 w-10 text-primary/80"})}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No bank accounts linked"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:"Connect your bank accounts to easily view cash balances across all your accounts without giving away your data."}),a.jsxs(ie,{onClick:()=>o(!0),children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Connect Bank Account"]})]})}),a.jsx(Bd,{isOpen:s,onClose:ae,onSuccess:()=>{r.invalidateQueries({queryKey:["/api/bank-accounts"]}),ae()}})]});const K=G=>({[At.CHECKING]:"Checking",[At.SAVINGS]:"Savings",[At.CREDIT]:"Credit Card",[At.INVESTMENT]:"Investment",[At.LOAN]:"Loan",[At.MORTGAGE]:"Mortgage",[At.OTHER]:"Other"})[G]||"Account",ne=G=>{switch(G){case At.CHECKING:return a.jsx(Xr,{className:"h-4 w-4"});case At.SAVINGS:return a.jsx(Xr,{className:"h-4 w-4"});case At.CREDIT:return a.jsx(Xr,{className:"h-4 w-4"});default:return a.jsx(Xr,{className:"h-4 w-4"})}};return a.jsxs(a.Fragment,{children:[a.jsxs(Ke,{children:[a.jsx(st,{className:"pb-0",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx(ot,{children:"Bank Accounts"}),a.jsx(ut,{children:"Manage your connected financial accounts"})]}),a.jsxs(ie,{onClick:()=>o(!0),children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Add Account"]})]})}),a.jsxs(Ue,{className:"pt-6",children:[c&&a.jsxs(Mt,{className:"mb-4",children:[a.jsx(C_,{className:"h-4 w-4"}),a.jsx(gn,{children:"Vault is locked"}),a.jsxs(zt,{className:"flex flex-col gap-2",children:[a.jsx("span",{children:"Your secure vault is currently locked. Log in to see your encrypted bank account data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ie,{variant:"outline",size:"sm",onClick:()=>{p(!1),console.log("Switched to server-side data source for demo")},children:[a.jsx(Bh,{className:"h-3 w-3 mr-1"}),"View Server Data for Demo"]}),a.jsxs(ie,{variant:"outline",size:"sm",onClick:async()=>{try{const G=await fetch("/api/dev-login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:"test@example.com"})});if(G.ok){const te=await G.json();console.log("Dev login successful:",te),t({title:"Dev Login Successful",description:`Logged in as ${te.email}`}),localStorage.setItem("session_email",te.email),localStorage.setItem("auth_timestamp",Date.now().toString()),r.invalidateQueries({queryKey:["/api/user"]}),r.invalidateQueries({queryKey:["/api/bank-accounts"]}),p(!1)}else console.error("Dev login failed:",await G.text()),t({title:"Dev Login Failed",description:"Could not auto-login with test account",variant:"destructive"})}catch(G){console.error("Dev login error:",G),t({title:"Dev Login Error",description:G instanceof Error?G.message:"Unknown error",variant:"destructive"})}},children:[a.jsx(BN,{className:"h-3 w-3 mr-1"}),"Dev Login"]})]})]})]}),a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Data Source:"}),a.jsxs(ie,{variant:f?"default":"outline",size:"sm",onClick:()=>p(!0),disabled:c,className:"text-xs h-8",children:[a.jsx(C_,{className:"h-3 w-3 mr-1"}),"Encrypted Vault"]}),a.jsxs(ie,{variant:f?"outline":"default",size:"sm",onClick:()=>p(!1),className:"text-xs h-8",children:[a.jsx(Bh,{className:"h-3 w-3 mr-1"}),"Server"]})]}),a.jsx(ie,{variant:"outline",size:"sm",onClick:g,disabled:c||d,className:"text-xs h-8",children:d?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"h-3 w-3 mr-1 animate-spin"}),"Syncing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(tr,{className:"h-3 w-3 mr-1"}),"Sync with Server"]})})]}),a.jsxs($f,{children:[a.jsx(u2,{children:"Your connected financial accounts"}),a.jsx(Of,{children:a.jsxs(ga,{children:[a.jsx(Xt,{children:"Institution"}),a.jsx(Xt,{children:"Account"}),a.jsx(Xt,{children:"Type"}),a.jsx(Xt,{className:"text-right",children:"Balance"}),a.jsx(Xt,{className:"w-[100px]",children:"Actions"})]})}),a.jsx(Mf,{children:Array.isArray(I)&&I.map(G=>{const te=j(G),le=M(G),fe=T(G),ge=N(G),de=$(G);return a.jsxs(ga,{children:[a.jsx(en,{className:"font-medium",children:a.jsx("div",{className:"flex items-center",children:a.jsx("span",{className:"ml-2",children:te})})}),a.jsx(en,{children:le}),a.jsx(en,{children:a.jsxs("div",{className:"flex items-center",children:[ne(fe),a.jsx("span",{className:"ml-2",children:K(fe)})]})}),a.jsx(en,{className:"text-right",children:fe===At.CREDIT?a.jsx("span",{className:de<0?"text-red-500":"",children:Fd(de)}):Fd(ge)}),a.jsx(en,{children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(ie,{variant:"ghost",size:"icon",onClick:()=>V(G),children:a.jsx(hz,{className:"h-4 w-4"})}),a.jsx(ie,{variant:"ghost",size:"icon",onClick:()=>q(G),children:a.jsx(Sv,{className:"h-4 w-4"})})]})})]},G.id)})})]})]}),a.jsx($o,{className:"border-t px-6 py-4",children:a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Available Cash"}),a.jsx("div",{className:"text-2xl font-bold",children:Fd(P)})]}),a.jsxs(ie,{variant:"outline",onClick:()=>window.open("https://app.plaid.com","_blank"),children:[a.jsx(UN,{className:"h-4 w-4 mr-2"}),"Manage in Bank"]})]})})]}),i&&a.jsx(Bd,{isOpen:!!i,onClose:ce,onSuccess:()=>{r.invalidateQueries({queryKey:["/api/bank-accounts"]}),ce()},account:i}),a.jsx(Bd,{isOpen:s,onClose:ae,onSuccess:()=>{r.invalidateQueries({queryKey:["/api/bank-accounts"]}),ae()}}),a.jsx(nn,{open:L,onOpenChange:O,children:a.jsxs(Gt,{className:"sm:max-w-[425px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Confirm Deletion"}),a.jsx(Qt,{children:"Are you sure you want to delete this bank account? This action cannot be undone."})]}),a.jsx("div",{className:"py-4",children:Z&&a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("div",{className:"font-medium",children:M(Z)}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[j(Z)," •",K(T(Z))]})]})}),a.jsxs(cn,{children:[a.jsx(ie,{variant:"outline",onClick:W,children:"Cancel"}),a.jsx(ie,{variant:"destructive",onClick:F,disabled:b.isPending,children:b.isPending?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete Account"})]})]})})]})}function b8(){const[e,t]=w.useState([]),[n,r]=w.useState([]),[s,o]=w.useState([]),[i,l]=w.useState(null),[c,u]=w.useState(null),[d,m]=w.useState(null),[f,p]=w.useState(!1),[v,h]=w.useState(!1),[x,y]=w.useState(null),[g,_]=w.useState("localStorage"),S=async()=>{try{const P=localStorage.getItem("current_user_email")||localStorage.getItem("session_email")||localStorage.getItem("auth_email")||localStorage.getItem("mata_active_user");if(u(P),P){const L=P.toLowerCase().trim();m(L);const O=localStorage.getItem(`mata_keys_${L}`)!==null,q=localStorage.getItem(`mata_salt_${L}`)!==null;p(O),h(q);try{const F=await mo(P);y(F||{})}catch(F){console.error("Error fetching user keys:",F),y({error:"Failed to fetch keys"})}}const b=[],V=[],Z=["auth_","session_","current_user_","vault_","mata_active_","encryption_","context_","_vault_","_email","_timestamp","password_vault_"];for(let L=0;L<localStorage.length;L++){const O=localStorage.key(L);if(O)try{const q=localStorage.getItem(O)||"";Z.some(W=>O.includes(W))?V.push({key:O,value:q,source:"migratedStorage"}):b.push({key:O,value:q,source:"localStorage"})}catch(q){b.push({key:O,value:`[Error reading value: ${q}]`,source:"localStorage"})}}t(b),o(V);const D=[];for(let L=0;L<sessionStorage.length;L++){const O=sessionStorage.key(L);if(O)try{const q=sessionStorage.getItem(O)||"";D.push({key:O,value:q,source:"sessionStorage"})}catch(q){D.push({key:O,value:`[Error reading value: ${q}]`,source:"sessionStorage"})}}r(D)}catch(P){console.error("Error loading storage data:",P)}};w.useEffect(()=>{S()},[]);const E=P=>{try{const b=JSON.parse(P);return JSON.stringify(b,null,2)}catch{return P}},A=P=>P.includes("password")||P.includes("private")||P.includes("token")||P.includes("secret"),I=P=>{l(P)},N=(P,b="")=>b?P.filter(V=>V.key.toLowerCase().includes(b.toLowerCase())||V.value&&V.value.toLowerCase().includes(b.toLowerCase())):P,T=N(e,"mata_"),$=N(s,"mata_"),M=N(n,"mata_"),j=[...T,...$,...M];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Storage Status Overview"}),a.jsx(ut,{children:"Current authentication and storage state"})]}),a.jsx(Ue,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:"Current Email:"}),a.jsx("span",{children:c||"Not logged in"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:"Sanitized Email:"}),a.jsx("span",{children:d||"N/A"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:"mata_keys Found:"}),a.jsx(As,{variant:f?"default":"destructive",children:f?"Found ✅":"Missing ❌"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:"mata_salt Found:"}),a.jsx(As,{variant:v?"default":"destructive",children:v?"Found ✅":"Missing ❌"})]}),a.jsx(ie,{className:"w-full mt-4",onClick:S,children:"Refresh Storage Status"})]})})]}),a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Storage Explorer"}),a.jsx(ut,{children:"Explore localStorage (including migrated sessionStorage keys) and any remaining sessionStorage contents"})]}),a.jsxs(Ue,{children:[a.jsxs(Ko,{defaultValue:"localStorage",value:g,onValueChange:_,className:"w-full",children:[a.jsxs(Us,{className:"grid w-full grid-cols-4",children:[a.jsxs(Je,{value:"localStorage",children:["Local Storage (",e.length,")"]}),a.jsxs(Je,{value:"migratedStorage",children:["Migrated Keys (",s.length,")"]}),a.jsxs(Je,{value:"sessionStorage",children:["Session Storage (",n.length,")"]}),a.jsx(Je,{value:"mataKeys",children:"Mata Keys"})]}),a.jsx(nt,{value:"localStorage",className:"space-y-4",children:a.jsx("div",{className:"h-72 overflow-y-auto border rounded-md p-4",children:e.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No items in localStorage"}):a.jsx("div",{className:"space-y-2",children:e.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""}`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})})}),a.jsx(nt,{value:"migratedStorage",className:"space-y-4",children:a.jsxs("div",{className:"h-72 overflow-y-auto border rounded-md p-4",children:[a.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-950 border border-yellow-200 dark:border-yellow-800 p-3 mb-4 rounded",children:[a.jsx("h3",{className:"text-sm font-semibold mb-1 text-yellow-800 dark:text-yellow-300",children:"Migrated Session Keys"}),a.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400",children:"These keys were migrated from sessionStorage to localStorage to ensure data persistence between sessions. They maintain all the security properties while providing better user experience."})]}),s.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No migrated keys found"}):a.jsx("div",{className:"space-y-2",children:s.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""} border-l-4 border-yellow-500`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})]})}),a.jsx(nt,{value:"sessionStorage",className:"space-y-4",children:a.jsx("div",{className:"h-72 overflow-y-auto border rounded-md p-4",children:n.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No items in sessionStorage"}):a.jsx("div",{className:"space-y-2",children:n.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""}`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})})}),a.jsx(nt,{value:"mataKeys",className:"space-y-4",children:a.jsxs("div",{className:"h-72 overflow-y-auto border rounded-md p-4",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 p-3 mb-4 rounded",children:[a.jsx("h3",{className:"text-sm font-semibold mb-1 text-blue-800 dark:text-blue-300",children:"MATA Keys (All Sources)"}),a.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-400",children:["Displaying all Mata-specific keys from localStorage, migrated keys, and sessionStorage.",j.length>0&&` Found ${j.length} keys across all storage types.`]})]}),a.jsxs("div",{className:"mb-5",children:[a.jsxs("h3",{className:"text-md font-semibold mb-2",children:["All Mata Keys (",j.length,")"]}),j.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No Mata keys found in any storage"}):a.jsx("div",{className:"space-y-2",children:j.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""} ${P.source==="migratedStorage"?"border-l-4 border-yellow-500":P.source==="localStorage"?"border-l-4 border-green-500":"border-l-4 border-blue-500"}`,onClick:()=>I(P),children:[a.jsxs("div",{className:"font-medium flex justify-between",children:[a.jsx("span",{children:P.key}),a.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-secondary",children:P.source==="migratedStorage"?"Migrated":P.source==="localStorage"?"Local":"Session"})]}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("h3",{className:"text-md font-medium mb-2",children:["Mata Keys in localStorage (",T.length,")"]}),T.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No Mata keys in localStorage"}):a.jsx("div",{className:"space-y-2",children:T.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""} border-l-4 border-green-500`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("h3",{className:"text-md font-medium mb-2",children:["Mata Keys in Migrated Storage (",$.length,")"]}),$.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No migrated Mata keys"}):a.jsx("div",{className:"space-y-2",children:$.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""} border-l-4 border-yellow-500`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-md font-medium mb-2",children:["Mata Keys in sessionStorage (",M.length,")"]}),M.length===0?a.jsx("p",{className:"text-center text-muted-foreground",children:"No Mata keys in sessionStorage"}):a.jsx("div",{className:"space-y-2",children:M.map((P,b)=>a.jsxs("div",{className:`p-2 rounded cursor-pointer hover:bg-secondary ${i===P?"bg-secondary":""} border-l-4 border-blue-500`,onClick:()=>I(P),children:[a.jsx("div",{className:"font-medium",children:P.key}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A(P.key)?"[SENSITIVE DATA]":P.value.substring(0,50)+(P.value.length>50?"...":"")})]},b))})]})]})})]}),i&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("h3",{className:"text-lg font-medium",children:["Selected Item: ",i.key]}),a.jsx(Ke,{children:a.jsx(Ue,{className:"pt-6",children:a.jsx("pre",{className:`whitespace-pre-wrap overflow-x-auto text-xs p-4 bg-secondary rounded-md ${A(i.key)?"blur-sm hover:blur-none":""}`,children:E(i.value)})})}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Source: ",i.source," • ",A(i.key)?"(Hover to reveal sensitive data)":""]})]})]})]}),x&&a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"User Keys Debug"}),a.jsx(ut,{children:"Retrieved user keys via getUserKeys() function"})]}),a.jsx(Ue,{children:a.jsx("pre",{className:"whitespace-pre-wrap overflow-x-auto text-xs p-4 bg-secondary rounded-md",children:JSON.stringify(x,(P,b)=>P==="privateKey"||P==="encryptedPrivateKey"||P==="hash"?"[REDACTED]":b,2)})})]})]})}function E8(){const{isOffline:e,hasPendingChanges:t,pendingOperationsCount:n}=Pv();return!e&&!t?null:a.jsx(Cu,{children:a.jsxs(Nu,{children:[a.jsx(ju,{asChild:!0,children:a.jsx(As,{variant:e?"destructive":"outline",className:ye("flex items-center gap-1.5 px-3 py-1.5 cursor-pointer transition-all font-medium text-sm",e&&"animate-pulse bg-red-100 hover:bg-red-200",t&&!e&&"border-amber-500 text-amber-500 hover:bg-amber-50 bg-amber-50"),children:e?a.jsxs(a.Fragment,{children:[a.jsx(GN,{className:"h-4 w-4"}),a.jsx("span",{children:"Offline Mode"})]}):t?a.jsxs(a.Fragment,{children:[a.jsx(FN,{className:"h-4 w-4"}),a.jsxs("span",{children:["Syncing (",n,")"]})]}):null})}),a.jsx(wl,{side:"bottom",className:"p-4 max-w-xs",children:e?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"font-medium flex items-center gap-1.5 text-base",children:[a.jsx(is,{className:"h-5 w-5 text-destructive"}),"You're working offline"]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Your vault data is still accessible. All features will continue to work with your locally stored data. Any changes will be synchronized when your connection is restored."})]}):t?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"font-medium flex items-center gap-1.5 text-base",children:[a.jsx(xf,{className:"h-5 w-5 text-amber-500"}),"Syncing changes"]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[n," operation",n!==1?"s":""," made while offline are being synchronized with the server."]})]}):null})]})})}function k8(e,t=[]){let n=[];function r(o,i){const l=w.createContext(i),c=n.length;n=[...n,i];function u(m){const{scope:f,children:p,...v}=m,h=(f==null?void 0:f[e][c])||l,x=w.useMemo(()=>v,Object.values(v));return a.jsx(h.Provider,{value:x,children:p})}function d(m,f){const p=(f==null?void 0:f[e][c])||l,v=w.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return u.displayName=o+"Provider",[u,d]}const s=()=>{const o=n.map(i=>w.createContext(i));return function(l){const c=(l==null?void 0:l[e])||o;return w.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,C8(s,...t)]}function C8(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=r.reduce((l,{useScope:c,scopeName:u})=>{const m=c(o)[`__scope${u}`];return{...l,...m}},{});return w.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return n.scopeName=t.scopeName,n}var Dx="Progress",Rx=100,[N8,tW]=k8(Dx),[j8,I8]=N8(Dx),IA=w.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:o=T8,...i}=e;(s||s===0)&&!xS(s)&&console.error(A8(`${s}`,"Progress"));const l=xS(s)?s:Rx;r!==null&&!wS(r,l)&&console.error(P8(`${r}`,"Progress"));const c=wS(r,l)?r:null,u=Jf(c)?o(c,l):void 0;return a.jsx(j8,{scope:n,value:c,max:l,children:a.jsx(je.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Jf(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":PA(c,l),"data-value":c??void 0,"data-max":l,...i,ref:t})})});IA.displayName=Dx;var TA="ProgressIndicator",AA=w.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=I8(TA,n);return a.jsx(je.div,{"data-state":PA(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});AA.displayName=TA;function T8(e,t){return`${Math.round(e/t*100)}%`}function PA(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Jf(e){return typeof e=="number"}function xS(e){return Jf(e)&&!isNaN(e)&&e>0}function wS(e,t){return Jf(e)&&!isNaN(e)&&e<=t&&e>=0}function A8(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Rx}\`.`}function P8(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Rx} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var DA=IA,D8=AA;const Sl=w.forwardRef(({className:e,value:t,...n},r)=>a.jsx(DA,{ref:r,className:ye("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:a.jsx(D8,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Sl.displayName=DA.displayName;var R8="Separator",_S="horizontal",$8=["horizontal","vertical"],RA=w.forwardRef((e,t)=>{const{decorative:n,orientation:r=_S,...s}=e,o=O8(r)?r:_S,l=n?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return a.jsx(je.div,{"data-orientation":o,...l,...s,ref:t})});RA.displayName=R8;function O8(e){return $8.includes(e)}var $A=RA;const Kd=w.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},s)=>a.jsx($A,{ref:s,decorative:n,orientation:t,className:ye("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));Kd.displayName=$A.displayName;function M8(){const[e,t]=w.useState({installed:!1,communicationWorking:!1,storageWorking:!1,testComplete:!1,loading:!0}),[n,r]=w.useState(0),[s,o]=w.useState("status"),[i,l]=w.useState(null);w.useEffect(()=>{c()},[]);async function c(){t(d=>({...d,loading:!0})),r(10);try{const d=await Am();if(r(30),t(m=>({...m,installed:d.installed,version:d.version,communicationWorking:d.installed})),!d.installed){t(m=>({...m,loading:!1,testComplete:!0,error:"Extension not installed or not detected"})),r(100);return}r(50);try{const m=await Rr("CHECK_EXTENSION",{data:JSON.stringify({source:"extension_diagnostics",timestamp:Date.now()})},15e3);r(80),t(f=>({...f,storageWorking:(m==null?void 0:m.success)||!1,diagnostics:m,testComplete:!0,loading:!1,error:m!=null&&m.success?void 0:(m==null?void 0:m.error)||"Storage test failed"}))}catch(m){t(f=>({...f,storageWorking:!1,testComplete:!0,loading:!1,error:`Storage test error: ${(m==null?void 0:m.message)||"Unknown error"}`}))}r(100)}catch(d){t({installed:!1,communicationWorking:!1,storageWorking:!1,testComplete:!0,loading:!1,error:(d==null?void 0:d.message)||"Unknown error checking extension"}),r(100)}}const u=({success:d,pending:m})=>m?a.jsx(it,{className:"w-5 h-5 text-blue-500 animate-spin"}):d?a.jsx(xv,{className:"w-5 h-5 text-green-500"}):a.jsx(wv,{className:"w-5 h-5 text-red-500"});return a.jsxs(Ke,{className:"w-full max-w-3xl mx-auto",children:[a.jsxs(st,{children:[a.jsxs(ot,{className:"flex items-center gap-2",children:[a.jsx("span",{children:"MATA Extension Diagnostics"}),e.loading&&a.jsx(it,{className:"w-4 h-4 animate-spin"})]}),a.jsx(ut,{children:"Test and troubleshoot your MATA browser extension"}),a.jsx(Ko,{value:s,onValueChange:o,className:"w-full",children:a.jsxs(Us,{className:"grid w-full grid-cols-3",children:[a.jsx(Je,{value:"status",children:"Status"}),a.jsx(Je,{value:"install",children:"Installation"}),a.jsx(Je,{value:"troubleshoot",children:"Troubleshooting"})]})})]}),a.jsxs(Ue,{children:[a.jsxs(nt,{value:"status",className:"space-y-4",children:[e.loading&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium",children:"Testing extension..."}),a.jsxs("span",{className:"text-sm text-gray-500",children:[n,"%"]})]}),a.jsx(Sl,{value:n,className:"h-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we test your extension..."})]}),e.testComplete&&a.jsxs(a.Fragment,{children:[e.error&&a.jsxs(Mt,{variant:"destructive",className:"mb-4",children:[a.jsx(j_,{className:"h-4 w-4"}),a.jsx(gn,{children:"Error"}),a.jsx(zt,{children:e.error})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Extension Installed"}),a.jsx(u,{success:e.installed})]}),e.installed&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Communication Working"}),a.jsx(u,{success:e.communicationWorking})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Storage Access"}),a.jsx(u,{success:e.storageWorking})]}),e.version&&a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Version"}),a.jsx("span",{className:"text-sm",children:e.version})]})]})]}),e.diagnostics&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("button",{className:"text-sm text-blue-500 flex items-center gap-1",onClick:()=>l(i==="diagnostics"?null:"diagnostics"),children:[a.jsx(wf,{className:"h-4 w-4"}),i==="diagnostics"?"Hide":"Show"," Detailed Diagnostics"]}),i==="diagnostics"&&a.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded-md text-xs font-mono overflow-x-auto max-h-[40vh] overflow-y-auto break-words whitespace-pre-wrap",children:a.jsx("pre",{className:"break-words whitespace-pre-wrap",children:JSON.stringify(e.diagnostics,null,2)})})]})]})]}),a.jsx(nt,{value:"install",className:"space-y-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Mt,{children:[a.jsx(wf,{className:"h-4 w-4"}),a.jsx(gn,{children:"Installation Instructions"}),a.jsx(zt,{children:"Follow these steps to install the MATA extension in your browser."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white px-2 text-xs font-semibold text-gray-500",children:"Step 1"}),a.jsx("h3",{className:"font-medium",children:"Download the Extension"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Download the MATA extension package"}),a.jsx(ie,{asChild:!0,size:"sm",children:a.jsxs("a",{href:tl,download:tl.substring(1),children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),Mv()]})})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white px-2 text-xs font-semibold text-gray-500",children:"Step 2"}),a.jsx("h3",{className:"font-medium",children:"Extract the ZIP File"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Extract the downloaded ZIP file to a folder on your computer."})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white px-2 text-xs font-semibold text-gray-500",children:"Step 3"}),a.jsx("h3",{className:"font-medium",children:"Load the Extension in Chrome"}),a.jsxs("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal pl-5 mt-2",children:[a.jsxs("li",{children:["Open Chrome and navigate to ",a.jsx("code",{children:"chrome://extensions"})]}),a.jsx("li",{children:'Enable "Developer mode" using the toggle in the top right'}),a.jsx("li",{children:'Click "Load unpacked" button'}),a.jsx("li",{children:"Select the folder where you extracted the extension files"})]})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white px-2 text-xs font-semibold text-gray-500",children:"Step 4"}),a.jsx("h3",{className:"font-medium",children:"Verify Installation"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Check if the extension is properly installed and working"}),a.jsxs(ie,{onClick:c,size:"sm",children:[a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Test Extension"]})]})]})]})}),a.jsxs(nt,{value:"troubleshoot",className:"space-y-4",children:[a.jsxs(Mt,{variant:"default",children:[a.jsx(j_,{className:"h-4 w-4"}),a.jsx(gn,{children:"Troubleshooting"}),a.jsx(zt,{children:"If you're having issues with the extension, try these solutions."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none",children:[a.jsx("span",{children:"Extension Not Detected"}),a.jsx("span",{className:"transition group-open:rotate-180",children:a.jsx("svg",{fill:"none",height:"24","shape-rendering":"geometricPrecision",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",viewBox:"0 0 24 24",width:"24",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-2 group-open:animate-fadeIn space-y-2 break-words",children:[a.jsx("p",{children:"If the extension is not being detected:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsx("li",{children:"Ensure the extension is installed and enabled in Chrome"}),a.jsxs("li",{children:["Make sure you're using the latest ",Vn()," version which has improved detection"]}),a.jsx("li",{children:"Try refreshing the page completely (hold Shift and click Refresh button)"}),a.jsx("li",{children:"Check Chrome console (F12) for any error messages related to MATA extension"}),a.jsx("li",{children:"Make sure you're using Chrome, as the extension only works with Chrome"}),a.jsx("li",{children:"If upgrading from a previous version, uninstall old versions first"}),a.jsx("li",{children:"Restart your browser after installation"})]})]})]}),a.jsx(Kd,{}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none",children:[a.jsx("span",{children:"Storage Test Fails"}),a.jsx("span",{className:"transition group-open:rotate-180",children:a.jsx("svg",{fill:"none",height:"24","shape-rendering":"geometricPrecision",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",viewBox:"0 0 24 24",width:"24",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-2 group-open:animate-fadeIn space-y-2 break-words",children:[a.jsx("p",{children:"If the storage test fails:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsxs("li",{children:["Make sure you're using the latest ",Vn()," extension with improved storage access"]}),a.jsx("li",{children:"Check Chrome settings for storage permissions"}),a.jsx("li",{children:"Try reinstalling the extension (uninstall first, then install again)"}),a.jsx("li",{children:"Verify that other Chrome extensions with storage capabilities are working"}),a.jsx("li",{children:`The extension may show "storage test fails" but still work properly - we've seen this inconsistency`}),a.jsx("li",{children:"Even without extension storage, MATA will continue to work in local-only mode"}),a.jsx("li",{children:"Clear browser cache only as a last resort (might affect stored vault data)"})]})]})]}),a.jsx(Kd,{}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none",children:[a.jsx("span",{children:"Communication Problems"}),a.jsx("span",{className:"transition group-open:rotate-180",children:a.jsx("svg",{fill:"none",height:"24","shape-rendering":"geometricPrecision",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",viewBox:"0 0 24 24",width:"24",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-2 group-open:animate-fadeIn space-y-2 break-words",children:[a.jsx("p",{children:"If the app can't communicate with the extension:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsxs("li",{children:["Make sure you're using the ",Vn()," extension with improved content script loading"]}),a.jsx("li",{children:`Open Chrome's console (F12) and look for any "MATA extension" messages or errors`}),a.jsx("li",{children:"Check that content scripts are allowed on Replit domains"}),a.jsx("li",{children:"Try completely reloading the page (hold Shift while clicking refresh)"}),a.jsx("li",{children:`If on Replit, make sure you've opened the app in a new tab using the "Open in new tab" button`}),a.jsx("li",{children:"Make sure browser extensions aren't being blocked by your organization"}),a.jsxs("li",{children:["The ",Vn()," extension has improved permissions for all Replit domains, including specific Replit domain patterns"]})]})]})]}),a.jsx(Kd,{}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none",children:[a.jsx("span",{children:"Known Issues & Workarounds"}),a.jsx("span",{className:"transition group-open:rotate-180",children:a.jsx("svg",{fill:"none",height:"24","shape-rendering":"geometricPrecision",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",viewBox:"0 0 24 24",width:"24",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-2 group-open:animate-fadeIn space-y-2 break-words",children:[a.jsx("p",{children:"These are some common scenarios we've identified:"}),a.jsxs("ul",{className:"list-disc pl-5 space-y-3",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Connection/Storage Inconsistency:"})," Sometimes the extension shows as connected but fails storage tests. In many cases, the storage still works despite the error message. Try using the app normally - your data may still be backed up to the extension."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Replit Domain Variations:"})," The ",Vn()," extension now supports all Replit domains, including your specific domain pattern. If you're still having issues, try opening the app in a clean new tab outside the Replit IDE."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Content Script Timing:"})," In some cases, the content script loads too late to detect the page. The ",Vn()," extension includes fixes for this with improved domain pattern matching, but a complete page refresh (Shift+Refresh) may still be necessary."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Invalid Manifest Error:"}),` If you see "Invalid value for 'content_scripts[0].matches': Invalid host wildcard" during installation, you have an older version. Download the latest `,Vn()," which fixes the wildcard pattern issues and adds support for your specific domain pattern in the manifest.json file."]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Fallback Mode:"})," Remember that MATA is designed to work in local-only mode without the extension, though cloud backup features will be limited. Your data remains secure in the local vault."]})]})]})]})]})]})]}),a.jsxs($o,{className:"flex justify-between",children:[a.jsx(ie,{variant:"outline",onClick:()=>window.open("/extension-guide.html","_blank"),children:"View Full Guide"}),a.jsx(ie,{onClick:c,disabled:e.loading,children:e.loading?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Testing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Recheck Extension"]})})]})]})}function z8(){const[e,t]=w.useState({installed:!1,communicating:!1,storageWorking:!1,checking:!0}),[n,r]=w.useState(!1),[s,o]=w.useState(0),[i,l]=w.useState(null);dn(),w.useEffect(()=>{c()},[]);async function c(){t(f=>({...f,checking:!0})),o(10);try{const f=await Am();if(o(40),t(p=>({...p,installed:f.installed,communicating:f.installed,version:f.version})),f.installed){o(70);try{const p=await Rr("CHECK_EXTENSION",{data:JSON.stringify({source:"extension_banner",timestamp:Date.now()})},8e3);t(v=>({...v,storageWorking:(p==null?void 0:p.success)||!1}))}catch(p){console.error("Storage test failed:",p),t(v=>({...v,storageWorking:!1}))}}o(100)}catch(f){console.error("Extension check failed:",f),t({installed:!1,communicating:!1,storageWorking:!1,checking:!1}),o(100)}finally{setTimeout(()=>{t(f=>({...f,checking:!1})),l(new Date)},500)}}if(e.installed&&e.communicating&&e.storageWorking)return null;const u=()=>e.checking?"default":!e.installed||!e.communicating||!e.storageWorking?"destructive":"default",d=()=>e.checking?a.jsx(it,{className:"h-4 w-4 animate-spin"}):!e.installed||!e.communicating?a.jsx(wv,{className:"h-4 w-4"}):e.storageWorking?a.jsx(xv,{className:"h-4 w-4"}):a.jsx(is,{className:"h-4 w-4"}),m=()=>e.checking?"Checking extension status...":e.installed?e.communicating?e.storageWorking?"Extension is ready":`Extension storage is not working properly. Your keys may not be properly backed up. Try reinstalling the ${Vn()} extension or check browser permissions.`:`Extension detected but not communicating with the app. Please try: 1) Refreshing this page, 2) Reinstalling the latest ${Vn()} extension, 3) Checking browser Extension permissions.`:`MATA extension ${Vn()} is available. For local device sync and persistent backups, download and install the extension, then refresh this page.`;return a.jsxs(a.Fragment,{children:[a.jsxs(Mt,{variant:u(),className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d,{}),a.jsx(gn,{className:"text-sm font-medium",children:"Extension Status"})]}),a.jsxs("div",{className:"mt-2 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx(zt,{className:"text-sm",children:m()}),!e.installed&&a.jsx("p",{className:"text-xs mt-1 text-muted-foreground",children:"Note: MATA will continue to work in local-only mode without the extension, but with limited backup and sync features."})]}),a.jsx("div",{className:"flex items-center gap-2",children:e.checking?a.jsx("div",{className:"w-full max-w-xs",children:a.jsx(Sl,{value:s,className:"h-2"})}):a.jsxs(a.Fragment,{children:[a.jsx(ie,{asChild:!0,size:"sm",variant:"default",children:a.jsxs("a",{href:tl,download:tl.substring(1),children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),Mv()]})}),a.jsx(ie,{size:"sm",variant:"ghost",onClick:c,disabled:e.checking,children:"Recheck"})]})})]})]}),a.jsx(nn,{open:n,onOpenChange:r,children:a.jsxs(Gt,{className:"w-[95vw] max-w-6xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Extension Diagnostics"}),a.jsx(Qt,{children:"Install and troubleshoot the MATA browser extension"})]}),a.jsx("div",{className:"py-4",children:a.jsx(M8,{})})]})})]})}function L8(){var M,j,P,b,V,Z,D,L;const[e,t]=w.useState(!1),[n,r]=w.useState("status"),[s,o]=w.useState(!1),[i,l]=w.useState(0),[c,u]=w.useState(null),[d,m]=w.useState(null),[f,p]=w.useState(null),[v,h]=w.useState(!1),[x,y]=w.useState([]),[g,_]=w.useState(""),{toast:S}=dn();w.useEffect(()=>{const O=()=>{t(!0),E()};return window.addEventListener("open-extension-dialog",O),()=>{window.removeEventListener("open-extension-dialog",O)}},[]),w.useEffect(()=>{e&&E()},[e]);function E(){var O,q;try{o(!0);const F=document.getElementById("mata-extension-marker"),W={timestamp:new Date().toISOString(),domMarkerExists:!!F,domMarkerDetails:F?{id:F.getAttribute("data-extension-id"),version:F.getAttribute("data-extension-version"),timestamp:F.getAttribute("data-timestamp")}:null,windowFlags:{mata_extension_connected:window.mata_extension_connected,MATA_EXTENSION_ID:window.MATA_EXTENSION_ID,_mataExtensionInstalled:window._mataExtensionInstalled,_mataExtensionTimestamp:window._mataExtensionTimestamp},browserInfo:{userAgent:navigator.userAgent,hasChrome:!!window.chrome,hasChromeRuntime:!!((O=window.chrome)!=null&&O.runtime)},extensionInstalled:Lr()};return m(W),(q=W.domMarkerDetails)!=null&&q.version&&_(W.domMarkerDetails.version),o(!1),W}catch(F){return console.error("Error checking extension state:",F),S({title:"Error",description:"Failed to check extension state",variant:"destructive"}),o(!1),null}}async function A(){var O,q,F;o(!0),u(null),l(10);try{E(),l(20),await Ij(),l(30);let W=!1;try{W=await Nf(),l(40)}catch(G){console.log("Extension verification failed before running tests",G),ho();const te={installed:!1,connection:{success:!1,error:"Extension verification failed: "+String(G)}};u(te),l(100),S({title:"Test Failed",description:"Extension verification failed - it may be uninstalled or not responding",variant:"destructive"}),o(!1);return}const ce=await Pj();u(ce),l(80),(O=ce.connection)!=null&&O.version&&_(ce.connection.version);const ae=((q=ce==null?void 0:ce.connection)==null?void 0:q.success)===!0,K=((F=ce==null?void 0:ce.storage)==null?void 0:F.success)===!0;ae&&K?(To(),S({title:"Test Complete",description:"All extension tests passed successfully"})):ae?S({title:"Test Partially Failed",description:"Extension detected but some tests failed. See details for more information.",variant:"destructive"}):(ho(),S({title:"Test Failed",description:"Extension connection failed. The extension may be uninstalled or not responding.",variant:"destructive"})),l(100)}catch(W){console.error("Extension test error:",W),u({error:String(W)}),S({title:"Test Error",description:String(W),variant:"destructive"}),l(100)}finally{o(!1)}}async function I(){try{o(!0),p({success:!1});const O={testId:Math.random().toString(36).substr(2,9),timestamp:Date.now(),value:"Storage Test Data"},q=await Aj();p(q),q.success?S({title:"Storage Test Success",description:"Successfully stored and retrieved test data"}):S({title:"Storage Test Failed",description:q.error||"Failed to test storage",variant:"destructive"})}catch(O){console.error("Storage test error:",O),p({success:!1,error:String(O)}),S({title:"Storage Test Error",description:String(O),variant:"destructive"})}finally{o(!1)}}async function N(){try{if(o(!0),!Lr())try{await Nf()}catch{y([]),S({title:"Extension Not Available",description:"The extension is not installed or not responding. No accounts available.",variant:"destructive"}),o(!1);return}try{const q=await Ao("LIST_ACCOUNTS",{includeUnsyncedUsers:!0},1e4);if(q&&q.success&&q.accounts&&q.accounts.length>0){y(q.accounts),To(),S({title:"Accounts Retrieved",description:`Found ${q.accounts.length} accounts in the extension`}),o(!1);return}}catch(q){console.log("Account fetch method failed:",q)}const O=localStorage.getItem("current_user_email");if(O){const q={email:O,firstName:localStorage.getItem("user_firstName")||void 0,created:Date.now(),lastSynced:Date.now(),status:"Local Only"};y([q]),S({title:"Local User Account",description:"Using current authenticated user account. The extension may need re-syncing.",variant:"destructive"});return}y([]),S({title:"No Accounts Found",description:"No accounts available from extension or local storage",variant:"destructive"})}catch(O){console.error("Error retrieving accounts:",O),y([]),S({title:"Account Retrieval Failed",description:String(O),variant:"destructive"})}finally{o(!1)}}function T(){return tl}const $=({success:O,pending:q})=>q?a.jsx(it,{className:"w-5 h-5 text-blue-500 animate-spin"}):O?a.jsx(xv,{className:"w-5 h-5 text-green-500"}):a.jsx(wv,{className:"w-5 h-5 text-red-500"});return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"max-w-3xl max-h-[85vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsxs(Yt,{className:"flex items-center gap-2",children:[a.jsx(Pg,{className:"h-5 w-5"}),"MATA Extension Debug"]}),a.jsx(Qt,{children:"Manage, verify and debug your browser extension connection"})]}),a.jsxs(Ko,{value:n,onValueChange:r,className:"w-full",children:[a.jsxs(Us,{className:"grid w-full grid-cols-4",children:[a.jsx(Je,{value:"status",children:"Status"}),a.jsx(Je,{value:"tools",children:"Tools"}),a.jsx(Je,{value:"tests",children:"Tests"}),a.jsx(Je,{value:"install",children:"Installation"})]}),a.jsx(nt,{value:"status",className:"space-y-4 pt-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsxs(ot,{className:"flex items-center justify-between",children:["Extension Status",a.jsx(As,{variant:d!=null&&d.extensionInstalled?"default":"destructive",children:d!=null&&d.extensionInstalled?"Detected":"Not Detected"})]}),a.jsx(ut,{children:"Current connection status of your MATA extension"})]}),a.jsxs(Ue,{className:"flex flex-col items-center justify-center py-6 space-y-4",children:[a.jsx(Rf,{size:"lg"}),a.jsxs("div",{className:"w-full mt-4 space-y-4",children:[d!=null&&d.extensionInstalled?a.jsxs(Mt,{children:[a.jsx(gn,{children:"Extension Detected"}),a.jsxs(zt,{children:["Your MATA extension is properly installed and connected",g&&a.jsxs("div",{className:"mt-1 text-sm",children:["Version: ",g]})]})]}):a.jsxs(Mt,{variant:"destructive",children:[a.jsx(gn,{children:"Extension Not Detected"}),a.jsx(zt,{children:"The MATA Chrome extension is not installed or not detected. Please install the extension using the Installation tab."})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md p-3",children:[a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"DOM Marker Present"}),a.jsx($,{success:d==null?void 0:d.domMarkerExists})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Window Flag Set"}),a.jsx($,{success:(M=d==null?void 0:d.windowFlags)==null?void 0:M.mata_extension_connected})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Version"}),a.jsx("span",{children:((j=d==null?void 0:d.domMarkerDetails)==null?void 0:j.version)||Vn()})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"font-medium",children:"Last Checked"}),a.jsx("span",{children:d!=null&&d.timestamp?new Date(d.timestamp).toLocaleTimeString():"Never"})]})]})]})]}),a.jsxs($o,{className:"flex justify-between",children:[a.jsxs(ie,{variant:"outline",onClick:E,children:[a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Refresh Status"]}),a.jsx(ie,{asChild:!0,children:a.jsxs("a",{href:T(),download:!0,children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),"Download Latest (",Vn(),")"]})})]})]})}),a.jsx(nt,{value:"tools",className:"space-y-4 pt-4",children:a.jsxs("div",{className:"mb-2",children:[a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Extension Connection Tools"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"These tools can help force detection and connection with the browser extension. Use them if the automatic detection is not working properly."}),a.jsx($j,{showControls:!0}),a.jsxs(Ke,{className:"mt-6",children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Extension Accounts"}),a.jsx(ut,{children:"Manage accounts stored in the extension"})]}),a.jsx(Ue,{children:x.length>0?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"text-sm",children:["Found ",x.length," accounts in the extension:"]}),a.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-md p-3 max-h-40 overflow-y-auto",children:x.map((O,q)=>a.jsxs("div",{className:"py-2 border-b border-gray-200 last:border-0",children:[a.jsx("p",{className:"font-medium",children:O.email}),O.firstName&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Name: ",O.firstName]}),O.created&&a.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",new Date(O.created).toLocaleString()]})]},q))})]}):a.jsx("p",{className:"text-sm text-muted-foreground py-4",children:'No accounts found in the extension. Click "Check Accounts" to retrieve them.'})}),a.jsx($o,{children:a.jsxs(ie,{onClick:N,disabled:s,children:[s?a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Check Accounts"]})})]})]})}),a.jsx(nt,{value:"tests",className:"space-y-4 pt-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{children:[a.jsx(ot,{children:"Extension Tests"}),a.jsx(ut,{children:"Run diagnostics to verify extension functionality"})]}),a.jsxs(Ue,{className:"space-y-4",children:[s&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium",children:"Running tests..."}),a.jsxs("span",{className:"text-sm text-gray-500",children:[i,"%"]})]}),a.jsx(Sl,{value:i,className:"h-2"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we test your extension..."})]}),c&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:`p-4 rounded-md ${c.installed?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[a.jsxs("h3",{className:"font-medium flex items-center",children:[a.jsx($,{success:c.installed}),a.jsx("span",{className:"ml-2",children:c.installed?"Extension Installed":"Extension Not Installed"})]}),a.jsx("p",{className:"text-sm mt-1 ml-7",children:c.installed?"The extension is properly installed on this browser.":"The MATA extension is not installed or not detected."})]}),c.installed&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`p-4 rounded-md ${(P=c.connection)!=null&&P.success?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[a.jsxs("h3",{className:"font-medium flex items-center",children:[a.jsx($,{success:(b=c.connection)==null?void 0:b.success}),a.jsx("span",{className:"ml-2",children:(V=c.connection)!=null&&V.success?"Connection Successful":"Connection Failed"})]}),a.jsx("p",{className:"text-sm mt-1 ml-7",children:(Z=c.connection)!=null&&Z.success?`Successfully connected to extension (${((D=c.connection)==null?void 0:D.version)||"Unknown"})`:`Connection error: ${((L=c.connection)==null?void 0:L.error)||"Unknown error"}`})]}),c.storage&&a.jsxs("div",{className:`p-4 rounded-md ${c.storage.success?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[a.jsxs("h3",{className:"font-medium flex items-center",children:[a.jsx($,{success:c.storage.success}),a.jsx("span",{className:"ml-2",children:c.storage.success?"Storage Working":"Storage Issues"})]}),a.jsx("p",{className:"text-sm mt-1 ml-7",children:c.storage.success?"Extension storage is working correctly.":`Storage error: ${c.storage.error||"Unknown error"}`})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("button",{className:"text-sm text-blue-500 flex items-center gap-1",onClick:()=>h(!v),children:[a.jsx(wf,{className:"h-4 w-4"}),v?"Hide":"Show"," Detailed Diagnostics"]}),v&&a.jsx("div",{className:"mt-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-md text-xs font-mono overflow-x-auto max-h-60 overflow-y-auto",children:a.jsx("pre",{children:JSON.stringify(c,null,2)})})]})]}),f&&a.jsxs(Mt,{variant:f.success?"default":"destructive",children:[a.jsxs(gn,{children:["Storage Test ",f.success?"Successful":"Failed"]}),a.jsx(zt,{children:f.success?"Successfully stored and retrieved test data":f.error||"Failed to test storage functionality"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:[a.jsxs(ie,{variant:"outline",onClick:E,disabled:s,children:[a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Check Status"]}),a.jsxs(ie,{variant:"outline",onClick:I,disabled:s,children:[a.jsx(kz,{className:"mr-2 h-4 w-4"}),"Test Storage"]}),a.jsxs(ie,{onClick:A,disabled:s,variant:"default",children:[s?a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Pg,{className:"mr-2 h-4 w-4"}),"Run All Tests"]})]})]})]})}),a.jsx(nt,{value:"install",className:"space-y-4 pt-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Mt,{children:[a.jsx(wf,{className:"h-4 w-4"}),a.jsx(gn,{children:"Installation Instructions"}),a.jsx(zt,{children:"Follow these steps to install the MATA extension in your browser."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white dark:bg-gray-900 px-2 text-xs font-semibold text-gray-500",children:"Step 1"}),a.jsx("h3",{className:"font-medium",children:"Download the Extension"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Download the latest MATA extension package"}),a.jsx(ie,{asChild:!0,size:"sm",children:a.jsxs("a",{href:T(),download:!0,children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),Mv()]})})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white dark:bg-gray-900 px-2 text-xs font-semibold text-gray-500",children:"Step 2"}),a.jsx("h3",{className:"font-medium",children:"Extract the ZIP File"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Extract the downloaded ZIP file to a folder on your computer."})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white dark:bg-gray-900 px-2 text-xs font-semibold text-gray-500",children:"Step 3"}),a.jsx("h3",{className:"font-medium",children:"Load the Extension in Chrome"}),a.jsxs("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal pl-5 mt-2",children:[a.jsxs("li",{children:["Open Chrome and navigate to ",a.jsx("code",{children:"chrome://extensions"})]}),a.jsx("li",{children:'Enable "Developer mode" using the toggle in the top right'}),a.jsx("li",{children:'Click "Load unpacked" button'}),a.jsx("li",{children:"Select the folder where you extracted the extension files"})]})]}),a.jsxs("div",{className:"p-3 border border-gray-200 rounded-md relative",children:[a.jsx("span",{className:"absolute -top-3 left-3 bg-white dark:bg-gray-900 px-2 text-xs font-semibold text-gray-500",children:"Step 4"}),a.jsx("h3",{className:"font-medium",children:"Verify Installation"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Check if the extension is properly installed and working"}),a.jsxs(ie,{onClick:E,size:"sm",children:[a.jsx(tr,{className:"mr-2 h-4 w-4"}),"Verify Extension"]})]})]}),a.jsx("div",{className:"mt-6",children:a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none",children:[a.jsx("span",{children:"Troubleshooting Tips"}),a.jsx("span",{className:"transition group-open:rotate-180",children:a.jsx("svg",{fill:"none",height:"24","shape-rendering":"geometricPrecision",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",viewBox:"0 0 24 24",width:"24",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-3 group-open:animate-fadeIn space-y-2",children:[a.jsx("p",{children:"If you're having issues with the extension installation:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsx("li",{children:"Make sure you're using the latest version of Chrome"}),a.jsx("li",{children:"Try reinstalling the extension - remove it first, then add it again"}),a.jsx("li",{children:"Ensure you've extracted all files from the ZIP file before loading"}),a.jsx("li",{children:"Check for any errors in the Extensions page"}),a.jsx("li",{children:"Try using the Debug tab to manually force detection"}),a.jsx("li",{children:"Restart your browser after installation"}),a.jsx("li",{children:"Make sure you've enabled Developer Mode in Chrome's extensions page"})]})]})]})})]})})]})]})})}function F8({open:e,setOpen:t,onDownload:n,onError:r}){const[s,o]=w.useState(!1),[i,l]=w.useState("download"),[c,u]=w.useState(0),d=()=>{u(0);const f=setInterval(()=>{u(p=>{const v=p+Math.random()*15;return v>=100?(clearInterval(f),100):v})},300);return()=>clearInterval(f)},m=async()=>{try{o(!0);const f=d();await n(),u(100),setTimeout(()=>{t(!1),u(0)},500),f()}catch(f){console.error("Download error:",f),r(f),u(0)}finally{o(!1)}};return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"sm:max-w-[585px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Secure Your Keys"}),a.jsx(Qt,{children:"Choose how you want to backup and secure your MATA keys and data."})]}),a.jsxs(Ko,{defaultValue:"download",value:i,onValueChange:l,children:[a.jsxs(Us,{className:"grid grid-cols-3 w-full",children:[a.jsxs(Je,{value:"download",children:[a.jsx(HN,{className:"h-4 w-4 mr-2"}),"Self Backup"]}),a.jsxs(Je,{value:"friends",disabled:!0,children:[a.jsx(bv,{className:"h-4 w-4 mr-2"}),"Friend Backup",a.jsx("span",{className:"ml-2 text-xs px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded-full",children:"Soon"})]}),a.jsxs(Je,{value:"cloud",disabled:!0,children:[a.jsx(xf,{className:"h-4 w-4 mr-2"}),"Disco Backup",a.jsx("span",{className:"ml-2 text-xs px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded-full",children:"Soon"})]})]}),a.jsx(nt,{value:"download",className:"py-4 space-y-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-2",children:[a.jsxs(ot,{className:"text-lg flex items-center",children:[a.jsx(ls,{className:"h-5 w-5 mr-2 text-primary"}),"Download Secure Backup"]}),a.jsx(ut,{children:"Create a secure file with all your MATA data"})]}),a.jsx(Ue,{children:a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsx("p",{className:"mb-2",children:"The backup includes:"}),a.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[a.jsx("li",{children:"User authentication keys"}),a.jsx("li",{children:"Password vault data"}),a.jsx("li",{children:"Contact information"}),a.jsx("li",{children:"Bank account details"}),a.jsx("li",{children:"Application settings"})]}),a.jsxs(Mt,{className:"mt-4",children:[a.jsx(uz,{className:"h-4 w-4"}),a.jsx(zt,{children:"Store this file in a secure location. Anyone with access to this file could potentially access your data."})]})]})})]})}),a.jsx(nt,{value:"friends",className:"py-4 space-y-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-2",children:[a.jsxs(ot,{className:"text-lg flex items-center",children:[a.jsx(vz,{className:"h-5 w-5 mr-2 text-primary"}),"Split Keys With Friends"]}),a.jsx(ut,{children:"Securely share pieces of your keys with trusted friends"})]}),a.jsx(Ue,{children:a.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[a.jsx("p",{children:"With this advanced backup method, your encryption keys are split into multiple shares and distributed among your trusted contacts."}),a.jsx("p",{children:"No single person will have access to your complete keys, improving security while ensuring you can recover your data if needed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[a.jsxs("div",{className:"flex flex-col space-y-2 bg-slate-50 p-3 rounded-lg",children:[a.jsx("div",{className:"font-medium text-xs uppercase text-slate-500",children:"Benefits"}),a.jsxs("ul",{className:"text-xs list-disc pl-5 space-y-1",children:[a.jsx("li",{children:"Higher security than single backups"}),a.jsx("li",{children:"No single point of failure"}),a.jsx("li",{children:"Requires multiple trusted friends to collude"})]})]}),a.jsxs("div",{className:"flex flex-col space-y-2 bg-slate-50 p-3 rounded-lg",children:[a.jsx("div",{className:"font-medium text-xs uppercase text-slate-500",children:"How It Works"}),a.jsxs("ul",{className:"text-xs list-disc pl-5 space-y-1",children:[a.jsx("li",{children:"Uses Shamir's Secret Sharing algorithm"}),a.jsx("li",{children:"Configurable threshold (e.g., 3 of 5 shares)"}),a.jsx("li",{children:"Each friend receives an encrypted share"})]})]})]}),a.jsxs(Mt,{variant:"default",className:"mt-4 bg-blue-50 text-blue-800 border-blue-200",children:[a.jsx(is,{className:"h-4 w-4"}),a.jsx(zt,{children:"This feature is coming soon. Check back later for updates!"})]})]})})]})}),a.jsx(nt,{value:"cloud",className:"py-4 space-y-4",children:a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-2",children:[a.jsxs(ot,{className:"text-lg flex items-center",children:[a.jsx(xf,{className:"h-5 w-5 mr-2 text-primary"}),"Secure Cloud Backup"]}),a.jsx(ut,{children:"End-to-end encrypted cloud storage for your keys"})]}),a.jsx(Ue,{children:a.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[a.jsx("p",{children:"Your keys will be securely encrypted on your device first, then stored in our secure cloud infrastructure with end-to-end encryption."}),a.jsx("p",{children:"Even if our servers were compromised, your keys would remain secure as they're never stored in an unencrypted format."}),a.jsx("div",{className:"flex items-center justify-between bg-slate-50 p-3 rounded-lg mt-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(_f,{className:"h-5 w-5 mr-2 text-primary"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Premium Feature"}),a.jsx("div",{className:"text-xs text-slate-500",children:"Part of MATA Premium subscription"})]})]})}),a.jsxs(Mt,{variant:"default",className:"mt-4 bg-blue-50 text-blue-800 border-blue-200",children:[a.jsx(is,{className:"h-4 w-4"}),a.jsx(zt,{children:"Cloud backup will be available with the MATA Premium subscription."})]})]})})]})})]}),s&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(Sl,{value:c,className:"h-2"}),a.jsx("div",{className:"text-xs text-muted-foreground text-right",children:c<100?"Creating secure backup...":"Backup complete!"})]}),a.jsxs(cn,{className:"flex justify-between items-center sm:justify-between",children:[a.jsx("div",{className:"text-sm text-muted-foreground hidden sm:block",children:i==="download"?a.jsx("span",{children:"Download and keep your keys safe"}):i==="friends"?a.jsx("span",{children:"Coming soon: Share key fragments with friends"}):a.jsx("span",{children:"Coming soon: Premium cloud backup"})}),a.jsxs("div",{className:"space-x-2",children:[a.jsx(ie,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),i==="download"&&a.jsx(ie,{onClick:m,disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Downloading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ls,{className:"mr-2 h-4 w-4"}),"Download"]})})]})]})]})})}const pp=768;function OA(){const[e,t]=w.useState(void 0);return w.useEffect(()=>{const n=window.matchMedia(`(max-width: ${pp-1}px)`),r=()=>{t(window.innerWidth<pp)};return n.addEventListener("change",r),t(window.innerWidth<pp),()=>n.removeEventListener("change",r)},[]),!!e}var MA="AlertDialog",[V8,nW]=ms(MA,[qj]),Bs=qj(),zA=e=>{const{__scopeAlertDialog:t,...n}=e,r=Bs(t);return a.jsx(cI,{...r,...n,modal:!0})};zA.displayName=MA;var U8="AlertDialogTrigger",B8=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Bs(n);return a.jsx(eF,{...s,...r,ref:t})});B8.displayName=U8;var K8="AlertDialogPortal",LA=e=>{const{__scopeAlertDialog:t,...n}=e,r=Bs(t);return a.jsx(uI,{...r,...n})};LA.displayName=K8;var W8="AlertDialogOverlay",FA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Bs(n);return a.jsx(Kv,{...s,...r,ref:t})});FA.displayName=W8;var Ci="AlertDialogContent",[H8,q8]=V8(Ci),VA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...s}=e,o=Bs(n),i=w.useRef(null),l=qe(t,i),c=w.useRef(null);return a.jsx(YL,{contentName:Ci,titleName:UA,docsSlug:"alert-dialog",children:a.jsx(H8,{scope:n,cancelRef:c,children:a.jsxs(Wv,{role:"alertdialog",...o,...s,ref:l,onOpenAutoFocus:xe(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(hv,{children:r}),a.jsx(Z8,{contentRef:i})]})})})});VA.displayName=Ci;var UA="AlertDialogTitle",BA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Bs(n);return a.jsx(Hv,{...s,...r,ref:t})});BA.displayName=UA;var KA="AlertDialogDescription",WA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Bs(n);return a.jsx(qv,{...s,...r,ref:t})});WA.displayName=KA;var G8="AlertDialogAction",HA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Bs(n);return a.jsx(Gv,{...s,...r,ref:t})});HA.displayName=G8;var qA="AlertDialogCancel",GA=w.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:s}=q8(qA,n),o=Bs(n),i=qe(t,s);return a.jsx(Gv,{...o,...r,ref:i})});GA.displayName=qA;var Z8=({contentRef:e})=>{const t=`\`${Ci}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ci}\` by passing a \`${KA}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ci}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Y8=zA,Q8=LA,ZA=FA,YA=VA,QA=HA,XA=GA,JA=BA,eP=WA;const X8=Y8,J8=Q8,tP=w.forwardRef(({className:e,...t},n)=>a.jsx(ZA,{className:ye("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));tP.displayName=ZA.displayName;const nP=w.forwardRef(({className:e,...t},n)=>a.jsxs(J8,{children:[a.jsx(tP,{}),a.jsx(YA,{ref:n,className:ye("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));nP.displayName=YA.displayName;const rP=({className:e,...t})=>a.jsx("div",{className:ye("flex flex-col space-y-2 text-center sm:text-left",e),...t});rP.displayName="AlertDialogHeader";const sP=({className:e,...t})=>a.jsx("div",{className:ye("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});sP.displayName="AlertDialogFooter";const oP=w.forwardRef(({className:e,...t},n)=>a.jsx(JA,{ref:n,className:ye("text-lg font-semibold",e),...t}));oP.displayName=JA.displayName;const aP=w.forwardRef(({className:e,...t},n)=>a.jsx(eP,{ref:n,className:ye("text-sm text-muted-foreground",e),...t}));aP.displayName=eP.displayName;const iP=w.forwardRef(({className:e,...t},n)=>a.jsx(QA,{ref:n,className:ye($v(),e),...t}));iP.displayName=QA.displayName;const lP=w.forwardRef(({className:e,...t},n)=>a.jsx(XA,{ref:n,className:ye($v({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));lP.displayName=XA.displayName;var $x="Checkbox",[eB,rW]=ms($x),[tB,nB]=eB($x),cP=w.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:o,required:i,disabled:l,value:c="on",onCheckedChange:u,form:d,...m}=e,[f,p]=w.useState(null),v=qe(t,S=>p(S)),h=w.useRef(!1),x=f?d||!!f.closest("form"):!0,[y=!1,g]=as({prop:s,defaultProp:o,onChange:u}),_=w.useRef(y);return w.useEffect(()=>{const S=f==null?void 0:f.form;if(S){const E=()=>g(_.current);return S.addEventListener("reset",E),()=>S.removeEventListener("reset",E)}},[f,g]),a.jsxs(tB,{scope:n,state:y,disabled:l,children:[a.jsx(je.button,{type:"button",role:"checkbox","aria-checked":Co(y)?"mixed":y,"aria-required":i,"data-state":fP(y),"data-disabled":l?"":void 0,disabled:l,value:c,...m,ref:v,onKeyDown:xe(e.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:xe(e.onClick,S=>{g(E=>Co(E)?!0:!E),x&&(h.current=S.isPropagationStopped(),h.current||S.stopPropagation())})}),x&&a.jsx(rB,{control:f,bubbles:!h.current,name:r,value:c,checked:y,required:i,disabled:l,form:d,style:{transform:"translateX(-100%)"},defaultChecked:Co(o)?!1:o})]})});cP.displayName=$x;var uP="CheckboxIndicator",dP=w.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,o=nB(uP,n);return a.jsx(_r,{present:r||Co(o.state)||o.state===!0,children:a.jsx(je.span,{"data-state":fP(o.state),"data-disabled":o.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});dP.displayName=uP;var rB=e=>{const{control:t,checked:n,bubbles:r=!0,defaultChecked:s,...o}=e,i=w.useRef(null),l=fx(n),c=nx(t);w.useEffect(()=>{const d=i.current,m=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(m,"checked").set;if(l!==n&&p){const v=new Event("click",{bubbles:r});d.indeterminate=Co(n),p.call(d,Co(n)?!1:n),d.dispatchEvent(v)}},[l,n,r]);const u=w.useRef(Co(n)?!1:n);return a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??u.current,...o,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Co(e){return e==="indeterminate"}function fP(e){return Co(e)?"indeterminate":e?"checked":"unchecked"}var mP=cP,sB=dP;const Ox=w.forwardRef(({className:e,...t},n)=>a.jsx(mP,{ref:n,className:ye("peer h-4 w-4 shrink-0 rounded-md border border-gray-300 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-tertiary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-tertiary data-[state=checked]:text-white data-[state=checked]:border-tertiary",e),...t,children:a.jsx(sB,{className:ye("flex items-center justify-center text-current"),children:a.jsx(Da,{className:"h-4 w-4"})})}));Ox.displayName=mP.displayName;const oB=_e.object({cardholderName:_e.string().min(2,"Cardholder name is required"),cardNumber:_e.string().min(13,"Card number must be at least 13 digits").max(19,"Card number must be at most 19 digits").regex(/^[0-9]+$/,"Card number must contain only digits"),cardType:_e.string().min(1,"Please select a card type"),expiryMonth:_e.string().min(1,"Month is required"),expiryYear:_e.string().min(4,"Year is required"),securityCode:_e.string().min(3,"Security code must be at least 3 digits").max(4,"Security code must be at most 4 digits").regex(/^[0-9]+$/,"Security code must contain only digits"),saveAddress:_e.boolean().default(!1),street:_e.string().optional(),city:_e.string().optional(),state:_e.string().optional(),zipCode:_e.string().optional(),country:_e.string().optional()}).refine(e=>e.saveAddress?!!e.street&&!!e.city&&!!e.state&&!!e.zipCode&&!!e.country:!0,{message:"Please fill in all address fields",path:["street"]}),aB=[{value:"visa",label:"Visa"},{value:"mastercard",label:"MasterCard"},{value:"amex",label:"American Express"},{value:"discover",label:"Discover"},{value:"jcb",label:"JCB"},{value:"unionpay",label:"UnionPay"},{value:"diners",label:"Diners Club"}],iB=["01","02","03","04","05","06","07","08","09","10","11","12"],lB=new Date().getFullYear(),cB=Array.from({length:16},(e,t)=>(lB+t).toString());function uB({open:e,setOpen:t}){const{toast:n}=dn(),[r,s]=w.useState(!1),[o,i]=w.useState([]),[l,c]=w.useState(!0),[u,d]=w.useState(!1),[m,f]=w.useState(null),p=xi({resolver:wi(oB),defaultValues:{cardholderName:"",cardNumber:"",cardType:"",expiryMonth:"",expiryYear:"",securityCode:"",saveAddress:!1,street:"",city:"",state:"",zipCode:"",country:""}}),v=p.watch("saveAddress");w.useEffect(()=>{v&&setTimeout(()=>{const K=document.getElementById("billing-address-section");K&&K.scrollIntoView({behavior:"smooth",block:"nearest"})},100)},[v]),w.useEffect(()=>{e&&V()},[e]);const[h,x]=w.useState(!1),[y,g]=w.useState(""),[_,S]=w.useState(""),[E,A]=w.useState(!1),[I,N]=w.useState(null),[T,$]=w.useState(!1);async function M(){try{const K=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(!K){console.error("No user email found in storage - cannot access payment vault");return}console.log(`Setting payment vault context for user: ${K}`),localStorage.setItem("current_vault_context",K);let ne=localStorage.getItem(`vault_user_${K.replace(/[@.]/g,"_")}_payments_encryption_method`);if(ne||(ne=localStorage.getItem("current_encryption_method")),ne||(ne=localStorage.getItem("user_encryption_method")),!ne){const C=`encryption_pref_${K.replace(/[@.]/g,"_")}`;ne=localStorage.getItem(C)}ne||(ne=localStorage.getItem("default_encryption_method")),ne?console.log(`Found encryption method for vault: ${ne}`):(ne="webcrypto",console.log(`No encryption method found, defaulting to: ${ne}`));const G=`encryption_pref_${K.replace(/[@.]/g,"_")}`;localStorage.setItem(G,ne),localStorage.setItem("current_encryption_method",ne),localStorage.setItem("user_encryption_method",ne),localStorage.setItem("encryption_method_in_use",ne);const te=`user_${K.replace(/[@.]/g,"_")}_payments`;localStorage.setItem(`vault_${te}_encryption_method`,ne),console.log(`Applied consistent encryption method: ${ne}`),oe(()=>Promise.resolve().then(()=>tt),void 0).then(C=>{C.resetFallbackState(),ne==="webcrypto"?(C.markUsingFallback("encrypt"),C.markUsingFallback("decrypt"),console.log("Using WebCrypto for payment vault encryption/decryption")):console.log("Using WASM for payment vault encryption/decryption")});const le=await pe.getVaults();console.log("Available vaults:",le.map(C=>({id:C.id,type:C.type})));const fe=K.toLowerCase(),de=`user_${fe.replace(/[@.]/g,"_")}_payments`;console.log("Looking for payment vault with namespace:",de);const Pe=le.find(C=>C.id===de||C.id===`payments-${fe}`||C.type==="payments"&&C.id.includes(fe));if(Pe)console.log("Payment vault found:",Pe.id),localStorage.setItem("user_vault_namespace",Pe.id);else{console.log("Payment vault not found, creating a new one with ID:",de);const C=await pe.createNewVault("Payment Information","payments",de);localStorage.setItem("user_vault_namespace",de),localStorage.setItem("last_vault_namespace",de),console.log("Created user-specific payment vault:",de)}}catch(K){console.error("Error creating/checking payment vault:",K)}}async function j(){const K=localStorage.getItem("session_email");if(console.log(`Payment dialog - trying with session email: ${K||"not set"}`),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Set vault markers for payment vault access"),pe.isUnlocked())return console.log("Vault is already unlocked - proceeding with payment operations"),!0;try{pe.isInitialized()||await pe.initialize();const ne=await pe.unlockVault();return console.log("Vault unlock attempt result:",ne),ne}catch(ne){return console.error("Error unlocking vault:",ne),!1}try{return console.log("Auto-unlock failed, prompting for manual authentication"),new Promise(ne=>{N(()=>ne),g(""),S(""),x(!0)})}catch(ne){return console.error("Error setting up password prompt:",ne),n({title:"Authentication error",description:"Could not unlock your secure vault. Please try again.",variant:"destructive"}),!1}}async function P(K){if(K.preventDefault(),!y){S("Password is required");return}A(!0);try{if(console.log("Unlocking vault with provided password..."),!await pe.unlockVault(y)){S("Incorrect password. Please try again."),A(!1);return}console.log("Session is authenticated - proceeding with access"),localStorage.setItem("last_auth_password",y),localStorage.setItem("auth_timestamp",Date.now().toString());const G=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(y)),le=Array.from(new Uint8Array(G)).map(fe=>fe.toString(16).padStart(2,"0")).join("");localStorage.setItem("password_hash_check",le.substring(0,16)),console.log("Stored authentication data for future auto-unlock");try{await M()}catch(fe){console.error("Error ensuring payment vault exists:",fe)}n({title:"Authentication successful",description:"Your payment information is now accessible"}),x(!1),A(!1),I&&(I(!0),N(null))}catch(ne){console.error("Error unlocking vault:",ne),S("An error occurred while unlocking the vault. Please try again."),A(!1),I&&(I(!1),N(null))}}function b(){x(!1),I&&(I(!1),N(null)),n({title:"Authentication cancelled",description:"Vault access was cancelled.",variant:"destructive"})}async function V(){c(!0);try{if(!await pe.isVaultInitialized()){console.log("Vault system not initialized yet, initializing...");const J=await mo();if(!J||!an(J))throw console.error("No valid user keys found - cannot initialize vault"),new Error("Authentication issue - please log in again");await pe.initialize(),console.log("Vault system initialized successfully")}const K=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("last_session_email");if(!K)throw console.error("No user email found in storage - cannot load payment cards"),new Error("User session is invalid");console.log(`Setting payment vault context for user: ${K}`),localStorage.setItem("current_vault_context",K);const ne=localStorage.getItem(`encryption_pref_${K.replace(/[@.]/g,"_")}`);if(ne&&(console.log(`User ${K} has preferred encryption method: ${ne}`),localStorage.setItem("user_encryption_method",ne)),!pe.isUnlocked()){if(console.log("Attempting to auto-unlock vault for payment access..."),!await j()){console.log("Could not unlock vault - aborting payment data access"),i([]),c(!1);return}console.log("Auto-authenticated for payment access")}const G=await pe.getVaults();console.log("Available vaults:",G.map(J=>({id:J.id,type:J.type})));let te=localStorage.getItem("user_vault_namespace");te||(te=localStorage.getItem("last_vault_namespace"),te&&(localStorage.setItem("user_vault_namespace",te),console.log("Restored payment vault namespace from legacy location:",te))),console.log("Looking for payment vault with namespace:",te),console.log("Session email:",K);const le=K.toLowerCase(),ge=`user_${le.replace(/[@.]/g,"_")}_payments`;let de=G.find(J=>J.id===ge||J.id===`payments-${le}`||J.type==="payments"&&J.id.includes(le));if(!de){console.log("Payment vault not found, creating new one"),n({title:"Creating payment vault",description:"Setting up encrypted storage for your payment information"}),console.log("Creating new payment vault with ID:",ge);try{de=await pe.createNewVault("Payment Information","payments",ge),localStorage.setItem("user_vault_namespace",ge),console.log("Created user-specific payment vault:",ge)}catch(J){throw console.error("Error creating payment vault:",J),new Error("Could not create secure payment storage")}}const C=(await pe.getItems(de.id)).filter(J=>J.metadata.type==="payment_card").map(J=>J.data);i(C)}catch(K){console.error("Error loading payment cards:",K),n({title:"Error loading cards",description:"Could not load your saved payment methods",variant:"destructive"}),i([])}finally{c(!1)}}async function Z(K){s(!0);try{if(!await pe.isVaultInitialized()){console.log("Vault system not initialized yet, initializing...");const k=await mo();if(!k||!an(k))throw console.error("No valid user keys found - cannot initialize vault"),new Error("Authentication issue - please log in again");await pe.initialize(),console.log("Vault system initialized successfully for payment submission")}const ne=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(!ne)throw console.error("No user email found in session - cannot access payment vault"),new Error("User session is invalid");console.log(`Setting payment vault context for user: ${ne}`),localStorage.setItem("current_vault_context",ne);const G=localStorage.getItem("user_encryption_method")||localStorage.getItem("default_encryption_method")||"webcrypto",te=`encryption_pref_${ne.replace(/[@.]/g,"_")}`;if(localStorage.setItem(te,G),console.log(`Saved encryption preference for ${ne}: ${G}`),!pe.isUnlocked()){if(console.log("Vault is locked - attempting to unlock for payment submission"),!await j()){console.log("Could not unlock vault - aborting payment submission"),s(!1);return}console.log("Vault unlocked successfully for payment submission")}const le=await pe.getVaults();console.log("Available vaults for payment submission:",le.map(k=>({id:k.id,type:k.type})));const fe=ne.toLowerCase(),de=`user_${fe.replace(/[@.]/g,"_")}_payments`;console.log("Looking for payment vault with consistent ID:",de);let Pe=le.find(k=>k.id===de||k.id===`payments-${fe}`||k.type==="payments"&&k.id.includes(fe));if(!Pe){console.log("Payment vault not found, creating new one for submission"),console.log("Creating new payment vault with ID:",de);try{Pe=await pe.createNewVault("Payment Information","payments",de),localStorage.setItem("user_vault_namespace",de),console.log("Created user-specific payment vault:",de)}catch(k){throw console.error("Error creating payment vault:",k),new Error("Could not create secure payment storage")}}const C=K.cardNumber.slice(-4),J={id:m||`card_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,cardholderName:K.cardholderName,cardNumber:K.cardNumber,cardType:K.cardType,expiryMonth:K.expiryMonth,expiryYear:K.expiryYear,securityCode:K.securityCode,lastFourDigits:C,isDefault:o.length===0,createdAt:Date.now(),updatedAt:Date.now()};if(K.saveAddress&&(J.billingAddress={street:K.street||"",city:K.city||"",state:K.state||"",zipCode:K.zipCode||"",country:K.country||""}),m){const R=(await pe.getItems(Pe.id)).find(U=>U.data&&U.data.id===m);R&&await pe.deleteItem(Pe.id,R.id)}const ee=localStorage.getItem("user_encryption_method")||localStorage.getItem(`encryption_pref_${ne.replace(/[@.]/g,"_")}`)||"webcrypto",z=`vault_${Pe.id}_encryption_method`;localStorage.setItem(z,ee),console.log(`Using ${ee} for payment card encryption`),await oe(()=>Promise.resolve().then(()=>tt),void 0).then(k=>{ee==="webcrypto"?(k.resetFallbackState(),k.markUsingFallback("encrypt")):k.resetFallbackState()}),await pe.addItem(Pe.id,`${K.cardType.toUpperCase()} ****${C}`,"payment_card",J,{description:`${K.cardholderName}'s ${K.cardType} card`,tags:["payment","credit-card",K.cardType],searchTerms:[K.cardholderName.toLowerCase(),K.cardType.toLowerCase(),`card-${C}`]}),await V(),n({title:m?"Card updated":"Card added",description:`Your payment card has been securely ${m?"updated":"saved"}`}),p.reset(),d(!1),f(null)}catch(ne){console.error("Error saving payment card:",ne),n({title:"Error saving card",description:"Could not save your payment information",variant:"destructive"})}finally{s(!1)}}function D(K){var ne,G,te,le,fe;p.reset({cardholderName:K.cardholderName,cardNumber:K.cardNumber,cardType:K.cardType,expiryMonth:K.expiryMonth,expiryYear:K.expiryYear,securityCode:K.securityCode,saveAddress:!!K.billingAddress,street:(ne=K.billingAddress)==null?void 0:ne.street,city:(G=K.billingAddress)==null?void 0:G.city,state:(te=K.billingAddress)==null?void 0:te.state,zipCode:(le=K.billingAddress)==null?void 0:le.zipCode,country:(fe=K.billingAddress)==null?void 0:fe.country}),f(K.id),d(!0)}const[L,O]=w.useState(!1),[q,F]=w.useState(null);function W(K){F(K),O(!0)}async function ce(){if(!q){console.error("No card ID to delete");return}c(!0),O(!1);try{if(!await pe.isVaultInitialized()){console.log("Vault system not initialized yet, initializing for deletion...");const de=await mo();if(!de||!an(de))throw console.error("No valid user keys found - cannot initialize vault"),new Error("Authentication issue - please log in again");await pe.initialize(),console.log("Vault system initialized successfully for deletion")}const K=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("last_session_email");if(!K)throw console.error("No user email found in session - cannot delete payment card"),new Error("User session is invalid");console.log(`Setting payment vault context for user: ${K}`),localStorage.setItem("current_vault_context",K);const ne=localStorage.getItem(`encryption_pref_${K.replace(/[@.]/g,"_")}`);if(ne&&(console.log(`User ${K} has preferred encryption method: ${ne}`),localStorage.setItem("user_encryption_method",ne)),!pe.isUnlocked()){if(console.log("Vault is locked - attempting to unlock for card deletion"),!await j()){console.log("Could not unlock vault - aborting card deletion"),c(!1);return}console.log("Vault unlocked successfully for card deletion")}const G=await pe.getVaults(),te=localStorage.getItem("user_vault_namespace");let le=te?G.find(de=>de.id===te):G.find(de=>de.type==="payments");if(!le)throw new Error("Payment vault not found - please reload the page");const ge=(await pe.getItems(le.id)).find(de=>de.data&&de.data.id===q);ge&&(await pe.deleteItem(le.id,ge.id),n({title:"Card deleted",description:"Your payment method has been removed"}),await V())}catch(K){console.error("Error deleting card:",K),n({title:"Error deleting card",description:"Could not delete your payment method",variant:"destructive"})}finally{c(!1),F(null)}}async function ae(K){c(!0);try{if(!await pe.isVaultInitialized()){console.log("Vault system not initialized yet, initializing for set default card...");const de=await mo();if(!de||!an(de))throw console.error("No valid user keys found - cannot initialize vault"),new Error("Authentication issue - please log in again");await pe.initialize(),console.log("Vault system initialized successfully for set default card")}const ne=localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("last_session_email");if(!ne)throw console.error("No user email found in session - cannot update default payment card"),new Error("User session is invalid");console.log(`Setting payment vault context for user: ${ne}`),localStorage.setItem("current_vault_context",ne);const G=localStorage.getItem(`encryption_pref_${ne.replace(/[@.]/g,"_")}`);if(G&&(console.log(`User ${ne} has preferred encryption method: ${G}`),localStorage.setItem("user_encryption_method",G)),!pe.isUnlocked()){if(console.log("Vault is locked - attempting to unlock for setting default card"),!await j()){console.log("Could not unlock vault - aborting setting default card"),c(!1);return}console.log("Vault unlocked successfully for setting default card")}const te=await pe.getVaults(),le=localStorage.getItem("user_vault_namespace");let fe=le?te.find(de=>de.id===le):te.find(de=>de.type==="payments");if(!fe)throw new Error("Payment vault not found - please reload the page");const ge=await pe.getItems(fe.id);for(const de of ge)if(de.metadata.type==="payment_card"){const Pe=de.data,C=Pe.id===K;if(Pe.isDefault!==C){const J={...Pe,isDefault:C,updatedAt:Date.now()};await pe.deleteItem(fe.id,de.id);const ee=localStorage.getItem("user_encryption_method")||localStorage.getItem(`encryption_pref_${ne.replace(/[@.]/g,"_")}`)||"webcrypto",z=`vault_${fe.id}_encryption_method`;localStorage.setItem(z,ee),console.log(`Using ${ee} for default card update encryption`),await oe(()=>Promise.resolve().then(()=>tt),void 0).then(k=>{ee==="webcrypto"?(k.resetFallbackState(),k.markUsingFallback("encrypt")):k.resetFallbackState()}),await pe.addItem(fe.id,`${J.cardType.toUpperCase()} ****${J.lastFourDigits}`,"payment_card",J,{description:`${J.cardholderName}'s ${J.cardType} card`,tags:["payment","credit-card",J.cardType],searchTerms:[J.cardholderName.toLowerCase(),J.cardType.toLowerCase(),`card-${J.lastFourDigits}`]})}}await V(),n({title:"Default card updated",description:"Your default payment method has been updated"})}catch(ne){console.error("Error setting default card:",ne),n({title:"Error updating default",description:"Could not update your default payment method",variant:"destructive"})}finally{c(!1)}}return a.jsxs(a.Fragment,{children:[a.jsx(nn,{open:h,onOpenChange:K=>{K||b(),x(K)},children:a.jsxs(Gt,{className:"sm:max-w-[425px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Vault Authentication"}),a.jsx(Qt,{children:"Your payment information is encrypted. Please enter your password to unlock your secure vault."})]}),a.jsxs("form",{onSubmit:P,children:[a.jsx("div",{className:"grid gap-4 py-4",children:a.jsxs("div",{className:"grid gap-2",children:[a.jsx(ct,{htmlFor:"password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(De,{id:"password",type:T?"text":"password",placeholder:"Enter your password",value:y,onChange:K=>g(K.target.value),autoFocus:!0,className:"pr-10"}),a.jsx("button",{type:"button",onClick:()=>$(!T),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-500",tabIndex:-1,children:T?a.jsx(ma,{className:"h-4 w-4"}):a.jsx(ha,{className:"h-4 w-4"})})]}),_&&a.jsx("p",{className:"text-sm text-destructive",children:_})]})}),a.jsxs(cn,{children:[a.jsx(ie,{variant:"outline",type:"button",onClick:b,children:"Cancel"}),a.jsxs(ie,{type:"submit",disabled:E,children:[E&&a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Unlock"]})]})]})]})}),a.jsx(X8,{open:L,onOpenChange:O,children:a.jsxs(nP,{children:[a.jsxs(rP,{children:[a.jsx(oP,{children:"Delete Payment Method"}),a.jsx(aP,{children:"Are you sure you want to delete this payment method? This action cannot be undone."})]}),a.jsxs(sP,{children:[a.jsx(lP,{children:"Cancel"}),a.jsxs(iP,{onClick:ce,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[a.jsx(Sv,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}),a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Payment Methods"}),a.jsx(Qt,{children:u?"Add your payment card details. All information is encrypted and stored locally.":"Manage your saved payment methods. Your card data is encrypted and never sent to servers."})]}),l?a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx(it,{className:"h-8 w-8 animate-spin text-primary"})}):u?a.jsx(Si,{...p,children:a.jsxs("form",{onSubmit:p.handleSubmit(Z),className:"space-y-4",children:[a.jsx(ht,{control:p.control,name:"cardholderName",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Cardholder Name"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"John Doe",...K})}),a.jsx(pt,{})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ht,{control:p.control,name:"cardNumber",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Card Number"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"1234 5678 9012 3456",...K})}),a.jsx(pt,{})]})}),a.jsx(ht,{control:p.control,name:"cardType",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Card Type"}),a.jsxs(yc,{onValueChange:K.onChange,defaultValue:K.value,children:[a.jsx(ft,{children:a.jsx(bi,{children:a.jsx(vc,{placeholder:"Select card type"})})}),a.jsx(Ei,{children:aB.map(ne=>a.jsx(Ft,{value:ne.value,children:ne.label},ne.value))})]}),a.jsx(pt,{})]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx(ht,{control:p.control,name:"expiryMonth",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Month"}),a.jsxs(yc,{onValueChange:K.onChange,defaultValue:K.value,children:[a.jsx(ft,{children:a.jsx(bi,{children:a.jsx(vc,{placeholder:"MM"})})}),a.jsx(Ei,{children:iB.map(ne=>a.jsx(Ft,{value:ne,children:ne},ne))})]}),a.jsx(pt,{})]})}),a.jsx(ht,{control:p.control,name:"expiryYear",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Year"}),a.jsxs(yc,{onValueChange:K.onChange,defaultValue:K.value,children:[a.jsx(ft,{children:a.jsx(bi,{children:a.jsx(vc,{placeholder:"YYYY"})})}),a.jsx(Ei,{children:cB.map(ne=>a.jsx(Ft,{value:ne,children:ne},ne))})]}),a.jsx(pt,{})]})}),a.jsx(ht,{control:p.control,name:"securityCode",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Security Code"}),a.jsx(ft,{children:a.jsx(De,{type:"text",placeholder:"CVC",maxLength:4,inputMode:"numeric",pattern:"[0-9]*",...K})}),a.jsx(pt,{})]})})]}),a.jsx(ht,{control:p.control,name:"saveAddress",render:({field:K})=>a.jsxs(dt,{className:"flex flex-row items-center space-x-3 space-y-0 rounded-md border p-4",children:[a.jsx(ft,{children:a.jsx(Ox,{checked:K.value,onCheckedChange:K.onChange})}),a.jsx("div",{className:"space-y-1 leading-none",children:a.jsx(St,{children:"Save billing address"})})]})}),p.watch("saveAddress")&&a.jsxs("div",{id:"billing-address-section",className:"space-y-4 p-4 border rounded-md",children:[a.jsx(ht,{control:p.control,name:"street",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Street Address"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"123 Main St",...K})}),a.jsx(pt,{})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ht,{control:p.control,name:"city",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"City"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"New York",...K})}),a.jsx(pt,{})]})}),a.jsx(ht,{control:p.control,name:"state",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"State/Province"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"NY",...K})}),a.jsx(pt,{})]})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ht,{control:p.control,name:"zipCode",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"ZIP/Postal Code"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"10001",...K})}),a.jsx(pt,{})]})}),a.jsx(ht,{control:p.control,name:"country",render:({field:K})=>a.jsxs(dt,{children:[a.jsx(St,{children:"Country"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"USA",...K})}),a.jsx(pt,{})]})})]})]}),a.jsxs(cn,{children:[a.jsx(ie,{variant:"outline",onClick:()=>{d(!1),f(null),p.reset()},type:"button",children:"Cancel"}),a.jsxs(ie,{type:"submit",disabled:r,children:[r&&a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),m?"Update":"Save"," Payment Method"]})]})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-4",children:o.length===0?a.jsxs("div",{className:"text-center py-6",children:[a.jsx(Xr,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"No payment methods saved yet"})]}):a.jsx("div",{className:"space-y-3",children:o.map(K=>a.jsxs("div",{className:"border rounded-md p-4 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h4",{className:"font-medium",children:[K.cardType.toUpperCase()," •••• ",K.lastFourDigits]}),K.isDefault&&a.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded-full",children:"Default"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[K.cardholderName," • Expires ",K.expiryMonth,"/",K.expiryYear.slice(-2)]})]}),a.jsxs("div",{className:"flex gap-2",children:[!K.isDefault&&a.jsx(ie,{variant:"ghost",size:"sm",onClick:()=>ae(K.id),children:"Set as default"}),a.jsx(ie,{variant:"outline",size:"sm",onClick:()=>D(K),children:"Edit"}),a.jsx(ie,{variant:"destructive",size:"sm",onClick:()=>W(K.id),children:"Delete"})]})]},K.id))})}),a.jsx(cn,{className:"mt-6",children:a.jsx(ie,{onClick:()=>d(!0),children:"Add Payment Method"})})]})]})})]})}function dB({progress:e,message:t}){return a.jsxs("div",{className:"w-full space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mb-1",children:[a.jsx("span",{children:t}),a.jsxs("span",{children:[Math.round(e),"%"]})]}),a.jsx(Sl,{value:e,className:"h-2"})]})}function fB({isOpen:e,onClose:t,onSave:n,password:r}){const{toast:s}=dn(),[o,i]=w.useState(!1);function l(d){if(!d)return"weak";const m=d.length,f=/[A-Z]/.test(d),p=/[a-z]/.test(d),v=/\d/.test(d),h=/[^A-Za-z0-9]/.test(d),x=[f,p,v,h].filter(Boolean).length;return m<8||m<10&&x<3?"weak":m<12&&x<3?"medium":m>=12&&x>=3?"very-strong":m>=10&&x>=3?"strong":"medium"}const c=()=>{i(!0);try{const m="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_-+=";let f="";f+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)],f+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)],f+="0123456789"[Math.floor(Math.random()*10)],f+="!@#$%^&*()_-+="[Math.floor(Math.random()*14)];for(let v=4;v<32;v++)f+=m.charAt(Math.floor(Math.random()*m.length));f=f.split("").sort(()=>.5-Math.random()).join("");const p=document.getElementById("password");p&&(p.value=f,p.type="text",setTimeout(()=>{p.type="password"},3e3)),s({title:"32-Character Password Generated",description:"A secure password has been generated for you."})}catch(d){console.error("Error generating password:",d),s({title:"Generation Failed",description:"Failed to generate a secure password.",variant:"destructive"})}finally{i(!1)}},u=d=>{d.preventDefault();const m=d.target,f=m.querySelector("#name"),p=m.querySelector("#username"),v=m.querySelector("#password"),h=m.querySelector("#website"),x=m.querySelector("[data-radix-select-value]"),y=m.querySelector("#favorite");if(!(h!=null&&h.value)||!(p!=null&&p.value)||!(v!=null&&v.value)){s({title:"Missing Information",description:"Please fill in all required fields (Website URL, Username, and Password).",variant:"destructive"});return}const g=h.value.replace(/^https?:\/\//,"").replace(/^www\./,"").split("/")[0],_={id:(r==null?void 0:r.id)||"",name:f.value||g||"Unnamed",username:p.value,password:v.value,website:h.value||void 0,category:(x==null?void 0:x.getAttribute("data-value"))||"other",favorite:y.checked,lastUpdated:Date.now(),strength:l(v.value)};n(_),t()};return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:r?"Edit Password":"Add New Password"}),a.jsx(Qt,{children:r?"Update your saved password information":"Add a new password to your secure vault"})]}),a.jsxs("form",{onSubmit:u,children:[a.jsxs("div",{className:"space-y-4 py-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ct,{htmlFor:"name",children:"Name"}),a.jsx(De,{id:"name",defaultValue:(r==null?void 0:r.name)||"",placeholder:"e.g., Gmail, Amazon"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ct,{htmlFor:"website",children:"Website URL"}),a.jsx(De,{id:"website",defaultValue:(r==null?void 0:r.website)||"",placeholder:"e.g., https://example.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ct,{htmlFor:"username",children:"Username"}),a.jsx(De,{id:"username",defaultValue:(r==null?void 0:r.username)||"",placeholder:"e.g., user@example.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ct,{htmlFor:"password",children:"Password"}),a.jsx(ie,{variant:"outline",size:"sm",type:"button",onClick:c,disabled:o,className:"h-7 px-2",children:o?a.jsx(it,{className:"h-3 w-3 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(tr,{className:"h-3 w-3 mr-1"}),"Generate Password"]})})]}),a.jsx(De,{id:"password",type:"password",defaultValue:(r==null?void 0:r.password)||"",placeholder:"Enter password",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ct,{htmlFor:"category",children:"Category"}),a.jsxs(yc,{defaultValue:(r==null?void 0:r.category)||"other",children:[a.jsx(bi,{children:a.jsx(vc,{placeholder:"Select a category"})}),a.jsxs(Ei,{children:[a.jsx(Ft,{value:"banking",children:"Banking"}),a.jsx(Ft,{value:"shopping",children:"Shopping"}),a.jsx(Ft,{value:"work",children:"Work"}),a.jsx(Ft,{value:"social",children:"Social Media"}),a.jsx(Ft,{value:"travel",children:"Travel"}),a.jsx(Ft,{value:"entertainment",children:"Entertainment"}),a.jsx(Ft,{value:"email",children:"Email"}),a.jsx(Ft,{value:"utilities",children:"Utilities"}),a.jsx(Ft,{value:"other",children:"Other"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ox,{id:"favorite",defaultChecked:(r==null?void 0:r.favorite)||!1}),a.jsx(ct,{htmlFor:"favorite",className:"cursor-pointer",children:"Mark as favorite"})]})]}),a.jsxs(cn,{children:[a.jsx(ie,{variant:"outline",type:"button",onClick:t,children:"Cancel"}),a.jsx(ie,{type:"submit",children:"Save"})]})]})]})})}function mB({isOpen:e,onClose:t,onUnlock:n,isUnlocking:r}){const[s,o]=w.useState(""),i=l=>{l.preventDefault(),n(s)};return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Unlock Password Vault"}),a.jsx(Qt,{children:"Enter your password to unlock your password vault."})]}),a.jsxs("form",{onSubmit:i,children:[a.jsx("div",{className:"space-y-4 py-2",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(ct,{htmlFor:"unlock-password",children:"Password"}),a.jsx(De,{id:"unlock-password",type:"password",placeholder:"Enter your password",value:s,onChange:l=>o(l.target.value),required:!0})]})}),a.jsx(cn,{className:"mt-4",children:a.jsx(ie,{type:"submit",disabled:r,children:r?a.jsxs(a.Fragment,{children:[a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Unlocking..."]}):"Unlock"})})]})]})})}const Mx="passwords",Ni="password",ji="password_",em="credential_";function $u(e){return e?Jm(e,Mx):""}async function tm(e){if(!e)return console.error("Cannot initialize passwords vault without email"),!1;try{const{vaultService:t}=await oe(async()=>{const{vaultService:o}=await Promise.resolve().then(()=>Ot);return{vaultService:o}},void 0);if(t.isInitialized()||await t.initialize(),!t.isUnlocked())return console.warn("Vault service is locked - cannot initialize passwords vault"),!1;const n=$u(e);return localStorage.setItem("password_vault_namespace",n),(await t.getVaults()).find(o=>o.id===n)?(console.log(`Found existing passwords vault: ${n}`),!0):(await t.createNewVault("Passwords",Mx,n),console.log(`Created new passwords vault: ${n}`),!0)}catch(t){return console.error("Failed to initialize passwords vault:",t),!1}}async function hP(e,t){try{console.log("======= SAVING PASSWORD ======="),console.log(`Saving password "${t.name}" to vault for ${e}...`);const{vaultService:n}=await oe(async()=>{const{vaultService:u}=await Promise.resolve().then(()=>Ot);return{vaultService:u}},void 0),{setVaultUserContext:r}=await oe(async()=>{const{setVaultUserContext:u}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:u}},void 0);r(e);const{resetFallbackState:s}=await oe(async()=>{const{resetFallbackState:u}=await Promise.resolve().then(()=>tt);return{resetFallbackState:u}},void 0);if(s(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations"),n.isInitialized()||(console.log("Vault service not initialized, initializing now..."),await n.initialize()),!n.isUnlocked())return console.warn("Vault is locked! Cannot save password."),!1;const o=$u(e);console.log(`Using password vault ID: ${o}`);const i="wasm";console.log("Using standardized WASM-first approach with WebCrypto fallback for saving");const l={...t,id:t.id||`${ji}${Date.now()}_${Math.random().toString(36).substring(2,9)}`};!l.id.startsWith(ji)&&!l.id.startsWith(em)&&(l.id=`${ji}${l.id}`),console.log(`Password ID: ${l.id}`),l.lastUpdated||(l.lastUpdated=Date.now());const c={name:t.name,description:t.website||"",type:Ni,tags:t.tags||[],searchTerms:[t.name,t.username,t.category||"",t.website||"","password","credential"].filter(Boolean),favorite:t.favorite||!1,encryptionMethod:i};return console.log(`Adding password to vault with type: ${Ni}, encryption: ${i}`),await n.addItem(o,l.id,Ni,l,c,i),console.log(`Password "${t.name}" saved successfully to vault ${o} with method ${i}`),!0}catch(n){return console.error("Failed to save password:",n),!1}}async function hB(e){try{console.log("======= RETRIEVING PASSWORDS ======="),console.log(`Getting passwords from vault for ${e}...`);const{setVaultUserContext:t}=await oe(async()=>{const{setVaultUserContext:c}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:c}},void 0);t(e);const{resetFallbackState:n}=await oe(async()=>{const{resetFallbackState:c}=await Promise.resolve().then(()=>tt);return{resetFallbackState:c}},void 0);n(),console.log("Using standardized WASM-first approach with WebCrypto fallback for vault operations");const{vaultService:r}=await oe(async()=>{const{vaultService:c}=await Promise.resolve().then(()=>Ot);return{vaultService:c}},void 0);if(r.isInitialized()||(console.log("Vault service not initialized, initializing now..."),await r.initialize()),!r.isUnlocked())return console.warn("Vault is locked! Cannot get passwords."),[];const s=$u(e);console.log(`Using password vault ID for retrieval: ${s}`),console.log(`Retrieving items from vault ${s}...`);const o=await r.getItems(s);console.log(`Found ${o.length} items in password vault`),o.length===0&&(console.log("No passwords found in vault - checking if vault exists"),(await r.getVaults()).find(d=>d.id===s)?console.log("Password vault exists but is empty"):(console.log("Password vault doesn't exist, creating now..."),await tm(e)));const i=o.filter(c=>{var p,v,h,x;const u=((p=c.metadata)==null?void 0:p.type)===Ni,d=c.id.startsWith(ji)||c.id.startsWith(em),m=((v=c.metadata)==null?void 0:v.name)&&typeof c.metadata.name=="string"&&(c.metadata.name.includes("password")||c.metadata.name.includes("credential")),f=u||d||m;return console.log(`Item ${c.id} analysis:
        - Has type '${Ni}'? ${u}
        - Has ID prefix '${ji}' or '${em}'? ${d}
        - Has password/credential in name? ${m}
        - Final decision: ${f?"IS":"IS NOT"} a password item
        - Metadata type: ${((h=c.metadata)==null?void 0:h.type)||"undefined"}
      `),f||console.log(`Skipping non-password item: ${c.id}, type: ${(x=c.metadata)==null?void 0:x.type}`),f});console.log(`Found ${i.length} password items out of ${o.length} total items`);const l=i.map(c=>{var m,f,p;return console.log(`Processing password item: ${c.id}, type: ${(m=c.metadata)==null?void 0:m.type}`),c.data&&typeof c.data=="object"&&"name"in c.data&&"username"in c.data&&"password"in c.data||console.warn(`Item ${c.id} is missing required password fields:`,c.data),{...{name:((f=c.metadata)==null?void 0:f.name)||"Untitled Password",username:"",password:"",website:"",favorite:!1,lastUpdated:Date.now()},...c.data,id:c.id,favorite:((p=c.metadata)==null?void 0:p.favorite)||c.data&&c.data.favorite||!1,iconUrl:c.data&&c.data.iconUrl||(c.data&&c.data.website?yB(c.data.website):"")}});return console.log(`Returning ${l.length} valid passwords`),l}catch(t){console.error("Failed to get passwords:",t);try{return console.log("Attempting to initialize password vault after retrieval error"),await tm(e),[]}catch(n){return console.error("Failed to initialize password vault:",n),[]}}}async function pP(e,t){try{const{vaultService:n}=await oe(async()=>{const{vaultService:s}=await Promise.resolve().then(()=>Ot);return{vaultService:s}},void 0),r=$u(e);return await n.deleteItem(r,t),!0}catch(n){return console.error("Failed to delete password:",n),!1}}async function pB(e,t){try{return await pP(e,t.id),await hP(e,t)}catch(n){return console.error("Failed to update password:",n),!1}}async function gB(){try{const{vaultService:e}=await oe(async()=>{const{vaultService:t}=await Promise.resolve().then(()=>Ot);return{vaultService:t}},void 0);e.lockVault(),e.resetState(),console.log("Password vault session data cleaned up")}catch(e){console.error("Failed to clean up password vault session:",e),localStorage.removeItem("password_vault_namespace"),localStorage.removeItem("password_vault_unlocked"),localStorage.removeItem("password_vault_initialized"),localStorage.removeItem("password_vault_current_user"),localStorage.removeItem("password_item_encryption_method")}}function yB(e){if(!e)return"";try{return`https://www.google.com/s2/favicons?domain=${new URL(e.startsWith("http")?e:`https://${e}`).hostname}&sz=128`}catch{return""}}async function vB(e){try{const{vaultService:t}=await oe(async()=>{const{vaultService:n}=await Promise.resolve().then(()=>Ot);return{vaultService:n}},void 0);return t.isUnlocked()}catch(t){return console.error("Failed to check if password vault is unlocked:",t),!1}}async function xB(e){try{console.log("Attempting to unlock password vault...");const{vaultService:t}=await oe(async()=>{const{vaultService:s}=await Promise.resolve().then(()=>Ot);return{vaultService:s}},void 0);t.isInitialized()||(console.log("Vault service not initialized, initializing now..."),await t.initialize());const n=localStorage.getItem("session_email")||localStorage.getItem("current_user_email");if(!n)return console.error("No user email found in session - cannot unlock vault"),!1;console.log(`Unlocking password vault for user: ${n}`),localStorage.setItem("password_vault_current_user",n),localStorage.setItem("last_auth_password",e),localStorage.setItem("auth_timestamp",Date.now().toString());try{const o=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",o),c=Array.from(new Uint8Array(i)).map(u=>u.toString(16).padStart(2,"0")).join("");localStorage.setItem("password_hash_check",c.substring(0,16)),console.log("Stored auth tracking data for vault operations")}catch(s){console.warn("Could not create password status hash:",s)}return await t.unlockVault(e,!1)?(console.log("Password vault successfully unlocked"),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),localStorage.setItem("password_vault_unlocked","true"),await tm(n),!0):(console.error("Failed to unlock password vault - invalid credentials or vault error"),!1)}catch(t){return console.error("Failed to unlock password vault:",t),!1}}const Ou=Object.freeze(Object.defineProperty({__proto__:null,LEGACY_PASSWORD_ID_PREFIX:em,PASSWORDS_VAULT_TYPE:Mx,PASSWORD_ID_PREFIX:ji,PASSWORD_ITEM_TYPE:Ni,cleanupPasswordSession:gB,deletePassword:pP,getPasswordVaultId:$u,getPasswords:hB,initializePasswordVault:tm,isPasswordVaultUnlocked:vB,savePassword:hP,unlockPasswordVault:xB,updatePassword:pB},Symbol.toStringTag,{value:"Module"})),{initializePasswordVault:wB,isPasswordVaultUnlocked:_B,unlockPasswordVault:SB,getPasswords:bB,getPassword:EB,savePassword:kB,updatePassword:CB,deletePassword:NB,PASSWORD_ID_PREFIX:jB}=Ou,zl=Object.freeze(Object.defineProperty({__proto__:null,PASSWORD_ID_PREFIX:jB,default:Ou,deletePassword:NB,getPassword:EB,getPasswords:bB,initializePasswordVault:wB,isPasswordVaultUnlocked:_B,savePassword:kB,unlockPasswordVault:SB,updatePassword:CB},Symbol.toStringTag,{value:"Module"}));function IB(e){switch(e){case"weak":return"bg-red-500";case"medium":return"bg-yellow-500";case"strong":return"bg-green-500";case"very-strong":return"bg-blue-500";default:return"bg-gray-500"}}function TB({user:e}){var Z;const{toast:t}=dn(),[n,r]=w.useState("all"),[s,o]=w.useState(""),[i,l]=w.useState(!1),[c,u]=w.useState(!1),[d,m]=w.useState(null),[f,p]=w.useState([]),[v,h]=w.useState(!1),[x,y]=w.useState(!0),[g,_]=w.useState({}),S=[{id:"all",name:"All Passwords",count:0,icon:_f},{id:"favorites",name:"Favorites",count:0,icon:Kh},{id:"banking",name:"Banking",count:0,icon:Xr},{id:"shopping",name:"Shopping",count:0,icon:N_},{id:"work",name:"Work",count:0,icon:x_},{id:"social",name:"Social Media",count:0,icon:__},{id:"travel",name:"Travel",count:0,icon:k_},{id:"entertainment",name:"Entertainment",count:0,icon:b_},{id:"email",name:"Email",count:0,icon:Ag},{id:"utilities",name:"Utilities",count:0,icon:T_}];w.useEffect(()=>{(async()=>{if(e!=null&&e.email)try{y(!0);const{getPasswords:L,initializePasswordVault:O,isPasswordVaultUnlocked:q,unlockPasswordVault:F}=zl,{vaultService:W}=await oe(async()=>{const{vaultService:te}=await Promise.resolve().then(()=>Ot);return{vaultService:te}},void 0);console.log("Loading passwords - checking vault status");const ce=localStorage.getItem("skip_password_prompt")==="true",ae=parseInt(localStorage.getItem("vault_creation_time")||"0",10),K=ae>0&&Date.now()-ae<5*60*1e3;if(console.log("Initializing password vault if needed"),await O(e.email),ce&&K){console.log("Skipping password prompt for recently created account");const te=localStorage.getItem("initial_vault_password");te&&(console.log("Using stored initial password to auto-unlock"),await F(te),localStorage.removeItem("initial_vault_password")),localStorage.removeItem("skip_password_prompt")}const ne=await q(e.email);if(console.log(`Password vault unlock status: ${ne?"UNLOCKED":"LOCKED"}`),!ne){const te=parseInt(localStorage.getItem("vault_creation_time")||"0",10)>0&&Date.now()-parseInt(localStorage.getItem("vault_creation_time")||"0",10)<3e5,le=localStorage.getItem("skip_password_prompt")==="true",fe=localStorage.getItem("vault_unlocked")==="true",ge=localStorage.getItem("password_vault_unlocked")==="true";if(te&&(le||fe||ge)){console.log("Attempting auto-unlock for recently created account");const de=localStorage.getItem("initial_vault_password");if(de)if(console.log("Using initial password from registration for auto-unlock"),await Av(e.email,de,!0))console.log("Auto-unlock successful for new account");else{console.log("Auto-unlock failed, showing unlock dialog"),u(!0),y(!1);return}else{console.log("No initial password available, showing unlock dialog"),u(!0),y(!1);return}}else{console.log("Vault is locked, showing unlock dialog"),u(!0),y(!1);return}}console.log("Retrieving passwords from unlocked vault");const G=await L(e.email);console.log(`Retrieved ${G.length} passwords from vault`),p(G),G.length===0&&(console.log("No passwords found in vault - displaying empty state"),p([]))}catch(L){console.error("Error loading passwords:",L),t({title:"Error",description:"Failed to load your passwords. Please try again.",variant:"destructive"})}finally{y(!1)}})()},[e]);const E=async D=>{if(!(!(e!=null&&e.email)||!D))try{h(!0),console.log("Attempting to unlock vault with standardized approach...");const{vaultService:L}=await oe(async()=>{const{vaultService:W}=await Promise.resolve().then(()=>Ot);return{vaultService:W}},void 0),{getPasswords:O}=zl;if(localStorage.setItem("password_vault_current_user",e.email),localStorage.setItem("auth_timestamp",Date.now().toString()),!await L.unlockVault(D,!1)){console.error("Vault unlock failed - incorrect password or vault error"),t({title:"Unlock Failed",description:"Incorrect password. Please try again.",variant:"destructive"});return}console.log("Vault successfully unlocked - retrieving passwords");const F=await O(e.email);p(F),u(!1),console.log(`Retrieved ${F.length} passwords from unlocked vault`),t({title:"Vault Unlocked",description:"Your passwords are now available."})}catch(L){console.error("Error unlocking vault:",L),t({title:"Unlock Failed",description:"Failed to unlock your password vault. Please try again.",variant:"destructive"})}finally{h(!1)}},A=()=>{m(null),l(!0)},I=()=>S.map(D=>D.id==="all"?{...D,count:f.length}:D.id==="favorites"?{...D,count:f.filter(L=>L.favorite).length}:{...D,count:f.filter(L=>L.category===D.id).length}),N=f.filter(D=>{const L=s?D.name.toLowerCase().includes(s.toLowerCase())||D.username.toLowerCase().includes(s.toLowerCase())||D.website&&D.website.toLowerCase().includes(s.toLowerCase()):!0,O=n==="all"?!0:n==="favorites"?D.favorite:D.category===n;return L&&O}),T=D=>{_(L=>({...L,[D]:!L[D]}))},$=async D=>{if(e!=null&&e.email)try{const{savePassword:L,updatePassword:O,getPasswords:q,PASSWORD_ID_PREFIX:F}=zl,W="wasm";localStorage.setItem("password_item_encryption_method",W),console.log(`Using encryption method for password: ${W}`);let ce;if(D.id){const ae={...D,lastUpdated:Date.now()};console.log(`Updating password with ID: ${D.id}, type: credential`),ce=await O(e.email,ae)}else{const ae={...D,id:`${F}${Date.now()}_${Math.random().toString(36).substring(2,9)}`,lastUpdated:Date.now()};console.log(`Creating new password with ID: ${ae.id}, type: credential`),ce=await L(e.email,ae)}if(ce){const ae=await q(e.email);p(ae),t({title:"Password Saved",description:"Your password has been saved securely."})}else throw new Error("Failed to save password")}catch(L){console.error("Error saving password:",L),t({title:"Save Failed",description:"Failed to save your password. Please try again.",variant:"destructive"})}},M=D=>{m(D),l(!0)},j=async D=>{if(e!=null&&e.email)try{const{deletePassword:L,getPasswords:O}=zl;if(await L(e.email,D)){const F=await O(e.email);p(F),t({title:"Password Deleted",description:"The password has been successfully deleted."})}else throw new Error("Failed to delete password")}catch(L){console.error("Error deleting password:",L),t({title:"Delete Failed",description:"Failed to delete your password. Please try again.",variant:"destructive"})}},P=async D=>{if(e!=null&&e.email)try{const{updatePassword:L,getPasswords:O}=zl,q=f.find(ce=>ce.id===D);if(!q)throw new Error("Password not found");const F={...q,favorite:!q.favorite};if(await L(e.email,F)){const ce=await O(e.email);p(ce)}else throw new Error("Failed to update password")}catch(L){console.error("Error updating password:",L),t({title:"Update Failed",description:"Failed to update your password. Please try again.",variant:"destructive"})}},b=D=>{navigator.clipboard.writeText(D).then(()=>{t({title:"Copied!",description:"Password copied to clipboard"})}).catch(L=>{console.error("Failed to copy:",L),t({title:"Copy failed",description:"Could not copy password to clipboard",variant:"destructive"})})},V=D=>{navigator.clipboard.writeText(D).then(()=>{t({title:"Copied!",description:"Username copied to clipboard"})}).catch(L=>{console.error("Failed to copy:",L),t({title:"Copy failed",description:"Could not copy username to clipboard",variant:"destructive"})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(fB,{isOpen:i,onClose:()=>l(!1),onSave:$,password:d}),a.jsx(mB,{isOpen:c,onClose:()=>u(!1),onUnlock:E,isUnlocking:v}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(Ke,{className:"border-l-4 border-l-blue-500",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"Total Passwords"}),a.jsx(ut,{children:"Stored in your password vault"})]}),a.jsx(Ue,{children:a.jsx("div",{className:"text-3xl font-bold",children:f.length})})]}),a.jsxs(Ke,{className:"border-l-4 border-l-yellow-500",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"Reused Passwords"}),a.jsx(ut,{children:"Passwords used in multiple accounts"})]}),a.jsxs(Ue,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"0"}),a.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"No reused passwords detected"})]})]}),a.jsxs(Ke,{className:"border-l-4 border-l-red-500",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"Weak Passwords"}),a.jsx(ut,{children:"Passwords that need strengthening"})]}),a.jsxs(Ue,{children:[a.jsx("div",{className:"text-3xl font-bold",children:f.filter(D=>D.strength==="weak").length}),f.filter(D=>D.strength==="weak").length>0&&a.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Consider updating these passwords"})]})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[a.jsxs("div",{className:"relative w-full md:w-1/2",children:[a.jsx(WN,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(De,{type:"text",placeholder:"Search passwords...",className:"pl-8",value:s,onChange:D=>o(D.target.value)})]}),a.jsxs(ie,{onClick:A,children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Add Password"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx(Ke,{className:"p-4 lg:col-span-1",children:a.jsx("div",{className:"flex flex-col space-y-2",children:I().map(D=>a.jsxs(ie,{variant:n===D.id?"default":"ghost",className:"justify-start",onClick:()=>r(D.id),children:[a.jsx(D.icon,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"flex-grow text-left",children:D.name}),a.jsx(As,{variant:n===D.id?"default":"outline",className:`ml-2 ${n===D.id?"bg-primary text-white":"text-foreground"}`,children:D.count})]},D.id))})}),a.jsxs(Ke,{className:"lg:col-span-3",children:[a.jsxs(st,{className:"pb-3",children:[a.jsx(ot,{children:((Z=S.find(D=>D.id===n))==null?void 0:Z.name)||"All Passwords"}),a.jsx(ut,{children:N.length===0?"No passwords found":`Showing ${N.length} of ${f.length} passwords`})]}),a.jsx(Ue,{children:x?a.jsxs("div",{className:"text-center py-10",children:[a.jsx(it,{className:"h-10 w-10 mx-auto text-muted-foreground animate-spin"}),a.jsx("h3",{className:"mt-4 text-lg font-medium",children:"Loading passwords..."}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Decrypting your secure password vault"})]}):N.length===0?a.jsxs("div",{className:"text-center py-10",children:[a.jsx(_f,{className:"h-10 w-10 mx-auto text-muted-foreground"}),a.jsx("h3",{className:"mt-4 text-lg font-medium",children:"No passwords found"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:s?"Try adjusting your search term":"Add a new password to get started"}),a.jsxs(ie,{onClick:A,className:"mt-4",children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Add Password"]})]}):a.jsx("div",{className:"space-y-4",children:N.map(D=>a.jsx(Ke,{className:"overflow-hidden",children:a.jsxs("div",{className:"flex p-4",children:[a.jsx("div",{className:"flex-shrink-0 mr-4",children:a.jsx("div",{className:"h-10 w-10 rounded bg-secondary flex items-center justify-center",children:D.category==="banking"?a.jsx(Xr,{className:"h-5 w-5"}):D.category==="shopping"?a.jsx(N_,{className:"h-5 w-5"}):D.category==="work"?a.jsx(x_,{className:"h-5 w-5"}):D.category==="social"?a.jsx(__,{className:"h-5 w-5"}):D.category==="travel"?a.jsx(k_,{className:"h-5 w-5"}):D.category==="entertainment"?a.jsx(b_,{className:"h-5 w-5"}):D.category==="email"?a.jsx(Ag,{className:"h-5 w-5"}):D.category==="utilities"?a.jsx(T_,{className:"h-5 w-5"}):a.jsx(S_,{className:"h-5 w-5"})})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("h3",{className:"text-lg font-medium",children:D.name}),D.favorite&&a.jsx(Kh,{className:"h-4 w-4 ml-2 text-yellow-400 fill-yellow-400"})]}),a.jsxs(Sx,{children:[a.jsx(bx,{asChild:!0,children:a.jsx(ie,{variant:"ghost",size:"icon",className:"h-8 w-8",children:a.jsx(VN,{className:"h-4 w-4"})})}),a.jsxs(Xm,{align:"end",children:[a.jsx(uT,{children:"Actions"}),a.jsx(Gc,{}),a.jsxs(Bn,{onClick:()=>M(D),children:[a.jsx(wz,{className:"h-4 w-4 mr-2"}),"Edit"]}),a.jsxs(Bn,{onClick:()=>P(D.id),children:[a.jsx(Kh,{className:"h-4 w-4 mr-2"}),D.favorite?"Remove from favorites":"Add to favorites"]}),a.jsxs(Bn,{onClick:()=>b(D.password),children:[a.jsx(ic,{className:"h-4 w-4 mr-2"}),"Copy password"]}),a.jsx(Gc,{}),a.jsxs(Bn,{onClick:()=>j(D.id),className:"text-red-500",children:[a.jsx(Sz,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),D.website&&a.jsxs("a",{href:D.website.startsWith("http")?D.website:`https://${D.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-muted-foreground hover:text-primary flex items-center",children:[a.jsx(S_,{className:"h-3 w-3 mr-1"}),D.website.replace(/^https?:\/\/(www\.)?/,""),a.jsx(UN,{className:"h-3 w-3 ml-1"})]}),a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-sm font-medium w-20",children:"Username:"}),a.jsx("span",{className:"text-sm flex-grow truncate",children:D.username}),a.jsx(ie,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>V(D.username),children:a.jsx(ic,{className:"h-3 w-3"})})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-sm font-medium w-20",children:"Password:"}),a.jsx("span",{className:"text-sm flex-grow font-mono truncate",children:g[D.id]?D.password:"••••••••••••"}),a.jsxs("div",{className:"flex",children:[a.jsx(ie,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>T(D.id),children:g[D.id]?a.jsx(ma,{className:"h-3 w-3"}):a.jsx(ha,{className:"h-3 w-3"})}),a.jsx(ie,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>b(D.password),children:a.jsx(ic,{className:"h-3 w-3"})})]})]})]}),a.jsx("div",{className:"mt-3 mb-1",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-full bg-secondary rounded-full h-1.5 mr-3",children:a.jsx("div",{className:`h-1.5 rounded-full ${IB(D.strength||"weak")}`,style:{width:D.strength==="weak"?"25%":D.strength==="medium"?"50%":D.strength==="strong"?"75%":"100%"}})}),a.jsx("span",{className:"text-xs text-muted-foreground",children:D.strength==="weak"?"Weak":D.strength==="medium"?"Medium":D.strength==="strong"?"Strong":"Very Strong"})]})})]})]})},D.id))})})]})]})]})}function AB({open:e,setOpen:t}){const[n]=(()=>{try{return[Bo().user]}catch(T){return console.error("Auth error in ProfileDialog:",T),[null]}})(),{toast:r}=dn(),[s,o]=w.useState((n==null?void 0:n.firstName)||""),[i,l]=w.useState(""),[c,u]=w.useState(""),[d,m]=w.useState(!1),[f,p]=w.useState(""),[v,h]=w.useState(""),[x,y]=w.useState(null),[g,_]=w.useState(!1),[S,E]=w.useState(!1),[A,I]=w.useState(!1),N=async()=>{if(!s.trim()){r({title:"Invalid input",description:"Name cannot be empty",variant:"destructive"});return}const T=c.trim().length>0;if(T){if(h(""),!i){h("Current password is required"),r({title:"Current password required",description:"Please enter your current password to set a new one",variant:"destructive"});return}if(c.length<8){h("New password must be at least 8 characters"),r({title:"Password too short",description:"New password must be at least 8 characters long",variant:"destructive"});return}if(c!==f){h("New passwords don't match"),r({title:"Password mismatch",description:"New password and confirmation don't match",variant:"destructive"});return}}r(T?{title:"Processing",description:"Updating profile and changing password..."}:{title:"Processing",description:"Updating profile information..."}),m(!0);try{if(T&&(n!=null&&n.email))try{const{getUserKeys:$,generateUserKeys:M,saveUserKeys:j,verifyPassword:P}=await oe(async()=>{const{getUserKeys:q,generateUserKeys:F,saveUserKeys:W,verifyPassword:ce}=await Promise.resolve().then(()=>tt);return{getUserKeys:q,generateUserKeys:F,saveUserKeys:W,verifyPassword:ce}},void 0),{validatePassword:b,reEncryptAllKeys:V}=await oe(async()=>{const{validatePassword:q,reEncryptAllKeys:F}=await import("./keyManagementService-CfhrZZ9i.js");return{validatePassword:q,reEncryptAllKeys:F}},[]),{syncWithExtension:Z}=await oe(async()=>{const{syncWithExtension:q}=await Promise.resolve().then(()=>gi);return{syncWithExtension:q}},void 0),{vaultService:D}=await oe(async()=>{const{vaultService:q}=await Promise.resolve().then(()=>Ot);return{vaultService:q}},void 0),{getData:L}=await oe(async()=>{const{getData:q}=await Promise.resolve().then(()=>p5);return{getData:q}},void 0),O=await $(n.email);if(!O)throw new Error("User keys not found");try{if(!await P(i,O.salt,O.hash))throw new Error("Current password is incorrect");await b(i,n.email)||console.warn("Secondary password validation failed"),await D.unlockVault(i)||console.warn("No vault found or unable to unlock vault with current password"),y({progress:0,message:"Starting password change..."});try{const ce=(G,te)=>{y({progress:G,message:te})},K={...await M(c),publicKey:O.publicKey,email:O.email,firstName:s,id:O.id,isVerified:O.isVerified};if(!await V(i,c,n.email,ce))throw new Error("Re-encryption failed");await j(K),D.lockVault();try{await Z()}catch(G){console.error("Extension sync error:",G)}t(!1),r({title:"Update successful",description:"Your profile and encryption keys have been updated. All your data is now encrypted with your new password."})}catch(ce){console.error("Key re-encryption failed:",ce),y(null),r({title:"Update failed",description:"Failed to re-encrypt your keys. Please try again.",variant:"destructive"});return}}catch(q){console.error("Password verification failed:",q),r({title:"Incorrect password",description:"Your current password is incorrect.",variant:"destructive"});return}}catch($){console.error("Crypto operation failed:",$),r({title:"Update failed",description:"An error occurred during the key update process. Please try again.",variant:"destructive"});return}else await new Promise($=>setTimeout($,500)),t(!1),r({title:"Update successful",description:"Your profile has been updated"})}catch($){console.error("Profile update error:",$),r({title:"Update failed",description:"An error occurred while updating your profile",variant:"destructive"})}finally{m(!1)}};return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsx(Gt,{className:"sm:max-w-[425px]",children:a.jsxs("form",{onSubmit:T=>{T.preventDefault(),N()},children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Profile Settings"}),a.jsx(Qt,{children:"Update your profile or change your password."})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ct,{htmlFor:"firstName",className:"text-right",children:"Name"}),a.jsx(De,{id:"firstName",value:s,onChange:T=>o(T.target.value),className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ct,{htmlFor:"currentPassword",className:"text-right",children:"Current Password"}),a.jsxs("div",{className:"col-span-3 relative",children:[a.jsx(De,{id:"currentPassword",type:g?"text":"password",value:i,onChange:T=>l(T.target.value),className:"pr-10"}),a.jsx("button",{type:"button",onClick:()=>_(!g),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-500",tabIndex:-1,children:g?a.jsx(ma,{className:"h-4 w-4"}):a.jsx(ha,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ct,{htmlFor:"newPassword",className:"text-right",children:"New Password"}),a.jsxs("div",{className:"col-span-3 relative",children:[a.jsx(De,{id:"newPassword",type:S?"text":"password",value:c,onChange:T=>u(T.target.value),className:"pr-10"}),a.jsx("button",{type:"button",onClick:()=>E(!S),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-500",tabIndex:-1,children:S?a.jsx(ma,{className:"h-4 w-4"}):a.jsx(ha,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ct,{htmlFor:"confirmPassword",className:"text-right",children:"Confirm Password"}),a.jsxs("div",{className:"col-span-3 relative",children:[a.jsx(De,{id:"confirmPassword",type:A?"text":"password",value:f,onChange:T=>p(T.target.value),className:"pr-10"}),a.jsx("button",{type:"button",onClick:()=>I(!A),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-500",tabIndex:-1,children:A?a.jsx(ma,{className:"h-4 w-4"}):a.jsx(ha,{className:"h-4 w-4"})})]})]}),v&&a.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:a.jsx("div",{className:"col-start-2 col-span-3 text-sm text-red-500",children:v})}),x&&a.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:a.jsx("div",{className:"col-start-2 col-span-3",children:a.jsx(dB,{progress:x.progress,message:x.message})})}),a.jsx("div",{className:"grid grid-cols-4 items-center gap-4",children:a.jsx("div",{className:"col-start-2 col-span-3",children:a.jsx(Mt,{className:"py-2 px-3 bg-blue-50 border-blue-200",children:a.jsx(zt,{className:"text-xs",children:"Changing your password re-encrypts your private keys. This is a local operation, MATA does not have access to your private keys."})})})})]}),a.jsx(cn,{children:a.jsxs(ie,{type:"submit",disabled:d,children:[d?a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save changes"]})})]})})})}function PB({open:e,setOpen:t}){return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"sm:max-w-[425px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Connected Devices"}),a.jsx(Qt,{children:"View and manage devices connected to your MATA account."})]}),a.jsx("div",{className:"py-6",children:a.jsx(Ke,{className:"bg-muted/50 p-4",children:a.jsx("p",{className:"text-center text-muted-foreground",children:"Device management is a part of the Home Vault Era and will be available in a future update."})})}),a.jsx(cn,{children:a.jsx(ie,{variant:"outline",onClick:()=>t(!1),children:"Close"})})]})})}function DB(){const[{logoutMutation:e,user:t},n]=(()=>{try{return[Bo(),null]}catch(S){return console.error("Auth context error in Navbar:",S),[{logoutMutation:null,user:null},S]}})(),{toast:r}=dn();Pv();const[s,o]=w.useState(!1),[i,l]=w.useState(!1),[c,u]=w.useState(!1),[d,m]=w.useState(!1),[f,p]=w.useState(!1),{did:v,publicKey:h,isLoading:x,refreshDID:y}=c2();w.useEffect(()=>{t!=null&&t.id&&y()},[t==null?void 0:t.id,y]);const g=()=>{h&&l2(h,()=>{p(!0),r({title:"Copied!",description:"DID copied to clipboard"}),setTimeout(()=>{p(!1)},2e3)},S=>{console.error("Failed to copy:",S),r({title:"Copy failed",description:"Could not copy DID to clipboard",variant:"destructive"})})},_=()=>{if(typeof window<"u"){const S=new CustomEvent("setActiveTab",{detail:{tab:"wallet"}});window.dispatchEvent(S)}};return a.jsx("nav",{className:"bg-background border-b shadow-sm fixed top-0 left-0 right-0 z-50",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex h-16 items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl font-bold text-black cursor-pointer hover:opacity-80 transition-opacity",onClick:_,children:"MATA"}),h?a.jsxs("div",{className:"ml-4 flex items-center space-x-1 bg-tertiary/10 rounded-xl py-1 px-2 max-w-[160px] overflow-hidden",children:[a.jsx("span",{className:"text-xs text-tertiary font-mono whitespace-nowrap overflow-hidden text-ellipsis",children:v||i2(h)}),a.jsx(Cu,{children:a.jsxs(Nu,{children:[a.jsx(ju,{asChild:!0,children:a.jsx(ie,{variant:"ghost",size:"icon",onClick:g,className:"h-6 w-6 rounded-full flex-shrink-0 p-1 hover:bg-tertiary/20",children:f?a.jsx(Da,{className:"h-3.5 w-3.5 text-green-500"}):a.jsx(ic,{className:"h-3.5 w-3.5 text-tertiary"})})}),a.jsx(wl,{children:a.jsx("p",{children:"Copy full DID"})})]})})]}):a.jsx("span",{className:"ml-4 text-sm text-muted-foreground font-mono",children:x?a.jsx(it,{className:"h-4 w-4 animate-spin"}):a.jsx("span",{className:"text-xs",children:"No DID available"})})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(Rf,{})}),a.jsx("div",{className:"hidden md:block",children:a.jsx(E8,{})}),a.jsxs("p",{className:"text-sm font-medium text-muted-foreground hidden md:block mr-2",children:["Set yourself free, ",a.jsx("span",{className:"text-primary",children:t==null?void 0:t.firstName})]}),a.jsxs(Sx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(ie,{variant:"outline",size:"sm",children:[a.jsx(yz,{className:"h-4 w-4 mr-2"}),"Settings",a.jsx(Tm,{className:"h-4 w-4 ml-2"})]})}),a.jsxs(Xm,{align:"end",children:[a.jsxs(Bn,{onClick:()=>o(!0),children:[a.jsx(qN,{className:"h-4 w-4 mr-2"}),"Profile"]}),a.jsxs(Bn,{onClick:()=>l(!0),children:[a.jsx(xz,{className:"h-4 w-4 mr-2"}),"Devices"]}),a.jsxs(Bn,{onClick:()=>{const S="extension-dialog";let E=document.getElementById(S);E||(E=document.createElement("div"),E.id=S,E.style.display="none",document.body.appendChild(E)),new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});const A=new CustomEvent("open-extension-dialog");window.dispatchEvent(A)},children:[a.jsx(Pg,{className:"h-4 w-4 mr-2"}),"Extension"]}),a.jsxs(Bn,{onClick:()=>u(!0),children:[a.jsx(ls,{className:"h-4 w-4 mr-2"}),"Backup Keys"]}),a.jsxs(Bn,{onClick:()=>m(!0),children:[a.jsx(Xr,{className:"h-4 w-4 mr-2"}),"Payment Methods"]}),a.jsx(Gc,{}),a.jsxs(Bn,{onClick:()=>e&&e.mutate(),disabled:!e||!!e.isPending,children:[e&&e.isPending?a.jsx(it,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(dz,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),a.jsx(AB,{open:s,setOpen:o}),a.jsx(PB,{open:i,setOpen:l}),a.jsx(F8,{open:c,setOpen:u,onDownload:async()=>{const{createLocalStorageBackup:S,downloadBlob:E}=await oe(async()=>{const{createLocalStorageBackup:I,downloadBlob:N}=await import("./backup-service-B_Di7C96.js");return{createLocalStorageBackup:I,downloadBlob:N}},[]),A=await S();E(A.blob,A.filename),r({title:"Backup downloaded",description:"Your secure backup has been downloaded successfully. Keep it safe!"})},onError:S=>{r({title:"Download failed",description:`Could not download your backup. ${S instanceof Error?S.message:"Please try again."}`,variant:"destructive"})}}),a.jsx(uB,{open:d,setOpen:m}),a.jsx(L8,{})]})]})})})}function RB({collapsed:e,setCollapsed:t,activeItem:n,setActiveItem:r}){const s=OA(),[o,i]=w.useState(!1),l=[{id:"wallet",icon:Ez,label:"Wallet & Identity",available:!0},{id:"home",icon:iz,label:"Home Companion",available:!1},{id:"passwords",icon:_f,label:"Passwords",available:!0},{id:"contacts",icon:bv,label:"Contacts",available:!0},{id:"photos",icon:lz,label:"Photos",available:!1},{id:"movies",icon:sz,label:"Movies",available:!1},{id:"music",icon:mz,label:"Music",available:!1},{id:"documents",icon:_v,label:"Documents",available:!1},{id:"apps",icon:cz,label:"My Apps",available:!1}],c=e&&o||!e;return s?a.jsxs("div",{className:ye("fixed top-16 bottom-0 left-0 z-40 flex flex-col w-64 bg-white border-r shadow-lg transition-transform duration-300",e?"transform -translate-x-full":"transform translate-x-0"),children:[a.jsxs("div",{className:"flex items-center justify-between h-14 px-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold text-black",children:"MATA Menu"}),a.jsx(ie,{variant:"ghost",size:"icon",onClick:()=>t(!0),className:"text-quaternary hover:text-tertiary hover:bg-tertiary/5",children:a.jsx(zc,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto py-4",children:a.jsx("nav",{className:"px-2 space-y-1",children:l.map(u=>a.jsxs(ie,{variant:n===u.id?"tertiary":"ghost",className:ye("w-full justify-start mb-1 rounded-md",!u.available&&"opacity-70 cursor-default",n===u.id?"bg-tertiary/10 text-tertiary hover:bg-tertiary/20":"text-quaternary hover:bg-tertiary/5 hover:text-tertiary-dark"),onClick:()=>u.available&&r(u.id),disabled:!u.available,children:[a.jsx(u.icon,{className:ye("h-5 w-5 mr-3",n===u.id?"text-tertiary":"text-quaternary")}),a.jsxs("div",{className:"flex flex-col items-start",children:[a.jsx("span",{children:u.label}),!u.available&&a.jsx("span",{className:"text-xs text-quaternary",children:"Coming Soon"})]})]},u.id))})})]}):a.jsx("div",{className:"fixed left-0 top-16 bottom-0 border-r bg-white z-40",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:a.jsxs("div",{className:ye("h-full flex flex-col py-4 transition-all duration-300 overflow-hidden",c?"w-60":"w-16"),children:[a.jsx("nav",{className:"flex-1 px-2 space-y-1",children:l.map(u=>a.jsx(Cu,{delayDuration:0,children:a.jsxs(Nu,{children:[a.jsx(ju,{asChild:!0,children:a.jsxs(ie,{variant:n===u.id?"tertiary":"ghost",className:ye("w-full justify-start mb-1 rounded-md",!c&&"justify-center p-0 h-12",!u.available&&"opacity-70 cursor-default",n===u.id?"bg-tertiary/10 text-tertiary hover:bg-tertiary/20":"text-quaternary hover:bg-tertiary/5 hover:text-tertiary-dark"),onClick:()=>u.available&&r(u.id),disabled:!u.available,children:[a.jsx(u.icon,{className:ye("h-5 w-5",c&&"mr-3",n===u.id?"text-tertiary":"text-quaternary")}),c&&a.jsxs("div",{className:"flex flex-col items-start",children:[a.jsx("span",{children:u.label}),!u.available&&a.jsx("span",{className:"text-xs text-quaternary",children:"Coming Soon"})]})]})}),!c&&a.jsx(wl,{side:"right",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("p",{children:u.label}),!u.available&&a.jsx("span",{className:"text-xs text-quaternary",children:"Coming Soon"})]})})]})},u.id))}),a.jsx("div",{className:"px-2",children:a.jsx(ie,{variant:"ghost",size:"icon",className:"w-full mb-4 mt-6 text-quaternary hover:text-tertiary hover:bg-tertiary/5",onClick:()=>t(!e),children:e?a.jsx(Tm,{className:"h-5 w-5"}):a.jsx(KN,{className:"h-5 w-5"})})})]})})}function $B({user:e}){const{toast:t}=dn();w.useState("bank-accounts");const[n,r]=w.useState(!1),{did:s,publicKey:o,isLoading:i,refreshDID:l}=c2();w.useEffect(()=>{e!=null&&e.id&&l()},[e==null?void 0:e.id,l]);const c=()=>{o&&l2(o,()=>{r(!0),t({title:"Copied!",description:"DID copied to clipboard"}),setTimeout(()=>{r(!1)},2e3)},y=>{console.error("Failed to copy:",y),t({title:"Copy failed",description:"Could not copy DID to clipboard",variant:"destructive"})})},[u,d]=w.useState(!1),[m,f]=w.useState(null),p=()=>{f(null),d(!0)},v=y=>{d(!1),t({title:"Bank Account Added",description:`${y.accountName||y.account_name} has been successfully added to your wallet.`})},[h,x]=w.useState(0);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(Ke,{className:"border-l-4 border-l-green-500",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"Cash Balance"}),a.jsx(ut,{children:"Available in your linked banks"})]}),a.jsx(Ue,{children:a.jsx("div",{className:"text-3xl font-bold",children:Fd(h)})})]}),a.jsxs(Ke,{className:"border-l-4 border-l-blue-500",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"$MATA Balance"}),a.jsx(ut,{children:"Available $MATA tokens"})]}),a.jsxs(Ue,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"0 $MATA"}),a.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Coming soon"})]})]}),a.jsxs(Ke,{className:"border-l-4 border-l-tertiary",children:[a.jsxs(st,{className:"pb-2",children:[a.jsx(ot,{className:"text-lg font-medium",children:"Decentralized ID"}),a.jsx(ut,{children:"Your unique MATA identifier"})]}),a.jsxs(Ue,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"font-mono text-xs sm:text-sm bg-tertiary/5 p-2.5 rounded-xl flex-1 overflow-x-auto text-tertiary",children:i?a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(it,{className:"h-4 w-4 animate-spin text-muted-foreground"}),a.jsx("span",{className:"text-muted-foreground",children:"Loading DID..."})]}):o?i2(o):a.jsx("span",{className:"text-muted-foreground",children:"Not available"})}),a.jsx(ie,{variant:"outline",size:"icon",onClick:c,disabled:!o||i,className:"flex-shrink-0 h-10 w-10 rounded-full border border-gray-200 bg-white text-tertiary hover:bg-tertiary/5 disabled:opacity-50",children:n?a.jsx(Da,{className:"h-4 w-4 text-green-500"}):a.jsx(ic,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"text-xs text-quaternary mt-3",children:"Use your DID to authenticate online"})]})]})]}),a.jsxs(Ko,{defaultValue:"bank-accounts",className:"w-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs(Us,{children:[a.jsx(Je,{value:"bank-accounts",children:"Bank Accounts"}),a.jsx(Je,{value:"crypto",disabled:!0,children:"Crypto Wallets"}),a.jsx(Je,{value:"payment-history",children:"Payment History"})]}),a.jsxs(ie,{variant:"tertiary",onClick:p,className:"rounded-md",children:[a.jsx(Xr,{className:"h-4 w-4 mr-2"}),"Add Bank"]})]}),a.jsx(nt,{value:"bank-accounts",className:"mt-0",children:e&&e.id&&a.jsx(S8,{userId:e.id})}),a.jsx(nt,{value:"payment-history",className:"mt-0",children:a.jsxs(Ke,{children:[a.jsxs(st,{className:"pb-0",children:[a.jsx(ot,{children:"Payment History"}),a.jsx(ut,{children:"View your recent payments and subscriptions"})]}),a.jsx(Ue,{className:"pt-6",children:a.jsx(bU,{user:e})})]})})]}),e&&a.jsx(Bd,{isOpen:u,onClose:()=>d(!1),onSuccess:v,account:m})]})}function OB({user:e}){const{toast:t}=dn();w.useState("all");const[n,r]=w.useState(""),[s,o]=w.useState(!1),[i,l]=w.useState(!1),[c,u]=w.useState(null),[d,m]=w.useState([]),[f,p]=w.useState(""),[v,h]=w.useState(!1),[x,y]=w.useState(!1),[g,_]=w.useState(!1);w.useEffect(()=>{(async()=>{if(e!=null&&e.email)try{const{vaultService:T}=await oe(async()=>{const{vaultService:q}=await Promise.resolve().then(()=>Ot);return{vaultService:q}},void 0);T.isInitialized()||await T.initialize(),console.log(`Setting contacts vault context for user: ${e.email}`),localStorage.setItem("current_vault_context",e.email),localStorage.setItem("session_email",e.email);const $=`encryption_pref_${e.email.replace(/[@.]/g,"_")}`;let M=localStorage.getItem($);if(M?console.log(`Found encryption preference for ${e.email}: ${M}`):(M=localStorage.getItem("use_webcrypto")==="true"?"webcrypto":"standard",localStorage.setItem($,M),console.log(`Setting initial encryption preference for ${e.email}: ${M}`)),localStorage.setItem("user_encryption_method",M),!T.isUnlocked()){l(!0);return}const j=e.email.toLowerCase(),b=`user_${j.replace(/[@.]/g,"_")}_contacts`,V=await T.getVaults();console.log("Available vaults for contacts:",V.map(q=>({id:q.id,type:q.type})));const Z=V.find(q=>q.id===b||q.id===`contacts-${j}`||q.type==="contacts"&&q.id.includes(j)),D=(Z==null?void 0:Z.id)||b;localStorage.setItem("contacts_vault_namespace",D),Z?console.log(`Found existing contacts vault: ${D}`):(console.log(`Creating new contacts vault with ID: ${D}`),await T.createNewVault("Contacts","contacts",D)),console.log(`Loading contacts from vault: ${D}`);const L=await T.getItems(D);console.log(`Found ${L.length} contacts in vault`);const O=L.map(q=>{var F;return{...q.data,id:((F=q.data)==null?void 0:F.id)||q.id}});m(O)}catch(T){console.error("Error loading contacts:",T);try{const{vaultService:$}=await oe(async()=>{const{vaultService:M}=await Promise.resolve().then(()=>Ot);return{vaultService:M}},void 0);$.isInitialized()||await $.initialize(),$.isUnlocked()?t({title:"Error",description:"Failed to load contacts. Please try again.",variant:"destructive"}):l(!0)}catch($){console.error("Vault service error:",$),t({title:"Error",description:"Could not initialize secure storage. Please refresh and try again.",variant:"destructive"})}}})()},[e==null?void 0:e.email]);const S=async N=>{var T,$;if(e!=null&&e.email)try{const{vaultService:M}=await oe(async()=>{const{vaultService:D}=await Promise.resolve().then(()=>Ot);return{vaultService:D}},void 0);M.isInitialized()||await M.initialize(),console.log(`Setting contacts vault context for user: ${e.email}`),localStorage.setItem("current_vault_context",e.email),localStorage.setItem("session_email",e.email);const j=`encryption_pref_${e.email.replace(/[@.]/g,"_")}`;let P=localStorage.getItem(j);if(P||(P=localStorage.getItem("use_webcrypto")==="true"?"webcrypto":"standard",localStorage.setItem(j,P)),localStorage.setItem("user_encryption_method",P),console.log(`Using encryption method for contact add: ${P}`),!localStorage.getItem("contacts_vault_namespace")){const O=`user_${e.email.toLowerCase().replace(/[@.]/g,"_")}_contacts`;console.log(`No vault ID in localStorage, using standardized ID: ${O}`),localStorage.setItem("contacts_vault_namespace",O)}const V=localStorage.getItem("contacts_vault_namespace")||`contacts-${e.email.toLowerCase()}`;console.log(`Adding contact to vault: ${V}`);const Z={id:crypto.randomUUID(),...N,createdAt:Date.now(),updatedAt:Date.now()};await M.addItem(V,Z.name,"contact",Z,{description:`Contact information for ${Z.name}`,tags:["contact","encrypted"],searchTerms:[Z.name.toLowerCase(),((T=Z.email)==null?void 0:T.toLowerCase())||"",(($=Z.company)==null?void 0:$.toLowerCase())||""].filter(Boolean)}),m(D=>[...D,Z]),o(!1),t({title:"Contact added",description:"New contact has been saved securely."})}catch(M){console.error("Error adding contact:",M),t({title:"Error",description:"Failed to add contact. Please try again.",variant:"destructive"})}},E=async N=>{var T,$;if(!(!(e!=null&&e.email)||!c)){_(!0);try{const{vaultService:M}=await oe(async()=>{const{vaultService:Z}=await Promise.resolve().then(()=>Ot);return{vaultService:Z}},void 0);M.isInitialized()||await M.initialize(),console.log(`Setting contacts vault context for user: ${e.email}`),localStorage.setItem("current_vault_context",e.email),localStorage.setItem("session_email",e.email);const j=`encryption_pref_${e.email.replace(/[@.]/g,"_")}`;let P=localStorage.getItem(j);P||(P=localStorage.getItem("use_webcrypto")==="true"?"webcrypto":"standard",localStorage.setItem(j,P)),localStorage.setItem("user_encryption_method",P),console.log(`Using encryption method for contact edit: ${P}`);const b=localStorage.getItem("contacts_vault_namespace")||`contacts-${e.email.toLowerCase()}`;console.log(`Editing contact in vault: ${b}, contact ID: ${c.id}`),await M.deleteItem(b,c.id);const V={...c,...N,updatedAt:Date.now()};await M.addItem(b,V.name,"contact",V,{description:`Contact information for ${V.name}`,tags:["contact","encrypted"],searchTerms:[V.name.toLowerCase(),((T=V.email)==null?void 0:T.toLowerCase())||"",(($=V.company)==null?void 0:$.toLowerCase())||""].filter(Boolean)}),m(Z=>Z.map(D=>D.id===c.id?V:D)),y(!1),u(null),t({title:"Contact updated",description:"Contact information has been updated securely."})}catch(M){console.error("Error updating contact:",M),t({title:"Error",description:"Failed to update contact. Please try again.",variant:"destructive"})}finally{_(!1)}}},A=async N=>{if(e!=null&&e.email)try{const{vaultService:T}=await oe(async()=>{const{vaultService:P}=await Promise.resolve().then(()=>Ot);return{vaultService:P}},void 0);T.isInitialized()||await T.initialize(),console.log(`Setting contacts vault context for user: ${e.email}`),localStorage.setItem("current_vault_context",e.email),localStorage.setItem("session_email",e.email);const $=`encryption_pref_${e.email.replace(/[@.]/g,"_")}`;let M=localStorage.getItem($);M||(M=localStorage.getItem("use_webcrypto")==="true"?"webcrypto":"standard",localStorage.setItem($,M)),localStorage.setItem("user_encryption_method",M),console.log(`Using encryption method for contact delete: ${M}`);const j=localStorage.getItem("contacts_vault_namespace")||`contacts-${e.email.toLowerCase()}`;console.log(`Deleting contact from vault: ${j}, contact ID: ${N}`),await T.deleteItem(j,N),m(P=>P.filter(b=>b.id!==N)),t({title:"Contact deleted",description:"Contact has been removed from your list."})}catch(T){console.error("Error deleting contact:",T),t({title:"Error",description:"Failed to delete contact. Please try again.",variant:"destructive"})}},I=d.filter(N=>{var $,M,j;const T=n.toLowerCase();return N.name.toLowerCase().includes(T)||(($=N.email)==null?void 0:$.toLowerCase().includes(T))||((M=N.company)==null?void 0:M.toLowerCase().includes(T))||((j=N.phone)==null?void 0:j.toLowerCase().includes(T))});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[a.jsxs("div",{className:"relative w-full sm:w-96",children:[a.jsx(WN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(De,{placeholder:"Search contacts...",className:"pl-10",value:n,onChange:N=>r(N.target.value)})]}),a.jsxs(ie,{onClick:()=>o(!0),className:"w-full sm:w-auto",children:[a.jsx(I_,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[I.map(N=>a.jsxs(Ke,{className:"cursor-pointer hover:ring-2 hover:ring-primary/20 transition-all",onClick:()=>{u(N),y(!0)},children:[a.jsx(st,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:N.avatar?a.jsx("img",{src:N.avatar,alt:N.name,className:"h-12 w-12 rounded-full object-cover"}):a.jsx(qN,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx(ot,{className:"text-lg",children:N.name}),N.company&&a.jsxs(ut,{className:"flex items-center mt-1",children:[a.jsx(Y4,{className:"h-3 w-3 mr-1"}),N.company]})]})]})}),a.jsx(Ue,{children:a.jsxs("div",{className:"space-y-2 mt-2",children:[N.email&&a.jsxs("div",{className:"flex items-center text-sm mt-1",children:[a.jsx(Ag,{className:"h-4 w-4 mr-2 text-muted-foreground"}),a.jsx("a",{href:`mailto:${N.email}`,className:"text-primary hover:underline text-left",onClick:T=>T.stopPropagation(),children:N.email})]}),N.phone&&a.jsxs("div",{className:"flex items-center text-sm mt-1 font-medium",children:[a.jsx(pz,{className:"h-4 w-4 mr-2 text-muted-foreground"}),a.jsx("a",{href:`tel:${N.phone}`,className:"text-primary hover:underline",onClick:T=>T.stopPropagation(),children:N.phone})]}),N.address&&a.jsxs("div",{className:"flex items-center text-sm mt-1",children:[a.jsx(fz,{className:"h-4 w-4 mr-2 text-muted-foreground"}),a.jsx("span",{className:"text-left",children:N.address})]}),N.notes&&a.jsxs("div",{className:"flex items-start text-sm mt-3 pt-3 border-t border-border",children:[a.jsx(_v,{className:"h-4 w-4 mr-2 text-muted-foreground mt-0.5"}),a.jsx("span",{className:"text-muted-foreground line-clamp-2 text-left",children:N.notes})]})]})})]},N.id)),d.length===0&&a.jsx(Ke,{className:"col-span-full",children:a.jsxs(Ue,{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"rounded-full bg-primary/10 p-3 mb-4",children:a.jsx(bv,{className:"h-10 w-10 text-primary/80"})}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No contacts yet"}),a.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:"Start building your encrypted contact list. Your contacts are stored securely and only accessible by you."}),a.jsxs(ie,{onClick:()=>o(!0),children:[a.jsx(I_,{className:"h-4 w-4 mr-2"}),"Add Your First Contact"]})]})})]}),a.jsx(nn,{open:s,onOpenChange:o,children:a.jsxs(Gt,{className:"sm:max-w-[480px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Add Contact"}),a.jsx(Qt,{children:"Add a new contact to your encrypted contacts list."})]}),a.jsxs("form",{onSubmit:N=>{N.preventDefault();const T=new FormData(N.currentTarget);S({name:T.get("name"),email:T.get("email"),phone:T.get("phone"),company:T.get("company"),address:T.get("address"),notes:T.get("notes")})},children:[a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"name",children:"Name"}),a.jsx(De,{id:"name",name:"name",required:!0})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"email",children:"Email"}),a.jsx(De,{id:"email",name:"email",type:"email"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"phone",children:"Phone"}),a.jsx(De,{id:"phone",name:"phone",type:"tel"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"company",children:"Company"}),a.jsx(De,{id:"company",name:"company"})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"address",children:"Address"}),a.jsx(De,{id:"address",name:"address"})]})]}),a.jsxs("div",{className:"space-y-1.5 mt-2",children:[a.jsx(ct,{htmlFor:"notes",children:"Notes"}),a.jsx("textarea",{id:"notes",name:"notes",className:"w-full min-h-[100px] rounded-md border border-input bg-background p-2",placeholder:"Add notes about this contact...",onKeyDown:N=>{N.key==="Enter"&&!N.shiftKey&&N.stopPropagation()}})]})]}),a.jsx(cn,{children:a.jsx(ie,{type:"submit",variant:"tertiary",className:"rounded-md",children:"Add Contact"})})]})]})}),a.jsx(nn,{open:x,onOpenChange:y,children:a.jsxs(Gt,{className:"sm:max-w-[480px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Edit Contact"}),a.jsx(Qt,{children:"Update contact information in your encrypted contacts list."})]}),c&&a.jsxs("form",{onSubmit:N=>{N.preventDefault();const T=new FormData(N.currentTarget);E({name:T.get("name"),email:T.get("email"),phone:T.get("phone"),company:T.get("company"),address:T.get("address"),notes:T.get("notes")})},children:[a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"edit-name",children:"Name"}),a.jsx(De,{id:"edit-name",name:"name",defaultValue:c.name,required:!0})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"edit-email",children:"Email"}),a.jsx(De,{id:"edit-email",name:"email",type:"email",defaultValue:c.email||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"edit-phone",children:"Phone"}),a.jsx(De,{id:"edit-phone",name:"phone",type:"tel",defaultValue:c.phone||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"edit-company",children:"Company"}),a.jsx(De,{id:"edit-company",name:"company",defaultValue:c.company||""})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"edit-address",children:"Address"}),a.jsx(De,{id:"edit-address",name:"address",defaultValue:c.address||""})]})]}),a.jsxs("div",{className:"space-y-1.5 mt-2",children:[a.jsx(ct,{htmlFor:"edit-notes",children:"Notes"}),a.jsx("textarea",{id:"edit-notes",name:"notes",className:"w-full min-h-[100px] rounded-md border border-input bg-background p-2",placeholder:"Add notes about this contact...",defaultValue:c.notes||"",onKeyDown:N=>{N.key==="Enter"&&!N.shiftKey&&N.stopPropagation()}})]})]}),a.jsxs(cn,{children:[a.jsxs(ie,{type:"button",variant:"destructive",onClick:()=>{A(c.id),y(!1)},className:"mr-auto",children:[a.jsx(Sv,{className:"h-4 w-4 mr-2"}),"Delete"]}),a.jsxs(ie,{type:"submit",variant:"tertiary",className:"rounded-md",disabled:g,children:[g&&a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})]})}),a.jsx(nn,{open:i,onOpenChange:l,children:a.jsxs(Gt,{className:"sm:max-w-[480px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Unlock Your Vault"}),a.jsx(Qt,{children:"Enter your password to access your encrypted contacts."})]}),a.jsxs("form",{onSubmit:async N=>{N.preventDefault(),h(!0);try{const{vaultService:T}=await oe(async()=>{const{vaultService:M}=await Promise.resolve().then(()=>Ot);return{vaultService:M}},void 0);if(T.isInitialized()||await T.initialize(),await T.unlockVault(f)){l(!1);const j=(await T.getVaults()).find(D=>D.type==="contacts"),P=e.email.toLowerCase(),b=(j==null?void 0:j.id)||`contacts-${P}`;j||await T.createNewVault("Contacts","contacts",b);const Z=(await T.getItems(b)).map(D=>({...D.data,id:D.id}));m(Z),t({title:"Vault Unlocked",description:"Your contacts are now accessible."})}else t({title:"Error",description:"Incorrect password. Please try again.",variant:"destructive"})}catch(T){console.error("Error unlocking vault:",T),t({title:"Error",description:"Failed to unlock vault. Please try again.",variant:"destructive"})}finally{h(!1)}},children:[a.jsx("div",{className:"space-y-4 py-4",children:a.jsxs("div",{className:"space-y-1.5",children:[a.jsx(ct,{htmlFor:"password",children:"Password"}),a.jsx(De,{id:"password",type:"password",value:f,onChange:N=>p(N.target.value),required:!0})]})}),a.jsx(cn,{children:a.jsxs(ie,{type:"submit",variant:"tertiary",className:"rounded-md",disabled:v,children:[v&&a.jsx(it,{className:"mr-2 h-4 w-4 animate-spin"}),"Unlock Vault"]})})]})]})})]})}function MB(){const[e,t]=(()=>{try{return[Bo().user,null]}catch(m){return console.error("Auth context error:",m),[null,m]}})(),{isOffline:n,hasPendingChanges:r}=Pv(),s=OA(),[o,i]=w.useState(!s),[l,c]=w.useState("wallet"),[u,d]=w.useState(!1);return w.useEffect(()=>{const m=f=>{f.detail&&f.detail.tab&&c(f.detail.tab)};return window.addEventListener("setActiveTab",m),()=>{window.removeEventListener("setActiveTab",m)}},[]),a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(DB,{}),n&&a.jsxs("div",{className:"fixed top-16 left-0 right-0 bg-red-50 text-red-800 py-2 px-4 z-40 flex items-center justify-center space-x-2 text-sm border-b border-red-200",children:[a.jsx(GN,{className:"h-4 w-4"}),a.jsx("span",{children:"You're currently offline. Your vault data is still accessible and secure."})]}),!n&&r&&a.jsxs("div",{className:"fixed top-16 left-0 right-0 bg-amber-50 text-amber-800 py-2 px-4 z-40 flex items-center justify-center space-x-2 text-sm border-b border-amber-200",children:[a.jsx(FN,{className:"h-4 w-4"}),a.jsx("span",{children:"Syncing changes made while offline..."})]}),s&&a.jsx("div",{className:"fixed bottom-4 left-4 z-50",children:a.jsx(ie,{variant:"default",size:"icon",className:"rounded-full h-12 w-12 shadow-lg",onClick:()=>i(!1),children:a.jsx(KN,{className:"h-5 w-5"})})}),a.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:a.jsx(ie,{variant:"outline",size:"sm",className:"rounded-md shadow-lg",onClick:()=>d(!u),children:u?"Hide Debug":"Debug Storage"})}),a.jsx(nn,{open:u,onOpenChange:d,children:a.jsxs(Gt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Storage Debug Tool"}),a.jsx(Qt,{children:"Inspect localStorage, sessionStorage and IndexedDB content"})]}),a.jsx(b8,{})]})}),a.jsx(RB,{collapsed:o,setCollapsed:i,activeItem:l,setActiveItem:c}),a.jsxs("main",{className:ye("transition-all duration-300 py-12 min-h-screen pt-28",s?"px-4":o?"ml-16 px-8":"ml-60 px-8"),children:[a.jsx("div",{className:"mb-6",children:a.jsx(z8,{})}),l==="wallet"&&a.jsx($B,{user:e}),l==="contacts"&&a.jsx(OB,{user:e}),l==="passwords"&&a.jsx(TB,{user:e}),l!=="wallet"&&l!=="contacts"&&l!=="passwords"&&a.jsxs(Ke,{children:[a.jsx(st,{children:a.jsx(ot,{children:"Coming Soon"})}),a.jsxs(Ue,{children:[a.jsx("p",{className:"text-muted-foreground",children:"This feature is not yet available."}),a.jsx("p",{className:"mt-4 text-muted-foreground",children:"Please check back later or use the available sections."})]})]})]})]})}const ue=Symbol.for("drizzle:entityKind");function on(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,ue))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let n=Object.getPrototypeOf(e).constructor;if(n)for(;n;){if(ue in n&&n[ue]===t[ue])return!0;n=Object.getPrototypeOf(n)}return!1}var LS;LS=ue;class il{constructor(t,n){Y(this,"name");Y(this,"keyAsName");Y(this,"primary");Y(this,"notNull");Y(this,"default");Y(this,"defaultFn");Y(this,"onUpdateFn");Y(this,"hasDefault");Y(this,"isUnique");Y(this,"uniqueName");Y(this,"uniqueType");Y(this,"dataType");Y(this,"columnType");Y(this,"enumValues");Y(this,"generated");Y(this,"generatedIdentity");Y(this,"config");this.table=t,this.config=n,this.name=n.name,this.keyAsName=n.keyAsName,this.notNull=n.notNull,this.default=n.default,this.defaultFn=n.defaultFn,this.onUpdateFn=n.onUpdateFn,this.hasDefault=n.hasDefault,this.primary=n.primaryKey,this.isUnique=n.isUnique,this.uniqueName=n.uniqueName,this.uniqueType=n.uniqueType,this.dataType=n.dataType,this.columnType=n.columnType,this.generated=n.generated,this.generatedIdentity=n.generatedIdentity}mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}Y(il,LS,"Column");var FS;FS=ue;class gP{constructor(t,n,r){Y(this,"config");Y(this,"$default",this.$defaultFn);Y(this,"$onUpdate",this.$onUpdateFn);this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:n,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}Y(gP,FS,"ColumnBuilder");const Ii=Symbol.for("drizzle:Name");var VS;VS=ue;class yP{constructor(t,n){Y(this,"reference");Y(this,"_onUpdate","no action");Y(this,"_onDelete","no action");this.reference=()=>{const{name:r,columns:s,foreignColumns:o}=t();return{name:r,columns:s,foreignTable:o[0].table,foreignColumns:o}},n&&(this._onUpdate=n.onUpdate,this._onDelete=n.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new vP(t,this)}}Y(yP,VS,"PgForeignKeyBuilder");var US;US=ue;class vP{constructor(t,n){Y(this,"reference");Y(this,"onUpdate");Y(this,"onDelete");this.table=t,this.reference=n.reference,this.onUpdate=n._onUpdate,this.onDelete=n._onDelete}getName(){const{name:t,columns:n,foreignColumns:r}=this.reference(),s=n.map(l=>l.name),o=r.map(l=>l.name),i=[this.table[Ii],...s,r[0].table[Ii],...o];return t??`${i.join("_")}_fk`}}Y(vP,US,"PgForeignKey");function zB(e,...t){return e(...t)}function LB(e,t){return`${e[Ii]}_${t.join("_")}_unique`}function SS(e,t,n){for(let r=t;r<e.length;r++){const s=e[r];if(s==="\\"){r++;continue}if(s==='"')return[e.slice(t,r).replace(/\\/g,""),r+1];if(!n&&(s===","||s==="}"))return[e.slice(t,r).replace(/\\/g,""),r]}return[e.slice(t).replace(/\\/g,""),e.length]}function xP(e,t=0){const n=[];let r=t,s=!1;for(;r<e.length;){const o=e[r];if(o===","){(s||r===t)&&n.push(""),s=!0,r++;continue}if(s=!1,o==="\\"){r+=2;continue}if(o==='"'){const[c,u]=SS(e,r+1,!0);n.push(c),r=u;continue}if(o==="}")return[n,r+1];if(o==="{"){const[c,u]=xP(e,r+1);n.push(c),r=u;continue}const[i,l]=SS(e,r,!1);n.push(i),r=l}return[n,r]}function FB(e){const[t]=xP(e,1);return t}function wP(e){return`{${e.map(t=>Array.isArray(t)?wP(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}var BS,KS;class Ye extends(KS=gP,BS=ue,KS){constructor(){super(...arguments);Y(this,"foreignKeyConfigs",[])}array(n){return new SP(this.config.name,this,n)}references(n,r={}){return this.foreignKeyConfigs.push({ref:n,actions:r}),this}unique(n,r){return this.config.isUnique=!0,this.config.uniqueName=n,this.config.uniqueType=r==null?void 0:r.nulls,this}generatedAlwaysAs(n){return this.config.generated={as:n,type:"always",mode:"stored"},this}buildForeignKeys(n,r){return this.foreignKeyConfigs.map(({ref:s,actions:o})=>zB((i,l)=>{const c=new yP(()=>{const u=i();return{columns:[n],foreignColumns:[u]}});return l.onUpdate&&c.onUpdate(l.onUpdate),l.onDelete&&c.onDelete(l.onDelete),c.build(r)},s,o))}buildExtraConfigColumn(n){return new _P(n,this.config)}}Y(Ye,BS,"PgColumnBuilder");var WS,HS;class ze extends(HS=il,WS=ue,HS){constructor(t,n){n.uniqueName||(n.uniqueName=LB(t,[n.name])),super(t,n),this.table=t}}Y(ze,WS,"PgColumn");var qS,GS;class _P extends(GS=ze,qS=ue,GS){constructor(){super(...arguments);Y(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});Y(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(n){return this.indexConfig.opClass=n,this}}Y(_P,qS,"ExtraConfigColumn");var ZS,YS;class SP extends(YS=Ye,ZS=ue,YS){constructor(t,n,r){super(t,"array","PgArray"),this.config.baseBuilder=n,this.config.size=r}build(t){const n=this.config.baseBuilder.build(t);return new ly(t,this.config,n)}}Y(SP,ZS,"PgArrayBuilder");var QS,XS;const lm=class lm extends(XS=ze,QS=ue,XS){constructor(n,r,s,o){super(n,r);Y(this,"size");this.baseColumn=s,this.range=o,this.size=r.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(n){return typeof n=="string"&&(n=FB(n)),n.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(n,r=!1){const s=n.map(o=>o===null?null:on(this.baseColumn,lm)?this.baseColumn.mapToDriverValue(o,!0):this.baseColumn.mapToDriverValue(o));return r?s:wP(s)}};Y(lm,QS,"PgArray");let ly=lm;const bS=Symbol.for("drizzle:isPgEnum");function VB(e){return!!e&&typeof e=="function"&&bS in e&&e[bS]===!0}var JS;JS=ue;class zx{constructor(t,n,r,s=!1){this._={brand:"Subquery",sql:t,selectedFields:n,alias:r,isWith:s}}}Y(zx,JS,"Subquery");const UB={startActiveSpan(e,t){return t()}},Ti=Symbol.for("drizzle:ViewBaseConfig"),gp=Symbol.for("drizzle:Schema"),ES=Symbol.for("drizzle:Columns"),kS=Symbol.for("drizzle:ExtraConfigColumns"),yp=Symbol.for("drizzle:OriginalName"),vp=Symbol.for("drizzle:BaseName"),nm=Symbol.for("drizzle:IsAlias"),CS=Symbol.for("drizzle:ExtraConfigBuilder"),bP=Symbol.for("drizzle:IsDrizzleTable");var e0,t0,n0,r0,s0,o0,a0,i0,l0,c0;c0=ue,l0=Ii,i0=yp,a0=gp,o0=ES,s0=kS,r0=vp,n0=nm,t0=bP,e0=CS;class Cn{constructor(t,n,r){Y(this,l0);Y(this,i0);Y(this,a0);Y(this,o0);Y(this,s0);Y(this,r0);Y(this,n0,!1);Y(this,t0,!0);Y(this,e0);this[Ii]=this[yp]=t,this[gp]=n,this[vp]=r}}Y(Cn,c0,"Table"),Y(Cn,"Symbol",{Name:Ii,Schema:gp,OriginalName:yp,Columns:ES,ExtraConfigColumns:kS,BaseName:vp,IsAlias:nm,ExtraConfigBuilder:CS});function EP(e){return typeof e=="object"&&e!==null&&bP in e}function BB(e){return e!=null&&typeof e.getSQL=="function"}function KB(e){var n;const t={sql:"",params:[]};for(const r of e)t.sql+=r.sql,t.params.push(...r.params),(n=r.typings)!=null&&n.length&&(t.typings||(t.typings=[]),t.typings.push(...r.typings));return t}var u0;u0=ue;class ur{constructor(t){Y(this,"value");this.value=Array.isArray(t)?t:[t]}getSQL(){return new qt([this])}}Y(ur,u0,"StringChunk");var d0;d0=ue;const Jo=class Jo{constructor(t){Y(this,"decoder",kP);Y(this,"shouldInlineParams",!1);this.queryChunks=t}append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return UB.startActiveSpan("drizzle.buildSQL",n=>{const r=this.buildQueryFromSourceParams(this.queryChunks,t);return n==null||n.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(t,n){const r=Object.assign({},n,{inlineParams:n.inlineParams||this.shouldInlineParams,paramStartIndex:n.paramStartIndex||{value:0}}),{casing:s,escapeName:o,escapeParam:i,prepareTyping:l,inlineParams:c,paramStartIndex:u}=r;return KB(t.map(d=>{var m;if(on(d,ur))return{sql:d.value.join(""),params:[]};if(on(d,rm))return{sql:o(d.value),params:[]};if(d===void 0)return{sql:"",params:[]};if(Array.isArray(d)){const f=[new ur("(")];for(const[p,v]of d.entries())f.push(v),p<d.length-1&&f.push(new ur(", "));return f.push(new ur(")")),this.buildQueryFromSourceParams(f,r)}if(on(d,Jo))return this.buildQueryFromSourceParams(d.queryChunks,{...r,inlineParams:c||d.shouldInlineParams});if(on(d,Cn)){const f=d[Cn.Symbol.Schema],p=d[Cn.Symbol.Name];return{sql:f===void 0||d[nm]?o(p):o(f)+"."+o(p),params:[]}}if(on(d,il)){const f=s.getColumnCasing(d);if(n.invokeSource==="indexes")return{sql:o(f),params:[]};const p=d.table[Cn.Symbol.Schema];return{sql:d.table[nm]||p===void 0?o(d.table[Cn.Symbol.Name])+"."+o(f):o(p)+"."+o(d.table[Cn.Symbol.Name])+"."+o(f),params:[]}}if(on(d,jP)){const f=d[Ti].schema,p=d[Ti].name;return{sql:f===void 0||d[Ti].isAlias?o(p):o(f)+"."+o(p),params:[]}}if(on(d,Lx)){if(on(d.value,om))return{sql:i(u.value++,d),params:[d],typings:["none"]};const f=d.value===null?null:d.encoder.mapToDriverValue(d.value);if(on(f,Jo))return this.buildQueryFromSourceParams([f],r);if(c)return{sql:this.mapInlineParam(f,r),params:[]};let p=["none"];return l&&(p=[l(d.encoder)]),{sql:i(u.value++,f),params:[f],typings:p}}return on(d,om)?{sql:i(u.value++,d),params:[d],typings:["none"]}:on(d,Jo.Aliased)&&d.fieldAlias!==void 0?{sql:o(d.fieldAlias),params:[]}:on(d,zx)?d._.isWith?{sql:o(d._.alias),params:[]}:this.buildQueryFromSourceParams([new ur("("),d._.sql,new ur(") "),new rm(d._.alias)],r):VB(d)?d.schema?{sql:o(d.schema)+"."+o(d.enumName),params:[]}:{sql:o(d.enumName),params:[]}:BB(d)?(m=d.shouldOmitSQLParens)!=null&&m.call(d)?this.buildQueryFromSourceParams([d.getSQL()],r):this.buildQueryFromSourceParams([new ur("("),d.getSQL(),new ur(")")],r):c?{sql:this.mapInlineParam(d,r),params:[]}:{sql:i(u.value++,d),params:[d],typings:["none"]}}))}mapInlineParam(t,{escapeString:n}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return n(t);if(typeof t=="object"){const r=t.toString();return n(r==="[object Object]"?JSON.stringify(t):r)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new Jo.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}};Y(Jo,d0,"SQL");let qt=Jo;var f0;f0=ue;class rm{constructor(t){Y(this,"brand");this.value=t}getSQL(){return new qt([this])}}Y(rm,f0,"Name");const kP={mapFromDriverValue:e=>e},CP={mapToDriverValue:e=>e};({...kP,...CP});var m0;m0=ue;class Lx{constructor(t,n=CP){Y(this,"brand");this.value=t,this.encoder=n}getSQL(){return new qt([this])}}Y(Lx,m0,"Param");function sm(e,...t){const n=[];(t.length>0||e.length>0&&e[0]!=="")&&n.push(new ur(e[0]));for(const[r,s]of t.entries())n.push(s,new ur(e[r+1]));return new qt(n)}(e=>{function t(){return new qt([])}e.empty=t;function n(c){return new qt(c)}e.fromList=n;function r(c){return new qt([new ur(c)])}e.raw=r;function s(c,u){const d=[];for(const[m,f]of c.entries())m>0&&u!==void 0&&d.push(u),d.push(f);return new qt(d)}e.join=s;function o(c){return new rm(c)}e.identifier=o;function i(c){return new om(c)}e.placeholder=i;function l(c,u){return new Lx(c,u)}e.param=l})(sm||(sm={}));(e=>{var n;n=ue;const r=class r{constructor(o,i){Y(this,"isSelectionField",!1);this.sql=o,this.fieldAlias=i}getSQL(){return this.sql}clone(){return new r(this.sql,this.fieldAlias)}};Y(r,n,"SQL.Aliased");let t=r;e.Aliased=t})(qt||(qt={}));var h0;h0=ue;class om{constructor(t){this.name=t}getSQL(){return new qt([this])}}Y(om,h0,"Placeholder");const NP=Symbol.for("drizzle:IsDrizzleView");var p0,g0,y0;y0=ue,g0=Ti,p0=NP;class jP{constructor({name:t,schema:n,selectedFields:r,query:s}){Y(this,g0);Y(this,p0,!0);this[Ti]={name:t,originalName:t,schema:n,selectedFields:r,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new qt([this])}}Y(jP,y0,"View");function WB(e){return typeof e=="object"&&e!==null&&NP in e}il.prototype.getSQL=function(){return new qt([this])};Cn.prototype.getSQL=function(){return new qt([this])};zx.prototype.getSQL=function(){return new qt([this])};function HB(e){return e[Cn.Symbol.Columns]}function qB(e){return e[Ti].selectedFields}function rn(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}var v0,x0;class Mu extends(x0=Ye,v0=ue,x0){generatedAlwaysAsIdentity(t){if(t){const{name:n,...r}=t;this.config.generatedIdentity={type:"always",sequenceName:n,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:n,...r}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:n,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}Y(Mu,v0,"PgIntColumnBaseBuilder");var w0,_0;class IP extends(_0=Mu,w0=ue,_0){constructor(t){super(t,"number","PgBigInt53")}build(t){return new TP(t,this.config)}}Y(IP,w0,"PgBigInt53Builder");var S0,b0;class TP extends(b0=ze,S0=ue,b0){getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}Y(TP,S0,"PgBigInt53");var E0,k0;class AP extends(k0=Mu,E0=ue,k0){constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new PP(t,this.config)}}Y(AP,E0,"PgBigInt64Builder");var C0,N0;class PP extends(N0=ze,C0=ue,N0){getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}Y(PP,C0,"PgBigInt64");function GB(e,t){const{name:n,config:r}=rn(e,t);return r.mode==="number"?new IP(n):new AP(n)}var j0,I0;class DP extends(I0=Ye,j0=ue,I0){constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new RP(t,this.config)}}Y(DP,j0,"PgBigSerial53Builder");var T0,A0;class RP extends(A0=ze,T0=ue,A0){getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}Y(RP,T0,"PgBigSerial53");var P0,D0;class $P extends(D0=Ye,P0=ue,D0){constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new OP(t,this.config)}}Y($P,P0,"PgBigSerial64Builder");var R0,$0;class OP extends($0=ze,R0=ue,$0){getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}Y(OP,R0,"PgBigSerial64");function ZB(e,t){const{name:n,config:r}=rn(e,t);return r.mode==="number"?new DP(n):new $P(n)}var O0,M0;class MP extends(M0=Ye,O0=ue,M0){constructor(t){super(t,"boolean","PgBoolean")}build(t){return new zP(t,this.config)}}Y(MP,O0,"PgBooleanBuilder");var z0,L0;class zP extends(L0=ze,z0=ue,L0){getSQLType(){return"boolean"}}Y(zP,z0,"PgBoolean");function cu(e){return new MP(e??"")}var F0,V0;class LP extends(V0=Ye,F0=ue,V0){constructor(t,n){super(t,"string","PgChar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new FP(t,this.config)}}Y(LP,F0,"PgCharBuilder");var U0,B0;class FP extends(B0=ze,U0=ue,B0){constructor(){super(...arguments);Y(this,"length",this.config.length);Y(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}Y(FP,U0,"PgChar");function YB(e,t={}){const{name:n,config:r}=rn(e,t);return new LP(n,r)}var K0,W0;class VP extends(W0=Ye,K0=ue,W0){constructor(t){super(t,"string","PgCidr")}build(t){return new UP(t,this.config)}}Y(VP,K0,"PgCidrBuilder");var H0,q0;class UP extends(q0=ze,H0=ue,q0){getSQLType(){return"cidr"}}Y(UP,H0,"PgCidr");function QB(e){return new VP(e??"")}var G0,Z0;class BP extends(Z0=Ye,G0=ue,Z0){constructor(t,n,r){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=n,this.config.customTypeParams=r}build(t){return new KP(t,this.config)}}Y(BP,G0,"PgCustomColumnBuilder");var Y0,Q0;class KP extends(Q0=ze,Y0=ue,Q0){constructor(n,r){super(n,r);Y(this,"sqlName");Y(this,"mapTo");Y(this,"mapFrom");this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(n){return typeof this.mapFrom=="function"?this.mapFrom(n):n}mapToDriverValue(n){return typeof this.mapTo=="function"?this.mapTo(n):n}}Y(KP,Y0,"PgCustomColumn");function XB(e){return(t,n)=>{const{name:r,config:s}=rn(t,n);return new BP(r,s,e)}}var X0,J0;class bl extends(J0=Ye,X0=ue,J0){defaultNow(){return this.default(sm`now()`)}}Y(bl,X0,"PgDateColumnBaseBuilder");var eb,tb;class WP extends(tb=bl,eb=ue,tb){constructor(t){super(t,"date","PgDate")}build(t){return new HP(t,this.config)}}Y(WP,eb,"PgDateBuilder");var nb,rb;class HP extends(rb=ze,nb=ue,rb){getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}Y(HP,nb,"PgDate");var sb,ob;class qP extends(ob=bl,sb=ue,ob){constructor(t){super(t,"string","PgDateString")}build(t){return new GP(t,this.config)}}Y(qP,sb,"PgDateStringBuilder");var ab,ib;class GP extends(ib=ze,ab=ue,ib){getSQLType(){return"date"}}Y(GP,ab,"PgDateString");function ZP(e,t){const{name:n,config:r}=rn(e,t);return(r==null?void 0:r.mode)==="date"?new WP(n):new qP(n)}var lb,cb;class YP extends(cb=Ye,lb=ue,cb){constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new QP(t,this.config)}}Y(YP,lb,"PgDoublePrecisionBuilder");var ub,db;class QP extends(db=ze,ub=ue,db){getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}Y(QP,ub,"PgDoublePrecision");function JB(e){return new YP(e??"")}var fb,mb;class XP extends(mb=Ye,fb=ue,mb){constructor(t){super(t,"string","PgInet")}build(t){return new JP(t,this.config)}}Y(XP,fb,"PgInetBuilder");var hb,pb;class JP extends(pb=ze,hb=ue,pb){getSQLType(){return"inet"}}Y(JP,hb,"PgInet");function eK(e){return new XP(e??"")}var gb,yb;class eD extends(yb=Mu,gb=ue,yb){constructor(t){super(t,"number","PgInteger")}build(t){return new tD(t,this.config)}}Y(eD,gb,"PgIntegerBuilder");var vb,xb;class tD extends(xb=ze,vb=ue,xb){getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}Y(tD,vb,"PgInteger");function ll(e){return new eD(e??"")}var wb,_b;class nD extends(_b=Ye,wb=ue,_b){constructor(t,n){super(t,"string","PgInterval"),this.config.intervalConfig=n}build(t){return new rD(t,this.config)}}Y(nD,wb,"PgIntervalBuilder");var Sb,bb;class rD extends(bb=ze,Sb=ue,bb){constructor(){super(...arguments);Y(this,"fields",this.config.intervalConfig.fields);Y(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const n=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${n}${r}`}}Y(rD,Sb,"PgInterval");function tK(e,t={}){const{name:n,config:r}=rn(e,t);return new nD(n,r)}var Eb,kb;class sD extends(kb=Ye,Eb=ue,kb){constructor(t){super(t,"json","PgJson")}build(t){return new oD(t,this.config)}}Y(sD,Eb,"PgJsonBuilder");var Cb,Nb;class oD extends(Nb=ze,Cb=ue,Nb){constructor(t,n){super(t,n)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}Y(oD,Cb,"PgJson");function am(e){return new sD(e??"")}var jb,Ib;class aD extends(Ib=Ye,jb=ue,Ib){constructor(t){super(t,"json","PgJsonb")}build(t){return new iD(t,this.config)}}Y(aD,jb,"PgJsonbBuilder");var Tb,Ab;class iD extends(Ab=ze,Tb=ue,Ab){constructor(t,n){super(t,n)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}Y(iD,Tb,"PgJsonb");function nK(e){return new aD(e??"")}var Pb,Db;class lD extends(Db=Ye,Pb=ue,Db){constructor(t){super(t,"array","PgLine")}build(t){return new cD(t,this.config)}}Y(lD,Pb,"PgLineBuilder");var Rb,$b;class cD extends($b=ze,Rb=ue,$b){getSQLType(){return"line"}mapFromDriverValue(t){const[n,r,s]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(r),Number.parseFloat(s)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}Y(cD,Rb,"PgLine");var Ob,Mb;class uD extends(Mb=Ye,Ob=ue,Mb){constructor(t){super(t,"json","PgLineABC")}build(t){return new dD(t,this.config)}}Y(uD,Ob,"PgLineABCBuilder");var zb,Lb;class dD extends(Lb=ze,zb=ue,Lb){getSQLType(){return"line"}mapFromDriverValue(t){const[n,r,s]=t.slice(1,-1).split(",");return{a:Number.parseFloat(n),b:Number.parseFloat(r),c:Number.parseFloat(s)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}Y(dD,zb,"PgLineABC");function rK(e,t){const{name:n,config:r}=rn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new lD(n):new uD(n)}var Fb,Vb;class fD extends(Vb=Ye,Fb=ue,Vb){constructor(t){super(t,"string","PgMacaddr")}build(t){return new mD(t,this.config)}}Y(fD,Fb,"PgMacaddrBuilder");var Ub,Bb;class mD extends(Bb=ze,Ub=ue,Bb){getSQLType(){return"macaddr"}}Y(mD,Ub,"PgMacaddr");function sK(e){return new fD(e??"")}var Kb,Wb;class hD extends(Wb=Ye,Kb=ue,Wb){constructor(t){super(t,"string","PgMacaddr8")}build(t){return new pD(t,this.config)}}Y(hD,Kb,"PgMacaddr8Builder");var Hb,qb;class pD extends(qb=ze,Hb=ue,qb){getSQLType(){return"macaddr8"}}Y(pD,Hb,"PgMacaddr8");function oK(e){return new hD(e??"")}var Gb,Zb;class gD extends(Zb=Ye,Gb=ue,Zb){constructor(t,n,r){super(t,"string","PgNumeric"),this.config.precision=n,this.config.scale=r}build(t){return new yD(t,this.config)}}Y(gD,Gb,"PgNumericBuilder");var Yb,Qb;class yD extends(Qb=ze,Yb=ue,Qb){constructor(n,r){super(n,r);Y(this,"precision");Y(this,"scale");this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}Y(yD,Yb,"PgNumeric");function xc(e,t){const{name:n,config:r}=rn(e,t);return new gD(n,r==null?void 0:r.precision,r==null?void 0:r.scale)}var Xb,Jb;class vD extends(Jb=Ye,Xb=ue,Jb){constructor(t){super(t,"array","PgPointTuple")}build(t){return new xD(t,this.config)}}Y(vD,Xb,"PgPointTupleBuilder");var eE,tE;class xD extends(tE=ze,eE=ue,tE){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,r]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(r)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}Y(xD,eE,"PgPointTuple");var nE,rE;class wD extends(rE=Ye,nE=ue,rE){constructor(t){super(t,"json","PgPointObject")}build(t){return new _D(t,this.config)}}Y(wD,nE,"PgPointObjectBuilder");var sE,oE;class _D extends(oE=ze,sE=ue,oE){getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,r]=t.slice(1,-1).split(",");return{x:Number.parseFloat(n),y:Number.parseFloat(r)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}Y(_D,sE,"PgPointObject");function aK(e,t){const{name:n,config:r}=rn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new vD(n):new wD(n)}function iK(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(Number.parseInt(e.slice(n,n+2),16));return new Uint8Array(t)}function NS(e,t){const n=new ArrayBuffer(8),r=new DataView(n);for(let s=0;s<8;s++)r.setUint8(s,e[t+s]);return r.getFloat64(0,!0)}function SD(e){const t=iK(e);let n=0;const r=t[n];n+=1;const s=new DataView(t.buffer),o=s.getUint32(n,r===1);if(n+=4,o&536870912&&(s.getUint32(n,r===1),n+=4),(o&65535)===1){const i=NS(t,n);n+=8;const l=NS(t,n);return n+=8,[i,l]}throw new Error("Unsupported geometry type")}var aE,iE;class bD extends(iE=Ye,aE=ue,iE){constructor(t){super(t,"array","PgGeometry")}build(t){return new ED(t,this.config)}}Y(bD,aE,"PgGeometryBuilder");var lE,cE;class ED extends(cE=ze,lE=ue,cE){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return SD(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}Y(ED,lE,"PgGeometry");var uE,dE;class kD extends(dE=Ye,uE=ue,dE){constructor(t){super(t,"json","PgGeometryObject")}build(t){return new CD(t,this.config)}}Y(kD,uE,"PgGeometryObjectBuilder");var fE,mE;class CD extends(mE=ze,fE=ue,mE){getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const n=SD(t);return{x:n[0],y:n[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}Y(CD,fE,"PgGeometryObject");function lK(e,t){const{name:n,config:r}=rn(e,t);return!(r!=null&&r.mode)||r.mode==="tuple"?new bD(n):new kD(n)}var hE,pE;class ND extends(pE=Ye,hE=ue,pE){constructor(t,n){super(t,"number","PgReal"),this.config.length=n}build(t){return new jD(t,this.config)}}Y(ND,hE,"PgRealBuilder");var gE,yE;class jD extends(yE=ze,gE=ue,yE){constructor(n,r){super(n,r);Y(this,"mapFromDriverValue",n=>typeof n=="string"?Number.parseFloat(n):n)}getSQLType(){return"real"}}Y(jD,gE,"PgReal");function cK(e){return new ND(e??"")}var vE,xE;class ID extends(xE=Ye,vE=ue,xE){constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new TD(t,this.config)}}Y(ID,vE,"PgSerialBuilder");var wE,_E;class TD extends(_E=ze,wE=ue,_E){getSQLType(){return"serial"}}Y(TD,wE,"PgSerial");function zu(e){return new ID(e??"")}var SE,bE;class AD extends(bE=Mu,SE=ue,bE){constructor(t){super(t,"number","PgSmallInt")}build(t){return new PD(t,this.config)}}Y(AD,SE,"PgSmallIntBuilder");var EE,kE;class PD extends(kE=ze,EE=ue,kE){constructor(){super(...arguments);Y(this,"mapFromDriverValue",n=>typeof n=="string"?Number(n):n)}getSQLType(){return"smallint"}}Y(PD,EE,"PgSmallInt");function uK(e){return new AD(e??"")}var CE,NE;class DD extends(NE=Ye,CE=ue,NE){constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new RD(t,this.config)}}Y(DD,CE,"PgSmallSerialBuilder");var jE,IE;class RD extends(IE=ze,jE=ue,IE){getSQLType(){return"smallserial"}}Y(RD,jE,"PgSmallSerial");function dK(e){return new DD(e??"")}var TE,AE;class $D extends(AE=Ye,TE=ue,AE){constructor(t,n){super(t,"string","PgText"),this.config.enumValues=n.enum}build(t){return new OD(t,this.config)}}Y($D,TE,"PgTextBuilder");var PE,DE;class OD extends(DE=ze,PE=ue,DE){constructor(){super(...arguments);Y(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}Y(OD,PE,"PgText");function xt(e,t={}){const{name:n,config:r}=rn(e,t);return new $D(n,r)}var RE,$E;class MD extends($E=bl,RE=ue,$E){constructor(t,n,r){super(t,"string","PgTime"),this.withTimezone=n,this.precision=r,this.config.withTimezone=n,this.config.precision=r}build(t){return new zD(t,this.config)}}Y(MD,RE,"PgTimeBuilder");var OE,ME;class zD extends(ME=ze,OE=ue,ME){constructor(n,r){super(n,r);Y(this,"withTimezone");Y(this,"precision");this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}Y(zD,OE,"PgTime");function fK(e,t={}){const{name:n,config:r}=rn(e,t);return new MD(n,r.withTimezone??!1,r.precision)}var zE,LE;class LD extends(LE=bl,zE=ue,LE){constructor(t,n,r){super(t,"date","PgTimestamp"),this.config.withTimezone=n,this.config.precision=r}build(t){return new FD(t,this.config)}}Y(LD,zE,"PgTimestampBuilder");var FE,VE;class FD extends(VE=ze,FE=ue,VE){constructor(n,r){super(n,r);Y(this,"withTimezone");Y(this,"precision");Y(this,"mapFromDriverValue",n=>new Date(this.withTimezone?n:n+"+0000"));Y(this,"mapToDriverValue",n=>n.toISOString());this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}Y(FD,FE,"PgTimestamp");var UE,BE;class VD extends(BE=bl,UE=ue,BE){constructor(t,n,r){super(t,"string","PgTimestampString"),this.config.withTimezone=n,this.config.precision=r}build(t){return new UD(t,this.config)}}Y(VD,UE,"PgTimestampStringBuilder");var KE,WE;class UD extends(WE=ze,KE=ue,WE){constructor(n,r){super(n,r);Y(this,"withTimezone");Y(this,"precision");this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}Y(UD,KE,"PgTimestampString");function Ar(e,t={}){const{name:n,config:r}=rn(e,t);return(r==null?void 0:r.mode)==="string"?new VD(n,r.withTimezone??!1,r.precision):new LD(n,(r==null?void 0:r.withTimezone)??!1,r==null?void 0:r.precision)}var HE,qE;class BD extends(qE=Ye,HE=ue,qE){constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(sm`gen_random_uuid()`)}build(t){return new KD(t,this.config)}}Y(BD,HE,"PgUUIDBuilder");var GE,ZE;class KD extends(ZE=ze,GE=ue,ZE){getSQLType(){return"uuid"}}Y(KD,GE,"PgUUID");function mK(e){return new BD(e??"")}var YE,QE;class WD extends(QE=Ye,YE=ue,QE){constructor(t,n){super(t,"string","PgVarchar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new HD(t,this.config)}}Y(WD,YE,"PgVarcharBuilder");var XE,JE;class HD extends(JE=ze,XE=ue,JE){constructor(){super(...arguments);Y(this,"length",this.config.length);Y(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}Y(HD,XE,"PgVarchar");function qD(e,t={}){const{name:n,config:r}=rn(e,t);return new WD(n,r)}var ek,tk;class GD extends(tk=Ye,ek=ue,tk){constructor(t,n){super(t,"string","PgBinaryVector"),this.config.dimensions=n.dimensions}build(t){return new ZD(t,this.config)}}Y(GD,ek,"PgBinaryVectorBuilder");var nk,rk;class ZD extends(rk=ze,nk=ue,rk){constructor(){super(...arguments);Y(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}Y(ZD,nk,"PgBinaryVector");function hK(e,t){const{name:n,config:r}=rn(e,t);return new GD(n,r)}var sk,ok;class YD extends(ok=Ye,sk=ue,ok){constructor(t,n){super(t,"array","PgHalfVector"),this.config.dimensions=n.dimensions}build(t){return new QD(t,this.config)}}Y(YD,sk,"PgHalfVectorBuilder");var ak,ik;class QD extends(ik=ze,ak=ue,ik){constructor(){super(...arguments);Y(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}}Y(QD,ak,"PgHalfVector");function pK(e,t){const{name:n,config:r}=rn(e,t);return new YD(n,r)}var lk,ck;class XD extends(ck=Ye,lk=ue,ck){constructor(t,n){super(t,"string","PgSparseVector"),this.config.dimensions=n.dimensions}build(t){return new JD(t,this.config)}}Y(XD,lk,"PgSparseVectorBuilder");var uk,dk;class JD extends(dk=ze,uk=ue,dk){constructor(){super(...arguments);Y(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}Y(JD,uk,"PgSparseVector");function gK(e,t){const{name:n,config:r}=rn(e,t);return new XD(n,r)}var fk,mk;class eR extends(mk=Ye,fk=ue,mk){constructor(t,n){super(t,"array","PgVector"),this.config.dimensions=n.dimensions}build(t){return new tR(t,this.config)}}Y(eR,fk,"PgVectorBuilder");var hk,pk;class tR extends(pk=ze,hk=ue,pk){constructor(){super(...arguments);Y(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(n){return JSON.stringify(n)}mapFromDriverValue(n){return n.slice(1,-1).split(",").map(r=>Number.parseFloat(r))}}Y(tR,hk,"PgVector");function yK(e,t){const{name:n,config:r}=rn(e,t);return new eR(n,r)}function vK(){return{bigint:GB,bigserial:ZB,boolean:cu,char:YB,cidr:QB,customType:XB,date:ZP,doublePrecision:JB,inet:eK,integer:ll,interval:tK,json:am,jsonb:nK,line:rK,macaddr:sK,macaddr8:oK,numeric:xc,point:aK,geometry:lK,real:cK,serial:zu,smallint:uK,smallserial:dK,text:xt,time:fK,timestamp:Ar,uuid:mK,varchar:qD,bit:hK,halfvec:pK,sparsevec:gK,vector:yK}}const cy=Symbol.for("drizzle:PgInlineForeignKeys"),jS=Symbol.for("drizzle:EnableRLS");var gk,yk,vk,xk,wk;class im extends(wk=Cn,xk=ue,vk=cy,yk=jS,gk=Cn.Symbol.ExtraConfigBuilder,wk){constructor(){super(...arguments);Y(this,vk,[]);Y(this,yk,!1);Y(this,gk)}}Y(im,xk,"PgTable"),Y(im,"Symbol",Object.assign({},Cn.Symbol,{InlineForeignKeys:cy,EnableRLS:jS}));function xK(e,t,n,r,s=e){const o=new im(e,r,s),i=typeof t=="function"?t(vK()):t,l=Object.fromEntries(Object.entries(i).map(([d,m])=>{const f=m;f.setName(d);const p=f.build(o);return o[cy].push(...f.buildForeignKeys(p,o)),[d,p]})),c=Object.fromEntries(Object.entries(i).map(([d,m])=>{const f=m;f.setName(d);const p=f.buildExtraConfigColumn(o);return[d,p]})),u=Object.assign(o,l);return u[Cn.Symbol.Columns]=l,u[Cn.Symbol.ExtraConfigColumns]=c,Object.assign(u,{enableRLS:()=>(u[im.Symbol.EnableRLS]=!0,u)})}const lh=(e,t,n)=>xK(e,t,n,void 0),Et={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function Rt(e,t){return t.includes(e.columnType)}function wK(e){return"enumValues"in e&&Array.isArray(e.enumValues)&&e.enumValues.length>0}const _K=_e.union([_e.string(),_e.number(),_e.boolean(),_e.null()]),SK=_e.union([_K,_e.record(_e.any()),_e.array(_e.any())]),bK=_e.custom(e=>e instanceof Buffer);function nR(e,t){const n=(t==null?void 0:t.zodInstance)??_e,r=(t==null?void 0:t.coerce)??{};let s;return wK(e)&&(s=e.enumValues.length?n.enum(e.enumValues):n.string()),s||(Rt(e,["PgGeometry","PgPointTuple"])?s=n.tuple([n.number(),n.number()]):Rt(e,["PgGeometryObject","PgPointObject"])?s=n.object({x:n.number(),y:n.number()}):Rt(e,["PgHalfVector","PgVector"])?(s=n.array(n.number()),s=e.dimensions?s.length(e.dimensions):s):Rt(e,["PgLine"])?s=n.tuple([n.number(),n.number(),n.number()]):Rt(e,["PgLineABC"])?s=n.object({a:n.number(),b:n.number(),c:n.number()}):Rt(e,["PgArray"])?(s=n.array(nR(e.baseColumn,n)),s=e.size?s.length(e.size):s):e.dataType==="array"?s=n.array(n.any()):e.dataType==="number"?s=EK(e,n,r):e.dataType==="bigint"?s=kK(e,n,r):e.dataType==="boolean"?s=r===!0||r.boolean?n.coerce.boolean():n.boolean():e.dataType==="date"?s=r===!0||r.date?n.coerce.date():n.date():e.dataType==="string"?s=CK(e,n,r):e.dataType==="json"?s=SK:e.dataType==="custom"?s=n.any():e.dataType==="buffer"&&(s=bK)),s||(s=n.any()),s}function EK(e,t,n){let r=e.getSQLType().includes("unsigned"),s,o,i=!1;Rt(e,["MySqlTinyInt","SingleStoreTinyInt"])?(s=r?0:Et.INT8_MIN,o=r?Et.INT8_UNSIGNED_MAX:Et.INT8_MAX,i=!0):Rt(e,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(s=r?0:Et.INT16_MIN,o=r?Et.INT16_UNSIGNED_MAX:Et.INT16_MAX,i=!0):Rt(e,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(s=r?0:Et.INT24_MIN,o=r?Et.INT24_UNSIGNED_MAX:Et.INT24_MAX,i=Rt(e,["MySqlMediumInt","SingleStoreMediumInt"])):Rt(e,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(s=r?0:Et.INT32_MIN,o=r?Et.INT32_UNSIGNED_MAX:Et.INT32_MAX,i=!0):Rt(e,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(s=r?0:Et.INT48_MIN,o=r?Et.INT48_UNSIGNED_MAX:Et.INT48_MAX):Rt(e,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(r=r||Rt(e,["MySqlSerial","SingleStoreSerial"]),s=r?0:Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,i=!0):Rt(e,["MySqlYear","SingleStoreYear"])?(s=1901,o=2155,i=!0):(s=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER);let l=n===!0||n!=null&&n.number?t.coerce.number():t.number();return l=l.min(s).max(o),i?l.int():l}function kK(e,t,n){const r=e.getSQLType().includes("unsigned"),s=r?0n:Et.INT64_MIN,o=r?Et.INT64_UNSIGNED_MAX:Et.INT64_MAX;return(n===!0||n!=null&&n.bigint?t.coerce.bigint():t.bigint()).min(s).max(o)}function CK(e,t,n){if(Rt(e,["PgUUID"]))return t.string().uuid();let r,s,o=!1;Rt(e,["PgVarchar","SQLiteText"])?r=e.length:Rt(e,["MySqlVarChar","SingleStoreVarChar"])?r=e.length??Et.INT16_UNSIGNED_MAX:Rt(e,["MySqlText","SingleStoreText"])&&(e.textType==="longtext"?r=Et.INT32_UNSIGNED_MAX:e.textType==="mediumtext"?r=Et.INT24_UNSIGNED_MAX:e.textType==="text"?r=Et.INT16_UNSIGNED_MAX:r=Et.INT8_UNSIGNED_MAX),Rt(e,["PgChar","MySqlChar","SingleStoreChar"])&&(r=e.length,o=!0),Rt(e,["PgBinaryVector"])&&(s=/^[01]+$/,r=e.dimensions);let i=n===!0||n!=null&&n.string?t.coerce.string():t.string();return i=s?i.regex(s):i,r&&o?i.length(r):r?i.max(r):i}function rR(e){return EP(e)?HB(e):qB(e)}function sR(e,t,n,r){const s={};for(const[o,i]of Object.entries(e)){if(!on(i,il)&&!on(i,qt)&&!on(i,qt.Aliased)&&typeof i=="object"){const m=EP(i)||WB(i)?rR(i):i;s[o]=sR(m,t[o]??{},n,r);continue}const l=t[o];if(l!==void 0&&typeof l!="function"){s[o]=l;continue}const c=on(i,il)?i:void 0,u=c?nR(c,r):_e.any(),d=typeof l=="function"?l(u):u;n.never(c)||(s[o]=d,c&&(n.nullable(c)&&(s[o]=s[o].nullable()),n.optional(c)&&(s[o]=s[o].optional())))}return _e.object(s)}const NK={never:e=>{var t,n;return((t=e==null?void 0:e.generated)==null?void 0:t.type)==="always"||((n=e==null?void 0:e.generatedIdentity)==null?void 0:n.type)==="always"},optional:e=>!e.notNull||e.notNull&&e.hasDefault,nullable:e=>!e.notNull},ch=(e,t)=>{const n=rR(e);return sR(n,{},NK)},uh=lh("users",{id:zu("id").primaryKey(),email:xt("email").notNull().unique(),firstName:xt("first_name").notNull(),authCode:xt("auth_code"),publicKey:xt("public_key"),isVerified:cu("is_verified").notNull().default(!1),createdAt:Ar("created_at").defaultNow().notNull()}),oR=lh("bank_credentials",{id:zu("id").primaryKey(),userId:ll("user_id").notNull().references(()=>uh.id),institutionId:xt("institution_id").notNull(),institutionName:xt("institution_name").notNull(),plaidItemId:xt("plaid_item_id").unique(),plaidAccessToken:xt("plaid_access_token"),consentExpiresAt:Ar("consent_expires_at"),status:xt("status").notNull().default("active"),lastStatusUpdate:Ar("last_status_update"),errorCode:xt("error_code"),createdAt:Ar("created_at").defaultNow().notNull(),updatedAt:Ar("updated_at").defaultNow().notNull()}),aR=lh("bank_accounts",{id:zu("id").primaryKey(),userId:ll("user_id").notNull().references(()=>uh.id),credentialId:ll("credential_id").references(()=>oR.id),plaidAccountId:xt("plaid_account_id").unique(),accountName:xt("account_name").notNull(),accountNumber:xt("account_number"),accountType:xt("account_type").notNull(),institutionName:xt("institution_name").notNull(),institutionId:xt("institution_id"),institutionLogo:xt("institution_logo"),availableBalance:xc("available_balance").notNull(),currentBalance:xc("current_balance").notNull(),creditLimit:xc("credit_limit"),isoCurrencyCode:qD("iso_currency_code",{length:3}).notNull().default("USD"),isActive:cu("is_active").notNull().default(!0),isVerified:cu("is_verified").notNull().default(!1),lastSynced:Ar("last_synced"),metadata:am("metadata"),createdAt:Ar("created_at").defaultNow().notNull(),updatedAt:Ar("updated_at").defaultNow().notNull()}),jK=lh("bank_transactions",{id:zu("id").primaryKey(),userId:ll("user_id").notNull().references(()=>uh.id),accountId:ll("account_id").notNull().references(()=>aR.id),plaidTransactionId:xt("plaid_transaction_id").unique(),transactionName:xt("transaction_name").notNull(),amount:xc("amount").notNull(),date:ZP("date").notNull(),pending:cu("pending").notNull().default(!1),category:xt("category"),subCategory:xt("sub_category"),categoryIcon:xt("category_icon"),location:am("location"),paymentMethod:xt("payment_method"),paymentChannel:xt("payment_channel"),metadata:am("metadata"),createdAt:Ar("created_at").defaultNow().notNull(),updatedAt:Ar("updated_at").defaultNow().notNull()}),IK=_e.object({email:_e.string().email("Invalid email address"),firstName:_e.string().min(2,"First name must be at least 2 characters")}),TK=_e.object({code:_e.string().length(6,"Verification code must be 6 digits"),email:_e.string().email("Invalid email address")}),AK=_e.object({password:_e.string().min(8,"Password must be at least 8 characters"),publicKey:_e.string().optional()});ch(uh).extend({email:_e.string().email("Invalid email address"),originalEmail:_e.string().email("Invalid original email address").optional(),firstName:_e.string().min(2,"First name must be at least 2 characters"),publicKey:_e.string().optional(),isVerified:_e.boolean().optional()});ch(oR).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({userId:_e.number(),institutionId:_e.string(),institutionName:_e.string(),plaidItemId:_e.string().optional(),plaidAccessToken:_e.string().optional(),status:_e.string().default("active")});ch(aR).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({userId:_e.number(),credentialId:_e.number().optional(),accountName:_e.string(),accountType:_e.string(),institutionName:_e.string(),availableBalance:_e.number(),currentBalance:_e.number(),isActive:_e.boolean().default(!0)});ch(jK).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({userId:_e.number(),accountId:_e.number(),transactionName:_e.string(),amount:_e.number(),date:_e.date(),pending:_e.boolean().default(!1)});const PK=_e.object({email:_e.string().email("Invalid email address"),password:_e.string(),publicKey:_e.string().optional(),authProof:_e.string().optional()});function gd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var iR={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,o){function i(u,d){if(!s[u]){if(!r[u]){var m=typeof gd=="function"&&gd;if(!d&&m)return m(u,!0);if(l)return l(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var p=s[u]={exports:{}};r[u][0].call(p.exports,function(v){var h=r[u][1][v];return i(h||v)},p,p.exports,n,r,s,o)}return s[u].exports}for(var l=typeof gd=="function"&&gd,c=0;c<o.length;c++)i(o[c]);return i}({1:[function(n,r,s){var o=n("./utils"),i=n("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var u,d,m,f,p,v,h,x=[],y=0,g=c.length,_=g,S=o.getTypeOf(c)!=="string";y<c.length;)_=g-y,m=S?(u=c[y++],d=y<g?c[y++]:0,y<g?c[y++]:0):(u=c.charCodeAt(y++),d=y<g?c.charCodeAt(y++):0,y<g?c.charCodeAt(y++):0),f=u>>2,p=(3&u)<<4|d>>4,v=1<_?(15&d)<<2|m>>6:64,h=2<_?63&m:64,x.push(l.charAt(f)+l.charAt(p)+l.charAt(v)+l.charAt(h));return x.join("")},s.decode=function(c){var u,d,m,f,p,v,h=0,x=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var g,_=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&_--,c.charAt(c.length-2)===l.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=i.uint8array?new Uint8Array(0|_):new Array(0|_);h<c.length;)u=l.indexOf(c.charAt(h++))<<2|(f=l.indexOf(c.charAt(h++)))>>4,d=(15&f)<<4|(p=l.indexOf(c.charAt(h++)))>>2,m=(3&p)<<6|(v=l.indexOf(c.charAt(h++))),g[x++]=u,p!==64&&(g[x++]=d),v!==64&&(g[x++]=m);return g}},{"./support":30,"./utils":32}],2:[function(n,r,s){var o=n("./external"),i=n("./stream/DataWorker"),l=n("./stream/Crc32Probe"),c=n("./stream/DataLengthProbe");function u(d,m,f,p,v){this.compressedSize=d,this.uncompressedSize=m,this.crc32=f,this.compression=p,this.compressedContent=v}u.prototype={getContentWorker:function(){var d=new i(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),m=this;return d.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new i(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,m,f){return d.pipe(new l).pipe(new c("uncompressedSize")).pipe(m.compressWorker(f)).pipe(new c("compressedSize")).withStreamInfo("compression",m)},r.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var o=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var o=n("./utils"),i=function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c}();r.exports=function(l,c){return l!==void 0&&l.length?o.getTypeOf(l)!=="string"?function(u,d,m,f){var p=i,v=f+m;u^=-1;for(var h=f;h<v;h++)u=u>>>8^p[255&(u^d[h])];return-1^u}(0|c,l,l.length,0):function(u,d,m,f){var p=i,v=f+m;u^=-1;for(var h=f;h<v;h++)u=u>>>8^p[255&(u^d.charCodeAt(h))];return-1^u}(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var o=null;o=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:o}},{lie:37}],7:[function(n,r,s){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=n("pako"),l=n("./utils"),c=n("./stream/GenericWorker"),u=o?"uint8array":"array";function d(m,f){c.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=f,this.meta={}}s.magic="\b\0",l.inherits(d,c),d.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,m.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(f){m.push({data:f,meta:m.meta})}},s.compressWorker=function(m){return new d("Deflate",m)},s.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function o(p,v){var h,x="";for(h=0;h<v;h++)x+=String.fromCharCode(255&p),p>>>=8;return x}function i(p,v,h,x,y,g){var _,S,E=p.file,A=p.compression,I=g!==u.utf8encode,N=l.transformTo("string",g(E.name)),T=l.transformTo("string",u.utf8encode(E.name)),$=E.comment,M=l.transformTo("string",g($)),j=l.transformTo("string",u.utf8encode($)),P=T.length!==E.name.length,b=j.length!==$.length,V="",Z="",D="",L=E.dir,O=E.date,q={crc32:0,compressedSize:0,uncompressedSize:0};v&&!h||(q.crc32=p.crc32,q.compressedSize=p.compressedSize,q.uncompressedSize=p.uncompressedSize);var F=0;v&&(F|=8),I||!P&&!b||(F|=2048);var W=0,ce=0;L&&(W|=16),y==="UNIX"?(ce=798,W|=function(K,ne){var G=K;return K||(G=ne?16893:33204),(65535&G)<<16}(E.unixPermissions,L)):(ce=20,W|=function(K){return 63&(K||0)}(E.dosPermissions)),_=O.getUTCHours(),_<<=6,_|=O.getUTCMinutes(),_<<=5,_|=O.getUTCSeconds()/2,S=O.getUTCFullYear()-1980,S<<=4,S|=O.getUTCMonth()+1,S<<=5,S|=O.getUTCDate(),P&&(Z=o(1,1)+o(d(N),4)+T,V+="up"+o(Z.length,2)+Z),b&&(D=o(1,1)+o(d(M),4)+j,V+="uc"+o(D.length,2)+D);var ae="";return ae+=`
\0`,ae+=o(F,2),ae+=A.magic,ae+=o(_,2),ae+=o(S,2),ae+=o(q.crc32,4),ae+=o(q.compressedSize,4),ae+=o(q.uncompressedSize,4),ae+=o(N.length,2),ae+=o(V.length,2),{fileRecord:m.LOCAL_FILE_HEADER+ae+N+V,dirRecord:m.CENTRAL_FILE_HEADER+o(ce,2)+ae+o(M.length,2)+"\0\0\0\0"+o(W,4)+o(x,4)+N+V+M}}var l=n("../utils"),c=n("../stream/GenericWorker"),u=n("../utf8"),d=n("../crc32"),m=n("../signature");function f(p,v,h,x){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=h,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(f,c),f.prototype.push=function(p){var v=p.meta.percent||0,h=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:h?(v+100*(h-x-1))/h:100}}))},f.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var v=this.streamFiles&&!p.file.dir;if(v){var h=i(p,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(p){this.accumulate=!1;var v=this.streamFiles&&!p.file.dir,h=i(p,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),v)this.push({data:function(x){return m.DATA_DESCRIPTOR+o(x.crc32,4)+o(x.compressedSize,4)+o(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var p=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var h=this.bytesWritten-p,x=function(y,g,_,S,E){var A=l.transformTo("string",E(S));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(y,2)+o(y,2)+o(g,4)+o(_,4)+o(A.length,2)+A}(this.dirRecords.length,h,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(p){this._sources.push(p);var v=this;return p.on("data",function(h){v.processChunk(h)}),p.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),p.on("error",function(h){v.error(h)}),this},f.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(p){var v=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var h=0;h<v.length;h++)try{v[h].error(p)}catch{}return!0},f.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,v=0;v<p.length;v++)p[v].lock()},r.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var o=n("../compressions"),i=n("./ZipFileWorker");s.generateWorker=function(l,c,u){var d=new i(c.streamFiles,u,c.platform,c.encodeFileName),m=0;try{l.forEach(function(f,p){m++;var v=function(g,_){var S=g||_,E=o[S];if(!E)throw new Error(S+" is not a valid compression method !");return E}(p.options.compression,c.compression),h=p.options.compressionOptions||c.compressionOptions||{},x=p.dir,y=p.date;p._compressWorker(v,h).withStreamInfo("file",{name:f,dir:x,date:y,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(d)}),d.entriesCount=m}catch(f){d.error(f)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new o;for(var l in this)typeof this[l]!="function"&&(i[l]=this[l]);return i}}(o.prototype=n("./object")).loadAsync=n("./load"),o.support=n("./support"),o.defaults=n("./defaults"),o.version="3.10.1",o.loadAsync=function(i,l){return new o().loadAsync(i,l)},o.external=n("./external"),r.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var o=n("./utils"),i=n("./external"),l=n("./utf8"),c=n("./zipEntries"),u=n("./stream/Crc32Probe"),d=n("./nodejsUtils");function m(f){return new i.Promise(function(p,v){var h=f.decompressed.getContentWorker().pipe(new u);h.on("error",function(x){v(x)}).on("end",function(){h.streamInfo.crc32!==f.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(f,p){var v=this;return p=o.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(f)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",f,!0,p.optimizedBinaryString,p.base64).then(function(h){var x=new c(p);return x.load(h),x}).then(function(h){var x=[i.Promise.resolve(h)],y=h.files;if(p.checkCRC32)for(var g=0;g<y.length;g++)x.push(m(y[g]));return i.Promise.all(x)}).then(function(h){for(var x=h.shift(),y=x.files,g=0;g<y.length;g++){var _=y[g],S=_.fileNameStr,E=o.resolve(_.fileNameStr);v.file(E,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:p.createFolders}),_.dir||(v.file(E).unsafeOriginalName=S)}return x.zipComment.length&&(v.comment=x.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var o=n("../utils"),i=n("../stream/GenericWorker");function l(c,u){i.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(u)}o.inherits(l,i),l.prototype._bindStream=function(c){var u=this;(this._stream=c).pause(),c.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var o=n("readable-stream").Readable;function i(l,c,u){o.call(this,c),this._helper=l;var d=this;l.on("data",function(m,f){d.push(m)||d._helper.pause(),u&&u(f)}).on("error",function(m){d.emit("error",m)}).on("end",function(){d.push(null)})}n("../utils").inherits(i,o),i.prototype._read=function(){this._helper.resume()},r.exports=i},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,i);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,i)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var i=new Buffer(o);return i.fill(0),i},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(n,r,s){function o(E,A,I){var N,T=l.getTypeOf(A),$=l.extend(I||{},d);$.date=$.date||new Date,$.compression!==null&&($.compression=$.compression.toUpperCase()),typeof $.unixPermissions=="string"&&($.unixPermissions=parseInt($.unixPermissions,8)),$.unixPermissions&&16384&$.unixPermissions&&($.dir=!0),$.dosPermissions&&16&$.dosPermissions&&($.dir=!0),$.dir&&(E=y(E)),$.createFolders&&(N=x(E))&&g.call(this,N,!0);var M=T==="string"&&$.binary===!1&&$.base64===!1;I&&I.binary!==void 0||($.binary=!M),(A instanceof m&&A.uncompressedSize===0||$.dir||!A||A.length===0)&&($.base64=!1,$.binary=!0,A="",$.compression="STORE",T="string");var j=null;j=A instanceof m||A instanceof c?A:v.isNode&&v.isStream(A)?new h(E,A):l.prepareContent(E,A,$.binary,$.optimizedBinaryString,$.base64);var P=new f(E,j,$);this.files[E]=P}var i=n("./utf8"),l=n("./utils"),c=n("./stream/GenericWorker"),u=n("./stream/StreamHelper"),d=n("./defaults"),m=n("./compressedObject"),f=n("./zipObject"),p=n("./generate"),v=n("./nodejsUtils"),h=n("./nodejs/NodejsStreamInputAdapter"),x=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var A=E.lastIndexOf("/");return 0<A?E.substring(0,A):""},y=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},g=function(E,A){return A=A!==void 0?A:d.createFolders,E=y(E),this.files[E]||o.call(this,E,null,{dir:!0,createFolders:A}),this.files[E]};function _(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var A,I,N;for(A in this.files)N=this.files[A],(I=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&E(I,N)},filter:function(E){var A=[];return this.forEach(function(I,N){E(I,N)&&A.push(N)}),A},file:function(E,A,I){if(arguments.length!==1)return E=this.root+E,o.call(this,E,A,I),this;if(_(E)){var N=E;return this.filter(function($,M){return!M.dir&&N.test($)})}var T=this.files[this.root+E];return T&&!T.dir?T:null},folder:function(E){if(!E)return this;if(_(E))return this.filter(function(T,$){return $.dir&&E.test(T)});var A=this.root+E,I=g.call(this,A),N=this.clone();return N.root=I.name,N},remove:function(E){E=this.root+E;var A=this.files[E];if(A||(E.slice(-1)!=="/"&&(E+="/"),A=this.files[E]),A&&!A.dir)delete this.files[E];else for(var I=this.filter(function(T,$){return $.name.slice(0,E.length)===E}),N=0;N<I.length;N++)delete this.files[I[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var A,I={};try{if((I=l.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");l.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var N=I.comment||this.comment||"";A=p.generateWorker(this,I,N)}catch(T){(A=new c("error")).error(T)}return new u(A,I.type||"string",I.mimeType)},generateAsync:function(E,A){return this.generateInternalStream(E).accumulate(A)},generateNodeStream:function(E,A){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(A)}};r.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var o=n("./DataReader");function i(l){o.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}n("../utils").inherits(i,o),i.prototype.byteAt=function(l){return this.data[this.zero+l]},i.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),m=l.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===c&&this.data[f+1]===u&&this.data[f+2]===d&&this.data[f+3]===m)return f-this.zero;return-1},i.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),m=l.charCodeAt(3),f=this.readData(4);return c===f[0]&&u===f[1]&&d===f[2]&&m===f[3]},i.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=i},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var o=n("../utils");function i(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,u=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)u=(u<<8)+this.byteAt(c);return this.index+=l,u},readString:function(l){return o.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=i},{"../utils":32}],19:[function(n,r,s){var o=n("./Uint8ArrayReader");function i(l){o.call(this,l)}n("../utils").inherits(i,o),i.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var o=n("./DataReader");function i(l){o.call(this,l)}n("../utils").inherits(i,o),i.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},i.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},i.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},i.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=i},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var o=n("./ArrayReader");function i(l){o.call(this,l)}n("../utils").inherits(i,o),i.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},r.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var o=n("../utils"),i=n("../support"),l=n("./ArrayReader"),c=n("./StringReader"),u=n("./NodeBufferReader"),d=n("./Uint8ArrayReader");r.exports=function(m){var f=o.getTypeOf(m);return o.checkSupport(f),f!=="string"||i.uint8array?f==="nodebuffer"?new u(m):i.uint8array?new d(o.transformTo("uint8array",m)):new l(o.transformTo("array",m)):new c(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var o=n("./GenericWorker"),i=n("../utils");function l(c){o.call(this,"ConvertWorker to "+c),this.destType=c}i.inherits(l,o),l.prototype.processChunk=function(c){this.push({data:i.transformTo(this.destType,c.data),meta:c.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var o=n("./GenericWorker"),i=n("../crc32");function l(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(l,o),l.prototype.processChunk=function(c){this.streamInfo.crc32=i(c.data,this.streamInfo.crc32||0),this.push(c)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var o=n("../utils"),i=n("./GenericWorker");function l(c){i.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}o.inherits(l,i),l.prototype.processChunk=function(c){if(c){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+c.data.length}i.prototype.processChunk.call(this,c)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var o=n("../utils"),i=n("./GenericWorker");function l(c){i.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=o.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}o.inherits(l,i),l.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,u);break;case"uint8array":c=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":c=this.data.slice(this.index,u)}return this.index=u,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function o(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,l){return this._listeners[i].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,l){if(this._listeners[i])for(var c=0;c<this._listeners[i].length;c++)this._listeners[i][c].call(this,l)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var l=this;return i.on("data",function(c){l.processChunk(c)}),i.on("end",function(){l.end()}),i.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,l){return this.extraStreamInfo[i]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},r.exports=o},{}],29:[function(n,r,s){var o=n("../utils"),i=n("./ConvertWorker"),l=n("./GenericWorker"),c=n("../base64"),u=n("../support"),d=n("../external"),m=null;if(u.nodestream)try{m=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(v,h){return new d.Promise(function(x,y){var g=[],_=v._internalType,S=v._outputType,E=v._mimeType;v.on("data",function(A,I){g.push(A),h&&h(I)}).on("error",function(A){g=[],y(A)}).on("end",function(){try{var A=function(I,N,T){switch(I){case"blob":return o.newBlob(o.transformTo("arraybuffer",N),T);case"base64":return c.encode(N);default:return o.transformTo(I,N)}}(S,function(I,N){var T,$=0,M=null,j=0;for(T=0;T<N.length;T++)j+=N[T].length;switch(I){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(M=new Uint8Array(j),T=0;T<N.length;T++)M.set(N[T],$),$+=N[T].length;return M;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+I+"'")}}(_,g),E);x(A)}catch(I){y(I)}g=[]}).resume()})}function p(v,h,x){var y=h;switch(h){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=h,this._mimeType=x,o.checkSupport(y),this._worker=v.pipe(new i(y)),v.lock()}catch(g){this._worker=new l("error"),this._worker.error(g)}}p.prototype={accumulate:function(v){return f(this,v)},on:function(v,h){var x=this;return v==="data"?this._worker.on(v,function(y){h.call(x,y.data,y.meta)}):this._worker.on(v,function(){o.delay(h,arguments,x)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},v)}},r.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var o=new ArrayBuffer(0);try{s.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(o),s.blob=i.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var o=n("./utils"),i=n("./support"),l=n("./nodejsUtils"),c=n("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function m(){c.call(this,"utf-8 decode"),this.leftOver=null}function f(){c.call(this,"utf-8 encode")}s.utf8encode=function(p){return i.nodebuffer?l.newBufferFrom(p,"utf-8"):function(v){var h,x,y,g,_,S=v.length,E=0;for(g=0;g<S;g++)(64512&(x=v.charCodeAt(g)))==55296&&g+1<S&&(64512&(y=v.charCodeAt(g+1)))==56320&&(x=65536+(x-55296<<10)+(y-56320),g++),E+=x<128?1:x<2048?2:x<65536?3:4;for(h=i.uint8array?new Uint8Array(E):new Array(E),g=_=0;_<E;g++)(64512&(x=v.charCodeAt(g)))==55296&&g+1<S&&(64512&(y=v.charCodeAt(g+1)))==56320&&(x=65536+(x-55296<<10)+(y-56320),g++),x<128?h[_++]=x:(x<2048?h[_++]=192|x>>>6:(x<65536?h[_++]=224|x>>>12:(h[_++]=240|x>>>18,h[_++]=128|x>>>12&63),h[_++]=128|x>>>6&63),h[_++]=128|63&x);return h}(p)},s.utf8decode=function(p){return i.nodebuffer?o.transformTo("nodebuffer",p).toString("utf-8"):function(v){var h,x,y,g,_=v.length,S=new Array(2*_);for(h=x=0;h<_;)if((y=v[h++])<128)S[x++]=y;else if(4<(g=u[y]))S[x++]=65533,h+=g-1;else{for(y&=g===2?31:g===3?15:7;1<g&&h<_;)y=y<<6|63&v[h++],g--;1<g?S[x++]=65533:y<65536?S[x++]=y:(y-=65536,S[x++]=55296|y>>10&1023,S[x++]=56320|1023&y)}return S.length!==x&&(S.subarray?S=S.subarray(0,x):S.length=x),o.applyFromCharCode(S)}(p=o.transformTo(i.uint8array?"uint8array":"array",p))},o.inherits(m,c),m.prototype.processChunk=function(p){var v=o.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var h=v;(v=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),v.set(h,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var x=function(g,_){var S;for((_=_||g.length)>g.length&&(_=g.length),S=_-1;0<=S&&(192&g[S])==128;)S--;return S<0||S===0?_:S+u[g[S]]>_?S:_}(v),y=v;x!==v.length&&(i.uint8array?(y=v.subarray(0,x),this.leftOver=v.subarray(x,v.length)):(y=v.slice(0,x),this.leftOver=v.slice(x,v.length))),this.push({data:s.utf8decode(y),meta:p.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=m,o.inherits(f,c),f.prototype.processChunk=function(p){this.push({data:s.utf8encode(p.data),meta:p.meta})},s.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var o=n("./support"),i=n("./base64"),l=n("./nodejsUtils"),c=n("./external");function u(h){return h}function d(h,x){for(var y=0;y<h.length;++y)x[y]=255&h.charCodeAt(y);return x}n("setimmediate"),s.newBlob=function(h,x){s.checkSupport("blob");try{return new Blob([h],{type:x})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(h),y.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(h,x,y){var g=[],_=0,S=h.length;if(S<=y)return String.fromCharCode.apply(null,h);for(;_<S;)x==="array"||x==="nodebuffer"?g.push(String.fromCharCode.apply(null,h.slice(_,Math.min(_+y,S)))):g.push(String.fromCharCode.apply(null,h.subarray(_,Math.min(_+y,S)))),_+=y;return g.join("")},stringifyByChar:function(h){for(var x="",y=0;y<h.length;y++)x+=String.fromCharCode(h[y]);return x},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function f(h){var x=65536,y=s.getTypeOf(h),g=!0;if(y==="uint8array"?g=m.applyCanBeUsed.uint8array:y==="nodebuffer"&&(g=m.applyCanBeUsed.nodebuffer),g)for(;1<x;)try{return m.stringifyByChunk(h,y,x)}catch{x=Math.floor(x/2)}return m.stringifyByChar(h)}function p(h,x){for(var y=0;y<h.length;y++)x[y]=h[y];return x}s.applyFromCharCode=f;var v={};v.string={string:u,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return v.string.uint8array(h).buffer},uint8array:function(h){return d(h,new Uint8Array(h.length))},nodebuffer:function(h){return d(h,l.allocBuffer(h.length))}},v.array={string:f,array:u,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return l.newBufferFrom(h)}},v.arraybuffer={string:function(h){return f(new Uint8Array(h))},array:function(h){return p(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:u,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return l.newBufferFrom(new Uint8Array(h))}},v.uint8array={string:f,array:function(h){return p(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:u,nodebuffer:function(h){return l.newBufferFrom(h)}},v.nodebuffer={string:f,array:function(h){return p(h,new Array(h.length))},arraybuffer:function(h){return v.nodebuffer.uint8array(h).buffer},uint8array:function(h){return p(h,new Uint8Array(h.length))},nodebuffer:u},s.transformTo=function(h,x){if(x=x||"",!h)return x;s.checkSupport(h);var y=s.getTypeOf(x);return v[y][h](x)},s.resolve=function(h){for(var x=h.split("/"),y=[],g=0;g<x.length;g++){var _=x[g];_==="."||_===""&&g!==0&&g!==x.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},s.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":o.nodebuffer&&l.isBuffer(h)?"nodebuffer":o.uint8array&&h instanceof Uint8Array?"uint8array":o.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(h){if(!o[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(h){var x,y,g="";for(y=0;y<(h||"").length;y++)g+="\\x"+((x=h.charCodeAt(y))<16?"0":"")+x.toString(16).toUpperCase();return g},s.delay=function(h,x,y){setImmediate(function(){h.apply(y||null,x||[])})},s.inherits=function(h,x){function y(){}y.prototype=x.prototype,h.prototype=new y},s.extend=function(){var h,x,y={};for(h=0;h<arguments.length;h++)for(x in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],x)&&y[x]===void 0&&(y[x]=arguments[h][x]);return y},s.prepareContent=function(h,x,y,g,_){return c.Promise.resolve(x).then(function(S){return o.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new c.Promise(function(E,A){var I=new FileReader;I.onload=function(N){E(N.target.result)},I.onerror=function(N){A(N.target.error)},I.readAsArrayBuffer(S)}):S}).then(function(S){var E=s.getTypeOf(S);return E?(E==="arraybuffer"?S=s.transformTo("uint8array",S):E==="string"&&(_?S=i.decode(S):y&&g!==!0&&(S=function(A){return d(A,o.uint8array?new Uint8Array(A.length):new Array(A.length))}(S))),S):c.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var o=n("./reader/readerFor"),i=n("./utils"),l=n("./signature"),c=n("./zipEntry"),u=n("./support");function d(m){this.files=[],this.loadOptions=m}d.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(f)+", expected "+i.pretty(m)+")")}},isSignature:function(m,f){var p=this.reader.index;this.reader.setIndex(m);var v=this.reader.readString(4)===f;return this.reader.setIndex(p),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),f=u.uint8array?"uint8array":"array",p=i.transformTo(f,m);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,f,p,v=this.zip64EndOfCentralSize-44;0<v;)m=this.reader.readInt(2),f=this.reader.readInt(4),p=this.reader.readData(f),this.zip64ExtensibleData[m]={id:m,length:f,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,f;for(m=0;m<this.files.length;m++)f=this.files[m],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(m=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var f=m;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var v=f-p;if(0<v)this.isSignature(f,l.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(m){this.reader=o(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var o=n("./reader/readerFor"),i=n("./utils"),l=n("./compressedObject"),c=n("./crc32"),u=n("./utf8"),d=n("./compressions"),m=n("./support");function f(p,v){this.options=p,this.loadOptions=v}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var v,h;if(p.skip(22),this.fileNameLength=p.readInt(2),h=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(x){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)&&d[y].magic===x)return d[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,v,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var v=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(v),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=o(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var v,h,x,y=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<y;)v=p.readInt(2),h=p.readInt(2),x=p.readData(h),this.extraFields[v]={id:v,length:h,value:x};p.setIndex(y)},handleUTF8:function(){var p=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var h=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var y=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var v=o(p.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var v=o(p.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null}},r.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function o(v,h,x){this.name=v,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=h,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var i=n("./stream/StreamHelper"),l=n("./stream/DataWorker"),c=n("./utf8"),u=n("./compressedObject"),d=n("./stream/GenericWorker");o.prototype={internalStream:function(v){var h=null,x="string";try{if(!v)throw new Error("No output type specified.");var y=(x=v.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),h=this._decompressWorker();var g=!this._dataBinary;g&&!y&&(h=h.pipe(new c.Utf8EncodeWorker)),!g&&y&&(h=h.pipe(new c.Utf8DecodeWorker))}catch(_){(h=new d("error")).error(_)}return new i(h,x,"")},async:function(v,h){return this.internalStream(v).accumulate(h)},nodeStream:function(v,h){return this.internalStream(v||"nodebuffer").toNodejsStream(h)},_compressWorker:function(v,h){if(this._data instanceof u&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new c.Utf8EncodeWorker)),u.createWorkerFrom(x,v,h)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<m.length;p++)o.prototype[m[p]]=f;r.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(o){var i,l,c=o.MutationObserver||o.WebKitMutationObserver;if(c){var u=0,d=new c(v),m=o.document.createTextNode("");d.observe(m,{characterData:!0}),i=function(){m.data=u=++u%2}}else if(o.setImmediate||o.MessageChannel===void 0)i="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var h=o.document.createElement("script");h.onreadystatechange=function(){v(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},o.document.documentElement.appendChild(h)}:function(){setTimeout(v,0)};else{var f=new o.MessageChannel;f.port1.onmessage=v,i=function(){f.port2.postMessage(0)}}var p=[];function v(){var h,x;l=!0;for(var y=p.length;y;){for(x=p,p=[],h=-1;++h<y;)x[h]();y=p.length}l=!1}r.exports=function(h){p.push(h)!==1||l||i()}}).call(this,typeof Vu<"u"?Vu:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var o=n("immediate");function i(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function m(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,y!==i&&h(this,y)}function f(y,g,_){this.promise=y,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function p(y,g,_){o(function(){var S;try{S=g(_)}catch(E){return l.reject(y,E)}S===y?l.reject(y,new TypeError("Cannot resolve promise with itself")):l.resolve(y,S)})}function v(y){var g=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof g=="function")return function(){g.apply(y,arguments)}}function h(y,g){var _=!1;function S(I){_||(_=!0,l.reject(y,I))}function E(I){_||(_=!0,l.resolve(y,I))}var A=x(function(){g(E,S)});A.status==="error"&&S(A.value)}function x(y,g){var _={};try{_.value=y(g),_.status="success"}catch(S){_.status="error",_.value=S}return _}(r.exports=m).prototype.finally=function(y){if(typeof y!="function")return this;var g=this.constructor;return this.then(function(_){return g.resolve(y()).then(function(){return _})},function(_){return g.resolve(y()).then(function(){throw _})})},m.prototype.catch=function(y){return this.then(null,y)},m.prototype.then=function(y,g){if(typeof y!="function"&&this.state===u||typeof g!="function"&&this.state===c)return this;var _=new this.constructor(i);return this.state!==d?p(_,this.state===u?y:g,this.outcome):this.queue.push(new f(_,y,g)),_},f.prototype.callFulfilled=function(y){l.resolve(this.promise,y)},f.prototype.otherCallFulfilled=function(y){p(this.promise,this.onFulfilled,y)},f.prototype.callRejected=function(y){l.reject(this.promise,y)},f.prototype.otherCallRejected=function(y){p(this.promise,this.onRejected,y)},l.resolve=function(y,g){var _=x(v,g);if(_.status==="error")return l.reject(y,_.value);var S=_.value;if(S)h(y,S);else{y.state=u,y.outcome=g;for(var E=-1,A=y.queue.length;++E<A;)y.queue[E].callFulfilled(g)}return y},l.reject=function(y,g){y.state=c,y.outcome=g;for(var _=-1,S=y.queue.length;++_<S;)y.queue[_].callRejected(g);return y},m.resolve=function(y){return y instanceof this?y:l.resolve(new this(i),y)},m.reject=function(y){var g=new this(i);return l.reject(g,y)},m.all=function(y){var g=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,S=!1;if(!_)return this.resolve([]);for(var E=new Array(_),A=0,I=-1,N=new this(i);++I<_;)T(y[I],I);return N;function T($,M){g.resolve($).then(function(j){E[M]=j,++A!==_||S||(S=!0,l.resolve(N,E))},function(j){S||(S=!0,l.reject(N,j))})}},m.race=function(y){var g=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,S=!1;if(!_)return this.resolve([]);for(var E=-1,A=new this(i);++E<_;)I=y[E],g.resolve(I).then(function(N){S||(S=!0,l.resolve(A,N))},function(N){S||(S=!0,l.reject(A,N))});var I;return A}},{immediate:36}],38:[function(n,r,s){var o={};(0,n("./lib/utils/common").assign)(o,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var o=n("./zlib/deflate"),i=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=Object.prototype.toString,m=0,f=-1,p=0,v=8;function h(y){if(!(this instanceof h))return new h(y);this.options=i.assign({level:f,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},y||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var _=o.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(_!==m)throw new Error(c[_]);if(g.header&&o.deflateSetHeader(this.strm,g.header),g.dictionary){var S;if(S=typeof g.dictionary=="string"?l.string2buf(g.dictionary):d.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(_=o.deflateSetDictionary(this.strm,S))!==m)throw new Error(c[_]);this._dict_set=!0}}function x(y,g){var _=new h(g);if(_.push(y,!0),_.err)throw _.msg||c[_.err];return _.result}h.prototype.push=function(y,g){var _,S,E=this.strm,A=this.options.chunkSize;if(this.ended)return!1;S=g===~~g?g:g===!0?4:0,typeof y=="string"?E.input=l.string2buf(y):d.call(y)==="[object ArrayBuffer]"?E.input=new Uint8Array(y):E.input=y,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new i.Buf8(A),E.next_out=0,E.avail_out=A),(_=o.deflate(E,S))!==1&&_!==m)return this.onEnd(_),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(i.shrinkBuf(E.output,E.next_out))):this.onData(i.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&_!==1);return S===4?(_=o.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===m):S!==2||(this.onEnd(m),!(E.avail_out=0))},h.prototype.onData=function(y){this.chunks.push(y)},h.prototype.onEnd=function(y){y===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Deflate=h,s.deflate=x,s.deflateRaw=function(y,g){return(g=g||{}).raw=!0,x(y,g)},s.gzip=function(y,g){return(g=g||{}).gzip=!0,x(y,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var o=n("./zlib/inflate"),i=n("./utils/common"),l=n("./utils/strings"),c=n("./zlib/constants"),u=n("./zlib/messages"),d=n("./zlib/zstream"),m=n("./zlib/gzheader"),f=Object.prototype.toString;function p(h){if(!(this instanceof p))return new p(h);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},h||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||h&&h.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var y=o.inflateInit2(this.strm,x.windowBits);if(y!==c.Z_OK)throw new Error(u[y]);this.header=new m,o.inflateGetHeader(this.strm,this.header)}function v(h,x){var y=new p(x);if(y.push(h,!0),y.err)throw y.msg||u[y.err];return y.result}p.prototype.push=function(h,x){var y,g,_,S,E,A,I=this.strm,N=this.options.chunkSize,T=this.options.dictionary,$=!1;if(this.ended)return!1;g=x===~~x?x:x===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof h=="string"?I.input=l.binstring2buf(h):f.call(h)==="[object ArrayBuffer]"?I.input=new Uint8Array(h):I.input=h,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new i.Buf8(N),I.next_out=0,I.avail_out=N),(y=o.inflate(I,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&T&&(A=typeof T=="string"?l.string2buf(T):f.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,y=o.inflateSetDictionary(this.strm,A)),y===c.Z_BUF_ERROR&&$===!0&&(y=c.Z_OK,$=!1),y!==c.Z_STREAM_END&&y!==c.Z_OK)return this.onEnd(y),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&y!==c.Z_STREAM_END&&(I.avail_in!==0||g!==c.Z_FINISH&&g!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=l.utf8border(I.output,I.next_out),S=I.next_out-_,E=l.buf2string(I.output,_),I.next_out=S,I.avail_out=N-S,S&&i.arraySet(I.output,I.output,_,S,0),this.onData(E)):this.onData(i.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&($=!0)}while((0<I.avail_in||I.avail_out===0)&&y!==c.Z_STREAM_END);return y===c.Z_STREAM_END&&(g=c.Z_FINISH),g===c.Z_FINISH?(y=o.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===c.Z_OK):g!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(I.avail_out=0))},p.prototype.onData=function(h){this.chunks.push(h)},p.prototype.onEnd=function(h){h===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},s.Inflate=p,s.inflate=v,s.inflateRaw=function(h,x){return(x=x||{}).raw=!0,v(h,x)},s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var m in d)d.hasOwnProperty(m)&&(c[m]=d[m])}}return c},s.shrinkBuf=function(c,u){return c.length===u?c:c.subarray?c.subarray(0,u):(c.length=u,c)};var i={arraySet:function(c,u,d,m,f){if(u.subarray&&c.subarray)c.set(u.subarray(d,d+m),f);else for(var p=0;p<m;p++)c[f+p]=u[d+p]},flattenChunks:function(c){var u,d,m,f,p,v;for(u=m=0,d=c.length;u<d;u++)m+=c[u].length;for(v=new Uint8Array(m),u=f=0,d=c.length;u<d;u++)p=c[u],v.set(p,f),f+=p.length;return v}},l={arraySet:function(c,u,d,m,f){for(var p=0;p<m;p++)c[f+p]=u[d+p]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,i)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,l))},s.setTyped(o)},{}],42:[function(n,r,s){var o=n("./common"),i=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new o.Buf8(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(m,f){if(f<65537&&(m.subarray&&l||!m.subarray&&i))return String.fromCharCode.apply(null,o.shrinkBuf(m,f));for(var p="",v=0;v<f;v++)p+=String.fromCharCode(m[v]);return p}c[254]=c[254]=1,s.string2buf=function(m){var f,p,v,h,x,y=m.length,g=0;for(h=0;h<y;h++)(64512&(p=m.charCodeAt(h)))==55296&&h+1<y&&(64512&(v=m.charCodeAt(h+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),h++),g+=p<128?1:p<2048?2:p<65536?3:4;for(f=new o.Buf8(g),h=x=0;x<g;h++)(64512&(p=m.charCodeAt(h)))==55296&&h+1<y&&(64512&(v=m.charCodeAt(h+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),h++),p<128?f[x++]=p:(p<2048?f[x++]=192|p>>>6:(p<65536?f[x++]=224|p>>>12:(f[x++]=240|p>>>18,f[x++]=128|p>>>12&63),f[x++]=128|p>>>6&63),f[x++]=128|63&p);return f},s.buf2binstring=function(m){return d(m,m.length)},s.binstring2buf=function(m){for(var f=new o.Buf8(m.length),p=0,v=f.length;p<v;p++)f[p]=m.charCodeAt(p);return f},s.buf2string=function(m,f){var p,v,h,x,y=f||m.length,g=new Array(2*y);for(p=v=0;p<y;)if((h=m[p++])<128)g[v++]=h;else if(4<(x=c[h]))g[v++]=65533,p+=x-1;else{for(h&=x===2?31:x===3?15:7;1<x&&p<y;)h=h<<6|63&m[p++],x--;1<x?g[v++]=65533:h<65536?g[v++]=h:(h-=65536,g[v++]=55296|h>>10&1023,g[v++]=56320|1023&h)}return d(g,v)},s.utf8border=function(m,f){var p;for((f=f||m.length)>m.length&&(f=m.length),p=f-1;0<=p&&(192&m[p])==128;)p--;return p<0||p===0?f:p+c[m[p]]>f?p:f}},{"./common":41}],43:[function(n,r,s){r.exports=function(o,i,l,c){for(var u=65535&o|0,d=o>>>16&65535|0,m=0;l!==0;){for(l-=m=2e3<l?2e3:l;d=d+(u=u+i[c++]|0)|0,--m;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var o=function(){for(var i,l=[],c=0;c<256;c++){i=c;for(var u=0;u<8;u++)i=1&i?3988292384^i>>>1:i>>>1;l[c]=i}return l}();r.exports=function(i,l,c,u){var d=o,m=u+c;i^=-1;for(var f=u;f<m;f++)i=i>>>8^d[255&(i^l[f])];return-1^i}},{}],46:[function(n,r,s){var o,i=n("../utils/common"),l=n("./trees"),c=n("./adler32"),u=n("./crc32"),d=n("./messages"),m=0,f=4,p=0,v=-2,h=-1,x=4,y=2,g=8,_=9,S=286,E=30,A=19,I=2*S+1,N=15,T=3,$=258,M=$+T+1,j=42,P=113,b=1,V=2,Z=3,D=4;function L(C,J){return C.msg=d[J],J}function O(C){return(C<<1)-(4<C?9:0)}function q(C){for(var J=C.length;0<=--J;)C[J]=0}function F(C){var J=C.state,ee=J.pending;ee>C.avail_out&&(ee=C.avail_out),ee!==0&&(i.arraySet(C.output,J.pending_buf,J.pending_out,ee,C.next_out),C.next_out+=ee,J.pending_out+=ee,C.total_out+=ee,C.avail_out-=ee,J.pending-=ee,J.pending===0&&(J.pending_out=0))}function W(C,J){l._tr_flush_block(C,0<=C.block_start?C.block_start:-1,C.strstart-C.block_start,J),C.block_start=C.strstart,F(C.strm)}function ce(C,J){C.pending_buf[C.pending++]=J}function ae(C,J){C.pending_buf[C.pending++]=J>>>8&255,C.pending_buf[C.pending++]=255&J}function K(C,J){var ee,z,k=C.max_chain_length,R=C.strstart,U=C.prev_length,X=C.nice_match,B=C.strstart>C.w_size-M?C.strstart-(C.w_size-M):0,Q=C.window,se=C.w_mask,re=C.prev,be=C.strstart+$,Re=Q[R+U-1],Oe=Q[R+U];C.prev_length>=C.good_match&&(k>>=2),X>C.lookahead&&(X=C.lookahead);do if(Q[(ee=J)+U]===Oe&&Q[ee+U-1]===Re&&Q[ee]===Q[R]&&Q[++ee]===Q[R+1]){R+=2,ee++;do;while(Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&Q[++R]===Q[++ee]&&R<be);if(z=$-(be-R),R=be-$,U<z){if(C.match_start=J,X<=(U=z))break;Re=Q[R+U-1],Oe=Q[R+U]}}while((J=re[J&se])>B&&--k!=0);return U<=C.lookahead?U:C.lookahead}function ne(C){var J,ee,z,k,R,U,X,B,Q,se,re=C.w_size;do{if(k=C.window_size-C.lookahead-C.strstart,C.strstart>=re+(re-M)){for(i.arraySet(C.window,C.window,re,re,0),C.match_start-=re,C.strstart-=re,C.block_start-=re,J=ee=C.hash_size;z=C.head[--J],C.head[J]=re<=z?z-re:0,--ee;);for(J=ee=re;z=C.prev[--J],C.prev[J]=re<=z?z-re:0,--ee;);k+=re}if(C.strm.avail_in===0)break;if(U=C.strm,X=C.window,B=C.strstart+C.lookahead,Q=k,se=void 0,se=U.avail_in,Q<se&&(se=Q),ee=se===0?0:(U.avail_in-=se,i.arraySet(X,U.input,U.next_in,se,B),U.state.wrap===1?U.adler=c(U.adler,X,se,B):U.state.wrap===2&&(U.adler=u(U.adler,X,se,B)),U.next_in+=se,U.total_in+=se,se),C.lookahead+=ee,C.lookahead+C.insert>=T)for(R=C.strstart-C.insert,C.ins_h=C.window[R],C.ins_h=(C.ins_h<<C.hash_shift^C.window[R+1])&C.hash_mask;C.insert&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[R+T-1])&C.hash_mask,C.prev[R&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=R,R++,C.insert--,!(C.lookahead+C.insert<T)););}while(C.lookahead<M&&C.strm.avail_in!==0)}function G(C,J){for(var ee,z;;){if(C.lookahead<M){if(ne(C),C.lookahead<M&&J===m)return b;if(C.lookahead===0)break}if(ee=0,C.lookahead>=T&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ee=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),ee!==0&&C.strstart-ee<=C.w_size-M&&(C.match_length=K(C,ee)),C.match_length>=T)if(z=l._tr_tally(C,C.strstart-C.match_start,C.match_length-T),C.lookahead-=C.match_length,C.match_length<=C.max_lazy_match&&C.lookahead>=T){for(C.match_length--;C.strstart++,C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ee=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart,--C.match_length!=0;);C.strstart++}else C.strstart+=C.match_length,C.match_length=0,C.ins_h=C.window[C.strstart],C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+1])&C.hash_mask;else z=l._tr_tally(C,0,C.window[C.strstart]),C.lookahead--,C.strstart++;if(z&&(W(C,!1),C.strm.avail_out===0))return b}return C.insert=C.strstart<T-1?C.strstart:T-1,J===f?(W(C,!0),C.strm.avail_out===0?Z:D):C.last_lit&&(W(C,!1),C.strm.avail_out===0)?b:V}function te(C,J){for(var ee,z,k;;){if(C.lookahead<M){if(ne(C),C.lookahead<M&&J===m)return b;if(C.lookahead===0)break}if(ee=0,C.lookahead>=T&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ee=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),C.prev_length=C.match_length,C.prev_match=C.match_start,C.match_length=T-1,ee!==0&&C.prev_length<C.max_lazy_match&&C.strstart-ee<=C.w_size-M&&(C.match_length=K(C,ee),C.match_length<=5&&(C.strategy===1||C.match_length===T&&4096<C.strstart-C.match_start)&&(C.match_length=T-1)),C.prev_length>=T&&C.match_length<=C.prev_length){for(k=C.strstart+C.lookahead-T,z=l._tr_tally(C,C.strstart-1-C.prev_match,C.prev_length-T),C.lookahead-=C.prev_length-1,C.prev_length-=2;++C.strstart<=k&&(C.ins_h=(C.ins_h<<C.hash_shift^C.window[C.strstart+T-1])&C.hash_mask,ee=C.prev[C.strstart&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=C.strstart),--C.prev_length!=0;);if(C.match_available=0,C.match_length=T-1,C.strstart++,z&&(W(C,!1),C.strm.avail_out===0))return b}else if(C.match_available){if((z=l._tr_tally(C,0,C.window[C.strstart-1]))&&W(C,!1),C.strstart++,C.lookahead--,C.strm.avail_out===0)return b}else C.match_available=1,C.strstart++,C.lookahead--}return C.match_available&&(z=l._tr_tally(C,0,C.window[C.strstart-1]),C.match_available=0),C.insert=C.strstart<T-1?C.strstart:T-1,J===f?(W(C,!0),C.strm.avail_out===0?Z:D):C.last_lit&&(W(C,!1),C.strm.avail_out===0)?b:V}function le(C,J,ee,z,k){this.good_length=C,this.max_lazy=J,this.nice_length=ee,this.max_chain=z,this.func=k}function fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*I),this.dyn_dtree=new i.Buf16(2*(2*E+1)),this.bl_tree=new i.Buf16(2*(2*A+1)),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(N+1),this.heap=new i.Buf16(2*S+1),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*S+1),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ge(C){var J;return C&&C.state?(C.total_in=C.total_out=0,C.data_type=y,(J=C.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?j:P,C.adler=J.wrap===2?0:1,J.last_flush=m,l._tr_init(J),p):L(C,v)}function de(C){var J=ge(C);return J===p&&function(ee){ee.window_size=2*ee.w_size,q(ee.head),ee.max_lazy_match=o[ee.level].max_lazy,ee.good_match=o[ee.level].good_length,ee.nice_match=o[ee.level].nice_length,ee.max_chain_length=o[ee.level].max_chain,ee.strstart=0,ee.block_start=0,ee.lookahead=0,ee.insert=0,ee.match_length=ee.prev_length=T-1,ee.match_available=0,ee.ins_h=0}(C.state),J}function Pe(C,J,ee,z,k,R){if(!C)return v;var U=1;if(J===h&&(J=6),z<0?(U=0,z=-z):15<z&&(U=2,z-=16),k<1||_<k||ee!==g||z<8||15<z||J<0||9<J||R<0||x<R)return L(C,v);z===8&&(z=9);var X=new fe;return(C.state=X).strm=C,X.wrap=U,X.gzhead=null,X.w_bits=z,X.w_size=1<<X.w_bits,X.w_mask=X.w_size-1,X.hash_bits=k+7,X.hash_size=1<<X.hash_bits,X.hash_mask=X.hash_size-1,X.hash_shift=~~((X.hash_bits+T-1)/T),X.window=new i.Buf8(2*X.w_size),X.head=new i.Buf16(X.hash_size),X.prev=new i.Buf16(X.w_size),X.lit_bufsize=1<<k+6,X.pending_buf_size=4*X.lit_bufsize,X.pending_buf=new i.Buf8(X.pending_buf_size),X.d_buf=1*X.lit_bufsize,X.l_buf=3*X.lit_bufsize,X.level=J,X.strategy=R,X.method=ee,de(C)}o=[new le(0,0,0,0,function(C,J){var ee=65535;for(ee>C.pending_buf_size-5&&(ee=C.pending_buf_size-5);;){if(C.lookahead<=1){if(ne(C),C.lookahead===0&&J===m)return b;if(C.lookahead===0)break}C.strstart+=C.lookahead,C.lookahead=0;var z=C.block_start+ee;if((C.strstart===0||C.strstart>=z)&&(C.lookahead=C.strstart-z,C.strstart=z,W(C,!1),C.strm.avail_out===0)||C.strstart-C.block_start>=C.w_size-M&&(W(C,!1),C.strm.avail_out===0))return b}return C.insert=0,J===f?(W(C,!0),C.strm.avail_out===0?Z:D):(C.strstart>C.block_start&&(W(C,!1),C.strm.avail_out),b)}),new le(4,4,8,4,G),new le(4,5,16,8,G),new le(4,6,32,32,G),new le(4,4,16,16,te),new le(8,16,32,32,te),new le(8,16,128,128,te),new le(8,32,128,256,te),new le(32,128,258,1024,te),new le(32,258,258,4096,te)],s.deflateInit=function(C,J){return Pe(C,J,g,15,8,0)},s.deflateInit2=Pe,s.deflateReset=de,s.deflateResetKeep=ge,s.deflateSetHeader=function(C,J){return C&&C.state?C.state.wrap!==2?v:(C.state.gzhead=J,p):v},s.deflate=function(C,J){var ee,z,k,R;if(!C||!C.state||5<J||J<0)return C?L(C,v):v;if(z=C.state,!C.output||!C.input&&C.avail_in!==0||z.status===666&&J!==f)return L(C,C.avail_out===0?-5:v);if(z.strm=C,ee=z.last_flush,z.last_flush=J,z.status===j)if(z.wrap===2)C.adler=0,ce(z,31),ce(z,139),ce(z,8),z.gzhead?(ce(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),ce(z,255&z.gzhead.time),ce(z,z.gzhead.time>>8&255),ce(z,z.gzhead.time>>16&255),ce(z,z.gzhead.time>>24&255),ce(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),ce(z,255&z.gzhead.os),z.gzhead.extra&&z.gzhead.extra.length&&(ce(z,255&z.gzhead.extra.length),ce(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(C.adler=u(C.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=69):(ce(z,0),ce(z,0),ce(z,0),ce(z,0),ce(z,0),ce(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),ce(z,3),z.status=P);else{var U=g+(z.w_bits-8<<4)<<8;U|=(2<=z.strategy||z.level<2?0:z.level<6?1:z.level===6?2:3)<<6,z.strstart!==0&&(U|=32),U+=31-U%31,z.status=P,ae(z,U),z.strstart!==0&&(ae(z,C.adler>>>16),ae(z,65535&C.adler)),C.adler=1}if(z.status===69)if(z.gzhead.extra){for(k=z.pending;z.gzindex<(65535&z.gzhead.extra.length)&&(z.pending!==z.pending_buf_size||(z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),F(C),k=z.pending,z.pending!==z.pending_buf_size));)ce(z,255&z.gzhead.extra[z.gzindex]),z.gzindex++;z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=73)}else z.status=73;if(z.status===73)if(z.gzhead.name){k=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),F(C),k=z.pending,z.pending===z.pending_buf_size)){R=1;break}R=z.gzindex<z.gzhead.name.length?255&z.gzhead.name.charCodeAt(z.gzindex++):0,ce(z,R)}while(R!==0);z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),R===0&&(z.gzindex=0,z.status=91)}else z.status=91;if(z.status===91)if(z.gzhead.comment){k=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),F(C),k=z.pending,z.pending===z.pending_buf_size)){R=1;break}R=z.gzindex<z.gzhead.comment.length?255&z.gzhead.comment.charCodeAt(z.gzindex++):0,ce(z,R)}while(R!==0);z.gzhead.hcrc&&z.pending>k&&(C.adler=u(C.adler,z.pending_buf,z.pending-k,k)),R===0&&(z.status=103)}else z.status=103;if(z.status===103&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&F(C),z.pending+2<=z.pending_buf_size&&(ce(z,255&C.adler),ce(z,C.adler>>8&255),C.adler=0,z.status=P)):z.status=P),z.pending!==0){if(F(C),C.avail_out===0)return z.last_flush=-1,p}else if(C.avail_in===0&&O(J)<=O(ee)&&J!==f)return L(C,-5);if(z.status===666&&C.avail_in!==0)return L(C,-5);if(C.avail_in!==0||z.lookahead!==0||J!==m&&z.status!==666){var X=z.strategy===2?function(B,Q){for(var se;;){if(B.lookahead===0&&(ne(B),B.lookahead===0)){if(Q===m)return b;break}if(B.match_length=0,se=l._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,se&&(W(B,!1),B.strm.avail_out===0))return b}return B.insert=0,Q===f?(W(B,!0),B.strm.avail_out===0?Z:D):B.last_lit&&(W(B,!1),B.strm.avail_out===0)?b:V}(z,J):z.strategy===3?function(B,Q){for(var se,re,be,Re,Oe=B.window;;){if(B.lookahead<=$){if(ne(B),B.lookahead<=$&&Q===m)return b;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=T&&0<B.strstart&&(re=Oe[be=B.strstart-1])===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]){Re=B.strstart+$;do;while(re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&re===Oe[++be]&&be<Re);B.match_length=$-(Re-be),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=T?(se=l._tr_tally(B,1,B.match_length-T),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(se=l._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),se&&(W(B,!1),B.strm.avail_out===0))return b}return B.insert=0,Q===f?(W(B,!0),B.strm.avail_out===0?Z:D):B.last_lit&&(W(B,!1),B.strm.avail_out===0)?b:V}(z,J):o[z.level].func(z,J);if(X!==Z&&X!==D||(z.status=666),X===b||X===Z)return C.avail_out===0&&(z.last_flush=-1),p;if(X===V&&(J===1?l._tr_align(z):J!==5&&(l._tr_stored_block(z,0,0,!1),J===3&&(q(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),F(C),C.avail_out===0))return z.last_flush=-1,p}return J!==f?p:z.wrap<=0?1:(z.wrap===2?(ce(z,255&C.adler),ce(z,C.adler>>8&255),ce(z,C.adler>>16&255),ce(z,C.adler>>24&255),ce(z,255&C.total_in),ce(z,C.total_in>>8&255),ce(z,C.total_in>>16&255),ce(z,C.total_in>>24&255)):(ae(z,C.adler>>>16),ae(z,65535&C.adler)),F(C),0<z.wrap&&(z.wrap=-z.wrap),z.pending!==0?p:1)},s.deflateEnd=function(C){var J;return C&&C.state?(J=C.state.status)!==j&&J!==69&&J!==73&&J!==91&&J!==103&&J!==P&&J!==666?L(C,v):(C.state=null,J===P?L(C,-3):p):v},s.deflateSetDictionary=function(C,J){var ee,z,k,R,U,X,B,Q,se=J.length;if(!C||!C.state||(R=(ee=C.state).wrap)===2||R===1&&ee.status!==j||ee.lookahead)return v;for(R===1&&(C.adler=c(C.adler,J,se,0)),ee.wrap=0,se>=ee.w_size&&(R===0&&(q(ee.head),ee.strstart=0,ee.block_start=0,ee.insert=0),Q=new i.Buf8(ee.w_size),i.arraySet(Q,J,se-ee.w_size,ee.w_size,0),J=Q,se=ee.w_size),U=C.avail_in,X=C.next_in,B=C.input,C.avail_in=se,C.next_in=0,C.input=J,ne(ee);ee.lookahead>=T;){for(z=ee.strstart,k=ee.lookahead-(T-1);ee.ins_h=(ee.ins_h<<ee.hash_shift^ee.window[z+T-1])&ee.hash_mask,ee.prev[z&ee.w_mask]=ee.head[ee.ins_h],ee.head[ee.ins_h]=z,z++,--k;);ee.strstart=z,ee.lookahead=T-1,ne(ee)}return ee.strstart+=ee.lookahead,ee.block_start=ee.strstart,ee.insert=ee.lookahead,ee.lookahead=0,ee.match_length=ee.prev_length=T-1,ee.match_available=0,C.next_in=X,C.input=B,C.avail_in=U,ee.wrap=R,p},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(o,i){var l,c,u,d,m,f,p,v,h,x,y,g,_,S,E,A,I,N,T,$,M,j,P,b,V;l=o.state,c=o.next_in,b=o.input,u=c+(o.avail_in-5),d=o.next_out,V=o.output,m=d-(i-o.avail_out),f=d+(o.avail_out-257),p=l.dmax,v=l.wsize,h=l.whave,x=l.wnext,y=l.window,g=l.hold,_=l.bits,S=l.lencode,E=l.distcode,A=(1<<l.lenbits)-1,I=(1<<l.distbits)-1;e:do{_<15&&(g+=b[c++]<<_,_+=8,g+=b[c++]<<_,_+=8),N=S[g&A];t:for(;;){if(g>>>=T=N>>>24,_-=T,(T=N>>>16&255)===0)V[d++]=65535&N;else{if(!(16&T)){if(!(64&T)){N=S[(65535&N)+(g&(1<<T)-1)];continue t}if(32&T){l.mode=12;break e}o.msg="invalid literal/length code",l.mode=30;break e}$=65535&N,(T&=15)&&(_<T&&(g+=b[c++]<<_,_+=8),$+=g&(1<<T)-1,g>>>=T,_-=T),_<15&&(g+=b[c++]<<_,_+=8,g+=b[c++]<<_,_+=8),N=E[g&I];n:for(;;){if(g>>>=T=N>>>24,_-=T,!(16&(T=N>>>16&255))){if(!(64&T)){N=E[(65535&N)+(g&(1<<T)-1)];continue n}o.msg="invalid distance code",l.mode=30;break e}if(M=65535&N,_<(T&=15)&&(g+=b[c++]<<_,(_+=8)<T&&(g+=b[c++]<<_,_+=8)),p<(M+=g&(1<<T)-1)){o.msg="invalid distance too far back",l.mode=30;break e}if(g>>>=T,_-=T,(T=d-m)<M){if(h<(T=M-T)&&l.sane){o.msg="invalid distance too far back",l.mode=30;break e}if(P=y,(j=0)===x){if(j+=v-T,T<$){for($-=T;V[d++]=y[j++],--T;);j=d-M,P=V}}else if(x<T){if(j+=v+x-T,(T-=x)<$){for($-=T;V[d++]=y[j++],--T;);if(j=0,x<$){for($-=T=x;V[d++]=y[j++],--T;);j=d-M,P=V}}}else if(j+=x-T,T<$){for($-=T;V[d++]=y[j++],--T;);j=d-M,P=V}for(;2<$;)V[d++]=P[j++],V[d++]=P[j++],V[d++]=P[j++],$-=3;$&&(V[d++]=P[j++],1<$&&(V[d++]=P[j++]))}else{for(j=d-M;V[d++]=V[j++],V[d++]=V[j++],V[d++]=V[j++],2<($-=3););$&&(V[d++]=V[j++],1<$&&(V[d++]=V[j++]))}break}}break}}while(c<u&&d<f);c-=$=_>>3,g&=(1<<(_-=$<<3))-1,o.next_in=c,o.next_out=d,o.avail_in=c<u?u-c+5:5-(c-u),o.avail_out=d<f?f-d+257:257-(d-f),l.hold=g,l.bits=_}},{}],49:[function(n,r,s){var o=n("../utils/common"),i=n("./adler32"),l=n("./crc32"),c=n("./inffast"),u=n("./inftrees"),d=1,m=2,f=0,p=-2,v=1,h=852,x=592;function y(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(j){var P;return j&&j.state?(P=j.state,j.total_in=j.total_out=P.total=0,j.msg="",P.wrap&&(j.adler=1&P.wrap),P.mode=v,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new o.Buf32(h),P.distcode=P.distdyn=new o.Buf32(x),P.sane=1,P.back=-1,f):p}function S(j){var P;return j&&j.state?((P=j.state).wsize=0,P.whave=0,P.wnext=0,_(j)):p}function E(j,P){var b,V;return j&&j.state?(V=j.state,P<0?(b=0,P=-P):(b=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?p:(V.window!==null&&V.wbits!==P&&(V.window=null),V.wrap=b,V.wbits=P,S(j))):p}function A(j,P){var b,V;return j?(V=new g,(j.state=V).window=null,(b=E(j,P))!==f&&(j.state=null),b):p}var I,N,T=!0;function $(j){if(T){var P;for(I=new o.Buf32(512),N=new o.Buf32(32),P=0;P<144;)j.lens[P++]=8;for(;P<256;)j.lens[P++]=9;for(;P<280;)j.lens[P++]=7;for(;P<288;)j.lens[P++]=8;for(u(d,j.lens,0,288,I,0,j.work,{bits:9}),P=0;P<32;)j.lens[P++]=5;u(m,j.lens,0,32,N,0,j.work,{bits:5}),T=!1}j.lencode=I,j.lenbits=9,j.distcode=N,j.distbits=5}function M(j,P,b,V){var Z,D=j.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new o.Buf8(D.wsize)),V>=D.wsize?(o.arraySet(D.window,P,b-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(V<(Z=D.wsize-D.wnext)&&(Z=V),o.arraySet(D.window,P,b-V,Z,D.wnext),(V-=Z)?(o.arraySet(D.window,P,b-V,V,0),D.wnext=V,D.whave=D.wsize):(D.wnext+=Z,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=Z))),0}s.inflateReset=S,s.inflateReset2=E,s.inflateResetKeep=_,s.inflateInit=function(j){return A(j,15)},s.inflateInit2=A,s.inflate=function(j,P){var b,V,Z,D,L,O,q,F,W,ce,ae,K,ne,G,te,le,fe,ge,de,Pe,C,J,ee,z,k=0,R=new o.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return p;(b=j.state).mode===12&&(b.mode=13),L=j.next_out,Z=j.output,q=j.avail_out,D=j.next_in,V=j.input,O=j.avail_in,F=b.hold,W=b.bits,ce=O,ae=q,J=f;e:for(;;)switch(b.mode){case v:if(b.wrap===0){b.mode=13;break}for(;W<16;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(2&b.wrap&&F===35615){R[b.check=0]=255&F,R[1]=F>>>8&255,b.check=l(b.check,R,2,0),W=F=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&F)<<8)+(F>>8))%31){j.msg="incorrect header check",b.mode=30;break}if((15&F)!=8){j.msg="unknown compression method",b.mode=30;break}if(W-=4,C=8+(15&(F>>>=4)),b.wbits===0)b.wbits=C;else if(C>b.wbits){j.msg="invalid window size",b.mode=30;break}b.dmax=1<<C,j.adler=b.check=1,b.mode=512&F?10:12,W=F=0;break;case 2:for(;W<16;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(b.flags=F,(255&b.flags)!=8){j.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){j.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=F>>8&1),512&b.flags&&(R[0]=255&F,R[1]=F>>>8&255,b.check=l(b.check,R,2,0)),W=F=0,b.mode=3;case 3:for(;W<32;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.head&&(b.head.time=F),512&b.flags&&(R[0]=255&F,R[1]=F>>>8&255,R[2]=F>>>16&255,R[3]=F>>>24&255,b.check=l(b.check,R,4,0)),W=F=0,b.mode=4;case 4:for(;W<16;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.head&&(b.head.xflags=255&F,b.head.os=F>>8),512&b.flags&&(R[0]=255&F,R[1]=F>>>8&255,b.check=l(b.check,R,2,0)),W=F=0,b.mode=5;case 5:if(1024&b.flags){for(;W<16;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.length=F,b.head&&(b.head.extra_len=F),512&b.flags&&(R[0]=255&F,R[1]=F>>>8&255,b.check=l(b.check,R,2,0)),W=F=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(O<(K=b.length)&&(K=O),K&&(b.head&&(C=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),o.arraySet(b.head.extra,V,D,K,C)),512&b.flags&&(b.check=l(b.check,V,K,D)),O-=K,D+=K,b.length-=K),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(O===0)break e;for(K=0;C=V[D+K++],b.head&&C&&b.length<65536&&(b.head.name+=String.fromCharCode(C)),C&&K<O;);if(512&b.flags&&(b.check=l(b.check,V,K,D)),O-=K,D+=K,C)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(O===0)break e;for(K=0;C=V[D+K++],b.head&&C&&b.length<65536&&(b.head.comment+=String.fromCharCode(C)),C&&K<O;);if(512&b.flags&&(b.check=l(b.check,V,K,D)),O-=K,D+=K,C)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;W<16;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(F!==(65535&b.check)){j.msg="header crc mismatch",b.mode=30;break}W=F=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),j.adler=b.check=0,b.mode=12;break;case 10:for(;W<32;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}j.adler=b.check=y(F),W=F=0,b.mode=11;case 11:if(b.havedict===0)return j.next_out=L,j.avail_out=q,j.next_in=D,j.avail_in=O,b.hold=F,b.bits=W,2;j.adler=b.check=1,b.mode=12;case 12:if(P===5||P===6)break e;case 13:if(b.last){F>>>=7&W,W-=7&W,b.mode=27;break}for(;W<3;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}switch(b.last=1&F,W-=1,3&(F>>>=1)){case 0:b.mode=14;break;case 1:if($(b),b.mode=20,P!==6)break;F>>>=2,W-=2;break e;case 2:b.mode=17;break;case 3:j.msg="invalid block type",b.mode=30}F>>>=2,W-=2;break;case 14:for(F>>>=7&W,W-=7&W;W<32;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if((65535&F)!=(F>>>16^65535)){j.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&F,W=F=0,b.mode=15,P===6)break e;case 15:b.mode=16;case 16:if(K=b.length){if(O<K&&(K=O),q<K&&(K=q),K===0)break e;o.arraySet(Z,V,D,K,L),O-=K,D+=K,q-=K,L+=K,b.length-=K;break}b.mode=12;break;case 17:for(;W<14;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(b.nlen=257+(31&F),F>>>=5,W-=5,b.ndist=1+(31&F),F>>>=5,W-=5,b.ncode=4+(15&F),F>>>=4,W-=4,286<b.nlen||30<b.ndist){j.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;W<3;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.lens[U[b.have++]]=7&F,F>>>=3,W-=3}for(;b.have<19;)b.lens[U[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,ee={bits:b.lenbits},J=u(0,b.lens,0,19,b.lencode,0,b.work,ee),b.lenbits=ee.bits,J){j.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;le=(k=b.lencode[F&(1<<b.lenbits)-1])>>>16&255,fe=65535&k,!((te=k>>>24)<=W);){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(fe<16)F>>>=te,W-=te,b.lens[b.have++]=fe;else{if(fe===16){for(z=te+2;W<z;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(F>>>=te,W-=te,b.have===0){j.msg="invalid bit length repeat",b.mode=30;break}C=b.lens[b.have-1],K=3+(3&F),F>>>=2,W-=2}else if(fe===17){for(z=te+3;W<z;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}W-=te,C=0,K=3+(7&(F>>>=te)),F>>>=3,W-=3}else{for(z=te+7;W<z;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}W-=te,C=0,K=11+(127&(F>>>=te)),F>>>=7,W-=7}if(b.have+K>b.nlen+b.ndist){j.msg="invalid bit length repeat",b.mode=30;break}for(;K--;)b.lens[b.have++]=C}}if(b.mode===30)break;if(b.lens[256]===0){j.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,ee={bits:b.lenbits},J=u(d,b.lens,0,b.nlen,b.lencode,0,b.work,ee),b.lenbits=ee.bits,J){j.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,ee={bits:b.distbits},J=u(m,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,ee),b.distbits=ee.bits,J){j.msg="invalid distances set",b.mode=30;break}if(b.mode=20,P===6)break e;case 20:b.mode=21;case 21:if(6<=O&&258<=q){j.next_out=L,j.avail_out=q,j.next_in=D,j.avail_in=O,b.hold=F,b.bits=W,c(j,ae),L=j.next_out,Z=j.output,q=j.avail_out,D=j.next_in,V=j.input,O=j.avail_in,F=b.hold,W=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;le=(k=b.lencode[F&(1<<b.lenbits)-1])>>>16&255,fe=65535&k,!((te=k>>>24)<=W);){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(le&&!(240&le)){for(ge=te,de=le,Pe=fe;le=(k=b.lencode[Pe+((F&(1<<ge+de)-1)>>ge)])>>>16&255,fe=65535&k,!(ge+(te=k>>>24)<=W);){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}F>>>=ge,W-=ge,b.back+=ge}if(F>>>=te,W-=te,b.back+=te,b.length=fe,le===0){b.mode=26;break}if(32&le){b.back=-1,b.mode=12;break}if(64&le){j.msg="invalid literal/length code",b.mode=30;break}b.extra=15&le,b.mode=22;case 22:if(b.extra){for(z=b.extra;W<z;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.length+=F&(1<<b.extra)-1,F>>>=b.extra,W-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;le=(k=b.distcode[F&(1<<b.distbits)-1])>>>16&255,fe=65535&k,!((te=k>>>24)<=W);){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(!(240&le)){for(ge=te,de=le,Pe=fe;le=(k=b.distcode[Pe+((F&(1<<ge+de)-1)>>ge)])>>>16&255,fe=65535&k,!(ge+(te=k>>>24)<=W);){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}F>>>=ge,W-=ge,b.back+=ge}if(F>>>=te,W-=te,b.back+=te,64&le){j.msg="invalid distance code",b.mode=30;break}b.offset=fe,b.extra=15&le,b.mode=24;case 24:if(b.extra){for(z=b.extra;W<z;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}b.offset+=F&(1<<b.extra)-1,F>>>=b.extra,W-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){j.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(q===0)break e;if(K=ae-q,b.offset>K){if((K=b.offset-K)>b.whave&&b.sane){j.msg="invalid distance too far back",b.mode=30;break}ne=K>b.wnext?(K-=b.wnext,b.wsize-K):b.wnext-K,K>b.length&&(K=b.length),G=b.window}else G=Z,ne=L-b.offset,K=b.length;for(q<K&&(K=q),q-=K,b.length-=K;Z[L++]=G[ne++],--K;);b.length===0&&(b.mode=21);break;case 26:if(q===0)break e;Z[L++]=b.length,q--,b.mode=21;break;case 27:if(b.wrap){for(;W<32;){if(O===0)break e;O--,F|=V[D++]<<W,W+=8}if(ae-=q,j.total_out+=ae,b.total+=ae,ae&&(j.adler=b.check=b.flags?l(b.check,Z,ae,L-ae):i(b.check,Z,ae,L-ae)),ae=q,(b.flags?F:y(F))!==b.check){j.msg="incorrect data check",b.mode=30;break}W=F=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;W<32;){if(O===0)break e;O--,F+=V[D++]<<W,W+=8}if(F!==(4294967295&b.total)){j.msg="incorrect length check",b.mode=30;break}W=F=0}b.mode=29;case 29:J=1;break e;case 30:J=-3;break e;case 31:return-4;case 32:default:return p}return j.next_out=L,j.avail_out=q,j.next_in=D,j.avail_in=O,b.hold=F,b.bits=W,(b.wsize||ae!==j.avail_out&&b.mode<30&&(b.mode<27||P!==4))&&M(j,j.output,j.next_out,ae-j.avail_out)?(b.mode=31,-4):(ce-=j.avail_in,ae-=j.avail_out,j.total_in+=ce,j.total_out+=ae,b.total+=ae,b.wrap&&ae&&(j.adler=b.check=b.flags?l(b.check,Z,ae,j.next_out-ae):i(b.check,Z,ae,j.next_out-ae)),j.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(ce==0&&ae===0||P===4)&&J===f&&(J=-5),J)},s.inflateEnd=function(j){if(!j||!j.state)return p;var P=j.state;return P.window&&(P.window=null),j.state=null,f},s.inflateGetHeader=function(j,P){var b;return j&&j.state&&2&(b=j.state).wrap?((b.head=P).done=!1,f):p},s.inflateSetDictionary=function(j,P){var b,V=P.length;return j&&j.state?(b=j.state).wrap!==0&&b.mode!==11?p:b.mode===11&&i(1,P,V,0)!==b.check?-3:M(j,P,V,V)?(b.mode=31,-4):(b.havedict=1,f):p},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var o=n("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,m,f,p,v,h,x,y){var g,_,S,E,A,I,N,T,$,M=y.bits,j=0,P=0,b=0,V=0,Z=0,D=0,L=0,O=0,q=0,F=0,W=null,ce=0,ae=new o.Buf16(16),K=new o.Buf16(16),ne=null,G=0;for(j=0;j<=15;j++)ae[j]=0;for(P=0;P<p;P++)ae[m[f+P]]++;for(Z=M,V=15;1<=V&&ae[V]===0;V--);if(V<Z&&(Z=V),V===0)return v[h++]=20971520,v[h++]=20971520,y.bits=1,0;for(b=1;b<V&&ae[b]===0;b++);for(Z<b&&(Z=b),j=O=1;j<=15;j++)if(O<<=1,(O-=ae[j])<0)return-1;if(0<O&&(d===0||V!==1))return-1;for(K[1]=0,j=1;j<15;j++)K[j+1]=K[j]+ae[j];for(P=0;P<p;P++)m[f+P]!==0&&(x[K[m[f+P]]++]=P);if(I=d===0?(W=ne=x,19):d===1?(W=i,ce-=257,ne=l,G-=257,256):(W=c,ne=u,-1),j=b,A=h,L=P=F=0,S=-1,E=(q=1<<(D=Z))-1,d===1&&852<q||d===2&&592<q)return 1;for(;;){for(N=j-L,$=x[P]<I?(T=0,x[P]):x[P]>I?(T=ne[G+x[P]],W[ce+x[P]]):(T=96,0),g=1<<j-L,b=_=1<<D;v[A+(F>>L)+(_-=g)]=N<<24|T<<16|$|0,_!==0;);for(g=1<<j-1;F&g;)g>>=1;if(g!==0?(F&=g-1,F+=g):F=0,P++,--ae[j]==0){if(j===V)break;j=m[f+x[P]]}if(Z<j&&(F&E)!==S){for(L===0&&(L=Z),A+=b,O=1<<(D=j-L);D+L<V&&!((O-=ae[D+L])<=0);)D++,O<<=1;if(q+=1<<D,d===1&&852<q||d===2&&592<q)return 1;v[S=F&E]=Z<<24|D<<16|A-h|0}}return F!==0&&(v[A+F]=j-L<<24|64<<16|0),y.bits=Z,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var o=n("../utils/common"),i=0,l=1;function c(k){for(var R=k.length;0<=--R;)k[R]=0}var u=0,d=29,m=256,f=m+1+d,p=30,v=19,h=2*f+1,x=15,y=16,g=7,_=256,S=16,E=17,A=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(f+2));c(M);var j=new Array(2*p);c(j);var P=new Array(512);c(P);var b=new Array(256);c(b);var V=new Array(d);c(V);var Z,D,L,O=new Array(p);function q(k,R,U,X,B){this.static_tree=k,this.extra_bits=R,this.extra_base=U,this.elems=X,this.max_length=B,this.has_stree=k&&k.length}function F(k,R){this.dyn_tree=k,this.max_code=0,this.stat_desc=R}function W(k){return k<256?P[k]:P[256+(k>>>7)]}function ce(k,R){k.pending_buf[k.pending++]=255&R,k.pending_buf[k.pending++]=R>>>8&255}function ae(k,R,U){k.bi_valid>y-U?(k.bi_buf|=R<<k.bi_valid&65535,ce(k,k.bi_buf),k.bi_buf=R>>y-k.bi_valid,k.bi_valid+=U-y):(k.bi_buf|=R<<k.bi_valid&65535,k.bi_valid+=U)}function K(k,R,U){ae(k,U[2*R],U[2*R+1])}function ne(k,R){for(var U=0;U|=1&k,k>>>=1,U<<=1,0<--R;);return U>>>1}function G(k,R,U){var X,B,Q=new Array(x+1),se=0;for(X=1;X<=x;X++)Q[X]=se=se+U[X-1]<<1;for(B=0;B<=R;B++){var re=k[2*B+1];re!==0&&(k[2*B]=ne(Q[re]++,re))}}function te(k){var R;for(R=0;R<f;R++)k.dyn_ltree[2*R]=0;for(R=0;R<p;R++)k.dyn_dtree[2*R]=0;for(R=0;R<v;R++)k.bl_tree[2*R]=0;k.dyn_ltree[2*_]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function le(k){8<k.bi_valid?ce(k,k.bi_buf):0<k.bi_valid&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function fe(k,R,U,X){var B=2*R,Q=2*U;return k[B]<k[Q]||k[B]===k[Q]&&X[R]<=X[U]}function ge(k,R,U){for(var X=k.heap[U],B=U<<1;B<=k.heap_len&&(B<k.heap_len&&fe(R,k.heap[B+1],k.heap[B],k.depth)&&B++,!fe(R,X,k.heap[B],k.depth));)k.heap[U]=k.heap[B],U=B,B<<=1;k.heap[U]=X}function de(k,R,U){var X,B,Q,se,re=0;if(k.last_lit!==0)for(;X=k.pending_buf[k.d_buf+2*re]<<8|k.pending_buf[k.d_buf+2*re+1],B=k.pending_buf[k.l_buf+re],re++,X===0?K(k,B,R):(K(k,(Q=b[B])+m+1,R),(se=I[Q])!==0&&ae(k,B-=V[Q],se),K(k,Q=W(--X),U),(se=N[Q])!==0&&ae(k,X-=O[Q],se)),re<k.last_lit;);K(k,_,R)}function Pe(k,R){var U,X,B,Q=R.dyn_tree,se=R.stat_desc.static_tree,re=R.stat_desc.has_stree,be=R.stat_desc.elems,Re=-1;for(k.heap_len=0,k.heap_max=h,U=0;U<be;U++)Q[2*U]!==0?(k.heap[++k.heap_len]=Re=U,k.depth[U]=0):Q[2*U+1]=0;for(;k.heap_len<2;)Q[2*(B=k.heap[++k.heap_len]=Re<2?++Re:0)]=1,k.depth[B]=0,k.opt_len--,re&&(k.static_len-=se[2*B+1]);for(R.max_code=Re,U=k.heap_len>>1;1<=U;U--)ge(k,Q,U);for(B=be;U=k.heap[1],k.heap[1]=k.heap[k.heap_len--],ge(k,Q,1),X=k.heap[1],k.heap[--k.heap_max]=U,k.heap[--k.heap_max]=X,Q[2*B]=Q[2*U]+Q[2*X],k.depth[B]=(k.depth[U]>=k.depth[X]?k.depth[U]:k.depth[X])+1,Q[2*U+1]=Q[2*X+1]=B,k.heap[1]=B++,ge(k,Q,1),2<=k.heap_len;);k.heap[--k.heap_max]=k.heap[1],function(Oe,Pn){var gs,Dn,qo,_t,Oa,Ma,ys=Pn.dyn_tree,Fx=Pn.max_code,cR=Pn.stat_desc.static_tree,uR=Pn.stat_desc.has_stree,dR=Pn.stat_desc.extra_bits,Vx=Pn.stat_desc.extra_base,El=Pn.stat_desc.max_length,Lu=0;for(_t=0;_t<=x;_t++)Oe.bl_count[_t]=0;for(ys[2*Oe.heap[Oe.heap_max]+1]=0,gs=Oe.heap_max+1;gs<h;gs++)El<(_t=ys[2*ys[2*(Dn=Oe.heap[gs])+1]+1]+1)&&(_t=El,Lu++),ys[2*Dn+1]=_t,Fx<Dn||(Oe.bl_count[_t]++,Oa=0,Vx<=Dn&&(Oa=dR[Dn-Vx]),Ma=ys[2*Dn],Oe.opt_len+=Ma*(_t+Oa),uR&&(Oe.static_len+=Ma*(cR[2*Dn+1]+Oa)));if(Lu!==0){do{for(_t=El-1;Oe.bl_count[_t]===0;)_t--;Oe.bl_count[_t]--,Oe.bl_count[_t+1]+=2,Oe.bl_count[El]--,Lu-=2}while(0<Lu);for(_t=El;_t!==0;_t--)for(Dn=Oe.bl_count[_t];Dn!==0;)Fx<(qo=Oe.heap[--gs])||(ys[2*qo+1]!==_t&&(Oe.opt_len+=(_t-ys[2*qo+1])*ys[2*qo],ys[2*qo+1]=_t),Dn--)}}(k,R),G(Q,Re,k.bl_count)}function C(k,R,U){var X,B,Q=-1,se=R[1],re=0,be=7,Re=4;for(se===0&&(be=138,Re=3),R[2*(U+1)+1]=65535,X=0;X<=U;X++)B=se,se=R[2*(X+1)+1],++re<be&&B===se||(re<Re?k.bl_tree[2*B]+=re:B!==0?(B!==Q&&k.bl_tree[2*B]++,k.bl_tree[2*S]++):re<=10?k.bl_tree[2*E]++:k.bl_tree[2*A]++,Q=B,Re=(re=0)===se?(be=138,3):B===se?(be=6,3):(be=7,4))}function J(k,R,U){var X,B,Q=-1,se=R[1],re=0,be=7,Re=4;for(se===0&&(be=138,Re=3),X=0;X<=U;X++)if(B=se,se=R[2*(X+1)+1],!(++re<be&&B===se)){if(re<Re)for(;K(k,B,k.bl_tree),--re!=0;);else B!==0?(B!==Q&&(K(k,B,k.bl_tree),re--),K(k,S,k.bl_tree),ae(k,re-3,2)):re<=10?(K(k,E,k.bl_tree),ae(k,re-3,3)):(K(k,A,k.bl_tree),ae(k,re-11,7));Q=B,Re=(re=0)===se?(be=138,3):B===se?(be=6,3):(be=7,4)}}c(O);var ee=!1;function z(k,R,U,X){ae(k,(u<<1)+(X?1:0),3),function(B,Q,se,re){le(B),ce(B,se),ce(B,~se),o.arraySet(B.pending_buf,B.window,Q,se,B.pending),B.pending+=se}(k,R,U)}s._tr_init=function(k){ee||(function(){var R,U,X,B,Q,se=new Array(x+1);for(B=X=0;B<d-1;B++)for(V[B]=X,R=0;R<1<<I[B];R++)b[X++]=B;for(b[X-1]=B,B=Q=0;B<16;B++)for(O[B]=Q,R=0;R<1<<N[B];R++)P[Q++]=B;for(Q>>=7;B<p;B++)for(O[B]=Q<<7,R=0;R<1<<N[B]-7;R++)P[256+Q++]=B;for(U=0;U<=x;U++)se[U]=0;for(R=0;R<=143;)M[2*R+1]=8,R++,se[8]++;for(;R<=255;)M[2*R+1]=9,R++,se[9]++;for(;R<=279;)M[2*R+1]=7,R++,se[7]++;for(;R<=287;)M[2*R+1]=8,R++,se[8]++;for(G(M,f+1,se),R=0;R<p;R++)j[2*R+1]=5,j[2*R]=ne(R,5);Z=new q(M,I,m+1,f,x),D=new q(j,N,0,p,x),L=new q(new Array(0),T,0,v,g)}(),ee=!0),k.l_desc=new F(k.dyn_ltree,Z),k.d_desc=new F(k.dyn_dtree,D),k.bl_desc=new F(k.bl_tree,L),k.bi_buf=0,k.bi_valid=0,te(k)},s._tr_stored_block=z,s._tr_flush_block=function(k,R,U,X){var B,Q,se=0;0<k.level?(k.strm.data_type===2&&(k.strm.data_type=function(re){var be,Re=4093624447;for(be=0;be<=31;be++,Re>>>=1)if(1&Re&&re.dyn_ltree[2*be]!==0)return i;if(re.dyn_ltree[18]!==0||re.dyn_ltree[20]!==0||re.dyn_ltree[26]!==0)return l;for(be=32;be<m;be++)if(re.dyn_ltree[2*be]!==0)return l;return i}(k)),Pe(k,k.l_desc),Pe(k,k.d_desc),se=function(re){var be;for(C(re,re.dyn_ltree,re.l_desc.max_code),C(re,re.dyn_dtree,re.d_desc.max_code),Pe(re,re.bl_desc),be=v-1;3<=be&&re.bl_tree[2*$[be]+1]===0;be--);return re.opt_len+=3*(be+1)+5+5+4,be}(k),B=k.opt_len+3+7>>>3,(Q=k.static_len+3+7>>>3)<=B&&(B=Q)):B=Q=U+5,U+4<=B&&R!==-1?z(k,R,U,X):k.strategy===4||Q===B?(ae(k,2+(X?1:0),3),de(k,M,j)):(ae(k,4+(X?1:0),3),function(re,be,Re,Oe){var Pn;for(ae(re,be-257,5),ae(re,Re-1,5),ae(re,Oe-4,4),Pn=0;Pn<Oe;Pn++)ae(re,re.bl_tree[2*$[Pn]+1],3);J(re,re.dyn_ltree,be-1),J(re,re.dyn_dtree,Re-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,se+1),de(k,k.dyn_ltree,k.dyn_dtree)),te(k),X&&le(k)},s._tr_tally=function(k,R,U){return k.pending_buf[k.d_buf+2*k.last_lit]=R>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&R,k.pending_buf[k.l_buf+k.last_lit]=255&U,k.last_lit++,R===0?k.dyn_ltree[2*U]++:(k.matches++,R--,k.dyn_ltree[2*(b[U]+m+1)]++,k.dyn_dtree[2*W(R)]++),k.last_lit===k.lit_bufsize-1},s._tr_align=function(k){ae(k,2,3),K(k,_,M),function(R){R.bi_valid===16?(ce(R,R.bi_buf),R.bi_buf=0,R.bi_valid=0):8<=R.bi_valid&&(R.pending_buf[R.pending++]=255&R.bi_buf,R.bi_buf>>=8,R.bi_valid-=8)}(k)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(o){(function(i,l){if(!i.setImmediate){var c,u,d,m,f=1,p={},v=!1,h=i.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(i);x=x&&x.setTimeout?x:i,c={}.toString.call(i.process)==="[object process]"?function(S){process.nextTick(function(){g(S)})}:function(){if(i.postMessage&&!i.importScripts){var S=!0,E=i.onmessage;return i.onmessage=function(){S=!1},i.postMessage("","*"),i.onmessage=E,S}}()?(m="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",_,!1):i.attachEvent("onmessage",_),function(S){i.postMessage(m+S,"*")}):i.MessageChannel?((d=new MessageChannel).port1.onmessage=function(S){g(S.data)},function(S){d.port2.postMessage(S)}):h&&"onreadystatechange"in h.createElement("script")?(u=h.documentElement,function(S){var E=h.createElement("script");E.onreadystatechange=function(){g(S),E.onreadystatechange=null,u.removeChild(E),E=null},u.appendChild(E)}):function(S){setTimeout(g,0,S)},x.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var E=new Array(arguments.length-1),A=0;A<E.length;A++)E[A]=arguments[A+1];var I={callback:S,args:E};return p[f]=I,c(f),f++},x.clearImmediate=y}function y(S){delete p[S]}function g(S){if(v)setTimeout(g,0,S);else{var E=p[S];if(E){v=!0;try{(function(A){var I=A.callback,N=A.args;switch(N.length){case 0:I();break;case 1:I(N[0]);break;case 2:I(N[0],N[1]);break;case 3:I(N[0],N[1],N[2]);break;default:I.apply(l,N)}})(E)}finally{y(S),v=!1}}}}function _(S){S.source===i&&typeof S.data=="string"&&S.data.indexOf(m)===0&&g(+S.data.slice(m.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Vu<"u"?Vu:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(iR);var DK=iR.exports;const lR=uy(DK),sW=Object.freeze(Object.defineProperty({__proto__:null,default:lR},Symbol.toStringTag,{value:"Module"}));async function RK(e,t){try{console.log("Starting IndexedDB restoration for user:",t);const n=t.replace(/[@.]/g,"_");let r=0;for(const[s,o]of Object.entries(e)){if(!o||typeof o!="object"){console.warn(`Invalid data for database ${s}, skipping`);continue}const i=o,l=i.version||1,c=i.objectStores||[],u=i.stores||{};if(console.log(`Processing database ${s}, version ${l}, with ${c.length} object stores`),Object.keys(u).length===0){console.log(`No stores data found for database ${s}, skipping`);continue}try{const d=indexedDB.deleteDatabase(s);await new Promise((p,v)=>{d.onerror=()=>{console.warn(`Error deleting existing database ${s}:`,d.error),p()},d.onsuccess=()=>{console.log(`Successfully deleted existing database ${s}`),p()}});const m=indexedDB.open(s,l),f=await new Promise((p,v)=>{m.onupgradeneeded=h=>{console.log(`Upgrading database ${s} to version ${l}`);const x=m.result;for(const y of c)x.objectStoreNames.contains(y)||(console.log(`Creating object store ${y} in database ${s}`),x.createObjectStore(y,{keyPath:"id",autoIncrement:!0}))},m.onerror=()=>{v(new Error(`Failed to open database ${s}: ${m.error}`))},m.onsuccess=()=>{p(m.result)}});for(const[p,v]of Object.entries(u)){if(!v||!Array.isArray(v)){console.warn(`Invalid data for store ${p} in database ${s}, skipping`);continue}console.log(`Processing store ${p} with ${v.length} records`);const h=v.filter(g=>!g||typeof g!="object"?!1:!g.userEmail||g.userEmail===t||g.user===t||g.email===t||g.userId===n||g.userEmail===n||g.user===n||g.email===n);if(h.length===0){console.log(`No records to restore for store ${p} in database ${s}`);continue}console.log(`Restoring ${h.length} records to store ${p}`);const x=f.transaction(p,"readwrite"),y=x.objectStore(p);await new Promise((g,_)=>{const S=y.clear();S.onerror=()=>{console.warn(`Error clearing store ${p}:`,S.error),g()},S.onsuccess=()=>{console.log(`Successfully cleared store ${p}`),g()}});for(const g of h)try{y.add(g),r++}catch(_){console.error(`Error adding record to ${p}:`,_)}await new Promise((g,_)=>{x.oncomplete=()=>{console.log(`Transaction completed for store ${p}`),g()},x.onerror=()=>{console.error(`Error in transaction for store ${p}:`,x.error),_(x.error)}})}f.close(),console.log(`Closed database connection to ${s}`)}catch(d){console.error(`Error processing database ${s}:`,d)}}return console.log(`IndexedDB restoration completed for user ${t}, restored ${r} records`),r}catch(n){return console.error("Error in restoreIndexedDBData:",n),0}}function $K(){const{loginMutation:e}=Bo(),{toast:t}=dn(),[,n]=wu(),[r,s]=w.useState(!1),[o,i]=w.useState(!1),l=xi({resolver:wi(PK),defaultValues:{email:"",password:""}});w.useEffect(()=>{async function u(){const d=await Eu();i(d)}u()},[]);async function c(u){try{s(!0),Lc(!0),Ji();const d=u.email,m=Wt(u.email);localStorage.setItem("original_email_"+m,d),localStorage.setItem("sanitized_email_"+d.replace(/[@.]/g,"_"),m),localStorage.setItem("display_email_"+m,d);const f={...u,email:d,sanitizedEmail:m,originalEmail:d};t(o?{title:"Secure login",description:"Initializing secure authentication with MATA extension..."}:{title:"Secure login",description:"Initializing secure authentication..."}),console.log("Setting up localStorage for persistent cross-session authentication..."),localStorage.setItem("auth_timestamp",Date.now().toString()),localStorage.setItem("session_email",f.email),localStorage.setItem("current_user_email",f.email),localStorage.removeItem("vault_test_started"),localStorage.removeItem("vault_test_timestamp"),localStorage.removeItem("accessible_vault_count"),localStorage.removeItem("total_vault_count");const p=["passwords","contacts","payments","payment_history","bank_accounts"];for(const g of p)localStorage.removeItem(`vault_${g}_accessible`);localStorage.removeItem("current_encryption_method"),localStorage.removeItem("encryption_method_in_use"),localStorage.removeItem("user_encryption_method"),Object.keys(localStorage).forEach(g=>{(g.startsWith("vault_user_")&&(g.includes("_encryption_method")||g.includes("_bank_account")||g.includes("_payments"))||g.includes("_encryption_method")||g.includes("encryption_")||g.includes("method_"))&&(console.log("Removing potential conflicting key:",g),localStorage.removeItem(g))}),Object.keys(localStorage).forEach(g=>{(g.includes("_encryption_method")||g.includes("encryption_")||g.includes("method_"))&&(console.log("Removing potential conflicting localStorage key:",g),localStorage.removeItem(g))});const{resetFallbackState:v,getUserKeys:h}=await oe(async()=>{const{resetFallbackState:g,getUserKeys:_}=await Promise.resolve().then(()=>tt);return{resetFallbackState:g,getUserKeys:_}},void 0);v();const x=await h(f.email);let y=!1;if(x){console.log("Found local keys for user - performing standardized login process...");try{if(y=await Og(f.email,f.password),y){console.log("Standardized login process completed successfully"),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),localStorage.setItem("auth_email",f.email),localStorage.setItem("auth_timestamp",Date.now().toString()),console.log("Setting persistent vault access markers for cross-session authentication");const g=localStorage.getItem("display_email_"+f.email)||localStorage.getItem("originalEmail_"+f.email)||f.email,_={id:x.id||999,email:f.email,displayEmail:g,firstName:x.firstName||"User",isVerified:!0,publicKey:x.publicKey||""};try{const E={id:x.id||999,email:f.email,firstName:x.firstName||"User",isVerified:!0};localStorage.setItem("auth_user",JSON.stringify(E)),localStorage.setItem("local_only_auth","true"),Qo.invalidateQueries({queryKey:["/api/user"]}),console.log("App state updated with local user data")}catch(E){console.error("Failed to update local app state:",E)}try{const{hasExtension:E}=await oe(async()=>{const{hasExtension:I}=await Promise.resolve().then(()=>tt);return{hasExtension:I}},void 0),A=await E();console.log(`Chrome extension installed: ${A}`),window.dispatchEvent(new CustomEvent("user_login",{detail:{email:f.email,timestamp:Date.now()}})),console.log("Dispatched user_login event for extension auto-connection")}catch(E){console.warn("Error checking for extension:",E)}console.log("Using comprehensive vault verification before redirect"),localStorage.setItem("auth_user",JSON.stringify(_)),localStorage.setItem("local_only_auth","true"),console.log("Persisting user data for cross-session access with local-only authentication");const{verifyVaultDecryptionBeforeRedirect:S}=await oe(async()=>{const{verifyVaultDecryptionBeforeRedirect:E}=await import("./authRedirectUtils-_KQTIe7j.js");return{verifyVaultDecryptionBeforeRedirect:E}},__vite__mapDeps([0,1,2]));window.dispatchEvent(new CustomEvent("user_login",{detail:{email:f.email,timestamp:Date.now()}})),console.log("Dispatched user_login event for extension auto-connection before redirect"),await S(f.email,pe,pe.getStorageKey(),t,()=>{window.dispatchEvent(new CustomEvent("user_login",{detail:{email:f.email,timestamp:Date.now()}})),console.log("Dispatched another user_login event during redirect"),n("/")},"You've been authenticated with verified vault access.")}else console.warn("Standardized login process failed"),t({title:"Account access",description:"Please check your email and password and try again.",variant:"default"})}catch(g){console.error("Error during standardized login process:",g),t({title:"Account access",description:"Unable to access your account. Please check your credentials and try again.",variant:"default"})}}else console.log("No local keys found for user, need to create account first"),t({title:"Account not found",description:"Please register first to create your local account.",variant:"default"}),window.location.href="/?register=true"}catch(d){console.error("Login error:",d),t({title:"Account access",description:"Unable to access your account. Please try again.",variant:"default"})}finally{s(!1)}}return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Sign in to your account"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Access your data anywhere, anytime."})]}),a.jsx(Si,{...l,children:a.jsxs("form",{onSubmit:l.handleSubmit(c),className:"space-y-5",children:[a.jsx(ht,{control:l.control,name:"email",render:({field:u})=>a.jsxs(dt,{className:"space-y-2",children:[a.jsx(St,{className:"text-sm font-medium",children:"Email"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"Enter your email",...u,className:"h-11 text-base"})}),a.jsx(pt,{className:"text-xs"})]})}),a.jsx(ht,{control:l.control,name:"password",render:({field:u})=>{const[d,m]=w.useState(!1);return a.jsxs(dt,{className:"space-y-2",children:[a.jsx(St,{className:"text-sm font-medium",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(ft,{children:a.jsx(De,{type:d?"text":"password",placeholder:"Enter your password",...u,className:"h-11 text-base pr-10"})}),a.jsx("button",{type:"button",className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>m(!d),"aria-label":d?"Hide password":"Show password",children:d?a.jsx(ma,{className:"h-5 w-5"}):a.jsx(ha,{className:"h-5 w-5"})})]}),a.jsx(pt,{className:"text-xs"})]})}}),a.jsxs(ie,{type:"submit",variant:"outline",className:"w-full h-11 text-base font-semibold mt-6 bg-white text-[#4f46e5] border-[#4f46e5] hover:bg-[#4f46e5]/5",disabled:e.isPending,children:[e.isPending?a.jsx(it,{className:"mr-2 h-5 w-5 animate-spin"}):null,"Sign In"]})]})})]})}function OK(){const[e,t]=w.useState(1),[n,r]=w.useState({email:"",firstName:""}),[,s]=wu(),{registerMutation:o,verifyCodeMutation:i}=Bo(),{toast:l}=dn(),c=xi({resolver:wi(IK),defaultValues:{email:"",firstName:""}}),u=xi({resolver:wi(TK),defaultValues:{code:"",email:n.email}}),d=xi({resolver:wi(AK),defaultValues:{password:""}});async function m(v){try{l({title:"Creating account",description:"Setting up your initial account details..."}),Lc(!0),Ji();const h=v.email.toLowerCase(),x=Wt(h),y={originalEmail:h||v.email.toLowerCase(),email:x,firstName:v.firstName},g={email:x,firstName:v.firstName};await fetch("/api/pre-register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),r(g),localStorage.setItem("originalEmail_"+h.toLowerCase(),h),localStorage.setItem("originalEmail_"+x,h),localStorage.setItem("display_email_"+x,h),localStorage.setItem("originalEmail",h),console.log(`🔍 DEBUG: Stored global originalEmail in localStorage: ${h}`),t(2),l({title:"Email verification required",description:"Please check your email for a verification code"})}catch(h){console.error("Pre-registration failed:",h),l({title:"Account setup",description:"Please try creating your account again.",variant:"default"})}}async function f(v){try{if(console.log("onVerificationSubmit called with:",v),console.log("Email from formData:",n.email),Lc(!0),Ji(),!v.code||v.code.trim().length===0){console.error("No verification code provided"),l({title:"Email verification",description:"Please enter the verification code from your email",variant:"default"});return}l({title:"Verifying code",description:"Checking your verification code..."}),console.log(`About to send verification request to server:
        URL: /api/verify-code
        Method: POST
        Data: ${JSON.stringify({code:v.code.trim(),email:n.email})}`);try{const h=await fetch("/api/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:v.code.trim(),originalEmail:localStorage.getItem("originalEmail")||localStorage.getItem("originalEmail_"+n.email)||localStorage.getItem("display_email_"+n.email)||n.email.replace(/_/g,"."),email:n.email}),credentials:"include"});if(console.log("Verification API response received"),console.log("Status:",h.status),console.log("Status text:",h.statusText),!h.ok){const x=await h.text();throw console.error("API error response body:",x),new Error(x||`Server error: ${h.status}`)}console.log("Verification successful!"),t(3),l({title:"Code verified",description:"Please create your password"})}catch(h){throw console.error("Fetch error during verification:",h),h}}catch(h){console.error("Verification error:",h),l({title:"Email verification",description:"Please check your verification code and try again",variant:"default"})}}async function p(v){try{l({title:"Initializing encryption",description:"Setting up secure environment..."});const{clearSecurityContext:h}=await oe(async()=>{const{clearSecurityContext:S}=await Promise.resolve().then(()=>tt);return{clearSecurityContext:S}},void 0);h(!0);const{setVaultUserContext:x,getSanitizedEmail:y}=await oe(async()=>{const{setVaultUserContext:S,getSanitizedEmail:E}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:S,getSanitizedEmail:E}},void 0);console.log("📝 Setting user context BEFORE key generation for:",n.email),x(n.email),localStorage.setItem("local_only_auth","true"),console.log("✅ Setting LOCAL-ONLY authentication mode for complete offline operation"),localStorage.setItem("session_email",n.email),localStorage.setItem("current_user_email",n.email),localStorage.setItem("auth_email",n.email),localStorage.setItem("auth_timestamp",Date.now().toString()),console.log("Setting persistent user context for cross-session authentication");const g=await Eu();window.dispatchEvent(new CustomEvent("user_login",{detail:{email:n.email,timestamp:Date.now()}})),console.log("Dispatched user_login event for extension auto-connection"),l({title:"Setting up encryption",description:"Generating your secure keys..."}),await Cf(n.email);let _;try{console.log("Generating keys with standardized encryption approach..."),_=await pj(v.password),_.email=n.email,_.firstName=n.firstName,_.isVerified=!0,console.log("Keys generated successfully with standardized approach");const S=y(n.email),E=`mata_salt_${S}`;console.log(`🔍 DEBUG: Using standardized email format: ${S}`),console.log(`🔍 DEBUG: Attempting to store salt with key: ${E}`),console.log(`🔍 DEBUG: Salt value: ${_.salt?"exists":"missing"}`),localStorage.setItem(E,_.salt),console.log(`🔍 DEBUG: Salt stored: ${localStorage.getItem(E)?"success":"failed"}`),console.log("🔍 DEBUG: Now saving full keys object to localStorage...");const A=`mata_keys_${S}`;localStorage.setItem(A,JSON.stringify(_)),console.log(`🔍 DEBUG: Keys stored: ${localStorage.getItem(A)?"success":"failed"}`),console.log("🔍 DEBUG: Current localStorage keys (filtered for mata_):"),Object.keys(localStorage).forEach(I=>{I.includes("mata_")&&console.log(`🔍 DEBUG: ${I} = ${localStorage.getItem(I)?"has value":"empty"}`)}),localStorage.removeItem("mata_salt"),localStorage.removeItem("mata_keys");try{}catch(I){console.warn("Error removing deprecated storage format:",I)}l({title:"Keys stored",description:"Your keys are stored locally for offline authentication."})}catch(S){console.error("Key generation error:",S),l({title:"Account setup",description:"We encountered an issue setting up encryption. Please try again.",variant:"default"});return}l({title:"Completing registration",description:"Finalizing your account..."});try{const S=localStorage.getItem("originalEmail");console.log(`🔍 DEBUG: Global originalEmail from localStorage: ${S}`),S||console.log("🔍 DEBUG: Global originalEmail not found, trying fallbacks...");const A=S||localStorage.getItem("display_email_"+n.email)||localStorage.getItem("originalEmail_"+n.email)||n.email.replace(/_/g,".").toLowerCase()||n.email;console.log(`🔍 DEBUG: Registration using safeOriginalEmail=${A}`);const N={...{...n,publicKey:_.publicKey},originalEmail:A},T=await o.mutateAsync(N);_.id=T.id,console.log("🔍 DEBUG: Calling saveUserKeys with keys:",{email:_.email,publicKey:_.publicKey?"exists":"missing",encryptedPrivateKey:_.encryptedPrivateKey?"exists":"missing",salt:_.salt?"exists":"missing",hash:_.hash?"exists":"missing",id:_.id}),await Vc(_),console.log("🔍 DEBUG: LocalStorage after saveUserKeys - Current keys (filtered for mata_):"),Object.keys(localStorage).forEach($=>{$.includes("mata_")&&console.log(`🔍 DEBUG: ${$} = ${localStorage.getItem($)?"has value":"empty"}`)}),console.log("Complete user data saved locally for offline authentication"),console.log("Setting up vault for new user with WASM-first approach...");try{localStorage.removeItem("current_encryption_method"),Object.keys(localStorage).forEach(b=>{b.startsWith("vault_user_")&&(b.includes("_encryption_method")||b.includes("_bank_account")||b.includes("_payments"))&&localStorage.removeItem(b)});const{resetFallbackState:$,saveEncryptionPreference:M}=await oe(async()=>{const{resetFallbackState:b,saveEncryptionPreference:V}=await Promise.resolve().then(()=>tt);return{resetFallbackState:b,saveEncryptionPreference:V}},void 0);$(),M("wasm",n.email),localStorage.setItem("mata_active_user",y(n.email)),localStorage.setItem("current_vault_user",n.email),localStorage.setItem("mata_context_email",n.email),localStorage.setItem("session_email",n.email),localStorage.setItem("current_user_email",n.email),localStorage.setItem("auth_user_email",n.email),localStorage.setItem("local_only_auth","true"),console.log("Setting comprehensive user context in localStorage for cross-session persistence with local-only authentication"),console.log(`🔍 DEBUG: Set user context in localStorage: ${n.email} (${y(n.email)})`),localStorage.setItem("last_auth_password",v.password),await pe.setupVault(v.password,n.email,!0,!1),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Setting persistent vault unlocked flags for cross-session access"),console.log("Master vault initialized and unlocked for new user");const{setVaultUserContext:j}=await oe(async()=>{const{setVaultUserContext:b}=await Promise.resolve().then(()=>Ge);return{setVaultUserContext:b}},void 0),{applyStandardizedEncryption:P}=await oe(async()=>{const{applyStandardizedEncryption:b}=await Promise.resolve().then(()=>kf);return{applyStandardizedEncryption:b}},void 0);console.log("=========== STANDARDIZED INIT FOR NEW USER ==========="),j(n.email),P(n.email),localStorage.setItem("skip_password_prompt","true"),localStorage.setItem("vault_creation_time",Date.now().toString()),localStorage.setItem("initial_vault_password",v.password),console.log("Setting persistent flags for password prompt management");try{console.log("Using standardized vault unlock for registration"),await Av(n.email,v.password,!1)?(console.log("Vault unlocked successfully with standardized approach"),await kj(n.email)?(console.log("All vaults initialized successfully with standardized approach"),localStorage.setItem("password_vault_initialized","true"),localStorage.setItem("password_vault_unlocked","true"),localStorage.setItem("password_vault_unlock_time",Date.now().toString()),localStorage.setItem("payment_methods_vault_initialized","true"),localStorage.setItem("payment_history_vault_initialized","true"),localStorage.setItem("bank_accounts_vault_initialized","true"),console.log("Setting persistent vault initialization markers for cross-session access"),localStorage.setItem("initial_vault_password",v.password)):console.warn("Some vaults failed to initialize with standardized approach")):console.warn("Failed to unlock vault with standardized approach")}catch(b){console.error("Error during standardized vault initialization:",b)}try{console.log("Initializing bank accounts vault for new user");const{initializeBankAccountVault:b}=await oe(async()=>{const{initializeBankAccountVault:Z}=await Promise.resolve().then(()=>iy);return{initializeBankAccountVault:Z}},void 0);await b(n.email)?(console.log("Bank accounts vault successfully initialized"),localStorage.setItem("bank_accounts_vault_initialized","true")):console.warn("Failed to initialize bank accounts vault - user may be prompted later")}catch(b){console.error("Error during bank accounts vault initialization:",b)}try{console.log("Initializing contacts vault for new user");const V=`user_${y(n.email)}_contacts`;await pe.createNewVault("Contacts","contacts",V),console.log("Contacts vault successfully initialized"),localStorage.setItem("contacts_vault_initialized","true"),localStorage.setItem("contacts_vault_namespace",V)}catch(b){console.error("Error during contacts vault initialization:",b)}try{console.log("Initializing payment history vault for new user");const{initializePaymentHistoryVault:b}=await oe(async()=>{const{initializePaymentHistoryVault:Z}=await Promise.resolve().then(()=>Zg);return{initializePaymentHistoryVault:Z}},void 0);await b(n.email)?(console.log("Payment history vault successfully initialized"),localStorage.setItem("payment_history_vault_initialized","true")):console.warn("Failed to initialize payment history vault - user may be prompted later")}catch(b){console.error("Error during payment history vault initialization:",b)}localStorage.removeItem("last_auth_password"),console.log("All vaults initialized and unlocked - registration complete")}catch($){console.error("Error initializing vault:",$),localStorage.removeItem("last_auth_password")}try{console.log("Verifying decryption capability before redirecting...");const{standardizedDecrypt:$}=await oe(async()=>{const{standardizedDecrypt:b}=await Promise.resolve().then(()=>kf);return{standardizedDecrypt:b}},void 0),{vault_encrypt_data:M}=await oe(async()=>{const{vault_encrypt_data:b}=await Promise.resolve().then(()=>tt);return{vault_encrypt_data:b}},void 0),j=await M("MATA_VERIFICATION_TEST",pe.getStorageKey()||"");if(await $(j,pe.getStorageKey()||"",n.email)==="MATA_VERIFICATION_TEST"){console.log("Performing verification of vault access before redirect...");const{verifyVaultDecryptionBeforeRedirect:b}=await oe(async()=>{const{verifyVaultDecryptionBeforeRedirect:V}=await import("./authRedirectUtils-_KQTIe7j.js");return{verifyVaultDecryptionBeforeRedirect:V}},__vite__mapDeps([0,1,2]));await b(n.email,pe,pe.getStorageKey(),l,()=>s("/"),"Your secure account has been created with verified vault access!")}else console.log("Proceeding despite vault verification result"),l({title:"Account created!",description:"Your account has been created successfully!",variant:"default"}),setTimeout(()=>{s("/")},2e3)}catch($){console.error("Proceeding despite verification error:",$),l({title:"Account created!",description:"Your account has been created successfully!",variant:"default"}),setTimeout(()=>{s("/")},2e3)}}catch(S){console.error("Server registration error:",S),await Vc(_),console.log("Setting up vault for offline use with WASM-first approach...");try{localStorage.removeItem("current_encryption_method"),Object.keys(localStorage).forEach(N=>{N.startsWith("vault_user_")&&(N.includes("_encryption_method")||N.includes("_bank_account")||N.includes("_payments"))&&localStorage.removeItem(N)});const{resetFallbackState:E}=await oe(async()=>{const{resetFallbackState:N}=await Promise.resolve().then(()=>tt);return{resetFallbackState:N}},void 0);E();const A=y(n.email);localStorage.setItem("mata_active_user",A),localStorage.setItem("current_vault_user",A),localStorage.setItem("mata_context_email",A),localStorage.setItem("session_email",A),localStorage.setItem("current_user_email",A),localStorage.setItem("local_only_auth","true"),console.log(`🔍 DEBUG: Set user context in localStorage for offline use with local-only authentication: ${n.email}`),localStorage.setItem("last_auth_password",v.password),await pe.setupVault(v.password,n.email,!0,!1),localStorage.setItem("vault_unlocked","true"),localStorage.setItem("vault_unlocked_at",Date.now().toString()),console.log("Setting persistent vault unlocked flags for offline mode");try{const{initializePasswordVault:N,unlockPasswordVault:T}=await oe(async()=>{const{initializePasswordVault:$,unlockPasswordVault:M}=await Promise.resolve().then(()=>Ou);return{initializePasswordVault:$,unlockPasswordVault:M}},void 0);await N(n.email),await T(v.password),console.log("Password vault initialized for offline use")}catch(N){console.error("Failed to initialize password vault for offline use:",N)}try{const{initializeBankAccountVault:N}=await oe(async()=>{const{initializeBankAccountVault:T}=await Promise.resolve().then(()=>iy);return{initializeBankAccountVault:T}},void 0);await N(n.email),console.log("Bank accounts vault initialized for offline use")}catch(N){console.error("Failed to initialize bank accounts vault for offline use:",N)}try{const N=`user_${y(n.email)}_contacts`;await pe.createNewVault("Contacts","contacts",N),console.log("Contacts vault initialized for offline use")}catch(N){console.error("Failed to initialize contacts vault for offline use:",N)}try{const{initializePaymentHistoryVault:N}=await oe(async()=>{const{initializePaymentHistoryVault:T}=await Promise.resolve().then(()=>Zg);return{initializePaymentHistoryVault:T}},void 0);await N(n.email),console.log("Payment history vault initialized for offline use")}catch(N){console.error("Failed to initialize payment history vault for offline use:",N)}const{removeAllPasswordsFromStorage:I}=await oe(async()=>{const{removeAllPasswordsFromStorage:N}=await Promise.resolve().then(()=>tt);return{removeAllPasswordsFromStorage:N}},void 0);I(),console.log("🔒 Security: All password variables securely removed after account creation"),console.log("All vaults initialized and unlocked for offline use")}catch(E){console.error("Error initializing vault for offline use:",E);const{removeAllPasswordsFromStorage:A}=await oe(async()=>{const{removeAllPasswordsFromStorage:I}=await Promise.resolve().then(()=>tt);return{removeAllPasswordsFromStorage:I}},void 0);A(),console.log("🔒 Security: All password variables securely removed after vault error")}l({title:"Account created!",description:"Your account has been created successfully!",variant:"default"}),setTimeout(()=>{s("/")},1500)}}catch(h){console.error("Registration error:",h);try{const{removeAllPasswordsFromStorage:x}=await oe(async()=>{const{removeAllPasswordsFromStorage:y}=await Promise.resolve().then(()=>tt);return{removeAllPasswordsFromStorage:y}},void 0);x(),console.log("🔒 Security: All password variables securely removed after registration error")}catch(x){console.error("Error cleaning up passwords:",x)}l({title:"Account setup",description:"We encountered an issue. Please try again.",variant:"default"})}}return a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex justify-between relative",children:[a.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-gray-200 -translate-y-1/2"}),[1,2,3].map(v=>a.jsx("div",{className:"relative z-10",children:a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm transition-colors ${e>=v?"bg-primary text-primary-foreground":"bg-background border-2 border-gray-200"}`,children:e>v?"✓":v})},v))]}),e===1&&a.jsx(Si,{...c,children:a.jsxs("form",{onSubmit:c.handleSubmit(m),className:"space-y-5",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Create Your Account"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Let's get started taking back your future."})]}),a.jsx(ht,{control:c.control,name:"firstName",render:({field:v})=>a.jsxs(dt,{className:"space-y-2",children:[a.jsx(St,{className:"text-sm font-medium",children:"First Name"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"Enter your first name",...v,className:"h-11 text-base"})}),a.jsx(pt,{className:"text-xs"})]})}),a.jsx(ht,{control:c.control,name:"email",render:({field:v})=>a.jsxs(dt,{className:"space-y-2",children:[a.jsx(St,{className:"text-sm font-medium",children:"Email"}),a.jsx(ft,{children:a.jsx(De,{placeholder:"Enter your email",...v,className:"h-11 text-base"})}),a.jsx(pt,{className:"text-xs"})]})}),a.jsx(ie,{type:"submit",className:"w-full h-11 text-base font-semibold mt-6",children:"Continue"})]})}),e===2&&a.jsx(Si,{...u,children:a.jsxs("form",{onSubmit:v=>{console.log("Verification form submitted",v),v.preventDefault();const h=u.getValues("code");console.log("Code value from form:",h),f({code:h})},className:"space-y-5",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Verify Your Email"}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["We've sent a 6-digit code to",a.jsx("br",{}),a.jsx("span",{className:"font-medium",children:localStorage.getItem("display_email_"+n.email)||localStorage.getItem("originalEmail_"+n.email)||n.email.replace(/_/g,".")})]})]}),a.jsx(ht,{control:u.control,name:"code",render:({field:v})=>a.jsxs(dt,{className:"flex flex-col items-center",children:[a.jsx(ft,{children:a.jsx(De,{placeholder:"● ● ● ● ● ●",maxLength:6,className:"w-[80%] h-11 text-base text-center tracking-[0.75em] font-mono",...v})}),a.jsx(pt,{className:"text-xs mt-1"})]})}),a.jsxs(ie,{type:"submit",className:"w-full h-11 text-base font-semibold mt-6",disabled:i.isPending,children:[i.isPending?a.jsx(it,{className:"mr-2 h-5 w-5 animate-spin"}):null,"Verify Code"]}),a.jsx(ie,{type:"button",className:"w-full h-11 mt-2",variant:"outline",onClick:()=>{console.log("Manual verification button clicked");const v=u.getValues("code");f({code:v})},children:"Try Manual Verification"})]})}),e===3&&a.jsx(Si,{...d,children:a.jsxs("form",{onSubmit:async v=>{v.preventDefault();try{await hs(),d.handleSubmit(p)(v)}catch(h){console.error("WASM initialization error during form submit:",h),l({title:"Account setup",description:"We're having trouble initializing security. Please try again.",variant:"default"})}},className:"space-y-5",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Create Your Password"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"One password to rule them all, so make it good."})]}),a.jsx(ht,{control:d.control,name:"password",render:({field:v})=>{const[h,x]=w.useState(!1);return a.jsxs(dt,{className:"space-y-2",children:[a.jsx(St,{className:"text-sm font-medium",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(ft,{children:a.jsx(De,{type:h?"text":"password",placeholder:"Create a strong password",className:"h-11 text-base pr-10",...v})}),a.jsx("button",{type:"button",className:"absolute right-3 top-3 text-gray-500 hover:text-gray-700",onClick:()=>x(!h),"aria-label":h?"Hide password":"Show password",children:h?a.jsx(ma,{className:"h-5 w-5"}):a.jsx(ha,{className:"h-5 w-5"})})]}),a.jsx(pt,{className:"text-xs"})]})}}),a.jsxs(ie,{type:"submit",className:"w-full h-11 text-base font-semibold mt-6",disabled:o.isPending,children:[o.isPending&&a.jsx(it,{className:"mr-2 h-5 w-5 animate-spin"}),"Set Yourself Free"]})]})})]})}function MK({open:e,setOpen:t}){const{toast:n}=dn(),r=w.useRef(null),[s,o]=w.useState(!1),[i,l]=w.useState(null),[c,u]=w.useState(!1),d=async v=>{if(!v||v.length===0)return;const h=v[0];l(h.name),o(!0);try{console.log("Starting backup file processing:",h.name,"size:",h.size);const x=await h.arrayBuffer(),y=await lR.loadAsync(x);let g=0,_=0,S=!1,E=!1;if(y.forEach(I=>{_++,console.log("Found zip entry:",I)}),console.log(`Zip contains ${_} entries`),y.files["all-keys.json"])try{console.log("Processing all-keys.json...");const I=await y.files["all-keys.json"].async("string");console.log("all-keys.json content length:",I.length);const N=JSON.parse(I);console.log("all-keys.json parsed, keys:",Object.keys(N).length);for(const[T,$]of Object.entries(N))if(console.log("Processing key:",T,"type:",typeof $),T.startsWith("mata_"))if(T.startsWith("mata_keys_"))try{const M=$;if(console.log(`Processing mata_keys object for key ${T}:`,M?{hasPublicKey:!!M.publicKey,hasEncryptedPrivateKey:!!M.encryptedPrivateKey,hasSalt:!!M.salt,hasHash:!!M.hash,hasEmail:!!M.email}:"null"),M&&typeof M=="object"&&M.publicKey&&M.encryptedPrivateKey&&M.salt&&M.hash){localStorage.setItem(T,JSON.stringify(M)),console.log(`Restored user keys: ${T}`);const j=T.replace("mata_keys_","mata_salt_");if(localStorage.setItem(j,JSON.stringify(M.salt)),console.log(`Restored salt: ${j}`),M.email){localStorage.setItem("session_email",M.email),localStorage.setItem("current_user_email",M.email),localStorage.setItem("auth_email",M.email),localStorage.setItem("auth_timestamp",Date.now().toString()),console.log(`Set session data for: ${M.email}`);const P=M.email.replace(/[@.]/g,"_");localStorage.setItem("sanitized_email_"+M.email,P),localStorage.setItem("original_email_"+P,M.email),console.log(`Set email normalization mappings for: ${M.email}`)}S=!0,g+=2}else console.warn(`Invalid user keys object for ${T}:`,M)}catch(M){console.error(`Error processing user keys: ${T}`,M)}else localStorage.setItem(T,JSON.stringify($)),g++,console.log(`Restored key: ${T}`)}catch(I){console.error("Error processing all-keys.json:",I)}if(!S)if(y.files["user-data.json"])try{console.log("Processing user-data.json as fallback...");const I=await y.files["user-data.json"].async("string");console.log("user-data.json content length:",I.length);const N=JSON.parse(I);console.log("user-data.json parsed, keys:",Object.keys(N).length);for(const[T,$]of Object.entries(N))if(console.log("Processing user-data key:",T,"type:",typeof $),T.startsWith("mata_keys_"))try{const M=$;if(console.log(`Processing user-data mata_keys object for key ${T}:`,M?{hasPublicKey:!!M.publicKey,hasEncryptedPrivateKey:!!M.encryptedPrivateKey,hasSalt:!!M.salt,hasHash:!!M.hash,hasEmail:!!M.email}:"null"),M&&typeof M=="object"&&M.publicKey&&M.encryptedPrivateKey&&M.salt&&M.hash){localStorage.setItem(T,JSON.stringify(M)),console.log(`Restored user keys: ${T}`);const j=T.replace("mata_keys_","mata_salt_");if(localStorage.setItem(j,JSON.stringify(M.salt)),console.log(`Restored salt: ${j}`),M.email){localStorage.setItem("session_email",M.email),localStorage.setItem("current_user_email",M.email),localStorage.setItem("auth_email",M.email),localStorage.setItem("auth_timestamp",Date.now().toString()),console.log(`Set session data for: ${M.email}`);const P=M.email.replace(/[@.]/g,"_");localStorage.setItem("sanitized_email_"+M.email,P),localStorage.setItem("original_email_"+P,M.email),console.log(`Set email normalization mappings for: ${M.email}`)}S=!0,g+=2}else console.warn(`Invalid user keys object in user-data.json for ${T}:`,M)}catch(M){console.error(`Error processing user keys: ${T}`,M)}else try{localStorage.setItem(T,JSON.stringify($)),g++,console.log(`Restored key: ${T}`)}catch(M){console.error(`Error storing key ${T}:`,M)}}catch(I){console.error("Error processing user-data.json:",I)}else console.warn("No user-data.json file found in the backup");const A=y.files["indexeddb/indexeddb-data.json"];if(A)try{console.log("Found IndexedDB data in backup, processing...");const I=await A.async("string");console.log("IndexedDB content length:",I.length);const N=JSON.parse(I),T=localStorage.getItem("mata_active_user")||localStorage.getItem("session_email")||localStorage.getItem("current_user_email")||localStorage.getItem("auth_email");T?(console.log(`Restoring IndexedDB data for active user: ${T}`),await RK(N,T),E=!0,g+=Object.keys(N).length):console.warn("No active user found after restoring keys, can't restore IndexedDB data")}catch(I){console.error("Error processing IndexedDB data:",I)}else console.log("No IndexedDB data found in backup");for(const[I,N]of Object.entries(y.files))if(!N.dir&&I!=="all-keys.json"&&I!=="user-data.json"&&!I.includes("indexeddb/")&&I.endsWith(".json"))try{console.log(`Processing additional file: ${I}`);const T=await N.async("string");console.log(`${I} content length:`,T.length);const $=JSON.parse(T);console.log(`${I} parsed, keys:`,Object.keys($).length);for(const[M,j]of Object.entries($)){if(console.log(`Processing ${I} key: ${M}, type:`,typeof j),M.startsWith("mata_salt_")){try{localStorage.setItem(M,JSON.stringify(j)),g++,console.log(`Restored salt key: ${M} with proper formatting`)}catch(P){console.error(`Error processing salt key ${M}:`,P)}continue}if(M.startsWith("mata_keys_")){try{const P=j;if(P&&typeof P=="object"&&P.publicKey&&P.encryptedPrivateKey&&P.salt&&P.hash){localStorage.setItem(M,JSON.stringify(P)),console.log(`Restored additional user keys: ${M}`);const b=M.replace("mata_keys_","mata_salt_");if(localStorage.getItem(b)||(localStorage.setItem(b,JSON.stringify(P.salt)),console.log(`Restored missing salt for: ${b}`),g++),P.email&&!S){const V=P.email.replace(/[@.]/g,"_");localStorage.setItem("sanitized_email_"+P.email,V),localStorage.setItem("original_email_"+V,P.email),console.log(`Set additional email mappings for: ${P.email}`)}S||(S=!0)}}catch(P){console.error(`Error processing additional keys ${M}:`,P)}continue}if(localStorage.getItem(M)){console.log(`Skipping already processed key: ${M}`);continue}try{localStorage.setItem(M,JSON.stringify(j)),g++,console.log(`Restored additional key: ${M}`)}catch(P){console.error(`Error storing additional key ${M}:`,P)}}}catch(T){console.error(`Error processing ${I}:`,T)}S?(n({title:"Keys Restored Successfully",description:`Successfully restored user keys and ${g} items${E?" with IndexedDB data":""} from backup. You can now log in.`}),t(!1)):(n({title:"Data Restored",description:`Restored ${g} items, but no valid user keys were found. You may still need to create an account.`,variant:"destructive"}),setTimeout(()=>t(!1),1500))}catch(x){console.error("Error processing zip file:",x),n({title:"Restore Failed",description:"Could not restore keys from backup. Make sure you're using a valid backup file.",variant:"destructive"})}finally{o(!1)}},m=v=>{v.preventDefault(),u(!0)},f=()=>{u(!1)},p=v=>{v.preventDefault(),u(!1),d(v.dataTransfer.files)};return a.jsx(nn,{open:e,onOpenChange:t,children:a.jsxs(Gt,{className:"sm:max-w-[450px]",children:[a.jsxs(Zt,{children:[a.jsx(Yt,{children:"Upload Backup Keys"}),a.jsx(Qt,{children:"Restore your MATA keys and data from a previous backup file."})]}),a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsx("input",{type:"file",ref:r,accept:".zip",onChange:v=>d(v.target.files),className:"hidden"}),a.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${c?"border-primary bg-primary/5":"border-gray-300 hover:border-primary/50 hover:bg-gray-50"}`,onClick:()=>{var v;return(v=r.current)==null?void 0:v.click()},onDragOver:m,onDragLeave:f,onDrop:p,children:s?a.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[a.jsx(it,{className:"h-10 w-10 text-primary animate-spin mb-4"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Processing your backup..."}),i&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:i})]}):a.jsxs(a.Fragment,{children:[a.jsx(rz,{className:"h-10 w-10 text-primary/70 mx-auto mb-4"}),a.jsx("p",{className:"text-sm font-medium mb-1",children:"Drop your backup file here or click to browse"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Upload your MATA backup (.zip) file"})]})}),a.jsxs(Mt,{variant:"default",className:"bg-yellow-50 text-amber-800 border-amber-200",children:[a.jsx(_v,{className:"h-4 w-4 text-amber-600"}),a.jsx(zt,{className:"text-xs",children:"This will restore your MATA keys and data from a previous backup. It overwrites any existing data with the same keys."})]})]}),a.jsx(cn,{children:a.jsx(ie,{variant:"outline",onClick:()=>t(!1),disabled:s,children:"Cancel"})})]})})}function zK(){const{user:e}=Bo(),[,t]=wu(),[n,r]=w.useState(!1),[s,o]=w.useState(!1);return e?(t("/"),null):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900/90 via-gray-800/90 to-gray-900/90 animate-gradient-xy"}),a.jsx("div",{className:"flex-1 flex items-center justify-center p-8 relative z-10",children:a.jsx(Ke,{className:"w-full max-w-md bg-white shadow-xl border-0",children:a.jsx(Ue,{className:"pt-6",children:n?a.jsxs(a.Fragment,{children:[a.jsx(OK,{}),a.jsx(ie,{variant:"ghost",className:"w-full mt-6",onClick:()=>r(!1),children:"Back to Sign In"})]}):a.jsxs(a.Fragment,{children:[a.jsx($K,{}),a.jsxs("div",{className:"mt-6 text-center",children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Don't have an account?"}),a.jsx(ie,{variant:"default",className:"w-full bg-[#4f46e5] text-white hover:bg-[#4f46e5]/90",onClick:()=>r(!0),children:"Create Account"}),a.jsx("p",{className:"text-sm text-muted-foreground hover:text-gray-600 cursor-pointer mt-3",onClick:()=>o(!0),children:"Upload Keys"})]})]})})})}),a.jsx("div",{className:"hidden lg:flex flex-1 items-center justify-center p-12 relative z-10",children:a.jsxs("div",{className:"max-w-lg text-white",children:[a.jsx("h1",{className:"text-6xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-white to-white/80",children:"MATA"}),a.jsx("h2",{className:"text-3xl font-semibold mb-6 text-white/90",children:"Digital Freedom"}),a.jsx("p",{className:"text-xl text-gray-300 leading-relaxed",children:"Take back ownership of your data."})]})}),a.jsx(MK,{open:s,setOpen:o})]})}function LK(){return a.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:a.jsx(Ke,{className:"w-full max-w-md mx-4",children:a.jsxs(Ue,{className:"pt-6",children:[a.jsxs("div",{className:"flex mb-4 gap-2",children:[a.jsx(is,{className:"h-8 w-8 text-red-500"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),a.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function FK(){return a.jsxs(yM,{children:[a.jsx(A5,{path:"/",component:MB}),a.jsx(di,{path:"/auth",component:zK}),a.jsx(di,{path:"/extension-test",component:Y3}),a.jsx(di,{component:LK})]})}function VK(){return a.jsx(zM,{client:Qo,children:a.jsx(T5,{children:a.jsx(j5,{children:a.jsxs("div",{children:[a.jsx(FK,{}),a.jsx(l5,{}),a.jsx($j,{})]})})})})}function UK(){"serviceWorker"in navigator?window.addEventListener("load",async()=>{try{let e=function(){const n=document.getElementById("offline-message");n&&(navigator.onLine?n.style.display="none":n.style.display="block")};console.log("Registering service worker...");const t=await navigator.serviceWorker.register("/service-worker.js");console.log("ServiceWorker registration successful with scope:",t.scope),navigator.serviceWorker.controller?console.log("Service worker is controlling this page"):console.log("Service worker is registered but not yet controlling the page"),t.addEventListener("updatefound",()=>{const n=t.installing;n&&(console.log("New service worker is being installed"),n.addEventListener("statechange",()=>{console.log("Service worker state changed to:",n.state)}))}),window.addEventListener("online",e),window.addEventListener("offline",e),e()}catch(e){console.error("ServiceWorker registration failed:",e),e instanceof TypeError?console.error("TypeError in service worker registration. Check if the service-worker.js file exists and is accessible."):e instanceof DOMException&&console.error("DOMException in service worker registration:",e.name,e.message)}}):console.log("Service workers are not supported in this browser")}async function BK(){try{console.log("Loading WASM via direct import...");try{const e=await oe(()=>import("./mata_auth_wasm-CJeCcmGn.js"),[]);await e.default();const t={...e};if(typeof t.generate_random_key=="function"){const n=t.generate_random_key;t.generate_random_key=async()=>n()}if(typeof t.encrypt_data=="function"){console.log("Found encrypt_data function in WASM, creating vault_encrypt_data alias");const n=t.encrypt_data;t.vault_encrypt_data=async(r,s)=>n(r,s)}else if(typeof t.vault_encrypt_data=="function"){const n=t.vault_encrypt_data;t.vault_encrypt_data=async(r,s)=>n(r,s)}if(typeof t.decrypt_data=="function"){console.log("Found decrypt_data function in WASM, creating vault_decrypt_data alias");const n=t.decrypt_data;t.vault_decrypt_data=async(r,s)=>n(r,s)}else if(typeof t.vault_decrypt_data=="function"){const n=t.vault_decrypt_data;t.vault_decrypt_data=async(r,s)=>n(r,s)}window.wasm_bindgen=Promise.resolve(t),console.log("WASM module initialized successfully via direct import")}catch(e){console.error("Failed to load WASM via direct import:",e),console.warn("Crypto operations may fall back to WebCrypto API")}try{const{initExtensionSync:e}=await oe(async()=>{const{initExtensionSync:t}=await Promise.resolve().then(()=>gi);return{initExtensionSync:t}},void 0);e(),console.log("Extension sync system initialized")}catch(e){console.warn("Extension sync initialization failed:",e)}console.log("WASM initialization complete")}catch(e){console.error("Failed to initialize WASM module:",e),console.warn("Application will run with reduced security features")}}window.addEventListener("error",e=>{console.error("Global error caught:",e.message,"at",e.filename,"line:",e.lineno,"column:",e.colno,"error:",e.error)});BK().then(()=>{try{console.log("About to render React app..."),RC(document.getElementById("root")).render(a.jsx(VK,{})),console.log("React app rendered successfully"),UK(),iN(),window.addEventListener("unload",()=>{lN()})}catch(e){console.error("Error rendering React app:",e),document.body.innerHTML=`<div style="padding: 20px; color: red;">
      <h2>Application Error</h2>
      <pre>${e instanceof Error?e.stack:String(e)}</pre>
    </div>`}});export{kt as M,oe as _,Ka as a,ko as b,fj as c,wj as d,cs as e,Wl as f,ks as g,mo as h,_5 as i,sW as j,Ru as k,eh as l,$u as m,Jm as n,qK as o,Ge as p,tt as q,kf as r,rs as s,pe as v};
